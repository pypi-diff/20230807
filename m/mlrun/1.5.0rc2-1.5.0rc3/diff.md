# Comparing `tmp/mlrun-1.5.0rc2-py3-none-any.whl.zip` & `tmp/mlrun-1.5.0rc3-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,458 +1,469 @@
-Zip file size: 1292302 bytes, number of entries: 456
--rw-r--r--  2.0 unx     7279 b- defN 23-Jul-27 15:35 mlrun/__init__.py
--rw-r--r--  2.0 unx    48410 b- defN 23-Jul-27 15:35 mlrun/__main__.py
--rw-r--r--  2.0 unx    56571 b- defN 23-Jul-27 15:35 mlrun/config.py
--rw-r--r--  2.0 unx     6780 b- defN 23-Jul-27 15:35 mlrun/errors.py
--rw-r--r--  2.0 unx    39723 b- defN 23-Jul-27 15:35 mlrun/execution.py
--rw-r--r--  2.0 unx    15624 b- defN 23-Jul-27 15:35 mlrun/features.py
--rw-r--r--  2.0 unx     4876 b- defN 23-Jul-27 15:35 mlrun/k8s_utils.py
--rw-r--r--  2.0 unx    29489 b- defN 23-Jul-27 15:35 mlrun/kfpops.py
--rw-r--r--  2.0 unx     8390 b- defN 23-Jul-27 15:35 mlrun/lists.py
--rw-r--r--  2.0 unx    60317 b- defN 23-Jul-27 15:35 mlrun/model.py
--rw-r--r--  2.0 unx    13016 b- defN 23-Jul-27 15:35 mlrun/render.py
--rw-r--r--  2.0 unx    47007 b- defN 23-Jul-27 15:35 mlrun/run.py
--rw-r--r--  2.0 unx     7783 b- defN 23-Jul-27 15:35 mlrun/secrets.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/__init__.py
--rw-r--r--  2.0 unx     2105 b- defN 23-Jul-27 15:35 mlrun/api/alembic.ini
--rw-r--r--  2.0 unx      685 b- defN 23-Jul-27 15:35 mlrun/api/constants.py
--rw-r--r--  2.0 unx    25653 b- defN 23-Jul-27 15:35 mlrun/api/initial_data.py
--rw-r--r--  2.0 unx     8681 b- defN 23-Jul-27 15:35 mlrun/api/launcher.py
--rw-r--r--  2.0 unx    27263 b- defN 23-Jul-27 15:35 mlrun/api/main.py
--rw-r--r--  2.0 unx     5289 b- defN 23-Jul-27 15:35 mlrun/api/middlewares.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/api/__init__.py
--rw-r--r--  2.0 unx     4402 b- defN 23-Jul-27 15:35 mlrun/api/api/api.py
--rw-r--r--  2.0 unx     3197 b- defN 23-Jul-27 15:35 mlrun/api/api/deps.py
--rw-r--r--  2.0 unx    40170 b- defN 23-Jul-27 15:35 mlrun/api/api/utils.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/__init__.py
--rw-r--r--  2.0 unx    10452 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/artifacts.py
--rw-r--r--  2.0 unx     1199 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/auth.py
--rw-r--r--  2.0 unx     3618 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/background_tasks.py
--rw-r--r--  2.0 unx     1214 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/client_spec.py
--rw-r--r--  2.0 unx     1175 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/clusterization_spec.py
--rw-r--r--  2.0 unx    28853 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/feature_store.py
--rw-r--r--  2.0 unx     6709 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/files.py
--rw-r--r--  2.0 unx     5946 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/frontend_spec.py
--rw-r--r--  2.0 unx    38214 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/functions.py
--rw-r--r--  2.0 unx     6086 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/grafana_proxy.py
--rw-r--r--  2.0 unx     1344 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/healthz.py
--rw-r--r--  2.0 unx    10312 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/hub.py
--rw-r--r--  2.0 unx     2975 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/logs.py
--rw-r--r--  2.0 unx    15734 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/model_endpoints.py
--rw-r--r--  2.0 unx     3756 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/operations.py
--rw-r--r--  2.0 unx     9098 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/pipelines.py
--rw-r--r--  2.0 unx    14736 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/projects.py
--rw-r--r--  2.0 unx    11881 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/runs.py
--rw-r--r--  2.0 unx     9035 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/runtime_resources.py
--rw-r--r--  2.0 unx    12544 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/schedules.py
--rw-r--r--  2.0 unx     6061 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/secrets.py
--rw-r--r--  2.0 unx     5327 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/submit.py
--rw-r--r--  2.0 unx     4849 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/tags.py
--rw-r--r--  2.0 unx    13795 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/workflows.py
--rw-r--r--  2.0 unx     1203 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/internal/__init__.py
--rw-r--r--  2.0 unx     1043 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/internal/config.py
--rw-r--r--  2.0 unx     1718 b- defN 23-Jul-27 15:35 mlrun/api/api/endpoints/internal/memory_reports.py
--rw-r--r--  2.0 unx     1248 b- defN 23-Jul-27 15:35 mlrun/api/crud/__init__.py
--rw-r--r--  2.0 unx     5610 b- defN 23-Jul-27 15:35 mlrun/api/crud/artifacts.py
--rw-r--r--  2.0 unx     7536 b- defN 23-Jul-27 15:35 mlrun/api/crud/client_spec.py
--rw-r--r--  2.0 unx     1055 b- defN 23-Jul-27 15:35 mlrun/api/crud/clusterization_spec.py
--rw-r--r--  2.0 unx    18971 b- defN 23-Jul-27 15:35 mlrun/api/crud/feature_store.py
--rw-r--r--  2.0 unx     3556 b- defN 23-Jul-27 15:35 mlrun/api/crud/functions.py
--rw-r--r--  2.0 unx    12025 b- defN 23-Jul-27 15:35 mlrun/api/crud/hub.py
--rw-r--r--  2.0 unx     9409 b- defN 23-Jul-27 15:35 mlrun/api/crud/logs.py
--rw-r--r--  2.0 unx     5739 b- defN 23-Jul-27 15:35 mlrun/api/crud/notifications.py
--rw-r--r--  2.0 unx    14781 b- defN 23-Jul-27 15:35 mlrun/api/crud/pipelines.py
--rw-r--r--  2.0 unx    15240 b- defN 23-Jul-27 15:35 mlrun/api/crud/projects.py
--rw-r--r--  2.0 unx     5963 b- defN 23-Jul-27 15:35 mlrun/api/crud/runs.py
--rw-r--r--  2.0 unx     5645 b- defN 23-Jul-27 15:35 mlrun/api/crud/runtime_resources.py
--rw-r--r--  2.0 unx    22158 b- defN 23-Jul-27 15:35 mlrun/api/crud/secrets.py
--rw-r--r--  2.0 unx     3277 b- defN 23-Jul-27 15:35 mlrun/api/crud/tags.py
--rw-r--r--  2.0 unx    13193 b- defN 23-Jul-27 15:35 mlrun/api/crud/workflows.py
--rw-r--r--  2.0 unx      759 b- defN 23-Jul-27 15:35 mlrun/api/crud/model_monitoring/__init__.py
--rw-r--r--  2.0 unx    21692 b- defN 23-Jul-27 15:35 mlrun/api/crud/model_monitoring/deployment.py
--rw-r--r--  2.0 unx    17494 b- defN 23-Jul-27 15:35 mlrun/api/crud/model_monitoring/grafana.py
--rw-r--r--  2.0 unx     5581 b- defN 23-Jul-27 15:35 mlrun/api/crud/model_monitoring/helpers.py
--rw-r--r--  2.0 unx    31573 b- defN 23-Jul-27 15:35 mlrun/api/crud/model_monitoring/model_endpoints.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/crud/runtimes/__init__.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/crud/runtimes/nuclio/__init__.py
--rw-r--r--  2.0 unx    18762 b- defN 23-Jul-27 15:35 mlrun/api/crud/runtimes/nuclio/function.py
--rw-r--r--  2.0 unx    11510 b- defN 23-Jul-27 15:35 mlrun/api/crud/runtimes/nuclio/helpers.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/db/__init__.py
--rw-r--r--  2.0 unx    15769 b- defN 23-Jul-27 15:35 mlrun/api/db/base.py
--rw-r--r--  2.0 unx      739 b- defN 23-Jul-27 15:35 mlrun/api/db/init_db.py
--rw-r--r--  2.0 unx      994 b- defN 23-Jul-27 15:35 mlrun/api/db/session.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/db/sqldb/__init__.py
--rw-r--r--  2.0 unx   151630 b- defN 23-Jul-27 15:35 mlrun/api/db/sqldb/db.py
--rw-r--r--  2.0 unx     2340 b- defN 23-Jul-27 15:35 mlrun/api/db/sqldb/helpers.py
--rw-r--r--  2.0 unx     1105 b- defN 23-Jul-27 15:35 mlrun/api/db/sqldb/models/__init__.py
--rw-r--r--  2.0 unx    21345 b- defN 23-Jul-27 15:35 mlrun/api/db/sqldb/models/models_mysql.py
--rw-r--r--  2.0 unx    19014 b- defN 23-Jul-27 15:35 mlrun/api/db/sqldb/models/models_sqlite.py
--rw-r--r--  2.0 unx     2906 b- defN 23-Jul-27 15:35 mlrun/api/migrations_mysql/env.py
--rw-r--r--  2.0 unx     1203 b- defN 23-Jul-27 15:35 mlrun/api/migrations_mysql/versions/28383af526f3_market_place_to_hub.py
--rw-r--r--  2.0 unx     4614 b- defN 23-Jul-27 15:35 mlrun/api/migrations_mysql/versions/32bae1b0e29c_increase_timestamp_fields_precision.py
--rw-r--r--  2.0 unx     1936 b- defN 23-Jul-27 15:35 mlrun/api/migrations_mysql/versions/4903aef6a91d_tag_foreign_key_and_cascades.py
--rw-r--r--  2.0 unx     1909 b- defN 23-Jul-27 15:35 mlrun/api/migrations_mysql/versions/5f1351c88a19_adding_background_tasks_table.py
--rw-r--r--  2.0 unx     1415 b- defN 23-Jul-27 15:35 mlrun/api/migrations_mysql/versions/88e656800d6a_add_requested_logs_column_and_index_to_.py
--rw-r--r--  2.0 unx     1504 b- defN 23-Jul-27 15:35 mlrun/api/migrations_mysql/versions/9d16de5f03a7_adding_data_versions_table.py
--rw-r--r--  2.0 unx     1649 b- defN 23-Jul-27 15:35 mlrun/api/migrations_mysql/versions/b86f5b53f3d7_adding_name_and_updated_to_runs_table.py
--rw-r--r--  2.0 unx    24057 b- defN 23-Jul-27 15:35 mlrun/api/migrations_mysql/versions/c4af40b0bf61_init.py
--rw-r--r--  2.0 unx     2662 b- defN 23-Jul-27 15:35 mlrun/api/migrations_mysql/versions/c905d15bd91d_notifications.py
--rw-r--r--  2.0 unx     1351 b- defN 23-Jul-27 15:35 mlrun/api/migrations_mysql/versions/ee041e8fdaa0_adding_next_run_time_column_to_schedule_.py
--rw-r--r--  2.0 unx     2906 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/env.py
--rw-r--r--  2.0 unx    11473 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/11f8dd2dc9fe_init.py
--rw-r--r--  2.0 unx     1348 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/1c954f8cb32d_schedule_last_run_uri.py
--rw-r--r--  2.0 unx     5180 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/2b6d23c715aa_adding_feature_sets.py
--rw-r--r--  2.0 unx     2595 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/4acd9430b093_market_place_to_hub.py
--rw-r--r--  2.0 unx     1388 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/6401142f2d7c_adding_next_run_time_column_to_schedule_.py
--rw-r--r--  2.0 unx     1767 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/64d90a1a69bc_adding_background_tasks_table.py
--rw-r--r--  2.0 unx     1360 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/803438ecd005_add_requested_logs_column_to_runs.py
--rw-r--r--  2.0 unx     1259 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/863114f0c659_refactoring_feature_set.py
--rw-r--r--  2.0 unx     2352 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/959ae00528ad_notifications.py
--rw-r--r--  2.0 unx     1482 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/accf9fc83d38_adding_data_versions_table.py
--rw-r--r--  2.0 unx     1892 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/b68e8e897a28_schedule_labels.py
--rw-r--r--  2.0 unx     1882 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/bcd0c1f9720c_adding_project_labels.py
--rw-r--r--  2.0 unx     1420 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/cf21882f938e_schedule_id.py
--rw-r--r--  2.0 unx     2034 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/d781f58f607f_tag_object_name_string.py
--rw-r--r--  2.0 unx     1828 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/deac06871ace_adding_marketplace_sources_table.py
--rw-r--r--  2.0 unx     1380 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/e1dd5983c06b_schedule_concurrency_limit.py
--rw-r--r--  2.0 unx     1831 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/e5594ed3ab53_adding_name_and_updated_to_runs_table.py
--rw-r--r--  2.0 unx     3936 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/f4249b4ba6fa_adding_feature_vectors.py
--rw-r--r--  2.0 unx     2588 b- defN 23-Jul-27 15:35 mlrun/api/migrations_sqlite/versions/f7b5a1a03629_adding_feature_labels.py
--rw-r--r--  2.0 unx      577 b- defN 23-Jul-27 15:35 mlrun/api/rundb/__init__.py
--rw-r--r--  2.0 unx    25246 b- defN 23-Jul-27 15:35 mlrun/api/rundb/sqldb.py
--rw-r--r--  2.0 unx     2523 b- defN 23-Jul-27 15:35 mlrun/api/runtime_handlers/__init__.py
--rw-r--r--  2.0 unx    50942 b- defN 23-Jul-27 15:35 mlrun/api/runtime_handlers/base.py
--rw-r--r--  2.0 unx     7886 b- defN 23-Jul-27 15:35 mlrun/api/runtime_handlers/daskjob.py
--rw-r--r--  2.0 unx     1309 b- defN 23-Jul-27 15:35 mlrun/api/runtime_handlers/kubejob.py
--rw-r--r--  2.0 unx     5433 b- defN 23-Jul-27 15:35 mlrun/api/runtime_handlers/mpijob.py
--rw-r--r--  2.0 unx     1036 b- defN 23-Jul-27 15:35 mlrun/api/runtime_handlers/remotesparkjob.py
--rw-r--r--  2.0 unx     5440 b- defN 23-Jul-27 15:35 mlrun/api/runtime_handlers/sparkjob.py
--rw-r--r--  2.0 unx    13571 b- defN 23-Jul-27 15:35 mlrun/api/schemas/__init__.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/utils/__init__.py
--rw-r--r--  2.0 unx     1092 b- defN 23-Jul-27 15:35 mlrun/api/utils/asyncio.py
--rw-r--r--  2.0 unx     7371 b- defN 23-Jul-27 15:35 mlrun/api/utils/background_tasks.py
--rw-r--r--  2.0 unx    26821 b- defN 23-Jul-27 15:35 mlrun/api/utils/builder.py
--rw-r--r--  2.0 unx     2512 b- defN 23-Jul-27 15:35 mlrun/api/utils/helpers.py
--rw-r--r--  2.0 unx     3728 b- defN 23-Jul-27 15:35 mlrun/api/utils/memory_reports.py
--rw-r--r--  2.0 unx     2760 b- defN 23-Jul-27 15:35 mlrun/api/utils/periodic.py
--rw-r--r--  2.0 unx    45705 b- defN 23-Jul-27 15:35 mlrun/api/utils/scheduler.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/utils/auth/__init__.py
--rw-r--r--  2.0 unx    12383 b- defN 23-Jul-27 15:35 mlrun/api/utils/auth/verifier.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/utils/auth/providers/__init__.py
--rw-r--r--  2.0 unx     1381 b- defN 23-Jul-27 15:35 mlrun/api/utils/auth/providers/base.py
--rw-r--r--  2.0 unx     1460 b- defN 23-Jul-27 15:35 mlrun/api/utils/auth/providers/nop.py
--rw-r--r--  2.0 unx    10883 b- defN 23-Jul-27 15:35 mlrun/api/utils/auth/providers/opa.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/utils/clients/__init__.py
--rw-r--r--  2.0 unx    14075 b- defN 23-Jul-27 15:35 mlrun/api/utils/clients/chief.py
--rw-r--r--  2.0 unx    32674 b- defN 23-Jul-27 15:35 mlrun/api/utils/clients/iguazio.py
--rw-r--r--  2.0 unx    12281 b- defN 23-Jul-27 15:35 mlrun/api/utils/clients/log_collector.py
--rw-r--r--  2.0 unx     9911 b- defN 23-Jul-27 15:35 mlrun/api/utils/clients/nuclio.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/utils/clients/protocols/__init__.py
--rw-r--r--  2.0 unx     2567 b- defN 23-Jul-27 15:35 mlrun/api/utils/clients/protocols/grpc.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/utils/db/__init__.py
--rw-r--r--  2.0 unx     3305 b- defN 23-Jul-27 15:35 mlrun/api/utils/db/alembic.py
--rw-r--r--  2.0 unx     8214 b- defN 23-Jul-27 15:35 mlrun/api/utils/db/backup.py
--rw-r--r--  2.0 unx     3787 b- defN 23-Jul-27 15:35 mlrun/api/utils/db/mysql.py
--rw-r--r--  2.0 unx      992 b- defN 23-Jul-27 15:35 mlrun/api/utils/db/sql_collation.py
--rw-r--r--  2.0 unx     3861 b- defN 23-Jul-27 15:35 mlrun/api/utils/db/sqlite_migration.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/utils/events/__init__.py
--rw-r--r--  2.0 unx     1721 b- defN 23-Jul-27 15:35 mlrun/api/utils/events/base.py
--rw-r--r--  2.0 unx     1630 b- defN 23-Jul-27 15:35 mlrun/api/utils/events/events_factory.py
--rw-r--r--  2.0 unx     8798 b- defN 23-Jul-27 15:35 mlrun/api/utils/events/iguazio.py
--rw-r--r--  2.0 unx     1739 b- defN 23-Jul-27 15:35 mlrun/api/utils/events/nop.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/utils/projects/__init__.py
--rw-r--r--  2.0 unx    17760 b- defN 23-Jul-27 15:35 mlrun/api/utils/projects/follower.py
--rw-r--r--  2.0 unx    19412 b- defN 23-Jul-27 15:35 mlrun/api/utils/projects/leader.py
--rw-r--r--  2.0 unx     7133 b- defN 23-Jul-27 15:35 mlrun/api/utils/projects/member.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/utils/projects/remotes/__init__.py
--rw-r--r--  2.0 unx     2659 b- defN 23-Jul-27 15:35 mlrun/api/utils/projects/remotes/follower.py
--rw-r--r--  2.0 unx     2094 b- defN 23-Jul-27 15:35 mlrun/api/utils/projects/remotes/leader.py
--rw-r--r--  2.0 unx     4995 b- defN 23-Jul-27 15:35 mlrun/api/utils/projects/remotes/nop_follower.py
--rw-r--r--  2.0 unx     3854 b- defN 23-Jul-27 15:35 mlrun/api/utils/projects/remotes/nop_leader.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/utils/runtimes/__init__.py
--rw-r--r--  2.0 unx     1675 b- defN 23-Jul-27 15:35 mlrun/api/utils/runtimes/nuclio.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/api/utils/singletons/__init__.py
--rw-r--r--  2.0 unx     1313 b- defN 23-Jul-27 15:35 mlrun/api/utils/singletons/db.py
--rw-r--r--  2.0 unx    24570 b- defN 23-Jul-27 15:35 mlrun/api/utils/singletons/k8s.py
--rw-r--r--  2.0 unx      840 b- defN 23-Jul-27 15:35 mlrun/api/utils/singletons/logs_dir.py
--rw-r--r--  2.0 unx     1312 b- defN 23-Jul-27 15:35 mlrun/api/utils/singletons/project_member.py
--rw-r--r--  2.0 unx     1064 b- defN 23-Jul-27 15:35 mlrun/api/utils/singletons/scheduler.py
--rw-r--r--  2.0 unx     1123 b- defN 23-Jul-27 15:35 mlrun/artifacts/__init__.py
--rw-r--r--  2.0 unx    31144 b- defN 23-Jul-27 15:35 mlrun/artifacts/base.py
--rw-r--r--  2.0 unx    20485 b- defN 23-Jul-27 15:35 mlrun/artifacts/dataset.py
--rw-r--r--  2.0 unx    12573 b- defN 23-Jul-27 15:35 mlrun/artifacts/manager.py
--rw-r--r--  2.0 unx    24241 b- defN 23-Jul-27 15:35 mlrun/artifacts/model.py
--rw-r--r--  2.0 unx    15383 b- defN 23-Jul-27 15:35 mlrun/artifacts/plots.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/common/__init__.py
--rw-r--r--  2.0 unx      660 b- defN 23-Jul-27 15:35 mlrun/common/constants.py
--rw-r--r--  2.0 unx     1108 b- defN 23-Jul-27 15:35 mlrun/common/helpers.py
--rw-r--r--  2.0 unx      790 b- defN 23-Jul-27 15:35 mlrun/common/types.py
--rw-r--r--  2.0 unx      571 b- defN 23-Jul-27 15:35 mlrun/common/db/__init__.py
--rw-r--r--  2.0 unx     2542 b- defN 23-Jul-27 15:35 mlrun/common/db/sql_session.py
--rw-r--r--  2.0 unx      721 b- defN 23-Jul-27 15:35 mlrun/common/model_monitoring/__init__.py
--rw-r--r--  2.0 unx     2312 b- defN 23-Jul-27 15:35 mlrun/common/model_monitoring/helpers.py
--rw-r--r--  2.0 unx     4496 b- defN 23-Jul-27 15:35 mlrun/common/schemas/__init__.py
--rw-r--r--  2.0 unx     1923 b- defN 23-Jul-27 15:35 mlrun/common/schemas/artifact.py
--rw-r--r--  2.0 unx     5730 b- defN 23-Jul-27 15:35 mlrun/common/schemas/auth.py
--rw-r--r--  2.0 unx     1553 b- defN 23-Jul-27 15:35 mlrun/common/schemas/background_task.py
--rw-r--r--  2.0 unx     2813 b- defN 23-Jul-27 15:35 mlrun/common/schemas/client_spec.py
--rw-r--r--  2.0 unx      888 b- defN 23-Jul-27 15:35 mlrun/common/schemas/clusterization_spec.py
--rw-r--r--  2.0 unx     6243 b- defN 23-Jul-27 15:35 mlrun/common/schemas/constants.py
--rw-r--r--  2.0 unx     1026 b- defN 23-Jul-27 15:35 mlrun/common/schemas/events.py
--rw-r--r--  2.0 unx     3723 b- defN 23-Jul-27 15:35 mlrun/common/schemas/feature_store.py
--rw-r--r--  2.0 unx     2546 b- defN 23-Jul-27 15:35 mlrun/common/schemas/frontend_spec.py
--rw-r--r--  2.0 unx     4432 b- defN 23-Jul-27 15:35 mlrun/common/schemas/function.py
--rw-r--r--  2.0 unx      705 b- defN 23-Jul-27 15:35 mlrun/common/schemas/http.py
--rw-r--r--  2.0 unx     4245 b- defN 23-Jul-27 15:35 mlrun/common/schemas/hub.py
--rw-r--r--  2.0 unx     1395 b- defN 23-Jul-27 15:35 mlrun/common/schemas/k8s.py
--rw-r--r--  2.0 unx      920 b- defN 23-Jul-27 15:35 mlrun/common/schemas/memory_reports.py
--rw-r--r--  2.0 unx     1518 b- defN 23-Jul-27 15:35 mlrun/common/schemas/notification.py
--rw-r--r--  2.0 unx     1986 b- defN 23-Jul-27 15:35 mlrun/common/schemas/object.py
--rw-r--r--  2.0 unx     1184 b- defN 23-Jul-27 15:35 mlrun/common/schemas/pipeline.py
--rw-r--r--  2.0 unx     4224 b- defN 23-Jul-27 15:35 mlrun/common/schemas/project.py
--rw-r--r--  2.0 unx      776 b- defN 23-Jul-27 15:35 mlrun/common/schemas/regex.py
--rw-r--r--  2.0 unx      745 b- defN 23-Jul-27 15:35 mlrun/common/schemas/runs.py
--rw-r--r--  2.0 unx     1636 b- defN 23-Jul-27 15:35 mlrun/common/schemas/runtime_resource.py
--rw-r--r--  2.0 unx     4293 b- defN 23-Jul-27 15:35 mlrun/common/schemas/schedule.py
--rw-r--r--  2.0 unx     1484 b- defN 23-Jul-27 15:35 mlrun/common/schemas/secret.py
--rw-r--r--  2.0 unx      905 b- defN 23-Jul-27 15:35 mlrun/common/schemas/tag.py
--rw-r--r--  2.0 unx     1729 b- defN 23-Jul-27 15:35 mlrun/common/schemas/workflow.py
--rw-r--r--  2.0 unx     1322 b- defN 23-Jul-27 15:35 mlrun/common/schemas/model_monitoring/__init__.py
--rw-r--r--  2.0 unx     5376 b- defN 23-Jul-27 15:35 mlrun/common/schemas/model_monitoring/constants.py
--rw-r--r--  2.0 unx     1444 b- defN 23-Jul-27 15:35 mlrun/common/schemas/model_monitoring/grafana.py
--rw-r--r--  2.0 unx    11152 b- defN 23-Jul-27 15:35 mlrun/common/schemas/model_monitoring/model_endpoints.py
--rw-r--r--  2.0 unx     1087 b- defN 23-Jul-27 15:35 mlrun/data_types/__init__.py
--rw-r--r--  2.0 unx     4647 b- defN 23-Jul-27 15:35 mlrun/data_types/data_types.py
--rw-r--r--  2.0 unx     5813 b- defN 23-Jul-27 15:35 mlrun/data_types/infer.py
--rw-r--r--  2.0 unx     9426 b- defN 23-Jul-27 15:35 mlrun/data_types/spark.py
--rw-r--r--  2.0 unx     4089 b- defN 23-Jul-27 15:35 mlrun/datastore/__init__.py
--rw-r--r--  2.0 unx     6946 b- defN 23-Jul-27 15:35 mlrun/datastore/azure_blob.py
--rw-r--r--  2.0 unx    22471 b- defN 23-Jul-27 15:35 mlrun/datastore/base.py
--rw-r--r--  2.0 unx     8377 b- defN 23-Jul-27 15:35 mlrun/datastore/datastore.py
--rw-r--r--  2.0 unx     6302 b- defN 23-Jul-27 15:35 mlrun/datastore/dbfs_store.py
--rw-r--r--  2.0 unx     3791 b- defN 23-Jul-27 15:35 mlrun/datastore/filestore.py
--rw-r--r--  2.0 unx     5114 b- defN 23-Jul-27 15:35 mlrun/datastore/google_cloud_storage.py
--rw-r--r--  2.0 unx      622 b- defN 23-Jul-27 15:35 mlrun/datastore/helpers.py
--rw-r--r--  2.0 unx     2779 b- defN 23-Jul-27 15:35 mlrun/datastore/inmem.py
--rw-r--r--  2.0 unx     4873 b- defN 23-Jul-27 15:35 mlrun/datastore/redis.py
--rw-r--r--  2.0 unx     7035 b- defN 23-Jul-27 15:35 mlrun/datastore/s3.py
--rw-r--r--  2.0 unx    37649 b- defN 23-Jul-27 15:35 mlrun/datastore/sources.py
--rw-r--r--  2.0 unx     1498 b- defN 23-Jul-27 15:35 mlrun/datastore/spark_udf.py
--rw-r--r--  2.0 unx     6906 b- defN 23-Jul-27 15:35 mlrun/datastore/store_resources.py
--rw-r--r--  2.0 unx    63310 b- defN 23-Jul-27 15:35 mlrun/datastore/targets.py
--rw-r--r--  2.0 unx     5438 b- defN 23-Jul-27 15:35 mlrun/datastore/utils.py
--rw-r--r--  2.0 unx     8099 b- defN 23-Jul-27 15:35 mlrun/datastore/v3io.py
--rw-r--r--  2.0 unx     1343 b- defN 23-Jul-27 15:35 mlrun/datastore/wasbfs/__init__.py
--rw-r--r--  2.0 unx     6152 b- defN 23-Jul-27 15:35 mlrun/datastore/wasbfs/fs.py
--rw-r--r--  2.0 unx     1145 b- defN 23-Jul-27 15:35 mlrun/db/__init__.py
--rw-r--r--  2.0 unx    16494 b- defN 23-Jul-27 15:35 mlrun/db/base.py
--rw-r--r--  2.0 unx     2117 b- defN 23-Jul-27 15:35 mlrun/db/factory.py
--rw-r--r--  2.0 unx   139637 b- defN 23-Jul-27 15:35 mlrun/db/httpdb.py
--rw-r--r--  2.0 unx    13378 b- defN 23-Jul-27 15:35 mlrun/db/nopdb.py
--rw-r--r--  2.0 unx     1516 b- defN 23-Jul-27 15:35 mlrun/feature_store/__init__.py
--rw-r--r--  2.0 unx    44899 b- defN 23-Jul-27 15:35 mlrun/feature_store/api.py
--rw-r--r--  2.0 unx    12809 b- defN 23-Jul-27 15:35 mlrun/feature_store/common.py
--rw-r--r--  2.0 unx    47773 b- defN 23-Jul-27 15:35 mlrun/feature_store/feature_set.py
--rw-r--r--  2.0 unx    34934 b- defN 23-Jul-27 15:35 mlrun/feature_store/feature_vector.py
--rw-r--r--  2.0 unx    11185 b- defN 23-Jul-27 15:35 mlrun/feature_store/ingestion.py
--rw-r--r--  2.0 unx    29357 b- defN 23-Jul-27 15:35 mlrun/feature_store/steps.py
--rw-r--r--  2.0 unx     1260 b- defN 23-Jul-27 15:35 mlrun/feature_store/retrieval/__init__.py
--rw-r--r--  2.0 unx    30622 b- defN 23-Jul-27 15:35 mlrun/feature_store/retrieval/base.py
--rw-r--r--  2.0 unx     4895 b- defN 23-Jul-27 15:35 mlrun/feature_store/retrieval/dask_merger.py
--rw-r--r--  2.0 unx     7714 b- defN 23-Jul-27 15:35 mlrun/feature_store/retrieval/job.py
--rw-r--r--  2.0 unx     4218 b- defN 23-Jul-27 15:35 mlrun/feature_store/retrieval/local_merger.py
--rw-r--r--  2.0 unx     9819 b- defN 23-Jul-27 15:35 mlrun/feature_store/retrieval/spark_merger.py
--rw-r--r--  2.0 unx     6539 b- defN 23-Jul-27 15:35 mlrun/feature_store/retrieval/storey_merger.py
--rw-r--r--  2.0 unx      743 b- defN 23-Jul-27 15:35 mlrun/frameworks/__init__.py
--rw-r--r--  2.0 unx    11466 b- defN 23-Jul-27 15:35 mlrun/frameworks/parallel_coordinates.py
--rw-r--r--  2.0 unx      962 b- defN 23-Jul-27 15:35 mlrun/frameworks/_common/__init__.py
--rw-r--r--  2.0 unx     8515 b- defN 23-Jul-27 15:35 mlrun/frameworks/_common/artifacts_library.py
--rw-r--r--  2.0 unx    21018 b- defN 23-Jul-27 15:35 mlrun/frameworks/_common/mlrun_interface.py
--rw-r--r--  2.0 unx    55376 b- defN 23-Jul-27 15:35 mlrun/frameworks/_common/model_handler.py
--rw-r--r--  2.0 unx     3469 b- defN 23-Jul-27 15:35 mlrun/frameworks/_common/plan.py
--rw-r--r--  2.0 unx     5757 b- defN 23-Jul-27 15:35 mlrun/frameworks/_common/producer.py
--rw-r--r--  2.0 unx     9209 b- defN 23-Jul-27 15:35 mlrun/frameworks/_common/utils.py
--rw-r--r--  2.0 unx      750 b- defN 23-Jul-27 15:35 mlrun/frameworks/_dl_common/__init__.py
--rw-r--r--  2.0 unx     1151 b- defN 23-Jul-27 15:35 mlrun/frameworks/_dl_common/model_handler.py
--rw-r--r--  2.0 unx      996 b- defN 23-Jul-27 15:35 mlrun/frameworks/_dl_common/utils.py
--rw-r--r--  2.0 unx      787 b- defN 23-Jul-27 15:35 mlrun/frameworks/_dl_common/loggers/__init__.py
--rw-r--r--  2.0 unx    11531 b- defN 23-Jul-27 15:35 mlrun/frameworks/_dl_common/loggers/logger.py
--rw-r--r--  2.0 unx    14777 b- defN 23-Jul-27 15:35 mlrun/frameworks/_dl_common/loggers/mlrun_logger.py
--rw-r--r--  2.0 unx    28414 b- defN 23-Jul-27 15:35 mlrun/frameworks/_dl_common/loggers/tensorboard_logger.py
--rw-r--r--  2.0 unx      956 b- defN 23-Jul-27 15:35 mlrun/frameworks/_ml_common/__init__.py
--rw-r--r--  2.0 unx     3169 b- defN 23-Jul-27 15:35 mlrun/frameworks/_ml_common/artifacts_library.py
--rw-r--r--  2.0 unx    16957 b- defN 23-Jul-27 15:35 mlrun/frameworks/_ml_common/model_handler.py
--rw-r--r--  2.0 unx     2723 b- defN 23-Jul-27 15:35 mlrun/frameworks/_ml_common/pkl_model_server.py
--rw-r--r--  2.0 unx     4881 b- defN 23-Jul-27 15:35 mlrun/frameworks/_ml_common/plan.py
--rw-r--r--  2.0 unx     4061 b- defN 23-Jul-27 15:35 mlrun/frameworks/_ml_common/producer.py
--rw-r--r--  2.0 unx    10490 b- defN 23-Jul-27 15:35 mlrun/frameworks/_ml_common/utils.py
--rw-r--r--  2.0 unx      737 b- defN 23-Jul-27 15:35 mlrun/frameworks/_ml_common/loggers/__init__.py
--rw-r--r--  2.0 unx     5684 b- defN 23-Jul-27 15:35 mlrun/frameworks/_ml_common/loggers/logger.py
--rw-r--r--  2.0 unx     6453 b- defN 23-Jul-27 15:35 mlrun/frameworks/_ml_common/loggers/mlrun_logger.py
--rw-r--r--  2.0 unx      922 b- defN 23-Jul-27 15:35 mlrun/frameworks/_ml_common/plans/__init__.py
--rw-r--r--  2.0 unx     4943 b- defN 23-Jul-27 15:35 mlrun/frameworks/_ml_common/plans/calibration_curve_plan.py
--rw-r--r--  2.0 unx     6078 b- defN 23-Jul-27 15:35 mlrun/frameworks/_ml_common/plans/confusion_matrix_plan.py
--rw-r--r--  2.0 unx     6658 b- defN 23-Jul-27 15:35 mlrun/frameworks/_ml_common/plans/dataset_plan.py
--rw-r--r--  2.0 unx     5318 b- defN 23-Jul-27 15:35 mlrun/frameworks/_ml_common/plans/feature_importance_plan.py
--rw-r--r--  2.0 unx     6993 b- defN 23-Jul-27 15:35 mlrun/frameworks/_ml_common/plans/roc_curve_plan.py
--rw-r--r--  2.0 unx      706 b- defN 23-Jul-27 15:35 mlrun/frameworks/auto_mlrun/__init__.py
--rw-r--r--  2.0 unx    23796 b- defN 23-Jul-27 15:35 mlrun/frameworks/auto_mlrun/auto_mlrun.py
--rw-r--r--  2.0 unx      721 b- defN 23-Jul-27 15:35 mlrun/frameworks/huggingface/__init__.py
--rw-r--r--  2.0 unx     6083 b- defN 23-Jul-27 15:35 mlrun/frameworks/huggingface/model_server.py
--rw-r--r--  2.0 unx    15883 b- defN 23-Jul-27 15:35 mlrun/frameworks/lgbm/__init__.py
--rw-r--r--  2.0 unx    13891 b- defN 23-Jul-27 15:35 mlrun/frameworks/lgbm/model_handler.py
--rw-r--r--  2.0 unx     9189 b- defN 23-Jul-27 15:35 mlrun/frameworks/lgbm/model_server.py
--rw-r--r--  2.0 unx     8278 b- defN 23-Jul-27 15:35 mlrun/frameworks/lgbm/utils.py
--rw-r--r--  2.0 unx      857 b- defN 23-Jul-27 15:35 mlrun/frameworks/lgbm/callbacks/__init__.py
--rw-r--r--  2.0 unx     4081 b- defN 23-Jul-27 15:35 mlrun/frameworks/lgbm/callbacks/callback.py
--rw-r--r--  2.0 unx     5156 b- defN 23-Jul-27 15:35 mlrun/frameworks/lgbm/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     4137 b- defN 23-Jul-27 15:35 mlrun/frameworks/lgbm/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx      842 b- defN 23-Jul-27 15:35 mlrun/frameworks/lgbm/mlrun_interfaces/__init__.py
--rw-r--r--  2.0 unx     1624 b- defN 23-Jul-27 15:35 mlrun/frameworks/lgbm/mlrun_interfaces/booster_mlrun_interface.py
--rw-r--r--  2.0 unx    14256 b- defN 23-Jul-27 15:35 mlrun/frameworks/lgbm/mlrun_interfaces/mlrun_interface.py
--rw-r--r--  2.0 unx     1333 b- defN 23-Jul-27 15:35 mlrun/frameworks/lgbm/mlrun_interfaces/model_mlrun_interface.py
--rw-r--r--  2.0 unx      791 b- defN 23-Jul-27 15:35 mlrun/frameworks/onnx/__init__.py
--rw-r--r--  2.0 unx     6098 b- defN 23-Jul-27 15:35 mlrun/frameworks/onnx/dataset.py
--rw-r--r--  2.0 unx     2405 b- defN 23-Jul-27 15:35 mlrun/frameworks/onnx/mlrun_interface.py
--rw-r--r--  2.0 unx     6203 b- defN 23-Jul-27 15:35 mlrun/frameworks/onnx/model_handler.py
--rw-r--r--  2.0 unx     7061 b- defN 23-Jul-27 15:35 mlrun/frameworks/onnx/model_server.py
--rw-r--r--  2.0 unx    22056 b- defN 23-Jul-27 15:35 mlrun/frameworks/pytorch/__init__.py
--rw-r--r--  2.0 unx    27904 b- defN 23-Jul-27 15:35 mlrun/frameworks/pytorch/callbacks_handler.py
--rw-r--r--  2.0 unx    44639 b- defN 23-Jul-27 15:35 mlrun/frameworks/pytorch/mlrun_interface.py
--rw-r--r--  2.0 unx    22465 b- defN 23-Jul-27 15:35 mlrun/frameworks/pytorch/model_handler.py
--rw-r--r--  2.0 unx    10136 b- defN 23-Jul-27 15:35 mlrun/frameworks/pytorch/model_server.py
--rw-r--r--  2.0 unx     4515 b- defN 23-Jul-27 15:35 mlrun/frameworks/pytorch/utils.py
--rw-r--r--  2.0 unx      896 b- defN 23-Jul-27 15:35 mlrun/frameworks/pytorch/callbacks/__init__.py
--rw-r--r--  2.0 unx    11524 b- defN 23-Jul-27 15:35 mlrun/frameworks/pytorch/callbacks/callback.py
--rw-r--r--  2.0 unx    23166 b- defN 23-Jul-27 15:35 mlrun/frameworks/pytorch/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     9310 b- defN 23-Jul-27 15:35 mlrun/frameworks/pytorch/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx    26661 b- defN 23-Jul-27 15:35 mlrun/frameworks/pytorch/callbacks/tensorboard_logging_callback.py
--rw-r--r--  2.0 unx    10892 b- defN 23-Jul-27 15:35 mlrun/frameworks/sklearn/__init__.py
--rw-r--r--  2.0 unx     5852 b- defN 23-Jul-27 15:35 mlrun/frameworks/sklearn/estimator.py
--rw-r--r--  2.0 unx     7117 b- defN 23-Jul-27 15:35 mlrun/frameworks/sklearn/metric.py
--rw-r--r--  2.0 unx    12215 b- defN 23-Jul-27 15:35 mlrun/frameworks/sklearn/metrics_library.py
--rw-r--r--  2.0 unx    14126 b- defN 23-Jul-27 15:35 mlrun/frameworks/sklearn/mlrun_interface.py
--rw-r--r--  2.0 unx     4745 b- defN 23-Jul-27 15:35 mlrun/frameworks/sklearn/model_handler.py
--rw-r--r--  2.0 unx     1209 b- defN 23-Jul-27 15:35 mlrun/frameworks/sklearn/utils.py
--rw-r--r--  2.0 unx    10455 b- defN 23-Jul-27 15:35 mlrun/frameworks/tf_keras/__init__.py
--rw-r--r--  2.0 unx    16627 b- defN 23-Jul-27 15:35 mlrun/frameworks/tf_keras/mlrun_interface.py
--rw-r--r--  2.0 unx    28247 b- defN 23-Jul-27 15:35 mlrun/frameworks/tf_keras/model_handler.py
--rw-r--r--  2.0 unx     9565 b- defN 23-Jul-27 15:35 mlrun/frameworks/tf_keras/model_server.py
--rw-r--r--  2.0 unx     4284 b- defN 23-Jul-27 15:35 mlrun/frameworks/tf_keras/utils.py
--rw-r--r--  2.0 unx      844 b- defN 23-Jul-27 15:35 mlrun/frameworks/tf_keras/callbacks/__init__.py
--rw-r--r--  2.0 unx    21886 b- defN 23-Jul-27 15:35 mlrun/frameworks/tf_keras/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     8791 b- defN 23-Jul-27 15:35 mlrun/frameworks/tf_keras/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx    28728 b- defN 23-Jul-27 15:35 mlrun/frameworks/tf_keras/callbacks/tensorboard_logging_callback.py
--rw-r--r--  2.0 unx    10287 b- defN 23-Jul-27 15:35 mlrun/frameworks/xgboost/__init__.py
--rw-r--r--  2.0 unx      878 b- defN 23-Jul-27 15:35 mlrun/frameworks/xgboost/mlrun_interface.py
--rw-r--r--  2.0 unx    11617 b- defN 23-Jul-27 15:35 mlrun/frameworks/xgboost/model_handler.py
--rw-r--r--  2.0 unx     1069 b- defN 23-Jul-27 15:35 mlrun/frameworks/xgboost/utils.py
--rw-r--r--  2.0 unx      577 b- defN 23-Jul-27 15:35 mlrun/launcher/__init__.py
--rw-r--r--  2.0 unx    15798 b- defN 23-Jul-27 15:35 mlrun/launcher/base.py
--rw-r--r--  2.0 unx     6174 b- defN 23-Jul-27 15:35 mlrun/launcher/client.py
--rw-r--r--  2.0 unx     2344 b- defN 23-Jul-27 15:35 mlrun/launcher/factory.py
--rw-r--r--  2.0 unx    10815 b- defN 23-Jul-27 15:35 mlrun/launcher/local.py
--rw-r--r--  2.0 unx     6770 b- defN 23-Jul-27 15:35 mlrun/launcher/remote.py
--rw-r--r--  2.0 unx      872 b- defN 23-Jul-27 15:35 mlrun/model_monitoring/__init__.py
--rw-r--r--  2.0 unx    23970 b- defN 23-Jul-27 15:35 mlrun/model_monitoring/features_drift_table.py
--rw-r--r--  2.0 unx     1902 b- defN 23-Jul-27 15:35 mlrun/model_monitoring/helpers.py
--rw-r--r--  2.0 unx     5214 b- defN 23-Jul-27 15:35 mlrun/model_monitoring/model_endpoint.py
--rw-r--r--  2.0 unx    39798 b- defN 23-Jul-27 15:35 mlrun/model_monitoring/model_monitoring_batch.py
--rw-r--r--  2.0 unx     7605 b- defN 23-Jul-27 15:35 mlrun/model_monitoring/prometheus.py
--rw-r--r--  2.0 unx    48755 b- defN 23-Jul-27 15:35 mlrun/model_monitoring/stream_processing.py
--rw-r--r--  2.0 unx     4475 b- defN 23-Jul-27 15:35 mlrun/model_monitoring/tracking_policy.py
--rw-r--r--  2.0 unx     4525 b- defN 23-Jul-27 15:35 mlrun/model_monitoring/stores/__init__.py
--rw-r--r--  2.0 unx    20351 b- defN 23-Jul-27 15:35 mlrun/model_monitoring/stores/kv_model_endpoint_store.py
--rw-r--r--  2.0 unx     5695 b- defN 23-Jul-27 15:35 mlrun/model_monitoring/stores/model_endpoint_store.py
--rw-r--r--  2.0 unx    16123 b- defN 23-Jul-27 15:35 mlrun/model_monitoring/stores/sql_model_endpoint_store.py
--rw-r--r--  2.0 unx      884 b- defN 23-Jul-27 15:35 mlrun/model_monitoring/stores/models/__init__.py
--rw-r--r--  2.0 unx      655 b- defN 23-Jul-27 15:35 mlrun/model_monitoring/stores/models/base.py
--rw-r--r--  2.0 unx     4153 b- defN 23-Jul-27 15:35 mlrun/model_monitoring/stores/models/mysql.py
--rw-r--r--  2.0 unx     4070 b- defN 23-Jul-27 15:35 mlrun/model_monitoring/stores/models/sqlite.py
--rw-r--r--  2.0 unx     7101 b- defN 23-Jul-27 15:35 mlrun/package/__init__.py
--rw-r--r--  2.0 unx    13974 b- defN 23-Jul-27 15:35 mlrun/package/context_handler.py
--rw-r--r--  2.0 unx     1204 b- defN 23-Jul-27 15:35 mlrun/package/errors.py
--rw-r--r--  2.0 unx    12578 b- defN 23-Jul-27 15:35 mlrun/package/packager.py
--rw-r--r--  2.0 unx    37275 b- defN 23-Jul-27 15:35 mlrun/package/packagers_manager.py
--rw-r--r--  2.0 unx      769 b- defN 23-Jul-27 15:35 mlrun/package/packagers/__init__.py
--rw-r--r--  2.0 unx    24227 b- defN 23-Jul-27 15:35 mlrun/package/packagers/default_packager.py
--rw-r--r--  2.0 unx    20618 b- defN 23-Jul-27 15:35 mlrun/package/packagers/numpy_packagers.py
--rw-r--r--  2.0 unx    35951 b- defN 23-Jul-27 15:35 mlrun/package/packagers/pandas_packagers.py
--rw-r--r--  2.0 unx    21528 b- defN 23-Jul-27 15:35 mlrun/package/packagers/python_standard_library_packagers.py
--rw-r--r--  2.0 unx     1722 b- defN 23-Jul-27 15:35 mlrun/package/utils/__init__.py
--rw-r--r--  2.0 unx     7567 b- defN 23-Jul-27 15:35 mlrun/package/utils/_archiver.py
--rw-r--r--  2.0 unx     6393 b- defN 23-Jul-27 15:35 mlrun/package/utils/_formatter.py
--rw-r--r--  2.0 unx    10926 b- defN 23-Jul-27 15:35 mlrun/package/utils/_pickler.py
--rw-r--r--  2.0 unx     2379 b- defN 23-Jul-27 15:35 mlrun/package/utils/_supported_format.py
--rw-r--r--  2.0 unx     3709 b- defN 23-Jul-27 15:35 mlrun/package/utils/log_hint_utils.py
--rw-r--r--  2.0 unx    14825 b- defN 23-Jul-27 15:35 mlrun/package/utils/type_hint_utils.py
--rw-r--r--  2.0 unx     2352 b- defN 23-Jul-27 15:35 mlrun/platforms/__init__.py
--rw-r--r--  2.0 unx    21581 b- defN 23-Jul-27 15:35 mlrun/platforms/iguazio.py
--rw-r--r--  2.0 unx    11852 b- defN 23-Jul-27 15:35 mlrun/platforms/other.py
--rw-r--r--  2.0 unx     1153 b- defN 23-Jul-27 15:35 mlrun/projects/__init__.py
--rw-r--r--  2.0 unx    17602 b- defN 23-Jul-27 15:35 mlrun/projects/operations.py
--rw-r--r--  2.0 unx    34337 b- defN 23-Jul-27 15:35 mlrun/projects/pipelines.py
--rw-r--r--  2.0 unx   126661 b- defN 23-Jul-27 15:35 mlrun/projects/project.py
--rw-r--r--  2.0 unx     7174 b- defN 23-Jul-27 15:35 mlrun/runtimes/__init__.py
--rw-r--r--  2.0 unx    36681 b- defN 23-Jul-27 15:35 mlrun/runtimes/base.py
--rw-r--r--  2.0 unx     6689 b- defN 23-Jul-27 15:35 mlrun/runtimes/constants.py
--rw-r--r--  2.0 unx    22830 b- defN 23-Jul-27 15:35 mlrun/runtimes/daskjob.py
--rw-r--r--  2.0 unx     9994 b- defN 23-Jul-27 15:35 mlrun/runtimes/funcdoc.py
--rw-r--r--  2.0 unx    45208 b- defN 23-Jul-27 15:35 mlrun/runtimes/function.py
--rw-r--r--  2.0 unx     4911 b- defN 23-Jul-27 15:35 mlrun/runtimes/function_reference.py
--rw-r--r--  2.0 unx     6530 b- defN 23-Jul-27 15:35 mlrun/runtimes/generators.py
--rw-r--r--  2.0 unx    14634 b- defN 23-Jul-27 15:35 mlrun/runtimes/kubejob.py
--rw-r--r--  2.0 unx    19579 b- defN 23-Jul-27 15:35 mlrun/runtimes/local.py
--rw-r--r--  2.0 unx     2877 b- defN 23-Jul-27 15:35 mlrun/runtimes/nuclio.py
--rw-r--r--  2.0 unx    61396 b- defN 23-Jul-27 15:35 mlrun/runtimes/pod.py
--rw-r--r--  2.0 unx     7289 b- defN 23-Jul-27 15:35 mlrun/runtimes/remotesparkjob.py
--rw-r--r--  2.0 unx    30483 b- defN 23-Jul-27 15:35 mlrun/runtimes/serving.py
--rw-r--r--  2.0 unx    20801 b- defN 23-Jul-27 15:35 mlrun/runtimes/utils.py
--rw-r--r--  2.0 unx      742 b- defN 23-Jul-27 15:35 mlrun/runtimes/mpijob/__init__.py
--rw-r--r--  2.0 unx    15147 b- defN 23-Jul-27 15:35 mlrun/runtimes/mpijob/abstract.py
--rw-r--r--  2.0 unx    10916 b- defN 23-Jul-27 15:35 mlrun/runtimes/mpijob/v1.py
--rw-r--r--  2.0 unx     5650 b- defN 23-Jul-27 15:35 mlrun/runtimes/mpijob/v1alpha1.py
--rw-r--r--  2.0 unx      709 b- defN 23-Jul-27 15:35 mlrun/runtimes/sparkjob/__init__.py
--rw-r--r--  2.0 unx    30404 b- defN 23-Jul-27 15:35 mlrun/runtimes/sparkjob/abstract.py
--rw-r--r--  2.0 unx    28746 b- defN 23-Jul-27 15:35 mlrun/runtimes/sparkjob/spark3job.py
--rw-r--r--  2.0 unx     1078 b- defN 23-Jul-27 15:35 mlrun/serving/__init__.py
--rw-r--r--  2.0 unx     6116 b- defN 23-Jul-27 15:35 mlrun/serving/merger.py
--rw-r--r--  2.0 unx    18038 b- defN 23-Jul-27 15:35 mlrun/serving/remote.py
--rw-r--r--  2.0 unx    55318 b- defN 23-Jul-27 15:35 mlrun/serving/routers.py
--rw-r--r--  2.0 unx    20439 b- defN 23-Jul-27 15:35 mlrun/serving/server.py
--rw-r--r--  2.0 unx      836 b- defN 23-Jul-27 15:35 mlrun/serving/serving_wrapper.py
--rw-r--r--  2.0 unx    54288 b- defN 23-Jul-27 15:35 mlrun/serving/states.py
--rw-r--r--  2.0 unx     3902 b- defN 23-Jul-27 15:35 mlrun/serving/utils.py
--rw-r--r--  2.0 unx    11814 b- defN 23-Jul-27 15:35 mlrun/serving/v1_serving.py
--rw-r--r--  2.0 unx    21823 b- defN 23-Jul-27 15:35 mlrun/serving/v2_serving.py
--rw-r--r--  2.0 unx      826 b- defN 23-Jul-27 15:35 mlrun/utils/__init__.py
--rw-r--r--  2.0 unx    10636 b- defN 23-Jul-27 15:35 mlrun/utils/async_http.py
--rw-r--r--  2.0 unx     3456 b- defN 23-Jul-27 15:35 mlrun/utils/azure_vault.py
--rw-r--r--  2.0 unx     6245 b- defN 23-Jul-27 15:35 mlrun/utils/clones.py
--rw-r--r--  2.0 unx     1920 b- defN 23-Jul-27 15:35 mlrun/utils/condition_evaluator.py
--rw-r--r--  2.0 unx     1662 b- defN 23-Jul-27 15:35 mlrun/utils/db.py
--rw-r--r--  2.0 unx    47314 b- defN 23-Jul-27 15:35 mlrun/utils/helpers.py
--rw-r--r--  2.0 unx     8241 b- defN 23-Jul-27 15:35 mlrun/utils/http.py
--rw-r--r--  2.0 unx     7035 b- defN 23-Jul-27 15:35 mlrun/utils/logger.py
--rw-r--r--  2.0 unx     4430 b- defN 23-Jul-27 15:35 mlrun/utils/regex.py
--rw-r--r--  2.0 unx      883 b- defN 23-Jul-27 15:35 mlrun/utils/singleton.py
--rw-r--r--  2.0 unx     1319 b- defN 23-Jul-27 15:35 mlrun/utils/v3io_clients.py
--rw-r--r--  2.0 unx    10447 b- defN 23-Jul-27 15:35 mlrun/utils/vault.py
--rw-r--r--  2.0 unx      990 b- defN 23-Jul-27 15:35 mlrun/utils/notifications/__init__.py
--rw-r--r--  2.0 unx    19251 b- defN 23-Jul-27 15:35 mlrun/utils/notifications/notification_pusher.py
--rw-r--r--  2.0 unx     2113 b- defN 23-Jul-27 15:35 mlrun/utils/notifications/notification/__init__.py
--rw-r--r--  2.0 unx     2293 b- defN 23-Jul-27 15:35 mlrun/utils/notifications/notification/base.py
--rw-r--r--  2.0 unx     1971 b- defN 23-Jul-27 15:35 mlrun/utils/notifications/notification/console.py
--rw-r--r--  2.0 unx     5221 b- defN 23-Jul-27 15:35 mlrun/utils/notifications/notification/git.py
--rw-r--r--  2.0 unx     1962 b- defN 23-Jul-27 15:35 mlrun/utils/notifications/notification/ipython.py
--rw-r--r--  2.0 unx     3898 b- defN 23-Jul-27 15:35 mlrun/utils/notifications/notification/slack.py
--rw-r--r--  2.0 unx     1865 b- defN 23-Jul-27 15:35 mlrun/utils/notifications/notification/webhook.py
--rw-r--r--  2.0 unx      614 b- defN 23-Jul-27 15:35 mlrun/utils/version/__init__.py
--rw-r--r--  2.0 unx       88 b- defN 23-Jul-27 15:35 mlrun/utils/version/version.json
--rw-r--r--  2.0 unx     1970 b- defN 23-Jul-27 15:35 mlrun/utils/version/version.py
--rw-r--r--  2.0 unx    11357 b- defN 23-Jul-27 15:35 mlrun-1.5.0rc2.dist-info/LICENSE
--rw-r--r--  2.0 unx    17062 b- defN 23-Jul-27 15:35 mlrun-1.5.0rc2.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jul-27 15:35 mlrun-1.5.0rc2.dist-info/WHEEL
--rw-r--r--  2.0 unx       47 b- defN 23-Jul-27 15:35 mlrun-1.5.0rc2.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        6 b- defN 23-Jul-27 15:35 mlrun-1.5.0rc2.dist-info/top_level.txt
--rw-rw-r--  2.0 unx    42827 b- defN 23-Jul-27 15:35 mlrun-1.5.0rc2.dist-info/RECORD
-456 files, 4808627 bytes uncompressed, 1223992 bytes compressed:  74.6%
+Zip file size: 1319024 bytes, number of entries: 467
+-rw-r--r--  2.0 unx     7279 b- defN 23-Aug-07 15:02 mlrun/__init__.py
+-rw-r--r--  2.0 unx    48480 b- defN 23-Aug-07 15:02 mlrun/__main__.py
+-rw-r--r--  2.0 unx    56989 b- defN 23-Aug-07 15:02 mlrun/config.py
+-rw-r--r--  2.0 unx     6780 b- defN 23-Aug-07 15:02 mlrun/errors.py
+-rw-r--r--  2.0 unx    39723 b- defN 23-Aug-07 15:02 mlrun/execution.py
+-rw-r--r--  2.0 unx    15624 b- defN 23-Aug-07 15:02 mlrun/features.py
+-rw-r--r--  2.0 unx     4876 b- defN 23-Aug-07 15:02 mlrun/k8s_utils.py
+-rw-r--r--  2.0 unx    29489 b- defN 23-Aug-07 15:02 mlrun/kfpops.py
+-rw-r--r--  2.0 unx     8390 b- defN 23-Aug-07 15:02 mlrun/lists.py
+-rw-r--r--  2.0 unx    60657 b- defN 23-Aug-07 15:02 mlrun/model.py
+-rw-r--r--  2.0 unx    13016 b- defN 23-Aug-07 15:02 mlrun/render.py
+-rw-r--r--  2.0 unx    47374 b- defN 23-Aug-07 15:02 mlrun/run.py
+-rw-r--r--  2.0 unx     7783 b- defN 23-Aug-07 15:02 mlrun/secrets.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/__init__.py
+-rw-r--r--  2.0 unx     2105 b- defN 23-Aug-07 15:02 mlrun/api/alembic.ini
+-rw-r--r--  2.0 unx      685 b- defN 23-Aug-07 15:02 mlrun/api/constants.py
+-rw-r--r--  2.0 unx    26133 b- defN 23-Aug-07 15:02 mlrun/api/initial_data.py
+-rw-r--r--  2.0 unx     9167 b- defN 23-Aug-07 15:02 mlrun/api/launcher.py
+-rw-r--r--  2.0 unx    27263 b- defN 23-Aug-07 15:02 mlrun/api/main.py
+-rw-r--r--  2.0 unx     5289 b- defN 23-Aug-07 15:02 mlrun/api/middlewares.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/api/__init__.py
+-rw-r--r--  2.0 unx     4644 b- defN 23-Aug-07 15:02 mlrun/api/api/api.py
+-rw-r--r--  2.0 unx     3197 b- defN 23-Aug-07 15:02 mlrun/api/api/deps.py
+-rw-r--r--  2.0 unx    39018 b- defN 23-Aug-07 15:02 mlrun/api/api/utils.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/__init__.py
+-rw-r--r--  2.0 unx    10452 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/artifacts.py
+-rw-r--r--  2.0 unx     1199 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/auth.py
+-rw-r--r--  2.0 unx     3618 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/background_tasks.py
+-rw-r--r--  2.0 unx     1214 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/client_spec.py
+-rw-r--r--  2.0 unx     1175 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/clusterization_spec.py
+-rw-r--r--  2.0 unx     4860 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/datastore_profile.py
+-rw-r--r--  2.0 unx    28853 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/feature_store.py
+-rw-r--r--  2.0 unx     6709 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/files.py
+-rw-r--r--  2.0 unx     5946 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/frontend_spec.py
+-rw-r--r--  2.0 unx    37458 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/functions.py
+-rw-r--r--  2.0 unx     6086 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/grafana_proxy.py
+-rw-r--r--  2.0 unx     1344 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/healthz.py
+-rw-r--r--  2.0 unx    10624 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/hub.py
+-rw-r--r--  2.0 unx     2931 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/jobs.py
+-rw-r--r--  2.0 unx     2975 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/logs.py
+-rw-r--r--  2.0 unx    15734 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/model_endpoints.py
+-rw-r--r--  2.0 unx     3756 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/operations.py
+-rw-r--r--  2.0 unx     9098 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/pipelines.py
+-rw-r--r--  2.0 unx    14736 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/projects.py
+-rw-r--r--  2.0 unx    11881 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/runs.py
+-rw-r--r--  2.0 unx     9035 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/runtime_resources.py
+-rw-r--r--  2.0 unx    12544 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/schedules.py
+-rw-r--r--  2.0 unx     6061 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/secrets.py
+-rw-r--r--  2.0 unx     5327 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/submit.py
+-rw-r--r--  2.0 unx     4849 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/tags.py
+-rw-r--r--  2.0 unx    13795 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/workflows.py
+-rw-r--r--  2.0 unx     1203 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/internal/__init__.py
+-rw-r--r--  2.0 unx     1043 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/internal/config.py
+-rw-r--r--  2.0 unx     1718 b- defN 23-Aug-07 15:02 mlrun/api/api/endpoints/internal/memory_reports.py
+-rw-r--r--  2.0 unx     1298 b- defN 23-Aug-07 15:02 mlrun/api/crud/__init__.py
+-rw-r--r--  2.0 unx     5610 b- defN 23-Aug-07 15:02 mlrun/api/crud/artifacts.py
+-rw-r--r--  2.0 unx     7553 b- defN 23-Aug-07 15:02 mlrun/api/crud/client_spec.py
+-rw-r--r--  2.0 unx     1055 b- defN 23-Aug-07 15:02 mlrun/api/crud/clusterization_spec.py
+-rw-r--r--  2.0 unx     3883 b- defN 23-Aug-07 15:02 mlrun/api/crud/datastore_profiles.py
+-rw-r--r--  2.0 unx    18971 b- defN 23-Aug-07 15:02 mlrun/api/crud/feature_store.py
+-rw-r--r--  2.0 unx     4536 b- defN 23-Aug-07 15:02 mlrun/api/crud/functions.py
+-rw-r--r--  2.0 unx    14107 b- defN 23-Aug-07 15:02 mlrun/api/crud/hub.py
+-rw-r--r--  2.0 unx     9409 b- defN 23-Aug-07 15:02 mlrun/api/crud/logs.py
+-rw-r--r--  2.0 unx     5739 b- defN 23-Aug-07 15:02 mlrun/api/crud/notifications.py
+-rw-r--r--  2.0 unx    14781 b- defN 23-Aug-07 15:02 mlrun/api/crud/pipelines.py
+-rw-r--r--  2.0 unx    15240 b- defN 23-Aug-07 15:02 mlrun/api/crud/projects.py
+-rw-r--r--  2.0 unx     6226 b- defN 23-Aug-07 15:02 mlrun/api/crud/runs.py
+-rw-r--r--  2.0 unx     5645 b- defN 23-Aug-07 15:02 mlrun/api/crud/runtime_resources.py
+-rw-r--r--  2.0 unx    22204 b- defN 23-Aug-07 15:02 mlrun/api/crud/secrets.py
+-rw-r--r--  2.0 unx     3277 b- defN 23-Aug-07 15:02 mlrun/api/crud/tags.py
+-rw-r--r--  2.0 unx    13485 b- defN 23-Aug-07 15:02 mlrun/api/crud/workflows.py
+-rw-r--r--  2.0 unx      759 b- defN 23-Aug-07 15:02 mlrun/api/crud/model_monitoring/__init__.py
+-rw-r--r--  2.0 unx    24698 b- defN 23-Aug-07 15:02 mlrun/api/crud/model_monitoring/deployment.py
+-rw-r--r--  2.0 unx    17494 b- defN 23-Aug-07 15:02 mlrun/api/crud/model_monitoring/grafana.py
+-rw-r--r--  2.0 unx     5581 b- defN 23-Aug-07 15:02 mlrun/api/crud/model_monitoring/helpers.py
+-rw-r--r--  2.0 unx    31643 b- defN 23-Aug-07 15:02 mlrun/api/crud/model_monitoring/model_endpoints.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/crud/runtimes/__init__.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/crud/runtimes/nuclio/__init__.py
+-rw-r--r--  2.0 unx    18762 b- defN 23-Aug-07 15:02 mlrun/api/crud/runtimes/nuclio/function.py
+-rw-r--r--  2.0 unx    11510 b- defN 23-Aug-07 15:02 mlrun/api/crud/runtimes/nuclio/helpers.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/db/__init__.py
+-rw-r--r--  2.0 unx    16379 b- defN 23-Aug-07 15:02 mlrun/api/db/base.py
+-rw-r--r--  2.0 unx      739 b- defN 23-Aug-07 15:02 mlrun/api/db/init_db.py
+-rw-r--r--  2.0 unx      994 b- defN 23-Aug-07 15:02 mlrun/api/db/session.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/db/sqldb/__init__.py
+-rw-r--r--  2.0 unx   156090 b- defN 23-Aug-07 15:02 mlrun/api/db/sqldb/db.py
+-rw-r--r--  2.0 unx     2340 b- defN 23-Aug-07 15:02 mlrun/api/db/sqldb/helpers.py
+-rw-r--r--  2.0 unx     1105 b- defN 23-Aug-07 15:02 mlrun/api/db/sqldb/models/__init__.py
+-rw-r--r--  2.0 unx    21920 b- defN 23-Aug-07 15:02 mlrun/api/db/sqldb/models/models_mysql.py
+-rw-r--r--  2.0 unx    19609 b- defN 23-Aug-07 15:02 mlrun/api/db/sqldb/models/models_sqlite.py
+-rw-r--r--  2.0 unx     2906 b- defN 23-Aug-07 15:02 mlrun/api/migrations_mysql/env.py
+-rw-r--r--  2.0 unx     1203 b- defN 23-Aug-07 15:02 mlrun/api/migrations_mysql/versions/28383af526f3_market_place_to_hub.py
+-rw-r--r--  2.0 unx     4614 b- defN 23-Aug-07 15:02 mlrun/api/migrations_mysql/versions/32bae1b0e29c_increase_timestamp_fields_precision.py
+-rw-r--r--  2.0 unx     1936 b- defN 23-Aug-07 15:02 mlrun/api/migrations_mysql/versions/4903aef6a91d_tag_foreign_key_and_cascades.py
+-rw-r--r--  2.0 unx     1909 b- defN 23-Aug-07 15:02 mlrun/api/migrations_mysql/versions/5f1351c88a19_adding_background_tasks_table.py
+-rw-r--r--  2.0 unx     1415 b- defN 23-Aug-07 15:02 mlrun/api/migrations_mysql/versions/88e656800d6a_add_requested_logs_column_and_index_to_.py
+-rw-r--r--  2.0 unx     1504 b- defN 23-Aug-07 15:02 mlrun/api/migrations_mysql/versions/9d16de5f03a7_adding_data_versions_table.py
+-rw-r--r--  2.0 unx     1768 b- defN 23-Aug-07 15:02 mlrun/api/migrations_mysql/versions/b1d1e7ab5dec_adding_table_datastore_profiles.py
+-rw-r--r--  2.0 unx     1649 b- defN 23-Aug-07 15:02 mlrun/api/migrations_mysql/versions/b86f5b53f3d7_adding_name_and_updated_to_runs_table.py
+-rw-r--r--  2.0 unx    24057 b- defN 23-Aug-07 15:02 mlrun/api/migrations_mysql/versions/c4af40b0bf61_init.py
+-rw-r--r--  2.0 unx     2662 b- defN 23-Aug-07 15:02 mlrun/api/migrations_mysql/versions/c905d15bd91d_notifications.py
+-rw-r--r--  2.0 unx     1351 b- defN 23-Aug-07 15:02 mlrun/api/migrations_mysql/versions/ee041e8fdaa0_adding_next_run_time_column_to_schedule_.py
+-rw-r--r--  2.0 unx     2906 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/env.py
+-rw-r--r--  2.0 unx    11473 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/11f8dd2dc9fe_init.py
+-rw-r--r--  2.0 unx     1348 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/1c954f8cb32d_schedule_last_run_uri.py
+-rw-r--r--  2.0 unx     5180 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/2b6d23c715aa_adding_feature_sets.py
+-rw-r--r--  2.0 unx     2595 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/4acd9430b093_market_place_to_hub.py
+-rw-r--r--  2.0 unx     1388 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/6401142f2d7c_adding_next_run_time_column_to_schedule_.py
+-rw-r--r--  2.0 unx     1767 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/64d90a1a69bc_adding_background_tasks_table.py
+-rw-r--r--  2.0 unx     1678 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/6e0c9531edc7_adding_table_datastore_profiles.py
+-rw-r--r--  2.0 unx     1360 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/803438ecd005_add_requested_logs_column_to_runs.py
+-rw-r--r--  2.0 unx     1259 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/863114f0c659_refactoring_feature_set.py
+-rw-r--r--  2.0 unx     2352 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/959ae00528ad_notifications.py
+-rw-r--r--  2.0 unx     1482 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/accf9fc83d38_adding_data_versions_table.py
+-rw-r--r--  2.0 unx     1892 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/b68e8e897a28_schedule_labels.py
+-rw-r--r--  2.0 unx     1882 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/bcd0c1f9720c_adding_project_labels.py
+-rw-r--r--  2.0 unx     1420 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/cf21882f938e_schedule_id.py
+-rw-r--r--  2.0 unx     2034 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/d781f58f607f_tag_object_name_string.py
+-rw-r--r--  2.0 unx     1828 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/deac06871ace_adding_marketplace_sources_table.py
+-rw-r--r--  2.0 unx     1380 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/e1dd5983c06b_schedule_concurrency_limit.py
+-rw-r--r--  2.0 unx     1831 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/e5594ed3ab53_adding_name_and_updated_to_runs_table.py
+-rw-r--r--  2.0 unx     3936 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/f4249b4ba6fa_adding_feature_vectors.py
+-rw-r--r--  2.0 unx     2588 b- defN 23-Aug-07 15:02 mlrun/api/migrations_sqlite/versions/f7b5a1a03629_adding_feature_labels.py
+-rw-r--r--  2.0 unx      577 b- defN 23-Aug-07 15:02 mlrun/api/rundb/__init__.py
+-rw-r--r--  2.0 unx    27385 b- defN 23-Aug-07 15:02 mlrun/api/rundb/sqldb.py
+-rw-r--r--  2.0 unx     2399 b- defN 23-Aug-07 15:02 mlrun/api/runtime_handlers/__init__.py
+-rw-r--r--  2.0 unx    50942 b- defN 23-Aug-07 15:02 mlrun/api/runtime_handlers/base.py
+-rw-r--r--  2.0 unx    14568 b- defN 23-Aug-07 15:02 mlrun/api/runtime_handlers/daskjob.py
+-rw-r--r--  2.0 unx     1442 b- defN 23-Aug-07 15:02 mlrun/api/runtime_handlers/kubejob.py
+-rw-r--r--  2.0 unx     7853 b- defN 23-Aug-07 15:02 mlrun/api/runtime_handlers/mpijob.py
+-rw-r--r--  2.0 unx     1036 b- defN 23-Aug-07 15:02 mlrun/api/runtime_handlers/remotesparkjob.py
+-rw-r--r--  2.0 unx     5440 b- defN 23-Aug-07 15:02 mlrun/api/runtime_handlers/sparkjob.py
+-rw-r--r--  2.0 unx    13571 b- defN 23-Aug-07 15:02 mlrun/api/schemas/__init__.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/utils/__init__.py
+-rw-r--r--  2.0 unx     1092 b- defN 23-Aug-07 15:02 mlrun/api/utils/asyncio.py
+-rw-r--r--  2.0 unx     7371 b- defN 23-Aug-07 15:02 mlrun/api/utils/background_tasks.py
+-rw-r--r--  2.0 unx    35401 b- defN 23-Aug-07 15:02 mlrun/api/utils/builder.py
+-rw-r--r--  2.0 unx     2512 b- defN 23-Aug-07 15:02 mlrun/api/utils/helpers.py
+-rw-r--r--  2.0 unx     3728 b- defN 23-Aug-07 15:02 mlrun/api/utils/memory_reports.py
+-rw-r--r--  2.0 unx     2760 b- defN 23-Aug-07 15:02 mlrun/api/utils/periodic.py
+-rw-r--r--  2.0 unx    45265 b- defN 23-Aug-07 15:02 mlrun/api/utils/scheduler.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/utils/auth/__init__.py
+-rw-r--r--  2.0 unx    12383 b- defN 23-Aug-07 15:02 mlrun/api/utils/auth/verifier.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/utils/auth/providers/__init__.py
+-rw-r--r--  2.0 unx     1381 b- defN 23-Aug-07 15:02 mlrun/api/utils/auth/providers/base.py
+-rw-r--r--  2.0 unx     1460 b- defN 23-Aug-07 15:02 mlrun/api/utils/auth/providers/nop.py
+-rw-r--r--  2.0 unx    10883 b- defN 23-Aug-07 15:02 mlrun/api/utils/auth/providers/opa.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/utils/clients/__init__.py
+-rw-r--r--  2.0 unx    14075 b- defN 23-Aug-07 15:02 mlrun/api/utils/clients/chief.py
+-rw-r--r--  2.0 unx    32674 b- defN 23-Aug-07 15:02 mlrun/api/utils/clients/iguazio.py
+-rw-r--r--  2.0 unx    12281 b- defN 23-Aug-07 15:02 mlrun/api/utils/clients/log_collector.py
+-rw-r--r--  2.0 unx     9911 b- defN 23-Aug-07 15:02 mlrun/api/utils/clients/nuclio.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/utils/clients/protocols/__init__.py
+-rw-r--r--  2.0 unx     2567 b- defN 23-Aug-07 15:02 mlrun/api/utils/clients/protocols/grpc.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/utils/db/__init__.py
+-rw-r--r--  2.0 unx     3305 b- defN 23-Aug-07 15:02 mlrun/api/utils/db/alembic.py
+-rw-r--r--  2.0 unx     8214 b- defN 23-Aug-07 15:02 mlrun/api/utils/db/backup.py
+-rw-r--r--  2.0 unx     3787 b- defN 23-Aug-07 15:02 mlrun/api/utils/db/mysql.py
+-rw-r--r--  2.0 unx      992 b- defN 23-Aug-07 15:02 mlrun/api/utils/db/sql_collation.py
+-rw-r--r--  2.0 unx     3861 b- defN 23-Aug-07 15:02 mlrun/api/utils/db/sqlite_migration.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/utils/events/__init__.py
+-rw-r--r--  2.0 unx     1721 b- defN 23-Aug-07 15:02 mlrun/api/utils/events/base.py
+-rw-r--r--  2.0 unx     1630 b- defN 23-Aug-07 15:02 mlrun/api/utils/events/events_factory.py
+-rw-r--r--  2.0 unx     8798 b- defN 23-Aug-07 15:02 mlrun/api/utils/events/iguazio.py
+-rw-r--r--  2.0 unx     1739 b- defN 23-Aug-07 15:02 mlrun/api/utils/events/nop.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/utils/projects/__init__.py
+-rw-r--r--  2.0 unx    18658 b- defN 23-Aug-07 15:02 mlrun/api/utils/projects/follower.py
+-rw-r--r--  2.0 unx    19412 b- defN 23-Aug-07 15:02 mlrun/api/utils/projects/leader.py
+-rw-r--r--  2.0 unx     7133 b- defN 23-Aug-07 15:02 mlrun/api/utils/projects/member.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/utils/projects/remotes/__init__.py
+-rw-r--r--  2.0 unx     2659 b- defN 23-Aug-07 15:02 mlrun/api/utils/projects/remotes/follower.py
+-rw-r--r--  2.0 unx     2094 b- defN 23-Aug-07 15:02 mlrun/api/utils/projects/remotes/leader.py
+-rw-r--r--  2.0 unx     4995 b- defN 23-Aug-07 15:02 mlrun/api/utils/projects/remotes/nop_follower.py
+-rw-r--r--  2.0 unx     3854 b- defN 23-Aug-07 15:02 mlrun/api/utils/projects/remotes/nop_leader.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/utils/runtimes/__init__.py
+-rw-r--r--  2.0 unx     1675 b- defN 23-Aug-07 15:02 mlrun/api/utils/runtimes/nuclio.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/api/utils/singletons/__init__.py
+-rw-r--r--  2.0 unx     1313 b- defN 23-Aug-07 15:02 mlrun/api/utils/singletons/db.py
+-rw-r--r--  2.0 unx    24434 b- defN 23-Aug-07 15:02 mlrun/api/utils/singletons/k8s.py
+-rw-r--r--  2.0 unx      840 b- defN 23-Aug-07 15:02 mlrun/api/utils/singletons/logs_dir.py
+-rw-r--r--  2.0 unx     1312 b- defN 23-Aug-07 15:02 mlrun/api/utils/singletons/project_member.py
+-rw-r--r--  2.0 unx     1064 b- defN 23-Aug-07 15:02 mlrun/api/utils/singletons/scheduler.py
+-rw-r--r--  2.0 unx     1123 b- defN 23-Aug-07 15:02 mlrun/artifacts/__init__.py
+-rw-r--r--  2.0 unx    31144 b- defN 23-Aug-07 15:02 mlrun/artifacts/base.py
+-rw-r--r--  2.0 unx    20485 b- defN 23-Aug-07 15:02 mlrun/artifacts/dataset.py
+-rw-r--r--  2.0 unx    12628 b- defN 23-Aug-07 15:02 mlrun/artifacts/manager.py
+-rw-r--r--  2.0 unx    24241 b- defN 23-Aug-07 15:02 mlrun/artifacts/model.py
+-rw-r--r--  2.0 unx    15717 b- defN 23-Aug-07 15:02 mlrun/artifacts/plots.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/common/__init__.py
+-rw-r--r--  2.0 unx      660 b- defN 23-Aug-07 15:02 mlrun/common/constants.py
+-rw-r--r--  2.0 unx     1108 b- defN 23-Aug-07 15:02 mlrun/common/helpers.py
+-rw-r--r--  2.0 unx      790 b- defN 23-Aug-07 15:02 mlrun/common/types.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Aug-07 15:02 mlrun/common/db/__init__.py
+-rw-r--r--  2.0 unx     2542 b- defN 23-Aug-07 15:02 mlrun/common/db/sql_session.py
+-rw-r--r--  2.0 unx      721 b- defN 23-Aug-07 15:02 mlrun/common/model_monitoring/__init__.py
+-rw-r--r--  2.0 unx     2312 b- defN 23-Aug-07 15:02 mlrun/common/model_monitoring/helpers.py
+-rw-r--r--  2.0 unx     4561 b- defN 23-Aug-07 15:02 mlrun/common/schemas/__init__.py
+-rw-r--r--  2.0 unx     1923 b- defN 23-Aug-07 15:02 mlrun/common/schemas/artifact.py
+-rw-r--r--  2.0 unx     5879 b- defN 23-Aug-07 15:02 mlrun/common/schemas/auth.py
+-rw-r--r--  2.0 unx     1553 b- defN 23-Aug-07 15:02 mlrun/common/schemas/background_task.py
+-rw-r--r--  2.0 unx     2816 b- defN 23-Aug-07 15:02 mlrun/common/schemas/client_spec.py
+-rw-r--r--  2.0 unx      888 b- defN 23-Aug-07 15:02 mlrun/common/schemas/clusterization_spec.py
+-rw-r--r--  2.0 unx     6243 b- defN 23-Aug-07 15:02 mlrun/common/schemas/constants.py
+-rw-r--r--  2.0 unx      699 b- defN 23-Aug-07 15:02 mlrun/common/schemas/datastore_profile.py
+-rw-r--r--  2.0 unx     1026 b- defN 23-Aug-07 15:02 mlrun/common/schemas/events.py
+-rw-r--r--  2.0 unx     3723 b- defN 23-Aug-07 15:02 mlrun/common/schemas/feature_store.py
+-rw-r--r--  2.0 unx     2546 b- defN 23-Aug-07 15:02 mlrun/common/schemas/frontend_spec.py
+-rw-r--r--  2.0 unx     4432 b- defN 23-Aug-07 15:02 mlrun/common/schemas/function.py
+-rw-r--r--  2.0 unx      705 b- defN 23-Aug-07 15:02 mlrun/common/schemas/http.py
+-rw-r--r--  2.0 unx     4245 b- defN 23-Aug-07 15:02 mlrun/common/schemas/hub.py
+-rw-r--r--  2.0 unx     1395 b- defN 23-Aug-07 15:02 mlrun/common/schemas/k8s.py
+-rw-r--r--  2.0 unx      920 b- defN 23-Aug-07 15:02 mlrun/common/schemas/memory_reports.py
+-rw-r--r--  2.0 unx     1518 b- defN 23-Aug-07 15:02 mlrun/common/schemas/notification.py
+-rw-r--r--  2.0 unx     1986 b- defN 23-Aug-07 15:02 mlrun/common/schemas/object.py
+-rw-r--r--  2.0 unx     1184 b- defN 23-Aug-07 15:02 mlrun/common/schemas/pipeline.py
+-rw-r--r--  2.0 unx     4224 b- defN 23-Aug-07 15:02 mlrun/common/schemas/project.py
+-rw-r--r--  2.0 unx      776 b- defN 23-Aug-07 15:02 mlrun/common/schemas/regex.py
+-rw-r--r--  2.0 unx      745 b- defN 23-Aug-07 15:02 mlrun/common/schemas/runs.py
+-rw-r--r--  2.0 unx     1636 b- defN 23-Aug-07 15:02 mlrun/common/schemas/runtime_resource.py
+-rw-r--r--  2.0 unx     4293 b- defN 23-Aug-07 15:02 mlrun/common/schemas/schedule.py
+-rw-r--r--  2.0 unx     1484 b- defN 23-Aug-07 15:02 mlrun/common/schemas/secret.py
+-rw-r--r--  2.0 unx      905 b- defN 23-Aug-07 15:02 mlrun/common/schemas/tag.py
+-rw-r--r--  2.0 unx     1729 b- defN 23-Aug-07 15:02 mlrun/common/schemas/workflow.py
+-rw-r--r--  2.0 unx     1339 b- defN 23-Aug-07 15:02 mlrun/common/schemas/model_monitoring/__init__.py
+-rw-r--r--  2.0 unx     5582 b- defN 23-Aug-07 15:02 mlrun/common/schemas/model_monitoring/constants.py
+-rw-r--r--  2.0 unx     1444 b- defN 23-Aug-07 15:02 mlrun/common/schemas/model_monitoring/grafana.py
+-rw-r--r--  2.0 unx    11152 b- defN 23-Aug-07 15:02 mlrun/common/schemas/model_monitoring/model_endpoints.py
+-rw-r--r--  2.0 unx     1087 b- defN 23-Aug-07 15:02 mlrun/data_types/__init__.py
+-rw-r--r--  2.0 unx     4647 b- defN 23-Aug-07 15:02 mlrun/data_types/data_types.py
+-rw-r--r--  2.0 unx     5813 b- defN 23-Aug-07 15:02 mlrun/data_types/infer.py
+-rw-r--r--  2.0 unx     9426 b- defN 23-Aug-07 15:02 mlrun/data_types/spark.py
+-rw-r--r--  2.0 unx     4089 b- defN 23-Aug-07 15:02 mlrun/datastore/__init__.py
+-rw-r--r--  2.0 unx     6946 b- defN 23-Aug-07 15:02 mlrun/datastore/azure_blob.py
+-rw-r--r--  2.0 unx    22471 b- defN 23-Aug-07 15:02 mlrun/datastore/base.py
+-rw-r--r--  2.0 unx     8467 b- defN 23-Aug-07 15:02 mlrun/datastore/datastore.py
+-rw-r--r--  2.0 unx     5150 b- defN 23-Aug-07 15:02 mlrun/datastore/datastore_profile.py
+-rw-r--r--  2.0 unx     6435 b- defN 23-Aug-07 15:02 mlrun/datastore/dbfs_store.py
+-rw-r--r--  2.0 unx     3791 b- defN 23-Aug-07 15:02 mlrun/datastore/filestore.py
+-rw-r--r--  2.0 unx     5114 b- defN 23-Aug-07 15:02 mlrun/datastore/google_cloud_storage.py
+-rw-r--r--  2.0 unx      622 b- defN 23-Aug-07 15:02 mlrun/datastore/helpers.py
+-rw-r--r--  2.0 unx     2779 b- defN 23-Aug-07 15:02 mlrun/datastore/inmem.py
+-rw-r--r--  2.0 unx     5202 b- defN 23-Aug-07 15:02 mlrun/datastore/redis.py
+-rw-r--r--  2.0 unx     7035 b- defN 23-Aug-07 15:02 mlrun/datastore/s3.py
+-rw-r--r--  2.0 unx    37649 b- defN 23-Aug-07 15:02 mlrun/datastore/sources.py
+-rw-r--r--  2.0 unx     1498 b- defN 23-Aug-07 15:02 mlrun/datastore/spark_udf.py
+-rw-r--r--  2.0 unx     6906 b- defN 23-Aug-07 15:02 mlrun/datastore/store_resources.py
+-rw-r--r--  2.0 unx    63601 b- defN 23-Aug-07 15:02 mlrun/datastore/targets.py
+-rw-r--r--  2.0 unx     5438 b- defN 23-Aug-07 15:02 mlrun/datastore/utils.py
+-rw-r--r--  2.0 unx     8099 b- defN 23-Aug-07 15:02 mlrun/datastore/v3io.py
+-rw-r--r--  2.0 unx     1343 b- defN 23-Aug-07 15:02 mlrun/datastore/wasbfs/__init__.py
+-rw-r--r--  2.0 unx     6152 b- defN 23-Aug-07 15:02 mlrun/datastore/wasbfs/fs.py
+-rw-r--r--  2.0 unx     1145 b- defN 23-Aug-07 15:02 mlrun/db/__init__.py
+-rw-r--r--  2.0 unx    17358 b- defN 23-Aug-07 15:02 mlrun/db/base.py
+-rw-r--r--  2.0 unx     2117 b- defN 23-Aug-07 15:02 mlrun/db/factory.py
+-rw-r--r--  2.0 unx   143266 b- defN 23-Aug-07 15:02 mlrun/db/httpdb.py
+-rw-r--r--  2.0 unx    13984 b- defN 23-Aug-07 15:02 mlrun/db/nopdb.py
+-rw-r--r--  2.0 unx     1516 b- defN 23-Aug-07 15:02 mlrun/feature_store/__init__.py
+-rw-r--r--  2.0 unx    44899 b- defN 23-Aug-07 15:02 mlrun/feature_store/api.py
+-rw-r--r--  2.0 unx    12809 b- defN 23-Aug-07 15:02 mlrun/feature_store/common.py
+-rw-r--r--  2.0 unx    47773 b- defN 23-Aug-07 15:02 mlrun/feature_store/feature_set.py
+-rw-r--r--  2.0 unx    34934 b- defN 23-Aug-07 15:02 mlrun/feature_store/feature_vector.py
+-rw-r--r--  2.0 unx    11185 b- defN 23-Aug-07 15:02 mlrun/feature_store/ingestion.py
+-rw-r--r--  2.0 unx    29357 b- defN 23-Aug-07 15:02 mlrun/feature_store/steps.py
+-rw-r--r--  2.0 unx     1260 b- defN 23-Aug-07 15:02 mlrun/feature_store/retrieval/__init__.py
+-rw-r--r--  2.0 unx    30787 b- defN 23-Aug-07 15:02 mlrun/feature_store/retrieval/base.py
+-rw-r--r--  2.0 unx     4895 b- defN 23-Aug-07 15:02 mlrun/feature_store/retrieval/dask_merger.py
+-rw-r--r--  2.0 unx     7714 b- defN 23-Aug-07 15:02 mlrun/feature_store/retrieval/job.py
+-rw-r--r--  2.0 unx     4218 b- defN 23-Aug-07 15:02 mlrun/feature_store/retrieval/local_merger.py
+-rw-r--r--  2.0 unx     9819 b- defN 23-Aug-07 15:02 mlrun/feature_store/retrieval/spark_merger.py
+-rw-r--r--  2.0 unx     6539 b- defN 23-Aug-07 15:02 mlrun/feature_store/retrieval/storey_merger.py
+-rw-r--r--  2.0 unx      743 b- defN 23-Aug-07 15:02 mlrun/frameworks/__init__.py
+-rw-r--r--  2.0 unx    11466 b- defN 23-Aug-07 15:02 mlrun/frameworks/parallel_coordinates.py
+-rw-r--r--  2.0 unx      962 b- defN 23-Aug-07 15:02 mlrun/frameworks/_common/__init__.py
+-rw-r--r--  2.0 unx     8515 b- defN 23-Aug-07 15:02 mlrun/frameworks/_common/artifacts_library.py
+-rw-r--r--  2.0 unx    21018 b- defN 23-Aug-07 15:02 mlrun/frameworks/_common/mlrun_interface.py
+-rw-r--r--  2.0 unx    55376 b- defN 23-Aug-07 15:02 mlrun/frameworks/_common/model_handler.py
+-rw-r--r--  2.0 unx     3469 b- defN 23-Aug-07 15:02 mlrun/frameworks/_common/plan.py
+-rw-r--r--  2.0 unx     5757 b- defN 23-Aug-07 15:02 mlrun/frameworks/_common/producer.py
+-rw-r--r--  2.0 unx     9209 b- defN 23-Aug-07 15:02 mlrun/frameworks/_common/utils.py
+-rw-r--r--  2.0 unx      750 b- defN 23-Aug-07 15:02 mlrun/frameworks/_dl_common/__init__.py
+-rw-r--r--  2.0 unx     1151 b- defN 23-Aug-07 15:02 mlrun/frameworks/_dl_common/model_handler.py
+-rw-r--r--  2.0 unx      996 b- defN 23-Aug-07 15:02 mlrun/frameworks/_dl_common/utils.py
+-rw-r--r--  2.0 unx      787 b- defN 23-Aug-07 15:02 mlrun/frameworks/_dl_common/loggers/__init__.py
+-rw-r--r--  2.0 unx    11531 b- defN 23-Aug-07 15:02 mlrun/frameworks/_dl_common/loggers/logger.py
+-rw-r--r--  2.0 unx    14777 b- defN 23-Aug-07 15:02 mlrun/frameworks/_dl_common/loggers/mlrun_logger.py
+-rw-r--r--  2.0 unx    28414 b- defN 23-Aug-07 15:02 mlrun/frameworks/_dl_common/loggers/tensorboard_logger.py
+-rw-r--r--  2.0 unx      956 b- defN 23-Aug-07 15:02 mlrun/frameworks/_ml_common/__init__.py
+-rw-r--r--  2.0 unx     3169 b- defN 23-Aug-07 15:02 mlrun/frameworks/_ml_common/artifacts_library.py
+-rw-r--r--  2.0 unx    16957 b- defN 23-Aug-07 15:02 mlrun/frameworks/_ml_common/model_handler.py
+-rw-r--r--  2.0 unx     2723 b- defN 23-Aug-07 15:02 mlrun/frameworks/_ml_common/pkl_model_server.py
+-rw-r--r--  2.0 unx     4881 b- defN 23-Aug-07 15:02 mlrun/frameworks/_ml_common/plan.py
+-rw-r--r--  2.0 unx     4061 b- defN 23-Aug-07 15:02 mlrun/frameworks/_ml_common/producer.py
+-rw-r--r--  2.0 unx    10490 b- defN 23-Aug-07 15:02 mlrun/frameworks/_ml_common/utils.py
+-rw-r--r--  2.0 unx      737 b- defN 23-Aug-07 15:02 mlrun/frameworks/_ml_common/loggers/__init__.py
+-rw-r--r--  2.0 unx     5684 b- defN 23-Aug-07 15:02 mlrun/frameworks/_ml_common/loggers/logger.py
+-rw-r--r--  2.0 unx     6453 b- defN 23-Aug-07 15:02 mlrun/frameworks/_ml_common/loggers/mlrun_logger.py
+-rw-r--r--  2.0 unx      922 b- defN 23-Aug-07 15:02 mlrun/frameworks/_ml_common/plans/__init__.py
+-rw-r--r--  2.0 unx     4943 b- defN 23-Aug-07 15:02 mlrun/frameworks/_ml_common/plans/calibration_curve_plan.py
+-rw-r--r--  2.0 unx     6078 b- defN 23-Aug-07 15:02 mlrun/frameworks/_ml_common/plans/confusion_matrix_plan.py
+-rw-r--r--  2.0 unx     6658 b- defN 23-Aug-07 15:02 mlrun/frameworks/_ml_common/plans/dataset_plan.py
+-rw-r--r--  2.0 unx     5318 b- defN 23-Aug-07 15:02 mlrun/frameworks/_ml_common/plans/feature_importance_plan.py
+-rw-r--r--  2.0 unx     6993 b- defN 23-Aug-07 15:02 mlrun/frameworks/_ml_common/plans/roc_curve_plan.py
+-rw-r--r--  2.0 unx      706 b- defN 23-Aug-07 15:02 mlrun/frameworks/auto_mlrun/__init__.py
+-rw-r--r--  2.0 unx    23796 b- defN 23-Aug-07 15:02 mlrun/frameworks/auto_mlrun/auto_mlrun.py
+-rw-r--r--  2.0 unx      721 b- defN 23-Aug-07 15:02 mlrun/frameworks/huggingface/__init__.py
+-rw-r--r--  2.0 unx     6083 b- defN 23-Aug-07 15:02 mlrun/frameworks/huggingface/model_server.py
+-rw-r--r--  2.0 unx    15883 b- defN 23-Aug-07 15:02 mlrun/frameworks/lgbm/__init__.py
+-rw-r--r--  2.0 unx    13891 b- defN 23-Aug-07 15:02 mlrun/frameworks/lgbm/model_handler.py
+-rw-r--r--  2.0 unx     9189 b- defN 23-Aug-07 15:02 mlrun/frameworks/lgbm/model_server.py
+-rw-r--r--  2.0 unx     8278 b- defN 23-Aug-07 15:02 mlrun/frameworks/lgbm/utils.py
+-rw-r--r--  2.0 unx      857 b- defN 23-Aug-07 15:02 mlrun/frameworks/lgbm/callbacks/__init__.py
+-rw-r--r--  2.0 unx     4081 b- defN 23-Aug-07 15:02 mlrun/frameworks/lgbm/callbacks/callback.py
+-rw-r--r--  2.0 unx     5156 b- defN 23-Aug-07 15:02 mlrun/frameworks/lgbm/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     4137 b- defN 23-Aug-07 15:02 mlrun/frameworks/lgbm/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx      842 b- defN 23-Aug-07 15:02 mlrun/frameworks/lgbm/mlrun_interfaces/__init__.py
+-rw-r--r--  2.0 unx     1624 b- defN 23-Aug-07 15:02 mlrun/frameworks/lgbm/mlrun_interfaces/booster_mlrun_interface.py
+-rw-r--r--  2.0 unx    14256 b- defN 23-Aug-07 15:02 mlrun/frameworks/lgbm/mlrun_interfaces/mlrun_interface.py
+-rw-r--r--  2.0 unx     1333 b- defN 23-Aug-07 15:02 mlrun/frameworks/lgbm/mlrun_interfaces/model_mlrun_interface.py
+-rw-r--r--  2.0 unx      791 b- defN 23-Aug-07 15:02 mlrun/frameworks/onnx/__init__.py
+-rw-r--r--  2.0 unx     6098 b- defN 23-Aug-07 15:02 mlrun/frameworks/onnx/dataset.py
+-rw-r--r--  2.0 unx     2405 b- defN 23-Aug-07 15:02 mlrun/frameworks/onnx/mlrun_interface.py
+-rw-r--r--  2.0 unx     6203 b- defN 23-Aug-07 15:02 mlrun/frameworks/onnx/model_handler.py
+-rw-r--r--  2.0 unx     7061 b- defN 23-Aug-07 15:02 mlrun/frameworks/onnx/model_server.py
+-rw-r--r--  2.0 unx    22056 b- defN 23-Aug-07 15:02 mlrun/frameworks/pytorch/__init__.py
+-rw-r--r--  2.0 unx    27904 b- defN 23-Aug-07 15:02 mlrun/frameworks/pytorch/callbacks_handler.py
+-rw-r--r--  2.0 unx    44639 b- defN 23-Aug-07 15:02 mlrun/frameworks/pytorch/mlrun_interface.py
+-rw-r--r--  2.0 unx    22465 b- defN 23-Aug-07 15:02 mlrun/frameworks/pytorch/model_handler.py
+-rw-r--r--  2.0 unx    10136 b- defN 23-Aug-07 15:02 mlrun/frameworks/pytorch/model_server.py
+-rw-r--r--  2.0 unx     4515 b- defN 23-Aug-07 15:02 mlrun/frameworks/pytorch/utils.py
+-rw-r--r--  2.0 unx      896 b- defN 23-Aug-07 15:02 mlrun/frameworks/pytorch/callbacks/__init__.py
+-rw-r--r--  2.0 unx    11524 b- defN 23-Aug-07 15:02 mlrun/frameworks/pytorch/callbacks/callback.py
+-rw-r--r--  2.0 unx    23166 b- defN 23-Aug-07 15:02 mlrun/frameworks/pytorch/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     9310 b- defN 23-Aug-07 15:02 mlrun/frameworks/pytorch/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx    26661 b- defN 23-Aug-07 15:02 mlrun/frameworks/pytorch/callbacks/tensorboard_logging_callback.py
+-rw-r--r--  2.0 unx    10892 b- defN 23-Aug-07 15:02 mlrun/frameworks/sklearn/__init__.py
+-rw-r--r--  2.0 unx     5852 b- defN 23-Aug-07 15:02 mlrun/frameworks/sklearn/estimator.py
+-rw-r--r--  2.0 unx     7117 b- defN 23-Aug-07 15:02 mlrun/frameworks/sklearn/metric.py
+-rw-r--r--  2.0 unx    12215 b- defN 23-Aug-07 15:02 mlrun/frameworks/sklearn/metrics_library.py
+-rw-r--r--  2.0 unx    14126 b- defN 23-Aug-07 15:02 mlrun/frameworks/sklearn/mlrun_interface.py
+-rw-r--r--  2.0 unx     4745 b- defN 23-Aug-07 15:02 mlrun/frameworks/sklearn/model_handler.py
+-rw-r--r--  2.0 unx     1209 b- defN 23-Aug-07 15:02 mlrun/frameworks/sklearn/utils.py
+-rw-r--r--  2.0 unx    10455 b- defN 23-Aug-07 15:02 mlrun/frameworks/tf_keras/__init__.py
+-rw-r--r--  2.0 unx    16627 b- defN 23-Aug-07 15:02 mlrun/frameworks/tf_keras/mlrun_interface.py
+-rw-r--r--  2.0 unx    28247 b- defN 23-Aug-07 15:02 mlrun/frameworks/tf_keras/model_handler.py
+-rw-r--r--  2.0 unx     9565 b- defN 23-Aug-07 15:02 mlrun/frameworks/tf_keras/model_server.py
+-rw-r--r--  2.0 unx     4284 b- defN 23-Aug-07 15:02 mlrun/frameworks/tf_keras/utils.py
+-rw-r--r--  2.0 unx      844 b- defN 23-Aug-07 15:02 mlrun/frameworks/tf_keras/callbacks/__init__.py
+-rw-r--r--  2.0 unx    21886 b- defN 23-Aug-07 15:02 mlrun/frameworks/tf_keras/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     8791 b- defN 23-Aug-07 15:02 mlrun/frameworks/tf_keras/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx    28728 b- defN 23-Aug-07 15:02 mlrun/frameworks/tf_keras/callbacks/tensorboard_logging_callback.py
+-rw-r--r--  2.0 unx    10287 b- defN 23-Aug-07 15:02 mlrun/frameworks/xgboost/__init__.py
+-rw-r--r--  2.0 unx      878 b- defN 23-Aug-07 15:02 mlrun/frameworks/xgboost/mlrun_interface.py
+-rw-r--r--  2.0 unx    11617 b- defN 23-Aug-07 15:02 mlrun/frameworks/xgboost/model_handler.py
+-rw-r--r--  2.0 unx     1069 b- defN 23-Aug-07 15:02 mlrun/frameworks/xgboost/utils.py
+-rw-r--r--  2.0 unx      577 b- defN 23-Aug-07 15:02 mlrun/launcher/__init__.py
+-rw-r--r--  2.0 unx    15798 b- defN 23-Aug-07 15:02 mlrun/launcher/base.py
+-rw-r--r--  2.0 unx     6174 b- defN 23-Aug-07 15:02 mlrun/launcher/client.py
+-rw-r--r--  2.0 unx     2344 b- defN 23-Aug-07 15:02 mlrun/launcher/factory.py
+-rw-r--r--  2.0 unx    10815 b- defN 23-Aug-07 15:02 mlrun/launcher/local.py
+-rw-r--r--  2.0 unx     6770 b- defN 23-Aug-07 15:02 mlrun/launcher/remote.py
+-rw-r--r--  2.0 unx      916 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/__init__.py
+-rw-r--r--  2.0 unx    23344 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/api.py
+-rw-r--r--  2.0 unx    24209 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/features_drift_table.py
+-rw-r--r--  2.0 unx     1902 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/helpers.py
+-rw-r--r--  2.0 unx     5214 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/model_endpoint.py
+-rw-r--r--  2.0 unx    39932 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/model_monitoring_batch.py
+-rw-r--r--  2.0 unx     7605 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/prometheus.py
+-rw-r--r--  2.0 unx    48755 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/stream_processing.py
+-rw-r--r--  2.0 unx     4475 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/tracking_policy.py
+-rw-r--r--  2.0 unx     4525 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/stores/__init__.py
+-rw-r--r--  2.0 unx    20351 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/stores/kv_model_endpoint_store.py
+-rw-r--r--  2.0 unx     5695 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/stores/model_endpoint_store.py
+-rw-r--r--  2.0 unx    16123 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/stores/sql_model_endpoint_store.py
+-rw-r--r--  2.0 unx      884 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/stores/models/__init__.py
+-rw-r--r--  2.0 unx      655 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/stores/models/base.py
+-rw-r--r--  2.0 unx     4153 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/stores/models/mysql.py
+-rw-r--r--  2.0 unx     4070 b- defN 23-Aug-07 15:02 mlrun/model_monitoring/stores/models/sqlite.py
+-rw-r--r--  2.0 unx     7101 b- defN 23-Aug-07 15:02 mlrun/package/__init__.py
+-rw-r--r--  2.0 unx    15237 b- defN 23-Aug-07 15:02 mlrun/package/context_handler.py
+-rw-r--r--  2.0 unx     1204 b- defN 23-Aug-07 15:02 mlrun/package/errors.py
+-rw-r--r--  2.0 unx    12578 b- defN 23-Aug-07 15:02 mlrun/package/packager.py
+-rw-r--r--  2.0 unx    37275 b- defN 23-Aug-07 15:02 mlrun/package/packagers_manager.py
+-rw-r--r--  2.0 unx      769 b- defN 23-Aug-07 15:02 mlrun/package/packagers/__init__.py
+-rw-r--r--  2.0 unx    24227 b- defN 23-Aug-07 15:02 mlrun/package/packagers/default_packager.py
+-rw-r--r--  2.0 unx    20618 b- defN 23-Aug-07 15:02 mlrun/package/packagers/numpy_packagers.py
+-rw-r--r--  2.0 unx    35951 b- defN 23-Aug-07 15:02 mlrun/package/packagers/pandas_packagers.py
+-rw-r--r--  2.0 unx    22518 b- defN 23-Aug-07 15:02 mlrun/package/packagers/python_standard_library_packagers.py
+-rw-r--r--  2.0 unx     1722 b- defN 23-Aug-07 15:02 mlrun/package/utils/__init__.py
+-rw-r--r--  2.0 unx     7567 b- defN 23-Aug-07 15:02 mlrun/package/utils/_archiver.py
+-rw-r--r--  2.0 unx     6393 b- defN 23-Aug-07 15:02 mlrun/package/utils/_formatter.py
+-rw-r--r--  2.0 unx    10926 b- defN 23-Aug-07 15:02 mlrun/package/utils/_pickler.py
+-rw-r--r--  2.0 unx     2379 b- defN 23-Aug-07 15:02 mlrun/package/utils/_supported_format.py
+-rw-r--r--  2.0 unx     3709 b- defN 23-Aug-07 15:02 mlrun/package/utils/log_hint_utils.py
+-rw-r--r--  2.0 unx    14825 b- defN 23-Aug-07 15:02 mlrun/package/utils/type_hint_utils.py
+-rw-r--r--  2.0 unx     2352 b- defN 23-Aug-07 15:02 mlrun/platforms/__init__.py
+-rw-r--r--  2.0 unx    21636 b- defN 23-Aug-07 15:02 mlrun/platforms/iguazio.py
+-rw-r--r--  2.0 unx    11852 b- defN 23-Aug-07 15:02 mlrun/platforms/other.py
+-rw-r--r--  2.0 unx     1153 b- defN 23-Aug-07 15:02 mlrun/projects/__init__.py
+-rw-r--r--  2.0 unx    17948 b- defN 23-Aug-07 15:02 mlrun/projects/operations.py
+-rw-r--r--  2.0 unx    34337 b- defN 23-Aug-07 15:02 mlrun/projects/pipelines.py
+-rw-r--r--  2.0 unx   128900 b- defN 23-Aug-07 15:02 mlrun/projects/project.py
+-rw-r--r--  2.0 unx     7042 b- defN 23-Aug-07 15:02 mlrun/runtimes/__init__.py
+-rw-r--r--  2.0 unx    36844 b- defN 23-Aug-07 15:02 mlrun/runtimes/base.py
+-rw-r--r--  2.0 unx     6689 b- defN 23-Aug-07 15:02 mlrun/runtimes/constants.py
+-rw-r--r--  2.0 unx    16021 b- defN 23-Aug-07 15:02 mlrun/runtimes/daskjob.py
+-rw-r--r--  2.0 unx     9994 b- defN 23-Aug-07 15:02 mlrun/runtimes/funcdoc.py
+-rw-r--r--  2.0 unx    45208 b- defN 23-Aug-07 15:02 mlrun/runtimes/function.py
+-rw-r--r--  2.0 unx     4911 b- defN 23-Aug-07 15:02 mlrun/runtimes/function_reference.py
+-rw-r--r--  2.0 unx     6530 b- defN 23-Aug-07 15:02 mlrun/runtimes/generators.py
+-rw-r--r--  2.0 unx    15180 b- defN 23-Aug-07 15:02 mlrun/runtimes/kubejob.py
+-rw-r--r--  2.0 unx    19579 b- defN 23-Aug-07 15:02 mlrun/runtimes/local.py
+-rw-r--r--  2.0 unx     2877 b- defN 23-Aug-07 15:02 mlrun/runtimes/nuclio.py
+-rw-r--r--  2.0 unx    61396 b- defN 23-Aug-07 15:02 mlrun/runtimes/pod.py
+-rw-r--r--  2.0 unx     7289 b- defN 23-Aug-07 15:02 mlrun/runtimes/remotesparkjob.py
+-rw-r--r--  2.0 unx    30483 b- defN 23-Aug-07 15:02 mlrun/runtimes/serving.py
+-rw-r--r--  2.0 unx    18703 b- defN 23-Aug-07 15:02 mlrun/runtimes/utils.py
+-rw-r--r--  2.0 unx      569 b- defN 23-Aug-07 15:02 mlrun/runtimes/databricks/__init__.py
+-rw-r--r--  2.0 unx     2568 b- defN 23-Aug-07 15:02 mlrun/runtimes/databricks/databricks.py
+-rw-r--r--  2.0 unx     3249 b- defN 23-Aug-07 15:02 mlrun/runtimes/databricks/databricks_wrapper.py
+-rw-r--r--  2.0 unx     1539 b- defN 23-Aug-07 15:02 mlrun/runtimes/mpijob/__init__.py
+-rw-r--r--  2.0 unx    15147 b- defN 23-Aug-07 15:02 mlrun/runtimes/mpijob/abstract.py
+-rw-r--r--  2.0 unx    10916 b- defN 23-Aug-07 15:02 mlrun/runtimes/mpijob/v1.py
+-rw-r--r--  2.0 unx     5650 b- defN 23-Aug-07 15:02 mlrun/runtimes/mpijob/v1alpha1.py
+-rw-r--r--  2.0 unx      709 b- defN 23-Aug-07 15:02 mlrun/runtimes/sparkjob/__init__.py
+-rw-r--r--  2.0 unx    30404 b- defN 23-Aug-07 15:02 mlrun/runtimes/sparkjob/abstract.py
+-rw-r--r--  2.0 unx    28746 b- defN 23-Aug-07 15:02 mlrun/runtimes/sparkjob/spark3job.py
+-rw-r--r--  2.0 unx     1078 b- defN 23-Aug-07 15:02 mlrun/serving/__init__.py
+-rw-r--r--  2.0 unx     6116 b- defN 23-Aug-07 15:02 mlrun/serving/merger.py
+-rw-r--r--  2.0 unx    18038 b- defN 23-Aug-07 15:02 mlrun/serving/remote.py
+-rw-r--r--  2.0 unx    55318 b- defN 23-Aug-07 15:02 mlrun/serving/routers.py
+-rw-r--r--  2.0 unx    20439 b- defN 23-Aug-07 15:02 mlrun/serving/server.py
+-rw-r--r--  2.0 unx      836 b- defN 23-Aug-07 15:02 mlrun/serving/serving_wrapper.py
+-rw-r--r--  2.0 unx    54288 b- defN 23-Aug-07 15:02 mlrun/serving/states.py
+-rw-r--r--  2.0 unx     3902 b- defN 23-Aug-07 15:02 mlrun/serving/utils.py
+-rw-r--r--  2.0 unx    11814 b- defN 23-Aug-07 15:02 mlrun/serving/v1_serving.py
+-rw-r--r--  2.0 unx    21823 b- defN 23-Aug-07 15:02 mlrun/serving/v2_serving.py
+-rw-r--r--  2.0 unx      826 b- defN 23-Aug-07 15:02 mlrun/utils/__init__.py
+-rw-r--r--  2.0 unx    10636 b- defN 23-Aug-07 15:02 mlrun/utils/async_http.py
+-rw-r--r--  2.0 unx     3456 b- defN 23-Aug-07 15:02 mlrun/utils/azure_vault.py
+-rw-r--r--  2.0 unx     6245 b- defN 23-Aug-07 15:02 mlrun/utils/clones.py
+-rw-r--r--  2.0 unx     1920 b- defN 23-Aug-07 15:02 mlrun/utils/condition_evaluator.py
+-rw-r--r--  2.0 unx     1662 b- defN 23-Aug-07 15:02 mlrun/utils/db.py
+-rw-r--r--  2.0 unx    49274 b- defN 23-Aug-07 15:02 mlrun/utils/helpers.py
+-rw-r--r--  2.0 unx     8241 b- defN 23-Aug-07 15:02 mlrun/utils/http.py
+-rw-r--r--  2.0 unx     7035 b- defN 23-Aug-07 15:02 mlrun/utils/logger.py
+-rw-r--r--  2.0 unx     4430 b- defN 23-Aug-07 15:02 mlrun/utils/regex.py
+-rw-r--r--  2.0 unx      883 b- defN 23-Aug-07 15:02 mlrun/utils/singleton.py
+-rw-r--r--  2.0 unx     1319 b- defN 23-Aug-07 15:02 mlrun/utils/v3io_clients.py
+-rw-r--r--  2.0 unx    10447 b- defN 23-Aug-07 15:02 mlrun/utils/vault.py
+-rw-r--r--  2.0 unx      990 b- defN 23-Aug-07 15:02 mlrun/utils/notifications/__init__.py
+-rw-r--r--  2.0 unx    20181 b- defN 23-Aug-07 15:02 mlrun/utils/notifications/notification_pusher.py
+-rw-r--r--  2.0 unx     2113 b- defN 23-Aug-07 15:02 mlrun/utils/notifications/notification/__init__.py
+-rw-r--r--  2.0 unx     2293 b- defN 23-Aug-07 15:02 mlrun/utils/notifications/notification/base.py
+-rw-r--r--  2.0 unx     1971 b- defN 23-Aug-07 15:02 mlrun/utils/notifications/notification/console.py
+-rw-r--r--  2.0 unx     5221 b- defN 23-Aug-07 15:02 mlrun/utils/notifications/notification/git.py
+-rw-r--r--  2.0 unx     1962 b- defN 23-Aug-07 15:02 mlrun/utils/notifications/notification/ipython.py
+-rw-r--r--  2.0 unx     3898 b- defN 23-Aug-07 15:02 mlrun/utils/notifications/notification/slack.py
+-rw-r--r--  2.0 unx     1865 b- defN 23-Aug-07 15:02 mlrun/utils/notifications/notification/webhook.py
+-rw-r--r--  2.0 unx      614 b- defN 23-Aug-07 15:02 mlrun/utils/version/__init__.py
+-rw-r--r--  2.0 unx       88 b- defN 23-Aug-07 15:02 mlrun/utils/version/version.json
+-rw-r--r--  2.0 unx     1970 b- defN 23-Aug-07 15:02 mlrun/utils/version/version.py
+-rw-r--r--  2.0 unx    11357 b- defN 23-Aug-07 15:02 mlrun-1.5.0rc3.dist-info/LICENSE
+-rw-r--r--  2.0 unx    17455 b- defN 23-Aug-07 15:02 mlrun-1.5.0rc3.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Aug-07 15:02 mlrun-1.5.0rc3.dist-info/WHEEL
+-rw-r--r--  2.0 unx       47 b- defN 23-Aug-07 15:02 mlrun-1.5.0rc3.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        6 b- defN 23-Aug-07 15:02 mlrun-1.5.0rc3.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx    43962 b- defN 23-Aug-07 15:02 mlrun-1.5.0rc3.dist-info/RECORD
+467 files, 4902462 bytes uncompressed, 1248864 bytes compressed:  74.5%
```

## zipnote {}

```diff
@@ -84,14 +84,17 @@
 
 Filename: mlrun/api/api/endpoints/client_spec.py
 Comment: 
 
 Filename: mlrun/api/api/endpoints/clusterization_spec.py
 Comment: 
 
+Filename: mlrun/api/api/endpoints/datastore_profile.py
+Comment: 
+
 Filename: mlrun/api/api/endpoints/feature_store.py
 Comment: 
 
 Filename: mlrun/api/api/endpoints/files.py
 Comment: 
 
 Filename: mlrun/api/api/endpoints/frontend_spec.py
@@ -105,14 +108,17 @@
 
 Filename: mlrun/api/api/endpoints/healthz.py
 Comment: 
 
 Filename: mlrun/api/api/endpoints/hub.py
 Comment: 
 
+Filename: mlrun/api/api/endpoints/jobs.py
+Comment: 
+
 Filename: mlrun/api/api/endpoints/logs.py
 Comment: 
 
 Filename: mlrun/api/api/endpoints/model_endpoints.py
 Comment: 
 
 Filename: mlrun/api/api/endpoints/operations.py
@@ -162,14 +168,17 @@
 
 Filename: mlrun/api/crud/client_spec.py
 Comment: 
 
 Filename: mlrun/api/crud/clusterization_spec.py
 Comment: 
 
+Filename: mlrun/api/crud/datastore_profiles.py
+Comment: 
+
 Filename: mlrun/api/crud/feature_store.py
 Comment: 
 
 Filename: mlrun/api/crud/functions.py
 Comment: 
 
 Filename: mlrun/api/crud/hub.py
@@ -276,14 +285,17 @@
 
 Filename: mlrun/api/migrations_mysql/versions/88e656800d6a_add_requested_logs_column_and_index_to_.py
 Comment: 
 
 Filename: mlrun/api/migrations_mysql/versions/9d16de5f03a7_adding_data_versions_table.py
 Comment: 
 
+Filename: mlrun/api/migrations_mysql/versions/b1d1e7ab5dec_adding_table_datastore_profiles.py
+Comment: 
+
 Filename: mlrun/api/migrations_mysql/versions/b86f5b53f3d7_adding_name_and_updated_to_runs_table.py
 Comment: 
 
 Filename: mlrun/api/migrations_mysql/versions/c4af40b0bf61_init.py
 Comment: 
 
 Filename: mlrun/api/migrations_mysql/versions/c905d15bd91d_notifications.py
@@ -309,14 +321,17 @@
 
 Filename: mlrun/api/migrations_sqlite/versions/6401142f2d7c_adding_next_run_time_column_to_schedule_.py
 Comment: 
 
 Filename: mlrun/api/migrations_sqlite/versions/64d90a1a69bc_adding_background_tasks_table.py
 Comment: 
 
+Filename: mlrun/api/migrations_sqlite/versions/6e0c9531edc7_adding_table_datastore_profiles.py
+Comment: 
+
 Filename: mlrun/api/migrations_sqlite/versions/803438ecd005_add_requested_logs_column_to_runs.py
 Comment: 
 
 Filename: mlrun/api/migrations_sqlite/versions/863114f0c659_refactoring_feature_set.py
 Comment: 
 
 Filename: mlrun/api/migrations_sqlite/versions/959ae00528ad_notifications.py
@@ -588,14 +603,17 @@
 
 Filename: mlrun/common/schemas/clusterization_spec.py
 Comment: 
 
 Filename: mlrun/common/schemas/constants.py
 Comment: 
 
+Filename: mlrun/common/schemas/datastore_profile.py
+Comment: 
+
 Filename: mlrun/common/schemas/events.py
 Comment: 
 
 Filename: mlrun/common/schemas/feature_store.py
 Comment: 
 
 Filename: mlrun/common/schemas/frontend_spec.py
@@ -681,14 +699,17 @@
 
 Filename: mlrun/datastore/base.py
 Comment: 
 
 Filename: mlrun/datastore/datastore.py
 Comment: 
 
+Filename: mlrun/datastore/datastore_profile.py
+Comment: 
+
 Filename: mlrun/datastore/dbfs_store.py
 Comment: 
 
 Filename: mlrun/datastore/filestore.py
 Comment: 
 
 Filename: mlrun/datastore/google_cloud_storage.py
@@ -1056,14 +1077,17 @@
 
 Filename: mlrun/launcher/remote.py
 Comment: 
 
 Filename: mlrun/model_monitoring/__init__.py
 Comment: 
 
+Filename: mlrun/model_monitoring/api.py
+Comment: 
+
 Filename: mlrun/model_monitoring/features_drift_table.py
 Comment: 
 
 Filename: mlrun/model_monitoring/helpers.py
 Comment: 
 
 Filename: mlrun/model_monitoring/model_endpoint.py
@@ -1218,14 +1242,23 @@
 
 Filename: mlrun/runtimes/serving.py
 Comment: 
 
 Filename: mlrun/runtimes/utils.py
 Comment: 
 
+Filename: mlrun/runtimes/databricks/__init__.py
+Comment: 
+
+Filename: mlrun/runtimes/databricks/databricks.py
+Comment: 
+
+Filename: mlrun/runtimes/databricks/databricks_wrapper.py
+Comment: 
+
 Filename: mlrun/runtimes/mpijob/__init__.py
 Comment: 
 
 Filename: mlrun/runtimes/mpijob/abstract.py
 Comment: 
 
 Filename: mlrun/runtimes/mpijob/v1.py
@@ -1344,26 +1377,26 @@
 
 Filename: mlrun/utils/version/version.json
 Comment: 
 
 Filename: mlrun/utils/version/version.py
 Comment: 
 
-Filename: mlrun-1.5.0rc2.dist-info/LICENSE
+Filename: mlrun-1.5.0rc3.dist-info/LICENSE
 Comment: 
 
-Filename: mlrun-1.5.0rc2.dist-info/METADATA
+Filename: mlrun-1.5.0rc3.dist-info/METADATA
 Comment: 
 
-Filename: mlrun-1.5.0rc2.dist-info/WHEEL
+Filename: mlrun-1.5.0rc3.dist-info/WHEEL
 Comment: 
 
-Filename: mlrun-1.5.0rc2.dist-info/entry_points.txt
+Filename: mlrun-1.5.0rc3.dist-info/entry_points.txt
 Comment: 
 
-Filename: mlrun-1.5.0rc2.dist-info/top_level.txt
+Filename: mlrun-1.5.0rc3.dist-info/top_level.txt
 Comment: 
 
-Filename: mlrun-1.5.0rc2.dist-info/RECORD
+Filename: mlrun-1.5.0rc3.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## mlrun/__main__.py

```diff
@@ -743,19 +743,20 @@
 
     elif kind.startswith("art"):
         run_db = get_run_db()
         artifacts = run_db.list_artifacts(
             name, project=project, tag=tag, labels=selector
         )
         df = artifacts.to_df()[
-            ["tree", "key", "iter", "kind", "path", "hash", "updated", "uri"]
+            ["key", "iter", "kind", "path", "hash", "updated", "uri", "tree"]
         ]
         df["tree"] = df["tree"].apply(lambda x: f"..{x[-8:]}")
         df["hash"] = df["hash"].apply(lambda x: f"..{x[-6:]}")
         df["updated"] = df["updated"].apply(time_str)
+        df.rename(columns={"tree": "job/workflow uid"}, inplace=True)
         print(tabulate(df, headers="keys"))
 
     elif kind.startswith("func"):
         run_db = get_run_db()
         if name:
             f = run_db.get_function(name, project=project, tag=tag)
             print(dict_to_yaml(f))
```

## mlrun/config.py

```diff
@@ -81,15 +81,14 @@
     "package_path": "mlrun",  # mlrun pip package
     "default_base_image": "mlrun/mlrun",  # default base image when doing .deploy()
     # template for project default image name. Parameter {name} will be replaced with project name
     "default_project_image_name": ".mlrun-project-image-{name}",
     "default_project": "default",  # default project name
     "default_archive": "",  # default remote archive URL (for build tar.gz)
     "mpijob_crd_version": "",  # mpijob crd version (e.g: "v1alpha1". must be in: mlrun.runtime.MPIJobCRDVersions)
-    "hub_url": "https://raw.githubusercontent.com/mlrun/functions/{tag}/{name}/function.yaml",
     "ipython_widget": True,
     "log_level": "INFO",
     # log formatter (options: human | json)
     "log_formatter": "human",
     "submit_timeout": "180",  # timeout when submitting a new k8s resource
     # runtimes cleanup interval in seconds
     "runtimes_cleanup_interval": "300",
@@ -217,15 +216,15 @@
         "token": "",
         "logs_path": "./db/logs",
         # when set, these will replace references to the data_volume with the real_path
         "data_volume": "",
         "real_path": "",
         # comma delimited prefixes of paths allowed through the /files API (v3io & the real_path are always allowed).
         # These paths must be schemas (cannot be used for local files). For example "s3://mybucket,gcs://"
-        "allowed_file_paths": "s3://,gcs://,gs://,az://",
+        "allowed_file_paths": "s3://,gcs://,gs://,az://,dbfs://",
         "db_type": "sqldb",
         "max_workers": 64,
         # See mlrun.common.schemas.APIStates for options
         "state": "online",
         "retry_api_call_on_exception": "enabled",
         "http_connection_timeout_keep_alive": 11,
         "db": {
@@ -466,17 +465,17 @@
     },
     "hub": {
         "k8s_secrets_project_name": "-hub-secrets",
         "catalog_filename": "catalog.json",
         "default_source": {
             # Set false to avoid creating a global source (for example in a dark site)
             "create": True,
-            "name": "mlrun_global_hub",
+            "name": "default",
             "description": "MLRun global function hub",
-            "url": "https://raw.githubusercontent.com/mlrun/marketplace/master",
+            "url": "https://mlrun.github.io/marketplace",
             "object_type": "functions",
             "channel": "master",
         },
     },
     "storage": {
         # What type of auto-mount to use for functions. One of: none, auto, v3io_credentials, v3io_fuse, pvc, s3, env.
         # Default is auto - which is v3io_credentials when running on Iguazio. If not Iguazio: pvc if the
@@ -555,14 +554,21 @@
         # Whether to enable packagers. True will wrap each run in the `mlrun.package.handler` decorator to log and parse
         # using packagers.
         "enabled": True,
         # Whether to treat returned tuples from functions as a tuple and not as multiple returned items. If True, all
         # returned values will be packaged together as the tuple they are returned in. Default is False to enable
         # logging multiple returned items.
         "pack_tuples": False,
+        # In multi-workers run, only the logging worker will pack the outputs and log the results and artifacts.
+        # Otherwise, the workers will log the results and artifacts using the same keys, overriding them. It is common
+        # that only the main worker (usualy rank 0) will log, so this is the default value.
+        "logging_worker": 0,
+        # TODO: Consider adding support for logging from all workers (ignoring the `logging_worker`) and add the worker
+        #       number to the artifact / result key (like "<key>-rank<#>". Results can have reduce operation in the
+        #       log hint to average / min / max them across all the workers (default operation should be average).
     },
     # Events are currently (and only) used to audit changes and record access to MLRun entities (such as secrets)
     "events": {
         # supported modes "enabled", "disabled".
         # "enabled" - events are emitted.
         # "disabled" - a nop client is used (aka doing nothing).
         "mode": "disabled",
@@ -655,22 +661,17 @@
         return (
             config.httpdb.builder.pip_ca_secret_name
             and config.httpdb.builder.pip_ca_secret_key
             and config.httpdb.builder.pip_ca_path
         )
 
     @staticmethod
-    def get_hub_url():
-        if not config.hub_url.endswith("function.yaml"):
-            if config.hub_url.startswith("http"):
-                return f"{config.hub_url}/{{tag}}/{{name}}/function.yaml"
-            elif config.hub_url.startswith("v3io"):
-                return f"{config.hub_url}/{{name}}/function.yaml"
-
-        return config.hub_url
+    def get_default_hub_source() -> str:
+        default_source = config.hub.default_source
+        return f"{default_source.url}/{default_source.object_type}/{default_source.channel}/"
 
     @staticmethod
     def decode_base64_config_and_load_to_object(
         attribute_path: str, expected_type=dict
     ):
         """
         decodes and loads the config attribute to expected type
```

## mlrun/model.py

```diff
@@ -352,25 +352,29 @@
         code_origin=None,
         registry=None,
         load_source_on_run=None,
         origin_filename=None,
         with_mlrun=None,
         auto_build=None,
         requirements: list = None,
+        extra_args=None,
+        builder_env=None,
     ):
         self.functionSourceCode = functionSourceCode  #: functionSourceCode
         self.codeEntryType = ""  #: codeEntryType
         self.codeEntryAttributes = ""  #: codeEntryAttributes
         self.source = source  #: source
         self.code_origin = code_origin  #: code_origin
         self.origin_filename = origin_filename
         self.image = image  #: image
         self.base_image = base_image  #: base_image
         self.commands = commands or []  #: commands
         self.extra = extra  #: extra
+        self.extra_args = extra_args  #: extra args
+        self.builder_env = builder_env  #: builder env
         self.secret = secret  #: secret
         self.registry = registry  #: registry
         self.load_source_on_run = load_source_on_run  #: load_source_on_run
         self.with_mlrun = with_mlrun  #: with_mlrun
         self.auto_build = auto_build  #: auto_build
         self.build_pod = None
         self.requirements = requirements or []  #: pip requirements
@@ -404,14 +408,16 @@
         extra=None,
         load_source_on_run=None,
         with_mlrun=None,
         auto_build=None,
         requirements=None,
         requirements_file=None,
         overwrite=False,
+        builder_env=None,
+        extra_args=None,
     ):
         if image:
             self.image = image
         if base_image:
             self.base_image = base_image
         if commands:
             self.with_commands(commands, overwrite=overwrite)
@@ -425,14 +431,18 @@
             self.source = source
         if load_source_on_run:
             self.load_source_on_run = load_source_on_run
         if with_mlrun is not None:
             self.with_mlrun = with_mlrun
         if auto_build:
             self.auto_build = auto_build
+        if builder_env:
+            self.builder_env = builder_env
+        if extra_args:
+            self.extra_args = extra_args
 
     def with_commands(
         self,
         commands: List[str],
         overwrite: bool = False,
     ):
         """add commands to build spec.
```

## mlrun/run.py

```diff
@@ -51,14 +51,15 @@
     RemoteRuntime,
     RemoteSparkRuntime,
     RuntimeKinds,
     ServingRuntime,
     Spark3Runtime,
     get_runtime_class,
 )
+from .runtimes.databricks.databricks import DatabricksRuntime
 from .runtimes.funcdoc import update_function_entry_points
 from .runtimes.serving import serving_subkind
 from .runtimes.utils import add_code_metadata, global_context
 from .utils import (
     extend_hub_uri_if_needed,
     get_in,
     logger,
@@ -448,16 +449,16 @@
     """Create function object from DB or local/remote YAML file
 
     Functions can be imported from function repositories (mlrun Function Hub (formerly Marketplace) or local db),
     or be read from a remote URL (http(s), s3, git, v3io, ..) containing the function YAML
 
     special URLs::
 
-        function hub: hub://{name}[:{tag}]
-        local mlrun db:       db://{project-name}/{name}[:{tag}]
+        function hub:       hub://[{source}/]{name}[:{tag}]
+        local mlrun db:     db://{project-name}/{name}[:{tag}]
 
     examples::
 
         function = mlrun.import_function("hub://auto-trainer")
         function = mlrun.import_function("./func.yaml")
         function = mlrun.import_function("https://raw.githubusercontent.com/org/repo/func.yaml")
 
@@ -709,14 +710,15 @@
     RemoteRuntime,
     ServingRuntime,
     DaskCluster,
     KubejobRuntime,
     LocalRuntime,
     Spark3Runtime,
     RemoteSparkRuntime,
+    DatabricksRuntime,
 ]:
     """Convenience function to insert code and configure an mlrun runtime.
 
     Easiest way to construct a runtime type object. Provides the most often
     used configuration options for all runtimes as parameters.
 
     Instantiated runtimes are considered 'functions' in mlrun, but they are
@@ -843,28 +845,31 @@
         and (not filename or filename.endswith(".ipynb"))
     ):
         raise ValueError(
             "a valid code file must be specified "
             "when not using the embed_code option"
         )
 
+    if kind == RuntimeKinds.databricks and not embed_code:
+        raise ValueError("databricks tasks only support embed_code=True")
+
     is_nuclio, subkind = resolve_nuclio_subkind(kind)
     code_origin = add_name(add_code_metadata(filename), name)
 
     name, spec, code = nuclio.build_file(
         filename,
         name=name,
         handler=handler or "handler",
         kind=subkind,
         ignored_tags=ignored_tags,
     )
     spec["spec"]["env"].append(
         {
             "name": "MLRUN_HTTPDB__NUCLIO__EXPLICIT_ACK",
-            "value": mlrun.mlconf.is_explicit_ack(),
+            "value": mlrun.mlconf.httpdb.nuclio.explicit_ack,
         }
     )
     spec_kind = get_in(spec, "kind", "")
     if not kind and spec_kind not in ["", "Function"]:
         kind = spec_kind.lower()
 
         # if its a nuclio subkind, redo nb parsing
@@ -926,14 +931,16 @@
     r.handler = h[0] if len(h) <= 1 else h[1]
     r.metadata = get_in(spec, "spec.metadata")
     r.metadata.name = name
     build = r.spec.build
     build.code_origin = code_origin
     build.origin_filename = filename or (name + ".ipynb")
     build.extra = get_in(spec, "spec.build.extra")
+    build.extra_args = get_in(spec, "spec.build.extra_args")
+    build.builder_env = get_in(spec, "spec.build.builder_env")
     if not embed_code:
         if code_output:
             r.spec.command = code_output
         else:
             r.spec.command = filename
 
     build.image = get_in(spec, "spec.build.image")
```

## mlrun/api/initial_data.py

```diff
@@ -15,15 +15,14 @@
 import collections
 import datetime
 import os
 import pathlib
 import typing
 
 import dateutil.parser
-import pydantic.error_wrappers
 import pymysql.err
 import sqlalchemy.exc
 import sqlalchemy.orm
 
 import mlrun.api.db.sqldb.db
 import mlrun.api.db.sqldb.helpers
 import mlrun.api.db.sqldb.models
@@ -119,15 +118,15 @@
 
 # If the data_table version doesn't exist, we can assume the data version is 1.
 # This is because data version 1 points to a data migration which was added back in 0.6.0, and
 # upgrading from a version earlier than 0.6.0 to v>=0.8.0 is not supported.
 data_version_prior_to_table_addition = 1
 
 # NOTE: Bump this number when adding a new data migration
-latest_data_version = 3
+latest_data_version = 4
 
 
 def _resolve_needed_operations(
     alembic_util: mlrun.api.utils.db.alembic.AlembicUtil,
     sqlite_migration_util: typing.Optional[
         mlrun.api.utils.db.sqlite_migration.SQLiteMigrationUtil
     ],
@@ -226,15 +225,16 @@
             )
             if current_data_version < 1:
                 _perform_version_1_data_migrations(db, db_session)
             if current_data_version < 2:
                 _perform_version_2_data_migrations(db, db_session)
             if current_data_version < 3:
                 _perform_version_3_data_migrations(db, db_session)
-
+            if current_data_version < 4:
+                _perform_version_4_data_migrations(db, db_session)
             db.create_data_version(db_session, str(latest_data_version))
 
 
 def _add_initial_data(db_session: sqlalchemy.orm.Session):
     # FileDB is not really a thing anymore, so using SQLDB directly
     db = mlrun.api.db.sqldb.db.SQLDB("")
     _add_default_hub_source_if_needed(db, db_session)
@@ -533,56 +533,80 @@
             logger.debug(
                 "Found project without state data. Enriching",
                 name=project.metadata.name,
             )
             db.store_project(db_session, project.metadata.name, project)
 
 
+def _perform_version_4_data_migrations(
+    db: mlrun.api.db.sqldb.db.SQLDB, db_session: sqlalchemy.orm.Session
+):
+    _update_default_hub_source(db, db_session)
+
+
 def _add_default_hub_source_if_needed(
     db: mlrun.api.db.sqldb.db.SQLDB, db_session: sqlalchemy.orm.Session
 ):
-    try:
-        hub_marketplace_source = db.get_hub_source(
-            db_session, config.hub.default_source.name
+    hub_source = (
+        db_session.query(mlrun.api.db.sqldb.models.HubSource)
+        .filter(
+            mlrun.api.db.sqldb.models.HubSource.index
+            == mlrun.common.schemas.hub.last_source_index
         )
-    except mlrun.errors.MLRunNotFoundError:
-        hub_marketplace_source = None
-    except pydantic.error_wrappers.ValidationError as exc:
-
-        # following the renaming of 'marketplace' to 'hub', validation errors can occur on the old 'marketplace'.
-        # this will be handled later in the data migrations, but for now - if a validation error occurs, we assume
-        # that a default hub source exists
-        if all(
-            [
-                "validation error for HubSource" in str(exc),
-                "value is not a valid enumeration member" in str(exc),
-            ]
-        ):
-            logger.info("Found existing default hub source, data migration needed")
-            hub_marketplace_source = True
-        else:
-            raise exc
+        .one_or_none()
+    )
 
-    if not hub_marketplace_source:
-        hub_source = mlrun.common.schemas.HubSource.generate_default_source()
-        # hub_source will be None if the configuration has hub.default_source.create=False
-        if hub_source:
-            logger.info("Adding default hub source")
-            # Not using db.store_marketplace_source() since it doesn't allow changing the default hub source.
-            hub_record = db._transform_hub_source_schema_to_record(
-                mlrun.common.schemas.IndexedHubSource(
-                    index=mlrun.common.schemas.hub.last_source_index,
-                    source=hub_source,
-                )
+    if not hub_source:
+        _update_default_hub_source(db, db_session)
+
+
+def _update_default_hub_source(
+    db: mlrun.api.db.sqldb.db.SQLDB,
+    db_session: sqlalchemy.orm.Session,
+):
+    """
+    Updates default hub source in db.
+    """
+    hub_source = mlrun.common.schemas.HubSource.generate_default_source()
+    # hub_source will be None if the configuration has hub.default_source.create=False
+    if hub_source:
+        _delete_default_hub_source(db_session)
+        logger.info("Adding default hub source")
+        # Not using db.store_hub_source() since it doesn't allow changing the default hub source.
+        hub_record = db._transform_hub_source_schema_to_record(
+            mlrun.common.schemas.IndexedHubSource(
+                index=mlrun.common.schemas.hub.last_source_index,
+                source=hub_source,
             )
-            db_session.add(hub_record)
-            db_session.commit()
-        else:
-            logger.info("Not adding default hub source, per configuration")
-    return
+        )
+        db_session.add(hub_record)
+        db_session.commit()
+    else:
+        logger.info("Not adding default hub source, per configuration")
+
+
+def _delete_default_hub_source(db_session: sqlalchemy.orm.Session):
+    """
+    Delete default hub source directly from db
+    """
+    # Not using db.delete_hub_source() since it doesn't allow deleting the default hub source.
+    default_record = (
+        db_session.query(mlrun.api.db.sqldb.models.HubSource)
+        .filter(
+            mlrun.api.db.sqldb.models.HubSource.index
+            == mlrun.common.schemas.last_source_index
+        )
+        .one_or_none()
+    )
+    if default_record:
+        logger.info(f"Deleting default hub source {default_record.name}")
+        db_session.delete(default_record)
+        db_session.commit()
+    else:
+        logger.info("Default hub source not found")
 
 
 def _add_data_version(
     db: mlrun.api.db.sqldb.db.SQLDB, db_session: sqlalchemy.orm.Session
 ):
     if db.get_current_data_version(db_session, raise_on_not_found=False) is None:
         data_version = _resolve_current_data_version(db, db_session)
```

## mlrun/api/launcher.py

```diff
@@ -37,15 +37,15 @@
         self,
         local: bool = False,
         auth_info: Optional[mlrun.common.schemas.AuthInfo] = None,
         **kwargs,
     ):
         super().__init__(**kwargs)
         if local:
-            raise mlrun.errors.MLRunInternalServerError(
+            raise mlrun.errors.MLRunPreconditionFailedError(
                 "Launch of local run inside the server is not allowed"
             )
 
         self._auth_info = auth_info
 
     def launch(
         self,
@@ -148,15 +148,14 @@
             result = execution.to_dict()
             result = runtime._update_run_state(result, task=run)
 
         else:
             # single run
             try:
                 resp = runtime._run(run, execution)
-
             except mlrun.runtimes.utils.RunError as err:
                 last_err = err
 
             finally:
                 result = runtime._update_run_state(resp=resp, task=run, err=last_err)
 
         self._save_notifications(run)
@@ -217,12 +216,27 @@
         if db and runtime.kind != "handler":
             struct = runtime.to_dict()
             hash_key = db.store_function(
                 struct, runtime.metadata.name, runtime.metadata.project, versioned=True
             )
             run.spec.function = runtime._function_uri(hash_key=hash_key)
 
+    def _validate_runtime(
+        self,
+        runtime: "mlrun.runtimes.BaseRuntime",
+        run: "mlrun.run.RunObject",
+    ):
+        if (
+            mlrun.runtimes.RuntimeKinds.is_local_runtime(runtime.kind)
+            and not mlrun.mlconf.httpdb.jobs.allow_local_run
+        ):
+            raise mlrun.errors.MLRunInvalidArgumentError(
+                "Local runtimes can not be run through API (not locally)"
+            )
+
+        super()._validate_runtime(runtime, run)
+
 
 # Once this file is imported it will set the container server side launcher
 @containers.override(mlrun.launcher.factory.LauncherContainer)
 class ServerSideLauncherContainer(containers.DeclarativeContainer):
     server_side_launcher = providers.Factory(ServerSideLauncher)
```

## mlrun/api/api/api.py

```diff
@@ -18,22 +18,24 @@
 import mlrun.config
 from mlrun.api.api.endpoints import (
     artifacts,
     auth,
     background_tasks,
     client_spec,
     clusterization_spec,
+    datastore_profile,
     feature_store,
     files,
     frontend_spec,
     functions,
     grafana_proxy,
     healthz,
     hub,
     internal,
+    jobs,
     logs,
     model_endpoints,
     operations,
     pipelines,
     projects,
     runs,
     runtime_resources,
@@ -121,14 +123,17 @@
 api_router.include_router(
     secrets.router,
     tags=["secrets"],
     dependencies=[Depends(mlrun.api.api.deps.authenticate_request)],
 )
 api_router.include_router(grafana_proxy.router, tags=["grafana", "model-endpoints"])
 api_router.include_router(model_endpoints.router, tags=["model-endpoints"])
+
+api_router.include_router(jobs.router, tags=["jobs"])
+
 api_router.include_router(
     hub.router,
     tags=["hub"],
     dependencies=[Depends(mlrun.api.api.deps.authenticate_request)],
 )
 api_router.include_router(
     operations.router,
@@ -147,7 +152,12 @@
     dependencies=[Depends(mlrun.api.api.deps.authenticate_request)],
 )
 api_router.include_router(
     workflows.router,
     tags=["workflows"],
     dependencies=[Depends(mlrun.api.api.deps.authenticate_request)],
 )
+api_router.include_router(
+    datastore_profile.router,
+    tags=["datastores"],
+    dependencies=[Depends(mlrun.api.api.deps.authenticate_request)],
+)
```

## mlrun/api/api/utils.py

```diff
@@ -152,20 +152,16 @@
         log_and_raise(
             HTTPStatus.BAD_REQUEST.value,
             reason="bad JSON, need to include function/url and task objects",
         )
     return function_dict, function_url, task
 
 
-def _generate_function_and_task_from_submit_run_body(
-    db_session: Session, auth_info: mlrun.common.schemas.AuthInfo, data
-):
+def _generate_function_and_task_from_submit_run_body(db_session: Session, data):
     function_dict, function_url, task = parse_submit_run_body(data)
-    # TODO: block exec for function["kind"] in ["", "local]  (must be a
-    # remote/container runtime)
 
     if function_dict and not function_url:
         function = new_function(runtime=function_dict)
     else:
         if "://" in function_url:
             function = import_function(
                 url=function_url, project=task.get("metadata", {}).get("project")
@@ -184,15 +180,14 @@
 
         if function_dict:
             # The purpose of the function dict is to enable the user to override configurations of the existing function
             # without modifying it - to do that we're creating a function object from the request function dict and
             # assign values from it to the main function object
             function = enrich_function_from_dict(function, function_dict)
 
-    apply_enrichment_and_validation_on_function(function, auth_info)
     apply_enrichment_and_validation_on_task(task)
 
     return function, task
 
 
 async def submit_run(
     db_session: Session, auth_info: mlrun.common.schemas.AuthInfo, data
@@ -879,80 +874,55 @@
         3. str of the uid of the run that started execution (None when it was scheduled)
         4. dict of the response info
     """
     run_uid = None
     project = None
     response = None
     try:
-        fn, task = _generate_function_and_task_from_submit_run_body(
-            db_session, auth_info, data
-        )
-        if (
-            mlrun.runtimes.RuntimeKinds.is_local_runtime(fn.kind)
-            and not mlrun.mlconf.httpdb.jobs.allow_local_run
-        ):
-            raise mlrun.errors.MLRunInvalidArgumentError(
-                "Local runtimes can not be run through API (not locally)"
-            )
+        fn, task = _generate_function_and_task_from_submit_run_body(db_session, data)
+
         run_db = get_run_db_instance(db_session)
         fn.set_db_connection(run_db)
         logger.info("Submitting run", function=fn.to_dict(), task=task)
         schedule = data.get("schedule")
         if schedule:
             cron_trigger = schedule
             if isinstance(cron_trigger, dict):
                 cron_trigger = mlrun.common.schemas.ScheduleCronTrigger(**cron_trigger)
             schedule_labels = task["metadata"].get("labels")
-            created = False
 
             # if the task is pointing to a remote function (hub://), we need to save it to the db
             # and update the task to point to the saved function, so that the scheduler will be able to
             # access the db version of the function, and not the remote one (which can be changed between runs)
             if "://" in task["spec"]["function"]:
                 function_uri = fn.save(versioned=True)
                 data.pop("function", None)
                 data.pop("function_url", None)
                 task["spec"]["function"] = function_uri.replace("db://", "")
 
-            try:
-                get_scheduler().update_schedule(
-                    db_session,
-                    auth_info,
-                    task["metadata"]["project"],
-                    task["metadata"]["name"],
-                    data,
-                    cron_trigger,
-                    schedule_labels,
-                )
-            except mlrun.errors.MLRunNotFoundError:
-                logger.debug(
-                    "No existing schedule found, creating a new one",
-                    project=task["metadata"]["project"],
-                    name=task["metadata"]["name"],
-                )
-                get_scheduler().create_schedule(
-                    db_session,
-                    auth_info,
-                    task["metadata"]["project"],
-                    task["metadata"]["name"],
-                    mlrun.common.schemas.ScheduleKinds.job,
-                    data,
-                    cron_trigger,
-                    schedule_labels,
-                )
-                created = True
-            project = task["metadata"]["project"]
+            is_update = get_scheduler().store_schedule(
+                db_session,
+                auth_info,
+                task["metadata"]["project"],
+                task["metadata"]["name"],
+                mlrun.common.schemas.ScheduleKinds.job,
+                data,
+                cron_trigger,
+                schedule_labels,
+            )
 
+            project = task["metadata"]["project"]
             response = {
                 "schedule": schedule,
                 "project": task["metadata"]["project"],
                 "name": task["metadata"]["name"],
                 # indicate whether it was created or modified
-                "action": "created" if created else "modified",
+                "action": "modified" if is_update else "created",
             }
+
         else:
             # When processing a hyper-param run, secrets may be needed to access the parameters file (which is accessed
             # locally from the mlrun service pod) - include project secrets and the caller's access key
             param_file_secrets = (
                 mlrun.api.crud.Secrets()
                 .list_project_secrets(
                     task["metadata"]["project"],
@@ -961,15 +931,20 @@
                 )
                 .secrets
             )
             param_file_secrets["V3IO_ACCESS_KEY"] = (
                 auth_info.data_session or auth_info.access_key
             )
 
-            run = fn.run(task, watch=False, param_file_secrets=param_file_secrets)
+            run = fn.run(
+                task,
+                watch=False,
+                param_file_secrets=param_file_secrets,
+                auth_info=auth_info,
+            )
             run_uid = run.metadata.uid
             project = run.metadata.project
             if run:
                 response = run.to_dict()
 
     except HTTPException:
         logger.error(traceback.format_exc())
```

## mlrun/api/api/endpoints/functions.py

```diff
@@ -53,15 +53,15 @@
 from mlrun.api.utils.singletons.scheduler import get_scheduler
 from mlrun.common.helpers import parse_versioned_object_uri
 from mlrun.common.model_monitoring.helpers import parse_model_endpoint_store_prefix
 from mlrun.config import config
 from mlrun.errors import MLRunRuntimeError, err_to_str
 from mlrun.model_monitoring.tracking_policy import TrackingPolicy
 from mlrun.run import new_function
-from mlrun.runtimes import RuntimeKinds, ServingRuntime, runtime_resources_map
+from mlrun.runtimes import RuntimeKinds, ServingRuntime
 from mlrun.runtimes.utils import get_item_name
 from mlrun.utils import get_in, logger, update_in
 
 router = APIRouter()
 
 
 @router.post(
@@ -726,15 +726,15 @@
                 try:
                     if fn.spec.track_models:
                         logger.info("Tracking enabled, initializing model monitoring")
 
                         # Generating model monitoring access key
                         model_monitoring_access_key = None
                         if not mlrun.mlconf.is_ce_mode():
-                            model_monitoring_access_key = _process_model_monitoring_secret(
+                            model_monitoring_access_key = process_model_monitoring_secret(
                                 db_session,
                                 fn.metadata.project,
                                 mlrun.common.schemas.model_monitoring.ProjectSecretKeys.ACCESS_KEY,
                             )
 
                             stream_path = (
                                 mlrun.api.crud.model_monitoring.get_stream_path(
@@ -839,84 +839,75 @@
     function,
     auth_info: mlrun.common.schemas.AuthInfo,
     client_version: str = None,
     client_python_version: str = None,
 ):
     db_session = mlrun.api.db.session.create_session()
     try:
-        resource = runtime_resources_map.get(function.kind)
-        if "start" not in resource:
-            log_and_raise(
-                HTTPStatus.BAD_REQUEST.value,
-                reason="runtime error: 'start' not supported by this runtime",
-            )
         try:
             run_db = get_run_db_instance(db_session)
             function.set_db_connection(run_db)
             mlrun.api.api.utils.apply_enrichment_and_validation_on_function(
                 function,
                 auth_info,
             )
 
-            #  resp = resource["start"](fn)  # TODO: handle resp?
-            resource["start"](
-                function,
-                client_version=client_version,
-                client_python_version=client_python_version,
+            mlrun.api.crud.Functions().start_function(
+                function, client_version, client_python_version
             )
-            function.save(versioned=False)
             logger.info("Fn:\n %s", function.to_yaml())
+
+        except mlrun.errors.MLRunBadRequestError:
+            raise
+
         except Exception as err:
             logger.error(traceback.format_exc())
             log_and_raise(
                 HTTPStatus.BAD_REQUEST.value,
-                reason=f"runtime error: {err_to_str(err)}",
+                reason=f"Runtime error: {err_to_str(err)}",
             )
     finally:
         mlrun.api.db.session.close_session(db_session)
 
 
 async def _get_function_status(data, auth_info: mlrun.common.schemas.AuthInfo):
-    logger.info(f"function_status:\n{data}")
+    logger.info(f"Getting function status:\n{data}")
     selector = data.get("selector")
     kind = data.get("kind")
     if not selector or not kind:
         log_and_raise(
             HTTPStatus.BAD_REQUEST.value,
-            reason="runtime error: selector or runtime kind not specified",
+            reason="Runtime error: selector or runtime kind not specified",
         )
     project, name = data.get("project"), data.get("name")
-    # Only after 0.6.6 the client start sending the project and name, as long as 0.6.6 is a valid version we'll need
-    # to try and resolve them from the selector. TODO: remove this when 0.6.6 is not relevant anymore
-    if not project or not name:
-        project, name, _ = mlrun.runtimes.utils.parse_function_selector(selector)
 
     await mlrun.api.utils.auth.verifier.AuthVerifier().query_project_resource_permissions(
         mlrun.common.schemas.AuthorizationResourceTypes.function,
         project,
         name,
         mlrun.common.schemas.AuthorizationAction.read,
         auth_info,
     )
 
-    resource = runtime_resources_map.get(kind)
-    if "status" not in resource:
-        log_and_raise(
-            HTTPStatus.BAD_REQUEST.value,
-            reason="runtime error: 'status' not supported by this runtime",
+    try:
+        status = mlrun.api.crud.Functions().get_function_status(
+            kind,
+            selector,
         )
+        logger.info("Got function status", status=status)
+        return status
+
+    except mlrun.errors.MLRunBadRequestError:
+        raise
 
-    try:
-        resp = resource["status"](selector)
-        logger.info("status: %s", resp)
     except Exception as err:
         logger.error(traceback.format_exc())
         log_and_raise(
             HTTPStatus.BAD_REQUEST.value,
-            reason=f"runtime error: {err_to_str(err)}",
+            reason=f"Runtime error: {err_to_str(err)}",
         )
 
 
 def _create_model_monitoring_stream(project: str, function, stream_path):
     _init_serving_function_stream_args(fn=function)
 
     _, container, stream_path = parse_model_endpoint_store_prefix(stream_path)
@@ -966,15 +957,15 @@
 def _get_function_env_var(fn: ServingRuntime, var_name: str):
     for env_var in fn.spec.env:
         if get_item_name(env_var) == var_name:
             return env_var
     return None
 
 
-def _process_model_monitoring_secret(db_session, project_name: str, secret_key: str):
+def process_model_monitoring_secret(db_session, project_name: str, secret_key: str):
     # The expected result of this method is an access-key placed in an internal project-secret.
     # If the user provided an access-key as the "regular" secret_key, then we delete this secret and move contents
     # to the internal secret instead. Else, if the internal secret already contained a value, keep it. Last option
     # (which is the recommended option for users) is to retrieve a new access-key from the project owner and use it.
     logger.info(
         "Getting project secret", project_name=project_name, namespace=config.namespace
     )
```

## mlrun/api/api/endpoints/hub.py

```diff
@@ -63,29 +63,40 @@
 
 
 @router.get(
     path="",
     response_model=List[mlrun.common.schemas.hub.IndexedHubSource],
 )
 async def list_sources(
+    item_name: Optional[str] = Query(None, alias="item-name"),
+    tag: Optional[str] = Query(None),
+    version: Optional[str] = Query(None),
     db_session: Session = Depends(mlrun.api.api.deps.get_db_session),
     auth_info: mlrun.common.schemas.AuthInfo = Depends(
         mlrun.api.api.deps.authenticate_request
     ),
 ):
     await mlrun.api.utils.auth.verifier.AuthVerifier().query_global_resource_permissions(
         mlrun.common.schemas.AuthorizationResourceTypes.hub_source,
         mlrun.common.schemas.AuthorizationAction.read,
         auth_info,
     )
 
-    return await run_in_threadpool(
+    hub_sources = await run_in_threadpool(
         mlrun.api.utils.singletons.db.get_db().list_hub_sources, db_session
     )
 
+    return await run_in_threadpool(
+        mlrun.api.crud.Hub().filter_hub_sources,
+        hub_sources,
+        item_name,
+        tag,
+        version,
+    )
+
 
 @router.delete(
     path="/{source_name}",
     status_code=HTTPStatus.NO_CONTENT.value,
 )
 async def delete_source(
     source_name: str,
```

## mlrun/api/crud/__init__.py

```diff
@@ -13,14 +13,15 @@
 # limitations under the License.
 #
 # flake8: noqa: F401  - this is until we take care of the F401 violations with respect to __all__ & sphinx
 
 from .artifacts import Artifacts
 from .client_spec import ClientSpec
 from .clusterization_spec import ClusterizationSpec
+from .datastore_profiles import DatastoreProfiles
 from .feature_store import FeatureStore
 from .functions import Functions
 from .hub import Hub
 from .logs import Logs
 from .model_monitoring import ModelEndpoints
 from .notifications import Notifications
 from .pipelines import Pipelines
```

## mlrun/api/crud/client_spec.py

```diff
@@ -11,16 +11,16 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 import mlrun.api.utils.runtimes.nuclio
 import mlrun.common.schemas
 import mlrun.utils.singleton
+from mlrun.api.runtime_handlers.mpijob import resolve_mpijob_crd_version
 from mlrun.config import Config, config, default_config
-from mlrun.runtimes.utils import resolve_mpijob_crd_version
 
 
 class ClientSpec(
     metaclass=mlrun.utils.singleton.Singleton,
 ):
     def get_client_spec(
         self, client_version: str = None, client_python_version: str = None
@@ -63,15 +63,14 @@
             ),
             # These have a default value, therefore we want to send them only if their value is not the default one
             # (otherwise clients don't know when to use server value and when to use client value)
             ui_projects_prefix=self._get_config_value_if_not_default(
                 "ui.projects_prefix"
             ),
             scrape_metrics=self._get_config_value_if_not_default("scrape_metrics"),
-            hub_url=self._get_config_value_if_not_default("hub_url"),
             default_function_node_selector=self._get_config_value_if_not_default(
                 "default_function_node_selector"
             ),
             igz_version=self._get_config_value_if_not_default("igz_version"),
             auto_mount_type=self._get_config_value_if_not_default(
                 "storage.auto_mount_type"
             ),
@@ -101,14 +100,15 @@
             logs=self._get_config_value_if_not_default("httpdb.logs"),
             feature_store_data_prefixes=self._get_config_value_if_not_default(
                 "feature_store.data_prefixes"
             ),
             model_endpoint_monitoring_store_type=self._get_config_value_if_not_default(
                 "model_endpoint_monitoring.store_type"
             ),
+            packagers=self._get_config_value_if_not_default("packagers"),
         )
 
     @staticmethod
     def _resolve_image_by_client_versions(
         image: str, client_version: str = None, client_python_version=None
     ):
         """
```

## mlrun/api/crud/functions.py

```diff
@@ -13,14 +13,15 @@
 # limitations under the License.
 #
 import typing
 
 import sqlalchemy.orm
 
 import mlrun.api.api.utils
+import mlrun.api.runtime_handlers
 import mlrun.api.utils.projects.remotes.follower
 import mlrun.api.utils.singletons.db
 import mlrun.api.utils.singletons.project_member
 import mlrun.common.schemas
 import mlrun.config
 import mlrun.errors
 import mlrun.utils.singleton
@@ -101,7 +102,34 @@
             session=db_session,
             name=name,
             project=project,
             tag=tag,
             labels=labels,
             hash_key=hash_key,
         )
+
+    def get_function_status(
+        self,
+        kind,
+        selector,
+    ):
+        resource = mlrun.api.runtime_handlers.runtime_resources_map.get(kind)
+        if "status" not in resource:
+            raise mlrun.errors.MLRunBadRequestError(
+                reason="Runtime error: 'status' not supported by this runtime"
+            )
+
+        return resource["status"](selector)
+
+    def start_function(self, function, client_version=None, client_python_version=None):
+        resource = mlrun.api.runtime_handlers.runtime_resources_map.get(function.kind)
+        if "start" not in resource:
+            raise mlrun.errors.MLRunBadRequestError(
+                reason="Runtime error: 'start' not supported by this runtime"
+            )
+
+        resource["start"](
+            function,
+            client_version=client_version,
+            client_python_version=client_python_version,
+        )
+        function.save(versioned=False)
```

## mlrun/api/crud/hub.py

```diff
@@ -15,14 +15,15 @@
 import json
 from typing import Any, Dict, List, Optional, Tuple
 
 import mlrun.api.utils.singletons.k8s
 import mlrun.common.schemas
 import mlrun.common.schemas.hub
 import mlrun.errors
+import mlrun.utils.helpers
 import mlrun.utils.singleton
 from mlrun.config import config
 from mlrun.datastore import store_manager
 
 from .secrets import Secrets, SecretsClientType
 
 # Using a complex separator, as it's less likely someone will use it in a real secret name
@@ -155,14 +156,24 @@
         )
         # Loop over objects, then over object versions.
         for object_name, object_dict in catalog_dict.items():
             for version_tag, version_dict in object_dict.items():
                 object_details_dict = version_dict.copy()
                 spec_dict = object_details_dict.pop("spec", {})
                 assets = object_details_dict.pop("assets", {})
+                # We want to align all item names to be normalized.
+                # This is necessary since the item names are originally collected from the yaml files
+                # which may can contain underscores.
+                object_details_dict.update(
+                    {
+                        "name": mlrun.utils.helpers.normalize_name(
+                            object_name, verbose=False
+                        )
+                    }
+                )
                 metadata = mlrun.common.schemas.hub.HubItemMetadata(
                     tag=version_tag, **object_details_dict
                 )
                 item_uri = source.get_full_uri(metadata.get_relative_path())
                 spec = mlrun.common.schemas.hub.HubItemSpec(
                     item_uri=item_uri, assets=assets, **spec_dict
                 )
@@ -263,15 +274,16 @@
         Retrieve items from catalog filtered by name
 
         :param catalog:     list of items
         :param item_name:   item name to filter by
 
         :return:   list of item objects from catalog
         """
-        return [item for item in catalog if item.metadata.name == item_name]
+        normalized_name = mlrun.utils.helpers.normalize_name(item_name, verbose=False)
+        return [item for item in catalog if item.metadata.name == normalized_name]
 
     def get_item_object_using_source_credentials(
         self, source: mlrun.common.schemas.hub.HubSource, url
     ):
         credentials = self._get_source_credentials(source.metadata.name)
 
         if not url.startswith(source.spec.path):
@@ -306,7 +318,45 @@
         """
         credentials = self._get_source_credentials(source.metadata.name)
         asset_path = self._get_asset_full_path(source, item, asset_name)
         return (
             mlrun.run.get_object(url=asset_path, secrets=credentials),
             asset_path,
         )
+
+    def filter_hub_sources(
+        self,
+        sources: List[mlrun.common.schemas.IndexedHubSource],
+        item_name: Optional[str] = None,
+        tag: Optional[str] = None,
+        version: Optional[str] = None,
+    ) -> List[mlrun.common.schemas.IndexedHubSource]:
+        """
+        Retrieve only the sources that contains the item name
+        (and tag/version if supplied, if tag and version are both given, only tag will be taken into consideration)
+
+        :param sources:     List of hub sources
+        :param item_name:   item name. If not provided the original list will be returned.
+        :param tag:         item tag to filter by, supported only if item name is provided.
+        :param version:     item version to filter by, supported only if item name is provided.
+
+        :return:
+        """
+        if not item_name:
+            if tag or version:
+                raise mlrun.errors.MLRunBadRequestError(
+                    "Tag or version are supported only if item name is provided"
+                )
+            return sources
+
+        filtered_sources = []
+        for source in sources:
+            catalog = self.get_source_catalog(
+                source=source.source,
+                version=version,
+                tag=tag,
+            )
+            for item in catalog.catalog:
+                if item.metadata.name == item_name:
+                    filtered_sources.append(source)
+                    break
+        return filtered_sources
```

## mlrun/api/crud/runs.py

```diff
@@ -126,35 +126,35 @@
         max_partitions: int = 0,
         requested_logs: bool = None,
         return_as_run_structs: bool = True,
         with_notifications: bool = False,
     ):
         project = project or mlrun.mlconf.default_project
         return mlrun.api.utils.singletons.db.get_db().list_runs(
-            db_session,
-            name,
-            uid,
-            project,
-            labels,
-            states,
-            sort,
-            last,
-            iter,
-            start_time_from,
-            start_time_to,
-            last_update_time_from,
-            last_update_time_to,
-            partition_by,
-            rows_per_partition,
-            partition_sort_by,
-            partition_order,
-            max_partitions,
-            requested_logs,
-            return_as_run_structs,
-            with_notifications,
+            session=db_session,
+            name=name,
+            uid=uid,
+            project=project,
+            labels=labels,
+            states=states,
+            sort=sort,
+            last=last,
+            iter=iter,
+            start_time_from=start_time_from,
+            start_time_to=start_time_to,
+            last_update_time_from=last_update_time_from,
+            last_update_time_to=last_update_time_to,
+            partition_by=partition_by,
+            rows_per_partition=rows_per_partition,
+            partition_sort_by=partition_sort_by,
+            partition_order=partition_order,
+            max_partitions=max_partitions,
+            requested_logs=requested_logs,
+            return_as_run_structs=return_as_run_structs,
+            with_notifications=with_notifications,
         )
 
     def delete_run(
         self,
         db_session: sqlalchemy.orm.Session,
         uid: str,
         iter: int,
```

## mlrun/api/crud/secrets.py

```diff
@@ -32,14 +32,15 @@
 
 class SecretsClientType(str, enum.Enum):
     schedules = "schedules"
     model_monitoring = "model-monitoring"
     service_accounts = "service-accounts"
     hub = "hub"
     notifications = "notifications"
+    datastore_profiles = "datastore-profiles"
 
 
 class Secrets(
     metaclass=mlrun.utils.singleton.Singleton,
 ):
     internal_secrets_key_prefix = "mlrun."
     # make it a subset of internal since key map are by definition internal
```

## mlrun/api/crud/workflows.py

```diff
@@ -111,18 +111,18 @@
         }
 
         get_scheduler().store_schedule(
             db_session=db_session,
             auth_info=auth_info,
             project=project.metadata.name,
             name=workflow_spec.name,
+            kind=mlrun.common.schemas.ScheduleKinds.job,
             scheduled_object=scheduled_object,
             cron_trigger=schedule,
             labels=runner.metadata.labels,
-            kind=mlrun.common.schemas.ScheduleKinds.job,
         )
 
     def _prepare_run_object_for_scheduling(
         self,
         project: mlrun.common.schemas.Project,
         workflow_request: mlrun.common.schemas.WorkflowRequest,
         labels: Dict[str, str],
@@ -151,14 +151,16 @@
                     artifact_path=workflow_request.artifact_path,
                     workflow_handler=workflow_spec.handler,
                     namespace=workflow_request.namespace,
                     ttl=workflow_spec.ttl,
                     engine=workflow_spec.engine,
                     local=workflow_spec.run_local,
                     save=save,
+                    # save=True modifies the project.yaml (by enrichment) so the local git repo is becoming dirty
+                    dirty=save,
                     subpath=project.spec.subpath,
                 ),
                 handler="mlrun.projects.load_and_run",
                 scrape_metrics=config.scrape_metrics,
                 output_path=(
                     workflow_request.artifact_path or config.artifact_path
                 ).replace("{{run.uid}}", meta_uid),
@@ -272,14 +274,16 @@
         run_object = RunObject(
             spec=RunSpec(
                 parameters=dict(
                     url=project.spec.source,
                     project_name=project.metadata.name,
                     load_only=load_only,
                     save=save,
+                    # save=True modifies the project.yaml (by enrichment) so the local git repo is becoming dirty
+                    dirty=save,
                 ),
                 handler="mlrun.projects.load_and_run",
             ),
             metadata=RunMetadata(name=run_name),
         )
 
         if not load_only:
```

## mlrun/api/crud/model_monitoring/deployment.py

```diff
@@ -17,14 +17,15 @@
 
 import sqlalchemy.orm
 from fastapi import Depends
 
 import mlrun.api.api.endpoints.functions
 import mlrun.api.api.utils
 import mlrun.api.crud.model_monitoring.helpers
+import mlrun.api.utils.scheduler
 import mlrun.api.utils.singletons.db
 import mlrun.api.utils.singletons.k8s
 import mlrun.common.schemas.model_monitoring
 import mlrun.model_monitoring.stream_processing
 import mlrun.model_monitoring.tracking_policy
 from mlrun import feature_store as fstore
 from mlrun.api.api import deps
@@ -159,99 +160,102 @@
     def deploy_model_monitoring_batch_processing(
         self,
         project: str,
         model_monitoring_access_key: str,
         db_session: sqlalchemy.orm.Session,
         auth_info: mlrun.common.schemas.AuthInfo,
         tracking_policy: mlrun.model_monitoring.tracking_policy.TrackingPolicy,
+        with_schedule: bool = True,
+        overwrite: bool = False,
         tracking_offset: Seconds = Seconds(0),
-    ):
+    ) -> typing.Union[mlrun.runtimes.kubejob.KubejobRuntime, None]:
         """
         Deploying model monitoring batch job. The goal of this job is to identify drift in the data
         based on the latest batch of events. By default, this job is executed on the hour every hour.
-        Note that if the monitoring batch job was already deployed then you will have to delete the
-        old monitoring batch job before deploying a new one.
+        Note that if the monitoring batch job was already deployed then you will either have to pass overwrite=True or
+        to delete the old monitoring batch job before deploying a new one.
 
         :param project:                     The name of the project.
         :param model_monitoring_access_key: Access key to apply the model monitoring process.
         :param db_session:                  A session that manages the current dialog with the database.
         :param auth_info:                   The auth info of the request.
         :param tracking_policy:             Model monitoring configurations.
+        :param with_schedule:               If true, submit a scheduled batch drift job.
+        :param overwrite:                   If true, overwrite the existing model monitoring batch job.
         :param tracking_offset:             Offset for the tracking policy (for synchronization with the stream)
-        """
-
-        logger.info(
-            "Checking if model monitoring batch processing function is already deployed",
-            project=project,
-        )
 
-        # Try to list functions that named model monitoring batch
-        # to make sure that this job has not yet been deployed
-        function_list = mlrun.api.utils.singletons.db.get_db().list_functions(
-            session=db_session, name="model-monitoring-batch", project=project
-        )
+        :return: Model monitoring batch job as a runtime function.
+        """
 
-        if function_list:
+        fn = None
+        if not overwrite:
             logger.info(
-                "Detected model monitoring batch processing function already deployed",
+                "Checking if model monitoring batch processing function is already deployed",
                 project=project,
             )
-            return
 
-        # Create a monitoring batch job function object
-        fn = self._get_model_monitoring_batch_function(
-            project=project,
-            model_monitoring_access_key=model_monitoring_access_key,
-            db_session=db_session,
-            auth_info=auth_info,
-            tracking_policy=tracking_policy,
-        )
-
-        # Get the function uri
-        function_uri = fn.save(versioned=True)
-        function_uri = function_uri.replace("db://", "")
-
-        task = mlrun.new_task(name="model-monitoring-batch", project=project)
-        task.spec.function = function_uri
-
-        # Apply batching interval params
-        interval_list = [
-            tracking_policy.default_batch_intervals.minute,
-            tracking_policy.default_batch_intervals.hour,
-            tracking_policy.default_batch_intervals.day,
-        ]
-        (
-            minutes,
-            hours,
-            days,
-        ) = mlrun.api.crud.model_monitoring.helpers.get_batching_interval_param(
-            interval_list
-        )
-        batch_dict = {"minutes": minutes, "hours": hours, "days": days}
+            # Try to list functions that named model monitoring batch
+            # to make sure that this job has not yet been deployed
+            try:
+                fn = mlrun.api.crud.Functions().get_function(
+                    db_session=db_session,
+                    name="model-monitoring-batch",
+                    project=project,
+                )
+                logger.info(
+                    "Detected model monitoring batch processing function already deployed",
+                    project=project,
+                )
 
-        task.spec.parameters[
-            mlrun.common.schemas.model_monitoring.EventFieldType.BATCH_INTERVALS_DICT
-        ] = batch_dict
+            except mlrun.errors.MLRunNotFoundError:
+                logger.info(
+                    "Deploying monitoring batch processing function ", project=project
+                )
 
-        data = {
-            "task": task.to_dict(),
-            "schedule": mlrun.api.crud.model_monitoring.helpers.convert_to_cron_string(
-                tracking_policy.default_batch_intervals,
-                minute_delay=seconds2minutes(tracking_offset),
-            ),
-        }
+        if not fn:
+            # Create a monitoring batch job function object
+            fn = self._get_model_monitoring_batch_function(
+                project=project,
+                model_monitoring_access_key=model_monitoring_access_key,
+                db_session=db_session,
+                auth_info=auth_info,
+                tracking_policy=tracking_policy,
+            )
 
-        logger.info(
-            "Deploying model monitoring batch processing function", project=project
-        )
+            # Get the function uri
+            function_uri = fn.save(versioned=True)
 
-        # Add job schedule policy (every hour by default)
-        mlrun.api.api.utils.submit_run_sync(
-            db_session=db_session, auth_info=auth_info, data=data
-        )
+            if with_schedule:
+                if not overwrite:
+                    try:
+                        mlrun.api.utils.scheduler.Scheduler().get_schedule(
+                            db_session=db_session,
+                            project=project,
+                            name="model-monitoring-batch",
+                        )
+                        logger.info(
+                            "Already deployed monitoring batch scheduled job function ",
+                            project=project,
+                        )
+                        return
+                    except mlrun.errors.MLRunNotFoundError:
+                        logger.info(
+                            "Deploying monitoring batch scheduled job function ",
+                            project=project,
+                        )
+                # Submit batch scheduled job
+                self._submit_schedule_batch_job(
+                    project=project,
+                    function_uri=function_uri,
+                    db_session=db_session,
+                    auth_info=auth_info,
+                    tracking_policy=tracking_policy,
+                    tracking_offset=tracking_offset,
+                )
+        return fn
 
     def _initial_model_monitoring_stream_processing_function(
         self,
         project: str,
         model_monitoring_access_key: str,
         tracking_policy: mlrun.model_monitoring.tracking_policy.TrackingPolicy,
         auth_info: mlrun.common.schemas.AuthInfo,
@@ -359,14 +363,78 @@
         # Enrich runtime with the required configurations
         mlrun.api.api.utils.apply_enrichment_and_validation_on_function(
             function, auth_info
         )
 
         return function
 
+    @staticmethod
+    def _submit_schedule_batch_job(
+        project: str,
+        function_uri: str,
+        db_session: sqlalchemy.orm.Session,
+        auth_info: mlrun.common.schemas.AuthInfo,
+        tracking_policy: mlrun.model_monitoring.tracking_policy.TrackingPolicy,
+        tracking_offset: Seconds = Seconds(0),
+    ):
+        """
+        Create a new scheduled monitoring batch job analysis based on the model-monitoring-batch function that has
+        been already registered.
+
+        :param project:         Project name.
+        :param function_uri:    Function URI of the registered model monitoring batch job. This URI includes the
+                                related project name, function name, and hash key.
+        :param db_session:      A session that manages the current dialog with the database.
+        :param auth_info:       The auth info of the request.
+        :param tracking_policy: Model monitoring configurations.
+        :param tracking_offset: Offset for the tracking policy (for synchronization with the stream).
+
+        """
+
+        function_uri = function_uri.replace("db://", "")
+
+        task = mlrun.new_task(name="model-monitoring-batch", project=project)
+        task.spec.function = function_uri
+
+        # Apply batching interval params
+        interval_list = [
+            tracking_policy.default_batch_intervals.minute,
+            tracking_policy.default_batch_intervals.hour,
+            tracking_policy.default_batch_intervals.day,
+        ]
+        (
+            minutes,
+            hours,
+            days,
+        ) = mlrun.api.crud.model_monitoring.helpers.get_batching_interval_param(
+            interval_list
+        )
+        batch_dict = {"minutes": minutes, "hours": hours, "days": days}
+
+        task.spec.parameters[
+            mlrun.common.schemas.model_monitoring.EventFieldType.BATCH_INTERVALS_DICT
+        ] = batch_dict
+
+        data = {
+            "task": task.to_dict(),
+            "schedule": mlrun.api.crud.model_monitoring.helpers.convert_to_cron_string(
+                tracking_policy.default_batch_intervals,
+                minute_delay=seconds2minutes(tracking_offset),
+            ),
+        }
+
+        logger.info(
+            "Deploying model monitoring batch processing function", project=project
+        )
+
+        # Add job schedule policy (every hour by default)
+        mlrun.api.api.utils.submit_run_sync(
+            db_session=db_session, auth_info=auth_info, data=data
+        )
+
     def _apply_stream_trigger(
         self,
         project: str,
         function: mlrun.runtimes.ServingRuntime,
         model_monitoring_access_key: str = None,
         auth_info: mlrun.common.schemas.AuthInfo = Depends(deps.authenticate_request),
     ) -> mlrun.runtimes.ServingRuntime:
@@ -444,21 +512,21 @@
                 project
             ),
             mlrun.api.crud.secrets.Secrets().generate_client_project_secret_key(
                 mlrun.api.crud.secrets.SecretsClientType.model_monitoring,
                 mlrun.common.schemas.model_monitoring.ProjectSecretKeys.ACCESS_KEY,
             ),
         )
-        print("[EYAL]: setting batch creds!")
+
         function.metadata.credentials.access_key = model_monitoring_access_key
         function.apply(mlrun.mount_v3io())
 
         # Ensure that the auth env vars are set
         mlrun.api.api.utils.ensure_function_has_auth_set(function, auth_info)
-        print("[EYAL]: setting batch creds DONE!")
+
         return function
 
 
 def get_endpoint_features(
     feature_names: typing.List[str],
     feature_stats: dict = None,
     current_stats: dict = None,
```

## mlrun/api/crud/model_monitoring/model_endpoints.py

```diff
@@ -246,14 +246,16 @@
         feature_set.metadata.project = model_endpoint.metadata.project
 
         feature_set.metadata.labels = {
             mlrun.common.schemas.model_monitoring.EventFieldType.ENDPOINT_ID: model_endpoint.metadata.uid,
             mlrun.common.schemas.model_monitoring.EventFieldType.MODEL_CLASS: model_endpoint.spec.model_class,
         }
 
+        feature_set.metadata.tag = model_endpoint.metadata.uid + "_"
+
         # Add features to the feature set according to the model object
         if model_obj.spec.inputs:
             for feature in model_obj.spec.inputs:
                 feature_set.add_feature(
                     mlrun.feature_store.Feature(
                         name=feature.name, value_type=feature.value_type
                     )
```

## mlrun/api/db/base.py

```diff
@@ -634,7 +634,37 @@
         session,
         project: str,
         notifications: typing.List[mlrun.model.Notification],
         identifiers: typing.List[mlrun.common.schemas.RunIdentifier],
         **kwargs,
     ):
         pass
+
+    def store_datastore_profile(
+        self,
+        session,
+        profile: mlrun.common.schemas.DatastoreProfile,
+    ) -> str:
+        pass
+
+    def get_datastore_profile(
+        self,
+        session,
+        profile: str,
+        project: str,
+    ) -> Optional[mlrun.common.schemas.DatastoreProfile]:
+        pass
+
+    def delete_datastore_profile(
+        self,
+        session,
+        profile: str,
+        project: str,
+    ):
+        pass
+
+    def list_datastore_profiles(
+        self,
+        session,
+        project: str,
+    ) -> List[mlrun.common.schemas.DatastoreProfile]:
+        pass
```

## mlrun/api/db/sqldb/db.py

```diff
@@ -44,14 +44,15 @@
     run_start_time,
     run_state,
     update_labels,
 )
 from mlrun.api.db.sqldb.models import (
     Artifact,
     BackgroundTask,
+    DatastoreProfile,
     DataVersion,
     Entity,
     Feature,
     FeatureSet,
     FeatureVector,
     Function,
     HubSource,
@@ -1170,83 +1171,122 @@
                         artifact["spec"].get("db_key"),
                         artifact["metadata"].get("tag"),
                     )
                 )
 
         return results
 
+    @retry_on_conflict
     def store_schedule(
         self,
         session: Session,
         project: str,
         name: str,
         kind: mlrun.common.schemas.ScheduleKinds = None,
         scheduled_object: Any = None,
         cron_trigger: mlrun.common.schemas.ScheduleCronTrigger = None,
         labels: Dict = None,
         last_run_uri: str = None,
         concurrency_limit: int = None,
         next_run_time: datetime = None,
-    ) -> typing.Optional[mlrun.common.schemas.ScheduleRecord]:
-        schedule = self.get_schedule(
+    ) -> typing.Tuple[mlrun.common.schemas.ScheduleRecord, bool]:
+        schedule = self._get_schedule_record(
             session=session, project=project, name=name, raise_on_not_found=False
         )
-        schedule_exist = schedule is not None
+        is_update = schedule is not None
 
-        if not schedule_exist:
-            schedule = Schedule(
+        if not is_update:
+            schedule = self._create_schedule_db_record(
                 project=project,
                 name=name,
-                kind=kind.value,
-                creation_time=datetime.now(timezone.utc),
-                concurrency_limit=concurrency_limit,
-                next_run_time=next_run_time,
+                kind=kind,
                 scheduled_object=scheduled_object,
                 cron_trigger=cron_trigger,
+                concurrency_limit=concurrency_limit,
+                labels=labels,
+                next_run_time=next_run_time,
             )
-            labels = labels or {}
 
         self._update_schedule_body(
             schedule=schedule,
             scheduled_object=scheduled_object,
             cron_trigger=cron_trigger,
             labels=labels,
             last_run_uri=last_run_uri,
             concurrency_limit=concurrency_limit,
             next_run_time=next_run_time,
         )
 
         logger.debug(
             "Storing schedule to db",
+            project=schedule.project,
+            name=schedule.name,
+            kind=schedule.kind,
+            cron_trigger=schedule.cron_trigger,
+            labels=schedule.labels,
+            concurrency_limit=schedule.concurrency_limit,
+            scheduled_object=schedule.scheduled_object,
+        )
+
+        self._upsert(session, [schedule])
+
+        schedule = self._transform_schedule_record_to_scheme(schedule)
+        return schedule, is_update
+
+    def create_schedule(
+        self,
+        session: Session,
+        project: str,
+        name: str,
+        kind: mlrun.common.schemas.ScheduleKinds,
+        scheduled_object: Any,
+        cron_trigger: mlrun.common.schemas.ScheduleCronTrigger,
+        concurrency_limit: int,
+        labels: Dict = None,
+        next_run_time: datetime = None,
+    ) -> mlrun.common.schemas.ScheduleRecord:
+
+        schedule_record = self._create_schedule_db_record(
             project=project,
             name=name,
             kind=kind,
+            scheduled_object=scheduled_object,
             cron_trigger=cron_trigger,
-            labels=labels,
             concurrency_limit=concurrency_limit,
-            scheduled_object=scheduled_object,
+            labels=labels,
+            next_run_time=next_run_time,
         )
 
-        self._upsert(session, [schedule])
+        logger.debug(
+            "Saving schedule to db",
+            project=schedule_record.project,
+            name=schedule_record.name,
+            kind=schedule_record.kind,
+            cron_trigger=schedule_record.cron_trigger,
+            concurrency_limit=schedule_record.concurrency_limit,
+            next_run_time=schedule_record.next_run_time,
+        )
+        self._upsert(session, [schedule_record])
 
-        if schedule_exist:
-            return schedule
+        schedule = self._transform_schedule_record_to_scheme(schedule_record)
+        return schedule
 
-    def create_schedule(
-        self,
-        session: Session,
+    @staticmethod
+    def _create_schedule_db_record(
         project: str,
         name: str,
         kind: mlrun.common.schemas.ScheduleKinds,
         scheduled_object: Any,
         cron_trigger: mlrun.common.schemas.ScheduleCronTrigger,
         concurrency_limit: int,
         labels: Dict = None,
         next_run_time: datetime = None,
-    ):
+    ) -> Schedule:
+        if concurrency_limit is None:
+            concurrency_limit = config.httpdb.scheduling.default_concurrency_limit
         if next_run_time is not None:
             # We receive the next_run_time with localized timezone info (e.g +03:00). All the timestamps should be
             # saved in the DB in UTC timezone, therefore we transform next_run_time to UTC as well.
             next_run_time = next_run_time.astimezone(pytz.utc)
 
         schedule = Schedule(
             project=project,
@@ -1257,27 +1297,16 @@
             next_run_time=next_run_time,
             # these are properties of the object that map manually (using getters and setters) to other column of the
             # table and therefore Pycharm yells that they're unexpected
             scheduled_object=scheduled_object,
             cron_trigger=cron_trigger,
         )
 
-        labels = labels or {}
-        update_labels(schedule, labels)
-
-        logger.debug(
-            "Saving schedule to db",
-            project=project,
-            name=name,
-            kind=kind,
-            cron_trigger=cron_trigger,
-            concurrency_limit=concurrency_limit,
-            next_run_time=next_run_time,
-        )
-        self._upsert(session, [schedule])
+        update_labels(schedule, labels or {})
+        return schedule
 
     def update_schedule(
         self,
         session: Session,
         project: str,
         name: str,
         scheduled_object: Any = None,
@@ -1308,15 +1337,15 @@
             concurrency_limit=concurrency_limit,
             next_run_time=next_run_time,
         )
         self._upsert(session, [schedule])
 
     @staticmethod
     def _update_schedule_body(
-        schedule: mlrun.common.schemas.ScheduleRecord,
+        schedule: Schedule,
         scheduled_object: Any = None,
         cron_trigger: mlrun.common.schemas.ScheduleCronTrigger = None,
         labels: Dict = None,
         last_run_uri: str = None,
         concurrency_limit: int = None,
         next_run_time: datetime = None,
     ):
@@ -1372,15 +1401,15 @@
         if not schedule_record:
             return
         schedule = self._transform_schedule_record_to_scheme(schedule_record)
         return schedule
 
     def _get_schedule_record(
         self, session: Session, project: str, name: str, raise_on_not_found: bool = True
-    ) -> mlrun.common.schemas.ScheduleRecord:
+    ) -> Schedule:
         query = self._query(session, Schedule, project=project, name=name)
         schedule_record = query.one_or_none()
         if not schedule_record and raise_on_not_found:
             raise mlrun.errors.MLRunNotFoundError(
                 f"Schedule not found: project={project}, name={name}"
             )
         return schedule_record
@@ -1885,14 +1914,15 @@
         self.delete_run_notifications(session, project=name)
         self.del_runs(session, project=name)
         self.delete_schedules(session, name)
         self._delete_functions(session, name)
         self._delete_feature_sets(session, name)
         self._delete_feature_vectors(session, name)
         self._delete_background_tasks(session, project=name)
+        self.delete_datastore_profiles(session, project=name)
 
         # resources deletion should remove their tags and labels as well, but doing another try in case there are
         # orphan resources
         self._delete_resources_tags(session, name)
         self._delete_resources_labels(session, name)
 
     @staticmethod
@@ -3912,7 +3942,108 @@
             self.store_run_notifications(
                 session,
                 notification_objects=notifications,
                 run_uid=run.uid,
                 project=project,
             )
         self._commit(session, [run], ignore=True)
+
+    def store_datastore_profile(
+        self, session, info: mlrun.common.schemas.DatastoreProfile
+    ):
+        """
+        Create or replace a datastore profile.
+        :param session: SQLAlchemy session
+        :param info: datastore profile
+        :returns: None
+        """
+        info.project = info.project or config.default_project
+        profile = self._query(
+            session, DatastoreProfile, name=info.name, project=info.project
+        )
+        first = profile.first()
+        if first:
+            first.type = info.type
+            first.body = info.body
+            self._commit(session, [profile])
+        else:
+            profile = DatastoreProfile(
+                name=info.name,
+                type=info.type,
+                project=info.project,
+                body=info.body,
+            )
+            self._upsert(session, [profile])
+
+    def get_datastore_profile(
+        self,
+        session,
+        profile: str,
+        project: str,
+    ):
+        """
+        get a datastore profile.
+        :param session: SQLAlchemy session
+        :param profile: name of the profile
+        :param project: Name of the project
+        :returns: None
+        """
+        project = project or config.default_project
+        res = self._query(session, DatastoreProfile, name=profile, project=project)
+        if res.first():
+            r = res.first().to_dict(exclude=["id"])
+            return mlrun.common.schemas.DatastoreProfile(**r)
+        else:
+            raise mlrun.errors.MLRunNotFoundError(
+                f"Datastore profile '{profile}' not found in project '{project}'"
+            )
+
+    def delete_datastore_profile(
+        self,
+        session,
+        profile: str,
+        project: str,
+    ):
+        project = project or config.default_project
+        res = self._query(session, DatastoreProfile, name=profile, project=project)
+        if res.first():
+            session.delete(res.first())
+            session.commit()
+        else:
+            raise mlrun.errors.MLRunNotFoundError(
+                f"Datastore profile '{profile}' not found in project '{project}'"
+            )
+
+    def list_datastore_profiles(
+        self,
+        session,
+        project: str,
+    ):
+        """
+        list all datastore profiles for a project.
+        :param session: SQLAlchemy session
+        :param project: Name of the project
+        :returns: List of DatatoreProfile objects (only the public portion of it)
+        """
+        project = project or config.default_project
+        query_results = self._query(session, DatastoreProfile, project=project)
+        return [
+            mlrun.common.schemas.DatastoreProfile(**query.to_dict(exclude=["id"]))
+            for query in query_results
+        ]
+
+    def delete_datastore_profiles(
+        self,
+        session,
+        project: str,
+    ):
+        """
+        Delete all datastore profiles.
+        :param session: SQLAlchemy session
+        :param project: Name of the project
+        :returns: None
+        """
+        project = project or config.default_project
+        query_results = self._query(session, DatastoreProfile, project=project)
+        for profile in query_results:
+            session.delete(profile)
+        session.commit()
```

## mlrun/api/db/sqldb/models/models_mysql.py

```diff
@@ -518,14 +518,26 @@
             sqlalchemy.dialects.mysql.TIMESTAMP(fsp=3),
             default=datetime.now(timezone.utc),
         )
 
         def get_identifier_string(self) -> str:
             return f"{self.version}"
 
+    class DatastoreProfile(Base, mlrun.utils.db.BaseModel):
+        __tablename__ = "datastore_profiles"
+        __table_args__ = (
+            UniqueConstraint("name", "project", name="_datastore_profiles_uc"),
+        )
+
+        id = Column(Integer, primary_key=True)
+        name = Column(String(255, collation=SQLCollationUtil.collation()))
+        project = Column(String(255, collation=SQLCollationUtil.collation()))
+        type = Column(String(255, collation=SQLCollationUtil.collation()))
+        body = Column(String(1024, collation=SQLCollationUtil.collation()))
+
 
 # Must be after all table definitions
 _tagged = [cls for cls in Base.__subclasses__() if hasattr(cls, "Tag")]
 _labeled = [cls for cls in Base.__subclasses__() if hasattr(cls, "Label")]
 _with_notifications = [
     cls for cls in Base.__subclasses__() if hasattr(cls, "Notification")
 ]
```

## mlrun/api/db/sqldb/models/models_sqlite.py

```diff
@@ -474,14 +474,26 @@
         id = Column(Integer, primary_key=True)
         version = Column(String(255, collation=SQLCollationUtil.collation()))
         created = Column(TIMESTAMP, default=datetime.now(timezone.utc))
 
         def get_identifier_string(self) -> str:
             return f"{self.version}"
 
+    class DatastoreProfile(Base, mlrun.utils.db.BaseModel):
+        __tablename__ = "datastore_profiles"
+        __table_args__ = (
+            UniqueConstraint("name", "project", name="_datastore_profiles_uc"),
+        )
+
+        id = Column(Integer, primary_key=True, autoincrement=True)
+        name = Column(String(255, collation=SQLCollationUtil.collation()))
+        type = Column(String(255, collation=SQLCollationUtil.collation()))
+        project = Column(String(255, collation=SQLCollationUtil.collation()))
+        body = Column(String(1024, collation=SQLCollationUtil.collation()))
+
 
 # Must be after all table definitions
 _tagged = [cls for cls in Base.__subclasses__() if hasattr(cls, "Tag")]
 _labeled = [cls for cls in Base.__subclasses__() if hasattr(cls, "Label")]
 _with_notifications = [
     cls for cls in Base.__subclasses__() if hasattr(cls, "Notification")
 ]
```

## mlrun/api/rundb/sqldb.py

```diff
@@ -124,33 +124,33 @@
             mlrun.common.schemas.OrderType, str
         ] = mlrun.common.schemas.OrderType.desc,
         max_partitions: int = 0,
         with_notifications: bool = False,
     ):
         return self._transform_db_error(
             mlrun.api.crud.Runs().list_runs,
-            self.session,
-            name,
-            uid,
-            project,
-            labels,
-            mlrun.utils.helpers.as_list(state) if state is not None else None,
-            sort,
-            last,
-            iter,
-            start_time_from,
-            start_time_to,
-            last_update_time_from,
-            last_update_time_to,
-            partition_by,
-            rows_per_partition,
-            partition_sort_by,
-            partition_order,
-            max_partitions,
-            with_notifications,
+            db_session=self.session,
+            name=name,
+            uid=uid,
+            project=project,
+            labels=labels,
+            states=mlrun.utils.helpers.as_list(state) if state is not None else None,
+            sort=sort,
+            last=last,
+            iter=iter,
+            start_time_from=start_time_from,
+            start_time_to=start_time_to,
+            last_update_time_from=last_update_time_from,
+            last_update_time_to=last_update_time_to,
+            partition_by=partition_by,
+            rows_per_partition=rows_per_partition,
+            partition_sort_by=partition_sort_by,
+            partition_order=partition_order,
+            max_partitions=max_partitions,
+            with_notifications=with_notifications,
         )
 
     def del_run(self, uid, project=None, iter=None):
         return self._transform_db_error(
             mlrun.api.crud.Runs().delete_run,
             self.session,
             uid,
@@ -438,15 +438,15 @@
         )
 
     @staticmethod
     def _transform_db_error(func, *args, **kwargs):
         try:
             return func(*args, **kwargs)
         except DBError as exc:
-            raise mlrun.db.RunDBError(exc.args)
+            raise mlrun.db.RunDBError(exc.args) from exc
 
     def create_feature_set(self, feature_set, project="", versioned=True):
         return self._transform_db_error(
             mlrun.api.crud.FeatureStore().create_feature_set,
             self.session,
             project,
             feature_set,
@@ -688,14 +688,42 @@
             self.session,
             notification_objects,
             run_uid,
             project,
             mask_params,
         )
 
+    def function_status(self, project, name, kind, selector):
+        """Retrieve status of a function being executed remotely (relevant to ``dask`` functions).
+
+        :param project:     The project of the function, not needed here.
+        :param name:        The name of the function, not needed here.
+        :param kind:        The kind of the function, currently ``dask`` is supported.
+        :param selector:    Selector clause to be applied to the Kubernetes status query to filter the results.
+        """
+        return self._transform_db_error(
+            mlrun.api.crud.Functions().get_function_status,
+            kind,
+            selector,
+        )
+
+    def start_function(
+        self, func_url: str = None, function: "mlrun.runtimes.BaseRuntime" = None
+    ):
+        """Execute a function remotely, Used for ``dask`` functions.
+
+        :param func_url: URL to the function to be executed.
+        :param function: The function object to start.
+        :returns: A BackgroundTask object, with details on execution process and its status.
+        """
+        return self._transform_db_error(
+            mlrun.api.crud.Functions().start_function,
+            function,
+        )
+
     def list_pipelines(
         self,
         project: str,
         namespace: str = None,
         sort_by: str = "",
         page_token: str = "",
         filter_: str = "",
@@ -813,15 +841,20 @@
     def store_hub_source(
         self,
         source_name: str,
         source: Union[dict, mlrun.common.schemas.IndexedHubSource],
     ):
         raise NotImplementedError()
 
-    def list_hub_sources(self):
+    def list_hub_sources(
+        self,
+        item_name: Optional[str] = None,
+        tag: Optional[str] = None,
+        version: Optional[str] = None,
+    ):
         raise NotImplementedError()
 
     def get_hub_source(self, source_name: str):
         raise NotImplementedError()
 
     def delete_hub_source(self, source_name: str):
         raise NotImplementedError()
@@ -852,12 +885,30 @@
         # on server side authorization is done in endpoint anyway, so for server side we can "pass" on check
         # done from ingest()
         pass
 
     def watch_log(self, uid, project="", watch=True, offset=0):
         raise NotImplementedError("Watching logs is not supported on the server")
 
+    def get_datastore_profile(
+        self, name: str, project: str
+    ) -> Optional[mlrun.common.schemas.DatastoreProfile]:
+        raise NotImplementedError()
+
+    def delete_datastore_profile(self, name: str, project: str):
+        raise NotImplementedError()
+
+    def list_datastore_profile(
+        self, project: str
+    ) -> List[mlrun.common.schemas.DatastoreProfile]:
+        raise NotImplementedError()
+
+    def store_datastore_profile(
+        self, profile: mlrun.common.schemas.DatastoreProfile, project: str
+    ):
+        raise NotImplementedError()
+
 
 # Once this file is imported it will override the default RunDB implementation (RunDBContainer)
 @containers.override(mlrun.db.factory.RunDBContainer)
 class SQLRunDBContainer(containers.DeclarativeContainer):
     run_db = providers.Factory(SQLRunDB)
```

## mlrun/api/runtime_handlers/__init__.py

```diff
@@ -9,48 +9,48 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 from mlrun.api.runtime_handlers.base import BaseRuntimeHandler
-from mlrun.api.runtime_handlers.daskjob import DaskRuntimeHandler
-from mlrun.api.runtime_handlers.kubejob import KubeRuntimeHandler
+from mlrun.api.runtime_handlers.daskjob import DaskRuntimeHandler, get_dask_resource
+from mlrun.api.runtime_handlers.kubejob import (
+    DatabricksRuntimeHandler,
+    KubeRuntimeHandler,
+)
 from mlrun.api.runtime_handlers.mpijob import (
-    MpiV1Alpha1RuntimeHandler,
-    MpiV1RuntimeHandler,
+    MpiRuntimeHandlerContainer,
+    resolve_mpijob_crd_version,
 )
 from mlrun.api.runtime_handlers.remotesparkjob import RemoteSparkRuntimeHandler
 from mlrun.api.runtime_handlers.sparkjob import SparkRuntimeHandler
-from mlrun.runtimes import MPIJobCRDVersions, RuntimeKinds, resolve_mpijob_crd_version
+from mlrun.runtimes import RuntimeKinds
 
 runtime_handler_instances_cache = {}
+runtime_resources_map = {RuntimeKinds.dask: get_dask_resource()}
 
 
 def get_runtime_handler(kind: str) -> BaseRuntimeHandler:
     global runtime_handler_instances_cache
     if kind == RuntimeKinds.mpijob:
-        # TODO: split resolve_mpijob_crd_version to client and server side
         mpijob_crd_version = resolve_mpijob_crd_version()
-        crd_version_to_runtime_handler_class = {
-            MPIJobCRDVersions.v1alpha1: MpiV1Alpha1RuntimeHandler,
-            MPIJobCRDVersions.v1: MpiV1RuntimeHandler,
-        }
-        runtime_handler_class = crd_version_to_runtime_handler_class[mpijob_crd_version]
+        runtime_handler_class = MpiRuntimeHandlerContainer.handler_selector()
         if not runtime_handler_instances_cache.setdefault(RuntimeKinds.mpijob, {}).get(
             mpijob_crd_version
         ):
             runtime_handler_instances_cache[RuntimeKinds.mpijob][
                 mpijob_crd_version
             ] = runtime_handler_class()
         return runtime_handler_instances_cache[RuntimeKinds.mpijob][mpijob_crd_version]
 
     kind_runtime_handler_map = {
         RuntimeKinds.dask: DaskRuntimeHandler,
         RuntimeKinds.spark: SparkRuntimeHandler,
         RuntimeKinds.remotespark: RemoteSparkRuntimeHandler,
         RuntimeKinds.job: KubeRuntimeHandler,
+        RuntimeKinds.databricks: DatabricksRuntimeHandler,
     }
     runtime_handler_class = kind_runtime_handler_map[kind]
     if not runtime_handler_instances_cache.get(kind):
         runtime_handler_instances_cache[kind] = runtime_handler_class()
     return runtime_handler_instances_cache[kind]
```

## mlrun/api/runtime_handlers/daskjob.py

```diff
@@ -14,27 +14,38 @@
 #
 import typing
 from typing import Dict, List, Optional, Union
 
 from kubernetes.client.rest import ApiException
 from sqlalchemy.orm import Session
 
+import mlrun.api.utils.singletons.k8s
 import mlrun.common.schemas
 import mlrun.errors
 import mlrun.k8s_utils
+import mlrun.runtimes
+import mlrun.runtimes.pod
 import mlrun.utils
 import mlrun.utils.regex
 from mlrun.api.db.base import DBInterface
 from mlrun.api.runtime_handlers.base import BaseRuntimeHandler
 from mlrun.config import config
 from mlrun.runtimes.base import RuntimeClassMode
-from mlrun.runtimes.utils import get_k8s
+from mlrun.runtimes.utils import get_k8s, get_resource_labels
 from mlrun.utils import logger
 
 
+def get_dask_resource():
+    return {
+        "scope": "function",
+        "start": deploy_function,
+        "status": get_obj_status,
+    }
+
+
 class DaskRuntimeHandler(BaseRuntimeHandler):
     kind = "dask"
     class_modes = {RuntimeClassMode.run: "dask"}
 
     # Dask runtime resources are per function (and not per run).
     # It means that monitoring runtime resources state doesn't say anything about the run state.
     # Therefore dask run monitoring is done completely by the SDK, so overriding the monitoring method with no logic
@@ -203,7 +214,190 @@
                         service.metadata.name, namespace
                     )
                     logger.info(f"Deleted service: {service.metadata.name}")
             except ApiException as exc:
                 # ignore error if service is already removed
                 if exc.status != 404:
                     raise
+
+
+def deploy_function(
+    function: mlrun.runtimes.DaskCluster,
+    secrets=None,
+    client_version: str = None,
+    client_python_version: str = None,
+):
+    _validate_dask_related_libraries_installed()
+
+    scheduler_pod, worker_pod, function, namespace = enrich_dask_cluster(
+        function, secrets, client_version, client_python_version
+    )
+    return initialize_dask_cluster(scheduler_pod, worker_pod, function, namespace)
+
+
+def initialize_dask_cluster(scheduler_pod, worker_pod, function, namespace):
+    import dask
+    import dask_kubernetes
+
+    spec, meta = function.spec, function.metadata
+
+    svc_temp = dask.config.get("kubernetes.scheduler-service-template")
+    if spec.service_type or spec.node_port:
+        if spec.node_port:
+            spec.service_type = "NodePort"
+            svc_temp["spec"]["ports"][1]["nodePort"] = spec.node_port
+        mlrun.utils.update_in(svc_temp, "spec.type", spec.service_type)
+
+    norm_name = mlrun.utils.normalize_name(meta.name)
+    dask.config.set(
+        {
+            "kubernetes.scheduler-service-template": svc_temp,
+            "kubernetes.name": "mlrun-" + norm_name + "-{uuid}",
+        }
+    )
+
+    cluster = dask_kubernetes.KubeCluster(
+        worker_pod,
+        scheduler_pod_template=scheduler_pod,
+        deploy_mode="remote",
+        namespace=namespace,
+        idle_timeout=spec.scheduler_timeout,
+    )
+
+    logger.info(f"cluster {cluster.name} started at {cluster.scheduler_address}")
+
+    function.status.scheduler_address = cluster.scheduler_address
+    function.status.cluster_name = cluster.name
+    if spec.service_type == "NodePort":
+        ports = cluster.scheduler.service.spec.ports
+        function.status.node_ports = {
+            "scheduler": ports[0].node_port,
+            "dashboard": ports[1].node_port,
+        }
+
+    if spec.replicas:
+        cluster.scale(spec.replicas)
+    else:
+        cluster.adapt(minimum=spec.min_replicas, maximum=spec.max_replicas)
+
+    return cluster
+
+
+def enrich_dask_cluster(
+    function, secrets, client_version: str = None, client_python_version: str = None
+):
+    from dask.distributed import Client, default_client  # noqa: F401
+    from dask_kubernetes import KubeCluster, make_pod_spec  # noqa: F401
+    from kubernetes import client
+
+    # Is it possible that the function will not have a project at this point?
+    if function.metadata.project:
+        function._add_secrets_to_spec_before_running(project=function.metadata.project)
+
+    spec = function.spec
+    meta = function.metadata
+    spec.remote = True
+
+    image = (
+        function.full_image_path(
+            client_version=client_version, client_python_version=client_python_version
+        )
+        # TODO: we might never enter here, since running a function requires defining an image
+        or "daskdev/dask:latest"
+    )
+    env = spec.env
+    namespace = meta.namespace or config.namespace
+    if spec.extra_pip:
+        env.append(spec.extra_pip)
+
+    pod_labels = get_resource_labels(function, scrape_metrics=config.scrape_metrics)
+    # TODO: 'dask-worker' is deprecated, new dask CLI was introduced in 2022.10.0.
+    #  Upgrade when we drop python 3.7 support and use 'dask worker' instead
+    worker_args = ["dask-worker", "--nthreads", str(spec.nthreads)]
+    memory_limit = spec.worker_resources.get("limits", {}).get("memory")
+    if memory_limit:
+        worker_args.extend(["--memory-limit", str(memory_limit)])
+    if spec.args:
+        worker_args.extend(spec.args)
+    # TODO: 'dask-scheduler' is deprecated, new dask CLI was introduced in 2022.10.0.
+    #  Upgrade when we drop python 3.7 support and use 'dask scheduler' instead
+    scheduler_args = ["dask-scheduler"]
+
+    container_kwargs = {
+        "name": "base",
+        "image": image,
+        "env": env,
+        "image_pull_policy": spec.image_pull_policy,
+        "volume_mounts": spec.volume_mounts,
+    }
+    scheduler_container = client.V1Container(
+        resources=spec.scheduler_resources, args=scheduler_args, **container_kwargs
+    )
+    worker_container = client.V1Container(
+        resources=spec.worker_resources, args=worker_args, **container_kwargs
+    )
+
+    scheduler_pod_spec = mlrun.runtimes.pod.kube_resource_spec_to_pod_spec(
+        spec, scheduler_container
+    )
+    worker_pod_spec = mlrun.runtimes.pod.kube_resource_spec_to_pod_spec(
+        spec, worker_container
+    )
+    for pod_spec in [scheduler_pod_spec, worker_pod_spec]:
+        if spec.image_pull_secret:
+            pod_spec.image_pull_secrets = [
+                client.V1LocalObjectReference(name=spec.image_pull_secret)
+            ]
+
+    scheduler_pod = client.V1Pod(
+        metadata=client.V1ObjectMeta(namespace=namespace, labels=pod_labels),
+        # annotations=meta.annotation),
+        spec=scheduler_pod_spec,
+    )
+    worker_pod = client.V1Pod(
+        metadata=client.V1ObjectMeta(namespace=namespace, labels=pod_labels),
+        # annotations=meta.annotation),
+        spec=worker_pod_spec,
+    )
+    return scheduler_pod, worker_pod, function, namespace
+
+
+def _validate_dask_related_libraries_installed():
+    try:
+        import dask  # noqa: F401
+        from dask.distributed import Client, default_client  # noqa: F401
+        from dask_kubernetes import KubeCluster, make_pod_spec  # noqa: F401
+        from kubernetes import client  # noqa: F401
+    except ImportError as exc:
+        print(
+            "missing dask or dask_kubernetes, please run "
+            '"pip install dask distributed dask_kubernetes", %s',
+            exc,
+        )
+        raise exc
+
+
+def get_obj_status(selector=None, namespace=None):
+    if selector is None:
+        selector = []
+
+    k8s = mlrun.api.utils.singletons.k8s.get_k8s_helper()
+    namespace = namespace or config.namespace
+    selector = ",".join(["dask.org/component=scheduler"] + selector)
+    pods = k8s.list_pods(namespace, selector=selector)
+    status = ""
+    for pod in pods:
+        status = pod.status.phase.lower()
+        if status == "running":
+            cluster = pod.metadata.labels.get("dask.org/cluster-name")
+            logger.info(
+                "Found running dask function",
+                pod_name=pod.metadata.name,
+                cluster=cluster,
+            )
+            return status
+        logger.info(
+            "Found dask function in non ready state",
+            pod_name=pod.metadata.name,
+            status=status,
+        )
+    return status
```

## mlrun/api/runtime_handlers/kubejob.py

```diff
@@ -31,7 +31,12 @@
     @staticmethod
     def _are_resources_coupled_to_run_object() -> bool:
         return True
 
     @staticmethod
     def _get_object_label_selector(object_id: str) -> str:
         return f"mlrun/uid={object_id}"
+
+
+class DatabricksRuntimeHandler(KubeRuntimeHandler):
+    kind = "databricks"
+    class_modes = {RuntimeClassMode.run: "databricks"}
```

## mlrun/api/runtime_handlers/mpijob.py

```diff
@@ -11,20 +11,24 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import typing
 from datetime import datetime
 
+from dependency_injector import containers, providers
 from sqlalchemy.orm import Session
 
+import mlrun.api.utils.singletons.k8s
+import mlrun.k8s_utils
 from mlrun.api.db.base import DBInterface
 from mlrun.api.runtime_handlers import BaseRuntimeHandler
+from mlrun.config import config
 from mlrun.runtimes.base import RuntimeClassMode
-from mlrun.runtimes.constants import MPIJobV1Alpha1States, RunStates
+from mlrun.runtimes.constants import MPIJobCRDVersions, MPIJobV1Alpha1States, RunStates
 from mlrun.runtimes.mpijob import MpiRuntimeV1, MpiRuntimeV1Alpha1
 
 
 class MpiV1Alpha1RuntimeHandler(BaseRuntimeHandler):
     kind = "mpijob"
     class_modes = {
         RuntimeClassMode.run: "mpijob",
@@ -141,7 +145,72 @@
     @staticmethod
     def _get_crd_info() -> typing.Tuple[str, str, str]:
         return (
             MpiRuntimeV1.crd_group,
             MpiRuntimeV1.crd_version,
             MpiRuntimeV1.crd_plural,
         )
+
+
+cached_mpijob_crd_version = None
+
+
+def resolve_mpijob_crd_version():
+    """
+    Resolve mpijob runtime according to the mpi-operator's supported crd-version.
+    If specified on mlrun config set it likewise.
+    If not specified, try resolving it according to the mpi-operator, otherwise set to default.
+    Since this is a heavy operation (sending requests to k8s/API), and it's unlikely that the crd version
+    will change in any context - cache it.
+    :return: mpi operator's crd-version
+    """
+    global cached_mpijob_crd_version
+    if not cached_mpijob_crd_version:
+        # try to resolve the crd version with K8s API
+        # backoff to use default if needed
+        mpijob_crd_version = (
+            _resolve_mpijob_crd_version_best_effort() or MPIJobCRDVersions.default()
+        )
+
+        if mpijob_crd_version not in MPIJobCRDVersions.all():
+            raise ValueError(
+                f"Unsupported mpijob crd version: {mpijob_crd_version}. "
+                f"Supported versions: {MPIJobCRDVersions.all()}"
+            )
+        cached_mpijob_crd_version = mpijob_crd_version
+
+    return cached_mpijob_crd_version
+
+
+def _resolve_mpijob_crd_version_best_effort():
+    # config overrides everything
+    if config.mpijob_crd_version:
+        return config.mpijob_crd_version
+
+    if not mlrun.k8s_utils.is_running_inside_kubernetes_cluster():
+        return None
+
+    k8s_helper = mlrun.api.utils.singletons.k8s.get_k8s_helper()
+    namespace = k8s_helper.resolve_namespace()
+
+    # try resolving according to mpi-operator that's running
+    res = k8s_helper.list_pods(namespace=namespace, selector="component=mpi-operator")
+
+    if len(res) == 0:
+        return None
+
+    mpi_operator_pod = res[0]
+    return mpi_operator_pod.metadata.labels.get("crd-version")
+
+
+# overrides the way we resolve the mpijob crd version by querying the k8s API
+@containers.override(mlrun.runtimes.mpijob.MpiRuntimeContainer)
+class MpiRuntimeHandlerContainer(containers.DeclarativeContainer):
+    resolver = providers.Callable(
+        resolve_mpijob_crd_version,
+    )
+
+    handler_selector = providers.Selector(
+        resolver,
+        v1=providers.Object(MpiV1RuntimeHandler),
+        v1alpha1=providers.Object(MpiV1Alpha1RuntimeHandler),
+    )
```

## mlrun/api/utils/builder.py

```diff
@@ -11,16 +11,18 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 import os.path
 import pathlib
 import re
 import tempfile
+import textwrap
 import typing
 from base64 import b64decode, b64encode
+from collections import defaultdict
 from os import path
 from urllib.parse import urlparse
 
 from kubernetes import client
 
 import mlrun.api.utils.singletons.k8s
 import mlrun.common.constants
@@ -37,38 +39,89 @@
     commands: list = None,
     source: str = None,
     requirements_path: str = None,
     workdir: str = "/mlrun",
     extra: str = "",
     user_unix_id: int = None,
     enriched_group_id: int = None,
+    builder_env: typing.List[client.V1EnvVar] = None,
+    extra_args: str = "",
 ):
+    """
+    Generates the content of a Dockerfile for building a container image.
+
+    :param base_image: The base image for the Dockerfile.
+    :param commands: A list of shell commands to be included in the Dockerfile as RUN instructions.
+    :param source: The path to the source code directory to be included in the Docker image.
+    :param requirements_path: The path to the requirements file (e.g., requirements.txt) containing
+                              the Python dependencies to be installed in the Docker image.
+    :param workdir: The working directory inside the container where commands will be executed.
+                    Default is "/mlrun".
+    :param extra: Additional content to be appended to the generated Dockerfile.
+    :param user_unix_id: The Unix user ID to be used in the Docker image for running processes.
+                         This is useful for matching the user ID with the host environment
+                         to avoid permission issues.
+    :param enriched_group_id: The group ID to be used in the Docker image for running processes.
+    :param builder_env: A list of Kubernetes V1EnvVar objects representing environment variables
+                        to be set during the build process.
+    :param extra_args:  A string containing additional builder arguments in the format of command-line options,
+            e.g. extra_args="--skip-tls-verify --build-arg A=val"
+
+    :return: The content of the Dockerfile as a string.
+    """
     dock = f"FROM {base_image}\n"
 
+    builder_env = builder_env or []
+    extra_args = _parse_extra_args_for_dockerfile(extra_args)
+
+    # combine a list of all args (including builder_env, project_secrets and extra_args)
+    # to add in each of the Dockerfile stages.
+    all_args = [f"{env.name}_ARG" for env in builder_env] + [
+        f"{arg}_ARG" for arg in extra_args
+    ]
+    args = ""
+
+    for arg in all_args:
+        args += f"ARG {arg}\n"
+    dock += args
+
+    envs = ""
+    for env in builder_env:
+        envs += f"ENV {env.name}=${env.name}_ARG\n"
+
+    for env in extra_args:
+        envs += f"ENV {env}=${env}_ARG\n"
+    dock += envs
+
     if config.is_pip_ca_configured():
         dock += f"COPY ./{pathlib.Path(config.httpdb.builder.pip_ca_path).name} {config.httpdb.builder.pip_ca_path}\n"
         dock += f"ARG PIP_CERT={config.httpdb.builder.pip_ca_path}\n"
 
     build_args = config.get_build_args()
     for build_arg_key, build_arg_value in build_args.items():
         dock += f"ARG {build_arg_key}={build_arg_value}\n"
 
     if source:
+        args = args.rstrip("\n")
+        envs = envs.rstrip("\n")
         dock += f"WORKDIR {workdir}\n"
         # 'ADD' command does not extract zip files - add extraction stage to the dockerfile
         if source.endswith(".zip"):
             source_dir = os.path.join(workdir, "source")
-            stage1 = f"""
-            FROM {base_image} AS extractor
-            RUN apt-get update -qqy && apt install --assume-yes unzip
-            RUN mkdir -p {source_dir}
-            COPY {source} {source_dir}
-            RUN cd {source_dir} && unzip {source} && rm {source}
-            """
-            dock = stage1 + "\n" + dock
+            stage_lines = [
+                f"FROM {base_image} AS extractor",
+                args,
+                envs,
+                "RUN apt-get update -qqy && apt install --assume-yes unzip",
+                f"RUN mkdir -p {source_dir}",
+                f"COPY {source} {source_dir}",
+                f"RUN cd {source_dir} && unzip {source} && rm {source}",
+            ]
+            stage = textwrap.dedent("\n".join(stage_lines)).strip()
+            dock = stage + "\n" + dock
 
             dock += f"COPY --from=extractor {source_dir}/ {workdir}\n"
         else:
             dock += f"ADD {source} {workdir}\n"
 
         if user_unix_id is not None and enriched_group_id is not None:
             dock += f"RUN chown -R {user_unix_id}:{enriched_group_id} {workdir}\n"
@@ -80,14 +133,15 @@
         dock += (
             f"RUN echo 'Installing {requirements_path}...'; cat {requirements_path}\n"
         )
         dock += f"RUN python -m pip install -r {requirements_path}\n"
     if extra:
         dock += extra
     mlrun.utils.logger.debug("Resolved dockerfile", dockfile_contents=dock)
+
     return dock
 
 
 def make_kaniko_pod(
     project: str,
     context,
     dest,
@@ -99,14 +153,15 @@
     requirements_path=None,
     secret_name=None,
     name="",
     verbose=False,
     builder_env=None,
     runtime_spec=None,
     registry=None,
+    extra_args="",
 ):
     extra_runtime_spec = {}
     if not registry:
 
         # if registry was not given, infer it from the image destination
         registry = dest.partition("/")[0]
 
@@ -153,26 +208,29 @@
         if value == "disabled":
             continue
         if value == "enabled" or (value == "auto" and not secret_name):
             args.append(flag)
     if verbose:
         args += ["--verbosity", "debug"]
 
+    args = _add_kaniko_args_with_all_build_args(args, builder_env, extra_args)
+
     # While requests mainly affect scheduling, setting a limit may prevent Kaniko
     # from finishing successfully (destructive), since we're not allowing to override the default
     # specifically for the Kaniko pod, we're setting only the requests
     # we cannot specify gpu requests without specifying gpu limits, so we set requests without gpu field
     default_requests = config.get_default_function_pod_requirement_resources(
         "requests", with_gpu=False
     )
     resources = {
         "requests": mlrun.runtimes.utils.generate_resources(
             mem=default_requests.get("memory"), cpu=default_requests.get("cpu")
         )
     }
+
     kpod = mlrun.api.utils.singletons.k8s.BasePod(
         name or "mlrun-build",
         config.httpdb.builder.kaniko_image,
         args=args,
         kind="build",
         project=project,
         default_pod_spec_attributes=extra_runtime_spec,
@@ -328,17 +386,26 @@
     interactive=True,
     name="",
     extra=None,
     verbose=False,
     builder_env=None,
     client_version=None,
     runtime=None,
+    extra_args=None,
 ):
     runtime_spec = runtime.spec if runtime else None
+    runtime_builder_env = runtime_spec.build.builder_env or {}
+
+    extra_args = extra_args or {}
     builder_env = builder_env or {}
+
+    builder_env = runtime_builder_env | builder_env or {}
+    # no need to enrich extra args because we get them from the build anyway
+    _validate_extra_args(extra_args)
+
     image_target, secret_name = resolve_image_target_and_registry_secret(
         image_target, registry, secret_name
     )
 
     commands, requirements_list, requirements_path = _resolve_build_requirements(
         requirements, commands, with_mlrun, mlrun_version_specifier, client_version
     )
@@ -429,14 +496,16 @@
         commands,
         source=source_to_copy,
         requirements_path=requirements_path,
         extra=extra,
         user_unix_id=user_unix_id,
         enriched_group_id=enriched_group_id,
         workdir=runtime.spec.clone_target_dir,
+        builder_env=builder_env,
+        extra_args=extra_args,
     )
 
     kpod = make_kaniko_pod(
         project,
         context,
         image_target,
         dockertext=dock,
@@ -446,14 +515,15 @@
         requirements_path=requirements_path,
         secret_name=secret_name,
         name=name,
         verbose=verbose,
         builder_env=builder_env,
         runtime_spec=runtime_spec,
         registry=registry,
+        extra_args=extra_args,
     )
 
     if to_mount:
         kpod.mount_v3io(
             remote=source_dir_to_mount,
             mount_path="/context",
             access_key=access_key,
@@ -616,14 +686,15 @@
         source=build.source,
         secret_name=build.secret,
         interactive=interactive,
         name=name,
         with_mlrun=with_mlrun,
         mlrun_version_specifier=mlrun_version_specifier,
         extra=build.extra,
+        extra_args=build.extra_args,
         verbose=runtime.verbose,
         builder_env=builder_env,
         client_version=client_version,
         runtime=runtime,
     )
     runtime.status.build_pod = None
     if status == "skipped":
@@ -683,15 +754,17 @@
         return "/".join(image_target_components), secret_name
 
     image_target = remove_image_protocol_prefix(image_target)
 
     return image_target, secret_name
 
 
-def _generate_builder_env(project, builder_env):
+def _generate_builder_env(
+    project: str, builder_env: typing.Dict
+) -> typing.List[client.V1EnvVar]:
     k8s = mlrun.api.utils.singletons.k8s.get_k8s_helper(silent=False)
     secret_name = k8s.get_project_secret_name(project)
     existing_secret_keys = k8s.get_project_secret_keys(project, filter_internal=True)
 
     # generate env list from builder env and project secrets
     env = []
     for key in existing_secret_keys:
@@ -701,14 +774,52 @@
             )
             env.append(client.V1EnvVar(name=key, value_from=value_from))
     for key, value in builder_env.items():
         env.append(client.V1EnvVar(name=key, value=value))
     return env
 
 
+def _add_kaniko_args_with_all_build_args(args, builder_env, extra_args):
+
+    builder_env = builder_env or []
+
+    for env in builder_env:
+        args.extend(["--build-arg", f"{env.name}_ARG={env.value}"])
+
+    # add extra_args to args
+    args = _validate_and_merge_args_with_extra_args(args, extra_args)
+
+    return args
+
+
+def _parse_extra_args_for_dockerfile(extra_args: str) -> dict:
+    if not extra_args:
+        return {}
+
+    build_arg_values = {}
+    is_build_arg = False
+
+    for arg in extra_args.split():
+        if arg == "--build-arg":
+            is_build_arg = True
+        elif arg.startswith("--"):
+            is_build_arg = False
+        elif is_build_arg:
+            # Ensure 'arg' is in a valid format: starts with a letter or underscore,
+            # followed by alphanumerics and an equal sign
+            if not re.match(r"^[A-Za-z_][A-Za-z0-9_]*=[^=]+$", arg):
+                raise ValueError(f"Invalid --build-arg value: {arg}")
+            key, val = arg.split("=")
+            build_arg_values[key] = val
+        else:
+            is_build_arg = False
+
+    return build_arg_values
+
+
 def _resolve_build_requirements(
     requirements: typing.Union[typing.List, str],
     commands: typing.List,
     with_mlrun: bool,
     mlrun_version_specifier: typing.Optional[str],
     client_version: typing.Optional[str],
 ):
@@ -739,7 +850,130 @@
             requirements_list.insert(0, mlrun_version)
 
     if not requirements_list:
         # no requirements, we don't need a requirements file
         requirements_path = ""
 
     return commands, requirements_list, requirements_path
+
+
+def _parse_extra_args(extra_args: str) -> dict:
+    """
+    Parses a string of extra arguments into a dictionary format.
+
+    :param extra_args:  A string containing additional builder arguments in the format of command-line options,
+            e.g. extra_args="--skip-tls-verify --build-arg A=val"
+
+    :return: A dictionary where each key corresponds to an option flag (e.g., "--option_name"),
+             and the associated value is a list of values provided for that option.
+
+    :example:
+    >>> extra_args = "--option1 value1 --option2 value3 --option3 --option1 value2"
+    >>> parsed_args = _parse_extra_args(extra_args)
+    >>> print(parsed_args)
+    {
+        '--option1': ['value1', 'value2'],
+        '--option2': ['value3'],
+        '--option3': []
+    }
+    """
+    if not extra_args:
+        return {}
+    extra_args = extra_args.split()
+    args = defaultdict(list)
+
+    current_flag = None
+    for arg in extra_args:
+        if arg.startswith("--"):
+            current_flag = arg
+            # explicitly set the key in the dictionary
+            args.setdefault(current_flag, [])
+        elif current_flag:
+            args[current_flag].append(arg)
+
+        # sanity, args should be validated by now
+        else:
+            raise ValueError(
+                "Invalid argument sequence. Value must be followed by a flag preceding it."
+            )
+    return args
+
+
+def _validate_extra_args(extra_args: str):
+    """
+     Validate extra_args string for Docker commands:
+    - Ensure --build-arg is followed by a non-flag argument.
+    - Validate all --build-arg values are in a valid format of 'KEY=VALUE' using allowed characters only.
+
+    :raises ValueError: If the extra_args sequence is invalid or contains incorrectly formatted '--build-arg' values.
+    """
+    if not extra_args:
+        return
+
+    if not extra_args.startswith("--"):
+        raise ValueError(
+            "Invalid argument sequence. Value must be followed by a flag preceding it."
+        )
+    args = _parse_extra_args(extra_args)
+    for arg, values in args.items():
+        if arg == "--build-arg":
+            if not values:
+                raise ValueError(
+                    "Invalid '--build-arg' usage. It must be followed by a non-flag argument."
+                )
+            invalid_build_arg_values = [
+                val
+                for val in values
+                if not re.match(r"^[a-zA-Z0-9_]+=[a-zA-Z0-9_]+$", val)
+            ]
+            if invalid_build_arg_values:
+                raise ValueError(
+                    f"Invalid arguments format: '{','.join(invalid_build_arg_values)}'."
+                    " Please make sure all arguments are in a valid format"
+                )
+
+
+def _validate_and_merge_args_with_extra_args(args: list, extra_args: str) -> list:
+    """
+    Validate and merge the given args and extra_args for Kaniko pod.
+
+    :return: A merged list of strings containing the command-line arguments
+             from 'args' and 'extra_args' in args format.
+
+    :raises ValueError: If an arg in 'extra_args' is duplicated with different values then in the 'args'.
+    """
+    if not extra_args:
+        return args
+    extra_args = _parse_extra_args(extra_args)
+    # Create a set to store the keys from the --build-arg flags in args
+    build_arg_keys = {
+        key: value
+        for arg in args
+        if arg == "--build-arg"
+        for key, value in [args[args.index(arg) + 1].split("=")]
+    }
+
+    # Create a new list to store the merged args and extra_args
+    merged_args = args[:]
+
+    # Iterate through extra_args and add flags and their values to the merged_args list
+    for flag, values in extra_args.items():
+        if flag == "--build-arg":
+            for value in values:
+                key, val = value.split("=")
+                key = f"{key}_ARG"
+                if key not in build_arg_keys:
+                    merged_args.extend([flag, f"{key}={val}"])
+                    build_arg_keys[key] = val
+                else:
+                    if build_arg_keys[key] != val:
+                        raise ValueError(
+                            f"Duplicate --build-arg '{key}' with different values"
+                        )
+        elif flag not in args:
+            if not values:
+                merged_args.append(flag)
+            else:
+                for val in values:
+                    merged_args.extend([flag, val])
+
+    return merged_args
```

## mlrun/api/utils/scheduler.py

```diff
@@ -24,17 +24,19 @@
 import humanfriendly
 from apscheduler.jobstores.base import JobLookupError
 from apscheduler.schedulers.asyncio import AsyncIOScheduler
 from apscheduler.triggers.cron import CronTrigger as APSchedulerCronTrigger
 from sqlalchemy.orm import Session
 
 import mlrun.api.api.utils
+import mlrun.api.crud
 import mlrun.api.utils.auth.verifier
 import mlrun.api.utils.clients.iguazio
 import mlrun.api.utils.helpers
+import mlrun.api.utils.singletons.project_member
 import mlrun.common.schemas
 import mlrun.errors
 from mlrun.api.db.session import close_session, create_session
 from mlrun.api.utils.singletons.db import get_db
 from mlrun.config import config
 from mlrun.errors import err_to_str
 from mlrun.model import RunObject
@@ -110,16 +112,14 @@
         name: str,
         kind: mlrun.common.schemas.ScheduleKinds,
         scheduled_object: Union[Dict, Callable],
         cron_trigger: Union[str, mlrun.common.schemas.ScheduleCronTrigger],
         labels: Dict = None,
         concurrency_limit: int = None,
     ):
-        if concurrency_limit is None:
-            concurrency_limit = config.httpdb.scheduling.default_concurrency_limit
         if isinstance(cron_trigger, str):
             cron_trigger = mlrun.common.schemas.ScheduleCronTrigger.from_crontab(
                 cron_trigger
             )
 
         self._validate_cron_trigger(cron_trigger)
 
@@ -137,31 +137,31 @@
         secret_name = self._store_schedule_secrets_using_auth_secret(auth_info)
         # We use the schedule labels to keep track of the access-key to use. Note that this is the name of the secret,
         # not the secret value itself. Therefore, it can be kept in a non-secure field.
         labels = self._append_access_key_secret_to_labels(labels, secret_name)
 
         self._enrich_schedule_notifications(project, name, scheduled_object)
 
-        get_db().create_schedule(
+        db_schedule = get_db().create_schedule(
             session=db_session,
             project=project,
             name=name,
             kind=kind,
             scheduled_object=scheduled_object,
             cron_trigger=cron_trigger,
             concurrency_limit=concurrency_limit,
             labels=labels,
         )
         job = self._create_schedule_in_scheduler(
-            project,
-            name,
-            kind,
-            scheduled_object,
-            cron_trigger,
-            concurrency_limit,
+            db_schedule.project,
+            db_schedule.name,
+            db_schedule.kind,
+            db_schedule.scheduled_object,
+            db_schedule.cron_trigger,
+            db_schedule.concurrency_limit,
             auth_info,
         )
         self.update_schedule_next_run_time(db_session, name, project, job)
 
     def update_schedule_next_run_time(
         self, db_session, schedule_name, project_name, job=None
     ):
@@ -306,19 +306,19 @@
     @mlrun.api.utils.helpers.ensure_running_on_chief
     def store_schedule(
         self,
         db_session: Session,
         auth_info: mlrun.common.schemas.AuthInfo,
         project: str,
         name: str,
+        kind: mlrun.common.schemas.ScheduleKinds = None,
         scheduled_object: Union[Dict, Callable] = None,
         cron_trigger: Union[str, mlrun.common.schemas.ScheduleCronTrigger] = None,
         labels: Dict = None,
         concurrency_limit: int = None,
-        kind: mlrun.common.schemas.ScheduleKinds = None,
     ):
         if isinstance(cron_trigger, str):
             cron_trigger = mlrun.common.schemas.ScheduleCronTrigger.from_crontab(
                 cron_trigger
             )
 
         if cron_trigger is not None:
@@ -345,50 +345,54 @@
             kind = db_schedule.kind
 
         self._ensure_auth_info_has_access_key(auth_info, kind)
         secret_name = self._store_schedule_secrets_using_auth_secret(auth_info)
         labels = self._append_access_key_secret_to_labels(labels, secret_name)
         self._enrich_schedule_notifications(project, name, scheduled_object)
 
-        db_schedule = get_db().store_schedule(
+        db_schedule, is_update = get_db().store_schedule(
             session=db_session,
             project=project,
             name=name,
             kind=kind,
             scheduled_object=scheduled_object,
             cron_trigger=cron_trigger,
             labels=labels,
             concurrency_limit=concurrency_limit,
         )
-        if db_schedule:
+
+        # we differentiate between update and create because it changes our communication with the scheduler
+        if is_update:
             updated_schedule = self._transform_and_enrich_db_schedule(
                 db_session, db_schedule
             )
 
             job = self._update_schedule_in_scheduler(
                 project,
                 name,
                 updated_schedule.kind,
                 updated_schedule.scheduled_object,
                 updated_schedule.cron_trigger,
                 updated_schedule.concurrency_limit,
                 auth_info,
             )
+
         else:
             job = self._create_schedule_in_scheduler(
-                project,
-                name,
-                kind,
-                scheduled_object,
-                cron_trigger,
-                concurrency_limit,
+                db_schedule.project,
+                db_schedule.name,
+                db_schedule.kind,
+                db_schedule.scheduled_object,
+                db_schedule.cron_trigger,
+                db_schedule.concurrency_limit,
                 auth_info,
             )
 
         self.update_schedule_next_run_time(db_session, name, project, job)
+        return is_update
 
     def _remove_schedule_scheduler_resources(self, db_session: Session, project, name):
         self._remove_schedule_from_scheduler(project, name)
         # This is kept for backwards compatibility - if schedule was using the "old" format of storing secrets, then
         # this is a good opportunity to remove them. Using the new method we don't remove secrets since they are per
         # access-key and there may be other entities (runtimes, for example) using the same secret.
         self._remove_schedule_secrets(project, name)
@@ -457,16 +461,14 @@
         self.update_schedule(session, auth_info, project, name, scheduled_object)
 
     def _ensure_auth_info_has_access_key(
         self,
         auth_info: mlrun.common.schemas.AuthInfo,
         kind: mlrun.common.schemas.ScheduleKinds,
     ):
-        import mlrun.api.crud
-
         if (
             kind not in mlrun.common.schemas.ScheduleKinds.local_kinds()
             and mlrun.api.utils.auth.verifier.AuthVerifier().is_jobs_auth_required()
         ):
             if (
                 not auth_info.access_key
                 or auth_info.access_key == mlrun.model.Credentials.generate_access_key
@@ -492,17 +494,14 @@
                 auth_info.access_key = secret.access_key
                 auth_info.username = secret.username
 
     def _store_schedule_secrets_using_auth_secret(
         self,
         auth_info: mlrun.common.schemas.AuthInfo,
     ) -> str:
-        # import here to avoid circular imports
-        import mlrun.api.crud
-
         if mlrun.api.utils.auth.verifier.AuthVerifier().is_jobs_auth_required():
             # sanity
             if not auth_info.access_key:
                 raise mlrun.errors.MLRunAccessDeniedError(
                     "Access key is required to create schedules in OPA authorization mode"
                 )
 
@@ -523,17 +522,14 @@
     #       are sure we are far enough that it's no longer going to be used (or keep, and use for other things).
     def _store_schedule_secrets(
         self,
         auth_info: mlrun.common.schemas.AuthInfo,
         project: str,
         name: str,
     ):
-        # import here to avoid circular imports
-        import mlrun.api.crud
-
         if mlrun.api.utils.auth.verifier.AuthVerifier().is_jobs_auth_required():
             # sanity
             if not auth_info.access_key:
                 raise mlrun.errors.MLRunAccessDeniedError(
                     "Access key is required to create schedules in OPA authorization mode"
                 )
             access_key_secret_key = (
@@ -573,17 +569,14 @@
             )
 
     def _remove_schedule_secrets(
         self,
         project: str,
         name: str,
     ):
-        # import here to avoid circular imports
-        import mlrun.api.crud
-
         if mlrun.api.utils.auth.verifier.AuthVerifier().is_jobs_auth_required():
             access_key_secret_key = (
                 mlrun.api.crud.Secrets().generate_client_project_secret_key(
                     mlrun.api.crud.SecretsClientType.schedules,
                     name,
                     self._secret_access_key_subtype,
                 )
@@ -618,16 +611,14 @@
                 allow_internal_secrets=True,
                 key_map_secret_key=secret_key_map,
             )
 
     def _get_schedule_secrets(
         self, project: str, name: str, include_username: bool = True
     ) -> typing.Tuple[typing.Optional[str], typing.Optional[str]]:
-        # import here to avoid circular imports
-        import mlrun.api.crud
 
         schedule_access_key_secret_key = (
             mlrun.api.crud.Secrets().generate_client_project_secret_key(
                 mlrun.api.crud.SecretsClientType.schedules,
                 name,
                 self._secret_access_key_subtype,
             )
@@ -781,15 +772,14 @@
         job_id: str,
         function: Callable,
         trigger: APSchedulerCronTrigger,
         next_run_time: Optional[datetime] = None,
         *args,
         **kwargs,
     ):
-
         try:
             return self._scheduler.modify_job(
                 job_id,
                 func=function,
                 args=args,
                 kwargs=kwargs,
                 trigger=trigger,
@@ -802,17 +792,14 @@
 
     def _reload_schedules(self, db_session: Session):
         logger.info("Reloading schedules")
         db_schedules = get_db().list_schedules(db_session)
         for db_schedule in db_schedules:
             # don't let one failure fail the rest
             try:
-                # import here to avoid circular imports
-                import mlrun.api.crud
-
                 access_key = None
                 username = None
                 need_to_update_credentials = False
                 if mlrun.api.utils.auth.verifier.AuthVerifier().is_jobs_auth_required():
                     secret_name = self._get_access_key_secret_name_from_db_record(
                         db_schedule
                     )
@@ -1081,19 +1068,14 @@
         scheduler,
         scheduled_object,
         project_name,
         schedule_name,
         schedule_concurrency_limit,
         auth_info,
     ):
-
-        # import here to avoid circular imports
-        import mlrun.api.crud
-        from mlrun.api.api.utils import submit_run_sync
-
         db_session = None
 
         try:
             db_session = create_session()
 
             active_runs = mlrun.api.crud.Runs().list_runs(
                 db_session,
@@ -1117,17 +1099,14 @@
             # if credentials are needed but missing (will happen for schedules on upgrade from scheduler
             # that didn't store credentials to one that does store) enrich them
             # Note that here we're using the "knowledge" that submit_run only requires the access key of the auth info
             if (
                 not auth_info.access_key
                 and mlrun.api.utils.auth.verifier.AuthVerifier().is_jobs_auth_required()
             ):
-                # import here to avoid circular imports
-                import mlrun.api.utils.auth
-                import mlrun.api.utils.singletons.project_member
 
                 logger.info(
                     "Schedule missing auth info which is required. Trying to fill from project owner",
                     project_name=project_name,
                     schedule_name=schedule_name,
                 )
 
@@ -1145,15 +1124,17 @@
                             mlrun.api.utils.clients.iguazio.SessionPlanes.control,
                         ],
                     ),
                     project_name,
                     schedule_name,
                 )
 
-            _, _, _, response = submit_run_sync(db_session, auth_info, scheduled_object)
+            _, _, _, response = mlrun.api.api.utils.submit_run_sync(
+                db_session, auth_info, scheduled_object
+            )
 
             run_metadata = response["data"]["metadata"]
             run_uri = RunObject.create_uri(
                 run_metadata["project"], run_metadata["uid"], run_metadata["iteration"]
             )
             # update every finish of a run the next run time, so it would be accessible for worker instances
             job_id = scheduler._resolve_job_id(run_metadata["project"], schedule_name)
```

## mlrun/api/utils/projects/follower.py

```diff
@@ -297,81 +297,109 @@
         mlrun.api.utils.periodic.cancel_periodic_function(self._sync_projects.__name__)
 
     def _sync_projects(self, full_sync=False):
         """
         :param full_sync: when set to true, in addition to syncing project creation/updates from the leader, we will
         also sync deletions that may occur without updating us the follower
         """
+        db_session = mlrun.api.db.session.create_session()
+
+        try:
+            leader_projects, latest_updated_at = self._list_projects_from_leader()
+            db_projects = mlrun.api.crud.Projects().list_projects(db_session)
+
+            self._store_projects_from_leader(db_session, db_projects, leader_projects)
+
+            if full_sync:
+                self._archive_projects_missing_from_leader(
+                    db_session, db_projects, leader_projects
+                )
+
+            self._update_latest_synced_datetime(latest_updated_at)
+        finally:
+            mlrun.api.db.session.close_session(db_session)
+
+    def _list_projects_from_leader(self):
         try:
             leader_projects, latest_updated_at = self._leader_client.list_projects(
                 self._sync_session, self._synced_until_datetime
             )
         except Exception:
 
             # if we failed to get projects from the leader, we'll try get all the
             # projects without the updated_at filter
             leader_projects, latest_updated_at = self._leader_client.list_projects(
                 self._sync_session
             )
+        return leader_projects, latest_updated_at
 
-        db_session = mlrun.api.db.session.create_session()
-        try:
-            db_projects = mlrun.api.crud.Projects().list_projects(
-                db_session, format_=mlrun.common.schemas.ProjectsFormat.name_only
+    def _store_projects_from_leader(self, db_session, db_projects, leader_projects):
+
+        db_projects_names = [project.metadata.name for project in db_projects.projects]
+
+        # Don't add projects in non-terminal state if they didn't exist before to prevent race conditions
+        filtered_projects = []
+        for leader_project in leader_projects:
+            if (
+                leader_project.status.state
+                not in mlrun.common.schemas.ProjectState.terminal_states()
+                and leader_project.metadata.name not in db_projects_names
+            ):
+                continue
+            filtered_projects.append(leader_project)
+
+        for project in filtered_projects:
+            # if a project was previously archived, it's state will be overriden by the leader
+            # and returned to normal here.
+            mlrun.api.crud.Projects().store_project(
+                db_session, project.metadata.name, project
+            )
+
+    def _archive_projects_missing_from_leader(
+        self, db_session, db_projects, leader_projects
+    ):
+        logger.info("Performing full sync")
+        leader_project_names = [project.metadata.name for project in leader_projects]
+        projects_to_archive = {
+            project.metadata.name: project for project in db_projects.projects
+        }
+        for project_name in leader_project_names:
+            if project_name in projects_to_archive:
+                del projects_to_archive[project_name]
+
+        for project_to_archive in projects_to_archive:
+            logger.info(
+                "Found project in the DB that is not in leader. Archiving...",
+                name=project_to_archive,
             )
-            # Don't add projects in non terminal state if they didn't exist before to prevent race conditions
-            filtered_projects = []
-            for leader_project in leader_projects:
-                if (
-                    leader_project.status.state
-                    not in mlrun.common.schemas.ProjectState.terminal_states()
-                    and leader_project.metadata.name not in db_projects.projects
-                ):
-                    continue
-                filtered_projects.append(leader_project)
-
-            for project in filtered_projects:
-                mlrun.api.crud.Projects().store_project(
-                    db_session, project.metadata.name, project
+            try:
+                projects_to_archive[
+                    project_to_archive
+                ].status.state = mlrun.common.schemas.ProjectState.archived
+                mlrun.api.crud.Projects().patch_project(
+                    db_session,
+                    project_to_archive,
+                    projects_to_archive[project_to_archive].dict(),
                 )
-            if full_sync:
-                logger.info("Performing full sync")
-                leader_project_names = [
-                    project.metadata.name for project in leader_projects
-                ]
-                projects_to_remove = list(
-                    set(db_projects.projects).difference(leader_project_names)
+            except Exception as exc:
+                logger.warning(
+                    "Failed to archive project from DB, continuing...",
+                    name=project_to_archive,
+                    exc=err_to_str(exc),
                 )
-                for project_to_remove in projects_to_remove:
-                    logger.info(
-                        "Found project in the DB that is not in leader. Removing",
-                        name=project_to_remove,
-                    )
-                    try:
-                        mlrun.api.crud.Projects().delete_project(
-                            db_session,
-                            project_to_remove,
-                            mlrun.common.schemas.DeletionStrategy.cascading,
-                        )
-                    except Exception as exc:
-                        logger.warning(
-                            "Failed to delete project from DB, continuing...",
-                            name=project_to_remove,
-                            exc=err_to_str(exc),
-                        )
-            if latest_updated_at:
-
-                # sanity and defensive programming - if the leader returned a latest_updated_at that is older
-                # than the epoch, we'll set it to the epoch
-                epoch = pytz.UTC.localize(datetime.datetime.utcfromtimestamp(0))
-                if latest_updated_at < epoch:
-                    latest_updated_at = epoch
-                self._synced_until_datetime = latest_updated_at
-        finally:
-            mlrun.api.db.session.close_session(db_session)
+
+    def _update_latest_synced_datetime(self, latest_updated_at):
+        if latest_updated_at:
+
+            # sanity and defensive programming - if the leader returned a latest_updated_at that is older
+            # than the epoch, we'll set it to the epoch
+            epoch = pytz.UTC.localize(datetime.datetime.utcfromtimestamp(0))
+            if latest_updated_at < epoch:
+                latest_updated_at = epoch
+            self._synced_until_datetime = latest_updated_at
 
     def _is_request_from_leader(
         self, projects_role: typing.Optional[mlrun.common.schemas.ProjectsRole]
     ) -> bool:
         if projects_role and projects_role.value == self._leader_name:
             return True
         return False
```

## mlrun/api/utils/singletons/k8s.py

```diff
@@ -15,18 +15,20 @@
 import hashlib
 import time
 import typing
 
 from kubernetes import client, config
 from kubernetes.client.rest import ApiException
 
+import mlrun.api.runtime_handlers.mpijob
 import mlrun.common.schemas
 import mlrun.config as mlconfig
 import mlrun.errors
 import mlrun.platforms.iguazio
+import mlrun.runtimes
 from mlrun.utils import logger
 
 _k8s = None
 
 
 def get_k8s_helper(namespace=None, silent=True, log=False) -> "K8sHelper":
     """
@@ -215,22 +217,18 @@
         except ApiException as exc:
             logger.error(f"failed to get pod logs: {mlrun.errors.err_to_str(exc)}")
             raise exc
 
         return resp
 
     def get_logger_pods(self, project, uid, run_kind, namespace=""):
-
-        # As this file is imported in mlrun.runtimes, we sadly cannot have this import in the top level imports
-        # as that will create an import loop.
-        # TODO: Fix the import loops already!
-        import mlrun.runtimes
-
         namespace = self.resolve_namespace(namespace)
-        mpijob_crd_version = mlrun.runtimes.utils.resolve_mpijob_crd_version()
+        mpijob_crd_version = (
+            mlrun.api.runtime_handlers.mpijob.resolve_mpijob_crd_version()
+        )
         mpijob_role_label = (
             mlrun.runtimes.constants.MPIJobCRDVersions.role_label_by_version(
                 mpijob_crd_version
             )
         )
         extra_selectors = {
             "spark": "spark-role=driver",
```

## mlrun/artifacts/manager.py

```diff
@@ -46,14 +46,15 @@
     LegacyChartArtifact,
     LegacyPlotArtifact,
     LegacyPlotlyArtifact,
     PlotArtifact,
     PlotlyArtifact,
 )
 
+# TODO - Remove deprecated types when deleted in 1.7.0
 artifact_types = {
     "": Artifact,
     "artifact": Artifact,
     "dir": DirArtifact,
     "link": LinkArtifact,
     "plot": PlotArtifact,
     "chart": ChartArtifact,
```

## mlrun/artifacts/plots.py

```diff
@@ -62,14 +62,20 @@
 
         data_uri = base64.b64encode(data).decode("utf-8")
         return self._TEMPLATE.format(
             self.metadata.description or self.metadata.key, self.metadata.key, data_uri
         )
 
 
+# TODO: remove in 1.7.0
+@deprecated(
+    version="1.5.0",
+    reason="'ChartArtifact' will be removed in 1.7.0, use 'Artifact' instead",
+    category=FutureWarning,
+)
 class ChartArtifact(Artifact):
     kind = "chart"
 
     _TEMPLATE = """
 <html>
   <head>
     <script
@@ -130,14 +136,20 @@
         return (
             self._TEMPLATE.replace("$data$", dict_to_json(data))
             .replace("$opts$", dict_to_json(self.options))
             .replace("$chart$", self.chart)
         )
 
 
+# TODO: remove in 1.7.0
+@deprecated(
+    version="1.5.0",
+    reason="'BokehArtifact' will be removed in 1.7.0, use 'Artifact' instead",
+    category=FutureWarning,
+)
 class BokehArtifact(Artifact):
     """
     Bokeh artifact is an artifact for saving Bokeh generated figures. They will be stored in a html format.
     """
 
     kind = "bokeh"
```

## mlrun/common/schemas/__init__.py

```diff
@@ -43,14 +43,15 @@
     HeaderNames,
     LogsCollectorMode,
     OrderType,
     PatchMode,
     RunPartitionByField,
     SortField,
 )
+from .datastore_profile import DatastoreProfile
 from .events import (
     AuthSecretEventActions,
     EventClientKinds,
     EventsModes,
     SecretEventActions,
 )
 from .feature_store import (
@@ -94,14 +95,15 @@
     HubSourceSpec,
     IndexedHubSource,
     last_source_index,
 )
 from .k8s import NodeSelectorOperator, Resources, ResourceSpec
 from .memory_reports import MostCommonObjectTypesReport, ObjectTypeReport
 from .model_monitoring import (
+    DriftStatus,
     EndpointType,
     EndpointUID,
     EventFieldType,
     EventKeyMetrics,
     Features,
     FeatureValues,
     GrafanaColumn,
```

## mlrun/common/schemas/auth.py

```diff
@@ -54,14 +54,15 @@
     schedule = "schedule"
     secret = "secret"
     run = "run"
     model_endpoint = "model-endpoint"
     pipeline = "pipeline"
     hub_source = "hub-source"
     workflow = "workflow"
+    datastore_profile = "datastore-profile"
 
     def to_resource_string(
         self,
         project_name: str,
         resource_name: str,
     ):
         return {
@@ -82,14 +83,15 @@
             AuthorizationResourceTypes.schedule: "/projects/{project_name}/schedules/{resource_name}",
             AuthorizationResourceTypes.secret: "/projects/{project_name}/secrets/{resource_name}",
             AuthorizationResourceTypes.run: "/projects/{project_name}/runs/{resource_name}",
             # runtime resource doesn't have an identifier, we don't need any auth granularity behind project level
             AuthorizationResourceTypes.runtime_resource: "/projects/{project_name}/runtime-resources",
             AuthorizationResourceTypes.model_endpoint: "/projects/{project_name}/model-endpoints/{resource_name}",
             AuthorizationResourceTypes.pipeline: "/projects/{project_name}/pipelines/{resource_name}",
+            AuthorizationResourceTypes.datastore_profile: "/projects/{project_name}/datastore_profiles",
             # Hub sources are not project-scoped, and auth is globally on the sources endpoint.
             # TODO - this was reverted to /marketplace since MLRun needs to be able to run with old igz versions. Once
             #  we only have support for igz versions that support /hub (>=3.5.4), change this to "/hub/sources".
             AuthorizationResourceTypes.hub_source: "/marketplace/sources",
             # workflow define how to run a pipeline and can be considered as the specification of a pipeline.
             AuthorizationResourceTypes.workflow: "/projects/{project_name}/workflows/{resource_name}",
         }[self].format(project_name=project_name, resource_name=resource_name)
```

## mlrun/common/schemas/client_spec.py

```diff
@@ -36,15 +36,14 @@
     kfp_image: typing.Optional[str]
     kfp_url: typing.Optional[str]
     dask_kfp_image: typing.Optional[str]
     api_url: typing.Optional[str]
     nuclio_version: typing.Optional[str]
     ui_projects_prefix: typing.Optional[str]
     scrape_metrics: typing.Optional[str]
-    hub_url: typing.Optional[str]
     default_function_node_selector: typing.Optional[str]
     igz_version: typing.Optional[str]
     auto_mount_type: typing.Optional[str]
     auto_mount_params: typing.Optional[str]
     default_function_priority_class_name: typing.Optional[str]
     valid_function_priority_class_names: typing.Optional[str]
     default_tensorboard_logs_path: typing.Optional[str]
@@ -61,7 +60,8 @@
     # ce_mode is deprecated, we will use the full ce config instead and ce_mode will be removed in 1.6.0
     ce_mode: typing.Optional[str]
     ce: typing.Optional[dict]
     # not passing them as one object as it possible client user would like to override only one of the params
     calculate_artifact_hash: typing.Optional[str]
     generate_artifact_target_path_from_artifact_hash: typing.Optional[str]
     logs: typing.Optional[dict]
+    packagers: typing.Optional[dict]
```

## mlrun/common/schemas/model_monitoring/__init__.py

```diff
@@ -11,14 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 # flake8: noqa  - this is until we take care of the F401 violations with respect to __all__ & sphinx
 
 from .constants import (
+    DriftStatus,
     EndpointType,
     EndpointUID,
     EventFieldType,
     EventKeyMetrics,
     EventLiveStats,
     FileTargetKind,
     FunctionURI,
```

## mlrun/common/schemas/model_monitoring/constants.py

```diff
@@ -11,14 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 import enum
 import hashlib
 from dataclasses import dataclass
+from enum import Enum
 from typing import Optional
 
 import mlrun.common.helpers
 import mlrun.utils
 
 
 class EventFieldType:
@@ -191,7 +192,17 @@
         )
         versioned_model = f"{self.model}_{self.model_version or 'N/A'}"
         unique_string = f"{self.project}_{function_ref}_{versioned_model}"
         self.uid = hashlib.sha1(unique_string.encode("utf-8")).hexdigest()
 
     def __str__(self):
         return self.uid
+
+
+class DriftStatus(Enum):
+    """
+    Enum for the drift status values.
+    """
+
+    NO_DRIFT = "NO_DRIFT"
+    DRIFT_DETECTED = "DRIFT_DETECTED"
+    POSSIBLE_DRIFT = "POSSIBLE_DRIFT"
```

## mlrun/datastore/datastore.py

```diff
@@ -175,24 +175,28 @@
         if is_store_uri(url):
             artifact_url = url
             meta, url = self.get_store_artifact(
                 url, project, allow_empty_resources, secrets
             )
 
         store, subpath = self.get_or_create_store(url, secrets=secrets)
-        schema, endpoint, parsed_url = parse_url(url)
-        #  TODO: Modify the URL replacement to be outside of the dataitem. Dataitem class should
-        #   be implemented as a generic class.
-        if endpoint and schema == "dbfs":
-            url = url.replace(endpoint, "", 1)
         return DataItem(key, store, subpath, url, meta=meta, artifact_url=artifact_url)
 
     def get_or_create_store(self, url, secrets: dict = None) -> (DataStore, str):
         schema, endpoint, parsed_url = parse_url(url)
         subpath = parsed_url.path
+        datastore_type = schema
+
+        if schema == "ds":
+            profile_name = endpoint
+            project_name = urlparse(url).username or mlrun.mlconf.default_project
+            datastore = mlrun.db.get_run_db(
+                secrets=self._secrets
+            ).get_datastore_profile(profile_name, project_name)
+            datastore_type = datastore.type
 
         if schema == "memory":
             subpath = url[len("memory://") :]
             return in_memory_store, subpath
 
         if not schema and endpoint:
             if endpoint in self._stores.keys():
@@ -204,14 +208,14 @@
         if not secrets and not mlrun.config.is_running_as_api():
             if store_key in self._stores.keys():
                 return self._stores[store_key], subpath
 
         # support u/p embedding in url (as done in redis) by setting netloc as the "endpoint" parameter
         # when running on server we don't cache the datastore, because there are multiple users and we don't want to
         # cache the credentials, so for each new request we create a new store
-        store = schema_to_store(schema)(
+        store = schema_to_store(datastore_type)(
             self, schema, store_key, parsed_url.netloc, secrets=secrets
         )
         if not secrets and not mlrun.config.is_running_as_api():
             self._stores[store_key] = store
         # in file stores in windows path like c:\a\b the drive letter is dropped from the path, so we return the url
         return store, url if store.kind == "file" else subpath
```

## mlrun/datastore/dbfs_store.py

```diff
@@ -78,26 +78,29 @@
     def _ls_from_cache(self, path):
         pass
 
 
 # dbfs objects will be represented with the following URL: dbfs://<path>
 class DBFSStore(DataStore):
     def __init__(self, parent, schema, name, endpoint="", secrets: dict = None):
+        if not endpoint:
+            endpoint = mlrun.get_secret_or_env("DATABRICKS_HOST")
         super().__init__(parent, name, schema, endpoint, secrets=secrets)
         self.get_filesystem(silent=False)
 
     def get_filesystem(self, silent=True):
         """return fsspec file system object, if supported"""
         if not self._filesystem:
             self._filesystem = fsspec.filesystem("dbfs", **self.get_storage_options())
         return self._filesystem
 
     def get_storage_options(self):
         return dict(
-            token=self._get_secret_or_env("DATABRICKS_TOKEN"), instance=self.endpoint
+            token=self._get_secret_or_env("DATABRICKS_TOKEN"),
+            instance=mlrun.get_secret_or_env("DATABRICKS_HOST"),
         )
 
     def _verify_filesystem_and_key(self, key: str):
         if not self._filesystem:
             raise mlrun.errors.MLRunInvalidArgumentError(
                 "Performing actions on data-item without a valid filesystem"
             )
```

## mlrun/datastore/redis.py

```diff
@@ -14,14 +14,15 @@
 
 import redis
 import redis.cluster
 
 import mlrun
 
 from .base import DataStore
+from .datastore_profile import datastore_profile_read
 
 
 class RedisStore(DataStore):
     """
     Partial implementation of DataStore over the Redis KV store
 
     - no support for filesystem
@@ -29,25 +30,29 @@
     """
 
     def __init__(self, parent, schema, name, endpoint="", secrets: dict = None):
         super().__init__(parent, name, schema, endpoint, secrets=secrets)
         self.headers = None
 
         self.endpoint = self.endpoint or mlrun.mlconf.redis.url
+        if schema == "ds":
+            datastore_profile = datastore_profile_read(name)
+            self._redis_url = datastore_profile.url_with_credentials()
+            self.secure = datastore_profile.is_secured()
+        else:
+            if self.endpoint.startswith("rediss://"):
+                self.endpoint = self.endpoint[len("rediss://") :]
+                self.secure = True
+            elif self.endpoint.startswith("redis://"):
+                self.endpoint = self.endpoint[len("redis://") :]
+                self.secure = False
+            elif self.endpoint == "":
+                raise NotImplementedError(f"invalid endpoint: {self.endpoint}")
 
-        if self.endpoint.startswith("rediss://"):
-            self.endpoint = self.endpoint[len("rediss://") :]
-            self.secure = True
-        elif self.endpoint.startswith("redis://"):
-            self.endpoint = self.endpoint[len("redis://") :]
-            self.secure = False
-        elif self.endpoint == "":
-            raise NotImplementedError(f"invalid endpoint: {endpoint}")
-
-        self._redis_url = f"{schema}://{self.endpoint}"
+            self._redis_url = f"{schema}://{self.endpoint}"
 
         self._redis = None
 
     @property
     def redis(self):
         if self._redis is None:
             try:
@@ -139,15 +144,15 @@
     def rm(self, key, recursive=False, maxdepth=None):
         """
         delete keys, possibly recursively
         """
         if maxdepth is not None:
             raise NotImplementedError("maxdepth is not supported")
 
-        key = RedisStore.build_redis_key(key, prefix_only=True)
+        key = RedisStore.build_redis_key(key, prefix_only=recursive)
 
         if recursive:
             key += "*" if key.endswith("/") else "/*"
             for k in self.redis.scan_iter(key):
                 self.redis.delete(k)
             key = f"_spark:{key}"
             for k in self.redis.scan_iter(key):
```

## mlrun/datastore/targets.py

```diff
@@ -32,14 +32,15 @@
 from mlrun.model import DataSource, DataTarget, DataTargetBase, TargetPathObject
 from mlrun.utils import now_date
 from mlrun.utils.v3io_clients import get_frames_client
 
 from .. import errors
 from ..data_types import ValueType
 from ..platforms.iguazio import parse_path, split_path
+from .datastore_profile import datastore_profile_read
 from .utils import (
     _generate_sql_query_with_time_filter,
     filter_df_start_end_time,
     parse_kafka_url,
     select_columns_from_df,
     store_path_to_spark,
 )
@@ -1167,28 +1168,32 @@
 
     # Fetch server url from the RedisNoSqlTarget::__init__() 'path' parameter.
     # If not set fetch it from 'mlrun.mlconf.redis.url' (MLRUN_REDIS__URL environment variable).
     # Then look for username and password at REDIS_xxx secrets
     def _get_server_endpoint(self):
         endpoint, uri = parse_path(self.get_target_path())
         endpoint = endpoint or mlrun.mlconf.redis.url
-        parsed_endpoint = urlparse(endpoint)
-        if parsed_endpoint.username or parsed_endpoint.password:
-            raise mlrun.errors.MLRunInvalidArgumentError(
-                "Provide Redis username and password only via secrets"
-            )
-        user = self._get_credential("REDIS_USER", "")
-        password = self._get_credential("REDIS_PASSWORD", "")
-        host = parsed_endpoint.hostname
-        port = parsed_endpoint.port if parsed_endpoint.port else "6379"
-        scheme = parsed_endpoint.scheme
-        if user or password:
-            endpoint = f"{scheme}://{user}:{password}@{host}:{port}"
+        if endpoint.startswith("ds"):
+            datastore_profile = datastore_profile_read(endpoint)
+            endpoint = datastore_profile.url_with_credentials()
         else:
-            endpoint = f"{scheme}://{host}:{port}"
+            parsed_endpoint = urlparse(endpoint)
+            if parsed_endpoint.username or parsed_endpoint.password:
+                raise mlrun.errors.MLRunInvalidArgumentError(
+                    "Provide Redis username and password only via secrets"
+                )
+            user = self._get_credential("REDIS_USER", "")
+            password = self._get_credential("REDIS_PASSWORD", "")
+            host = parsed_endpoint.hostname
+            port = parsed_endpoint.port if parsed_endpoint.port else "6379"
+            scheme = parsed_endpoint.scheme
+            if user or password:
+                endpoint = f"{scheme}://{user}:{password}@{host}:{port}"
+            else:
+                endpoint = f"{scheme}://{host}:{port}"
         return endpoint, uri
 
     def get_table_object(self):
         from storey import Table
         from storey.redis_driver import RedisDriver
 
         endpoint, uri = self._get_server_endpoint()
```

## mlrun/db/base.py

```diff
@@ -561,15 +561,20 @@
         self,
         source_name: str,
         source: Union[dict, mlrun.common.schemas.IndexedHubSource],
     ):
         pass
 
     @abstractmethod
-    def list_hub_sources(self):
+    def list_hub_sources(
+        self,
+        item_name: Optional[str] = None,
+        tag: Optional[str] = None,
+        version: Optional[str] = None,
+    ):
         pass
 
     @abstractmethod
     def get_hub_source(self, source_name: str):
         pass
 
     @abstractmethod
@@ -629,7 +634,35 @@
         project: str = None,
         mask_params: bool = True,
     ):
         pass
 
     def watch_log(self, uid, project="", watch=True, offset=0):
         pass
+
+    def get_datastore_profile(
+        self, name: str, project: str
+    ) -> Optional[mlrun.common.schemas.DatastoreProfile]:
+        pass
+
+    def delete_datastore_profile(
+        self, name: str, project: str
+    ) -> mlrun.common.schemas.DatastoreProfile:
+        pass
+
+    def list_datastore_profile(
+        self, project: str
+    ) -> List[mlrun.common.schemas.DatastoreProfile]:
+        pass
+
+    def store_datastore_profile(
+        self, profile: mlrun.common.schemas.DatastoreProfile, project: str
+    ):
+        pass
+
+    def function_status(self, project, name, kind, selector):
+        pass
+
+    def start_function(
+        self, func_url: str = None, function: "mlrun.runtimes.BaseRuntime" = None
+    ):
+        pass
```

## mlrun/db/httpdb.py

```diff
@@ -31,8698 +31,8925 @@
 000001e0: 6e73 6520 666f 7220 7468 6520 7370 6563  nse for the spec
 000001f0: 6966 6963 206c 616e 6775 6167 6520 676f  ific language go
 00000200: 7665 726e 696e 6720 7065 726d 6973 7369  verning permissi
 00000210: 6f6e 7320 616e 640a 2320 6c69 6d69 7461  ons and.# limita
 00000220: 7469 6f6e 7320 756e 6465 7220 7468 6520  tions under the 
 00000230: 4c69 6365 6e73 652e 0a69 6d70 6f72 7420  License..import 
 00000240: 656e 756d 0a69 6d70 6f72 7420 6874 7470  enum.import http
-00000250: 0a69 6d70 6f72 7420 7265 0a69 6d70 6f72  .import re.impor
-00000260: 7420 7465 6d70 6669 6c65 0a69 6d70 6f72  t tempfile.impor
-00000270: 7420 7469 6d65 0a69 6d70 6f72 7420 7472  t time.import tr
-00000280: 6163 6562 6163 6b0a 696d 706f 7274 2074  aceback.import t
-00000290: 7970 696e 670a 6672 6f6d 2064 6174 6574  yping.from datet
-000002a0: 696d 6520 696d 706f 7274 2064 6174 6574  ime import datet
-000002b0: 696d 650a 6672 6f6d 206f 7320 696d 706f  ime.from os impo
-000002c0: 7274 2070 6174 682c 2072 656d 6f76 650a  rt path, remove.
-000002d0: 6672 6f6d 2074 7970 696e 6720 696d 706f  from typing impo
-000002e0: 7274 2044 6963 742c 204c 6973 742c 204f  rt Dict, List, O
-000002f0: 7074 696f 6e61 6c2c 2055 6e69 6f6e 0a66  ptional, Union.f
-00000300: 726f 6d20 7572 6c6c 6962 2e70 6172 7365  rom urllib.parse
-00000310: 2069 6d70 6f72 7420 7572 6c70 6172 7365   import urlparse
-00000320: 0a0a 696d 706f 7274 206b 6670 0a69 6d70  ..import kfp.imp
-00000330: 6f72 7420 7265 7175 6573 7473 0a69 6d70  ort requests.imp
-00000340: 6f72 7420 7365 6d76 6572 0a0a 696d 706f  ort semver..impo
-00000350: 7274 206d 6c72 756e 0a69 6d70 6f72 7420  rt mlrun.import 
-00000360: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00000370: 656d 6173 0a69 6d70 6f72 7420 6d6c 7275  emas.import mlru
-00000380: 6e2e 6d6f 6465 6c5f 6d6f 6e69 746f 7269  n.model_monitori
-00000390: 6e67 2e6d 6f64 656c 5f65 6e64 706f 696e  ng.model_endpoin
-000003a0: 740a 696d 706f 7274 206d 6c72 756e 2e70  t.import mlrun.p
-000003b0: 6c61 7466 6f72 6d73 0a69 6d70 6f72 7420  latforms.import 
-000003c0: 6d6c 7275 6e2e 7072 6f6a 6563 7473 0a66  mlrun.projects.f
-000003d0: 726f 6d20 6d6c 7275 6e2e 6572 726f 7273  rom mlrun.errors
-000003e0: 2069 6d70 6f72 7420 4d4c 5275 6e49 6e76   import MLRunInv
-000003f0: 616c 6964 4172 6775 6d65 6e74 4572 726f  alidArgumentErro
-00000400: 722c 2065 7272 5f74 6f5f 7374 720a 0a66  r, err_to_str..f
-00000410: 726f 6d20 2e2e 6172 7469 6661 6374 7320  rom ..artifacts 
-00000420: 696d 706f 7274 2041 7274 6966 6163 740a  import Artifact.
-00000430: 6672 6f6d 202e 2e63 6f6e 6669 6720 696d  from ..config im
-00000440: 706f 7274 2063 6f6e 6669 670a 6672 6f6d  port config.from
-00000450: 202e 2e66 6561 7475 7265 5f73 746f 7265   ..feature_store
-00000460: 2069 6d70 6f72 7420 4665 6174 7572 6553   import FeatureS
-00000470: 6574 2c20 4665 6174 7572 6556 6563 746f  et, FeatureVecto
-00000480: 720a 6672 6f6d 202e 2e6c 6973 7473 2069  r.from ..lists i
-00000490: 6d70 6f72 7420 4172 7469 6661 6374 4c69  mport ArtifactLi
-000004a0: 7374 2c20 5275 6e4c 6973 740a 6672 6f6d  st, RunList.from
-000004b0: 202e 2e72 756e 7469 6d65 7320 696d 706f   ..runtimes impo
-000004c0: 7274 2042 6173 6552 756e 7469 6d65 0a66  rt BaseRuntime.f
-000004d0: 726f 6d20 2e2e 7574 696c 7320 696d 706f  rom ..utils impo
-000004e0: 7274 2028 0a20 2020 2064 6174 6574 696d  rt (.    datetim
-000004f0: 655f 746f 5f69 736f 2c0a 2020 2020 6469  e_to_iso,.    di
-00000500: 6374 5f74 6f5f 6a73 6f6e 2c0a 2020 2020  ct_to_json,.    
-00000510: 6c6f 6767 6572 2c0a 2020 2020 6e65 775f  logger,.    new_
-00000520: 7069 7065 5f6d 6574 6164 6174 612c 0a20  pipe_metadata,. 
-00000530: 2020 206e 6f72 6d61 6c69 7a65 5f6e 616d     normalize_nam
-00000540: 652c 0a20 2020 2076 6572 7369 6f6e 2c0a  e,.    version,.
-00000550: 290a 6672 6f6d 202e 6261 7365 2069 6d70  ).from .base imp
-00000560: 6f72 7420 5275 6e44 4245 7272 6f72 2c20  ort RunDBError, 
-00000570: 5275 6e44 4249 6e74 6572 6661 6365 0a0a  RunDBInterface..
-00000580: 5f61 7274 6966 6163 745f 6b65 7973 203d  _artifact_keys =
-00000590: 205b 0a20 2020 2022 666f 726d 6174 222c   [.    "format",
-000005a0: 0a20 2020 2022 696e 6c69 6e65 222c 0a20  .    "inline",. 
-000005b0: 2020 2022 6b65 7922 2c0a 2020 2020 2273     "key",.    "s
-000005c0: 7263 5f70 6174 6822 2c0a 2020 2020 2274  rc_path",.    "t
-000005d0: 6172 6765 745f 7061 7468 222c 0a20 2020  arget_path",.   
-000005e0: 2022 7669 6577 6572 222c 0a5d 0a0a 0a64   "viewer",.]...d
-000005f0: 6566 2062 6f6f 6c32 7374 7228 7661 6c29  ef bool2str(val)
-00000600: 3a0a 2020 2020 7265 7475 726e 2022 7965  :.    return "ye
-00000610: 7322 2069 6620 7661 6c20 656c 7365 2022  s" if val else "
-00000620: 6e6f 220a 0a0a 636c 6173 7320 4854 5450  no"...class HTTP
-00000630: 5275 6e44 4228 5275 6e44 4249 6e74 6572  RunDB(RunDBInter
-00000640: 6661 6365 293a 0a20 2020 2022 2222 496e  face):.    """In
-00000650: 7465 7266 6163 6520 666f 7220 6163 6365  terface for acce
-00000660: 7373 696e 6720 616e 6420 6d61 6e69 7075  ssing and manipu
-00000670: 6c61 7469 6e67 2074 6865 203a 7079 3a6d  lating the :py:m
-00000680: 6f64 3a60 6d6c 7275 6e60 2070 6572 7369  od:`mlrun` persi
-00000690: 7374 656e 7420 7374 6f72 652c 206d 6169  stent store, mai
-000006a0: 6e74 6169 6e69 6e67 2074 6865 2066 756c  ntaining the ful
-000006b0: 6c20 7374 6174 650a 2020 2020 616e 6420  l state.    and 
-000006c0: 6361 7461 6c6f 6720 6f66 206f 626a 6563  catalog of objec
-000006d0: 7473 2074 6861 7420 4d4c 5275 6e20 7573  ts that MLRun us
-000006e0: 6573 2e20 5468 6520 3a70 793a 636c 6173  es. The :py:clas
-000006f0: 733a 6048 5454 5052 756e 4442 6020 636c  s:`HTTPRunDB` cl
-00000700: 6173 7320 7365 7276 6573 2061 7320 6120  ass serves as a 
-00000710: 636c 6965 6e74 2d73 6964 6520 7072 6f78  client-side prox
-00000720: 7920 746f 2074 6865 204d 4c52 756e 0a20  y to the MLRun. 
-00000730: 2020 2041 5049 2073 6572 7669 6365 2077     API service w
-00000740: 6869 6368 206d 6169 6e74 6169 6e73 2074  hich maintains t
-00000750: 6865 2061 6374 7561 6c20 6461 7461 2d73  he actual data-s
-00000760: 746f 7265 2c20 6163 6365 7373 6573 2074  tore, accesses t
-00000770: 6865 2073 6572 7665 7220 7468 726f 7567  he server throug
-00000780: 6820 5245 5354 2041 5049 732e 0a0a 2020  h REST APIs...  
-00000790: 2020 5468 6520 636c 6173 7320 7072 6f76    The class prov
-000007a0: 6964 6573 2066 756e 6374 696f 6e73 2066  ides functions f
-000007b0: 6f72 2061 6363 6573 7369 6e67 2061 6e64  or accessing and
-000007c0: 206d 6f64 6966 7969 6e67 2074 6865 2076   modifying the v
-000007d0: 6172 696f 7573 206f 626a 6563 7473 2074  arious objects t
-000007e0: 6861 7420 6172 6520 7573 6564 2062 7920  hat are used by 
-000007f0: 4d4c 5275 6e20 696e 2069 7473 0a20 2020  MLRun in its.   
-00000800: 206f 7065 7261 7469 6f6e 2e20 5468 6520   operation. The 
-00000810: 6675 6e63 7469 6f6e 7320 7072 6f76 6964  functions provid
-00000820: 6564 2066 6f6c 6c6f 7720 736f 6d65 2073  ed follow some s
-00000830: 7461 6e64 6172 6420 6775 6964 656c 696e  tandard guidelin
-00000840: 6573 2c20 7768 6963 6820 6172 653a 0a0a  es, which are:..
-00000850: 2020 2020 2d20 4576 6572 7920 6f62 6a65      - Every obje
-00000860: 6374 2069 6e20 4d4c 5275 6e20 6578 6973  ct in MLRun exis
-00000870: 7473 2069 6e20 7468 6520 636f 6e74 6578  ts in the contex
-00000880: 7420 6f66 2061 2070 726f 6a65 6374 2028  t of a project (
-00000890: 6578 6365 7074 2070 726f 6a65 6374 7320  except projects 
-000008a0: 7468 656d 7365 6c76 6573 292e 2057 6865  themselves). Whe
-000008b0: 6e20 7265 6665 7265 6e63 696e 6720 616e  n referencing an
-000008c0: 206f 626a 6563 740a 2020 2020 2020 7468   object.      th
-000008d0: 726f 7567 6820 616e 7920 4150 492c 2061  rough any API, a
-000008e0: 2070 726f 6a65 6374 206e 616d 6520 6d75   project name mu
-000008f0: 7374 2062 6520 7072 6f76 6964 6564 2e20  st be provided. 
-00000900: 5468 6520 6465 6661 756c 7420 666f 7220  The default for 
-00000910: 6d6f 7374 2041 5049 7320 6973 2066 6f72  most APIs is for
-00000920: 2061 6e20 656d 7074 7920 7072 6f6a 6563   an empty projec
-00000930: 7420 6e61 6d65 2c20 7768 6963 680a 2020  t name, which.  
-00000940: 2020 2020 7769 6c6c 2062 6520 7265 706c      will be repl
-00000950: 6163 6564 2062 7920 7468 6520 6e61 6d65  aced by the name
-00000960: 206f 6620 7468 6520 6465 6661 756c 7420   of the default 
-00000970: 7072 6f6a 6563 7420 2875 7375 616c 6c79  project (usually
-00000980: 2060 6064 6566 6175 6c74 6060 292e 2054   ``default``). T
-00000990: 6865 7265 666f 7265 2c20 6966 2070 6572  herefore, if per
-000009a0: 666f 726d 696e 6720 616e 2041 5049 2074  forming an API t
-000009b0: 6f0a 2020 2020 2020 6c69 7374 2066 756e  o.      list fun
-000009c0: 6374 696f 6e73 2c20 666f 7220 6578 616d  ctions, for exam
-000009d0: 706c 652c 2061 6e64 206e 6f74 2070 726f  ple, and not pro
-000009e0: 7669 6469 6e67 2061 2070 726f 6a65 6374  viding a project
-000009f0: 206e 616d 6520 2d20 7468 6520 7265 7375   name - the resu
-00000a00: 6c74 2077 696c 6c20 6e6f 7420 6265 2066  lt will not be f
-00000a10: 756e 6374 696f 6e73 2066 726f 6d20 616c  unctions from al
-00000a20: 6c0a 2020 2020 2020 7072 6f6a 6563 7473  l.      projects
-00000a30: 2062 7574 2072 6174 6865 7220 6672 6f6d   but rather from
-00000a40: 2074 6865 2060 6064 6566 6175 6c74 6060   the ``default``
-00000a50: 2070 726f 6a65 6374 2e0a 2020 2020 2d20   project..    - 
-00000a60: 4d61 6e79 206f 626a 6563 7473 2063 616e  Many objects can
-00000a70: 2062 6520 6173 7369 676e 6564 206c 6162   be assigned lab
-00000a80: 656c 732c 2061 6e64 206c 6973 7465 642f  els, and listed/
-00000a90: 7175 6572 6965 6420 6279 206c 6162 656c  queried by label
-00000aa0: 2e20 5468 6520 6c61 6265 6c20 7061 7261  . The label para
-00000ab0: 6d65 7465 7220 666f 7220 7175 6572 7920  meter for query 
-00000ac0: 4150 4973 2061 6c6c 6f77 7320 666f 720a  APIs allows for.
-00000ad0: 2020 2020 2020 6c69 7374 696e 6720 6f62        listing ob
-00000ae0: 6a65 6374 7320 7468 6174 3a0a 0a20 2020  jects that:..   
-00000af0: 2020 202d 2048 6176 6520 6120 7370 6563     - Have a spec
-00000b00: 6966 6963 206c 6162 656c 2c20 6279 2061  ific label, by a
-00000b10: 736b 696e 6720 666f 7220 6060 6c61 6265  sking for ``labe
-00000b20: 6c3d 223c 6c61 6265 6c5f 6e61 6d65 3e22  l="<label_name>"
-00000b30: 6060 2e20 496e 2074 6869 7320 6361 7365  ``. In this case
-00000b40: 2074 6865 2061 6374 7561 6c20 7661 6c75   the actual valu
-00000b50: 6520 6f66 2074 6865 206c 6162 656c 0a20  e of the label. 
-00000b60: 2020 2020 2020 2064 6f65 736e 2774 206d         doesn't m
-00000b70: 6174 7465 7220 616e 6420 6576 6572 7920  atter and every 
-00000b80: 6f62 6a65 6374 2077 6974 6820 7468 6174  object with that
-00000b90: 206c 6162 656c 2077 696c 6c20 6265 2072   label will be r
-00000ba0: 6574 7572 6e65 640a 2020 2020 2020 2d20  eturned.      - 
-00000bb0: 4861 7665 2061 206c 6162 656c 2077 6974  Have a label wit
-00000bc0: 6820 6120 7370 6563 6966 6963 2076 616c  h a specific val
-00000bd0: 7565 2e20 5468 6973 2069 7320 646f 6e65  ue. This is done
-00000be0: 2062 7920 7370 6563 6966 7969 6e67 2060   by specifying `
-00000bf0: 606c 6162 656c 3d22 3c6c 6162 656c 5f6e  `label="<label_n
-00000c00: 616d 653e 3d3c 6c61 6265 6c5f 7661 6c75  ame>=<label_valu
-00000c10: 653e 2260 602e 2049 6e20 7468 6973 0a20  e>"``. In this. 
-00000c20: 2020 2020 2020 2063 6173 6520 6f6e 6c79         case only
-00000c30: 206f 626a 6563 7473 2077 686f 7365 206c   objects whose l
-00000c40: 6162 656c 206d 6174 6368 6573 2074 6865  abel matches the
-00000c50: 2076 616c 7565 2077 696c 6c20 6265 2072   value will be r
-00000c60: 6574 7572 6e65 640a 0a20 2020 202d 204d  eturned..    - M
-00000c70: 6f73 7420 6f62 6a65 6374 7320 6861 7665  ost objects have
-00000c80: 2061 2060 6063 7265 6174 6560 6020 6d65   a ``create`` me
-00000c90: 7468 6f64 2061 7320 7765 6c6c 2061 7320  thod as well as 
-00000ca0: 6120 6060 7374 6f72 6560 6020 6d65 7468  a ``store`` meth
-00000cb0: 6f64 2e20 4372 6561 7465 2063 616e 206f  od. Create can o
-00000cc0: 6e6c 7920 6265 2063 616c 6c65 6420 7768  nly be called wh
-00000cd0: 656e 2073 7563 6820 616e 0a20 2020 2020  en such an.     
-00000ce0: 2064 6f65 7320 6e6f 7420 6578 6973 7420   does not exist 
-00000cf0: 7965 742c 2077 6869 6c65 2073 746f 7265  yet, while store
-00000d00: 2061 6c6c 6f77 7320 666f 7220 6569 7468   allows for eith
-00000d10: 6572 2063 7265 6174 696e 6720 6120 6e65  er creating a ne
-00000d20: 7720 6f62 6a65 6374 206f 7220 6f76 6572  w object or over
-00000d30: 7772 6974 696e 6720 616e 2065 7869 7374  writing an exist
-00000d40: 696e 6720 6f62 6a65 6374 2e0a 2020 2020  ing object..    
-00000d50: 2d20 536f 6d65 206f 626a 6563 7473 2068  - Some objects h
-00000d60: 6176 6520 6120 6060 7665 7273 696f 6e65  ave a ``versione
-00000d70: 6460 6020 6f70 7469 6f6e 2c20 696e 2077  d`` option, in w
-00000d80: 6869 6368 2063 6173 6520 6f76 6572 7772  hich case overwr
-00000d90: 6974 696e 6720 7468 6520 7361 6d65 206f  iting the same o
-00000da0: 626a 6563 7420 7769 7468 2061 2064 6966  bject with a dif
-00000db0: 6665 7265 6e74 2076 6572 7369 6f6e 206f  ferent version o
-00000dc0: 660a 2020 2020 2020 6974 2064 6f65 7320  f.      it does 
-00000dd0: 6e6f 7420 6465 6c65 7465 2074 6865 2070  not delete the p
-00000de0: 7265 7669 6f75 7320 7665 7273 696f 6e2c  revious version,
-00000df0: 2062 7574 2072 6174 6865 7220 6372 6561   but rather crea
-00000e00: 7465 7320 6120 6e65 7720 7665 7273 696f  tes a new versio
-00000e10: 6e20 6f66 2074 6865 206f 626a 6563 7420  n of the object 
-00000e20: 616e 6420 6b65 6570 7320 626f 7468 2076  and keeps both v
-00000e30: 6572 7369 6f6e 732e 0a20 2020 2020 2056  ersions..      V
-00000e40: 6572 7369 6f6e 6564 206f 626a 6563 7473  ersioned objects
-00000e50: 2075 7375 616c 6c79 2068 6176 6520 6120   usually have a 
-00000e60: 6060 7569 6460 6020 7072 6f70 6572 7479  ``uid`` property
-00000e70: 2077 6869 6368 2069 7320 6261 7365 6420   which is based 
-00000e80: 6f6e 2074 6865 6972 2063 6f6e 7465 6e74  on their content
-00000e90: 2061 6e64 2061 6c6c 6f77 7320 746f 2072   and allows to r
-00000ea0: 6566 6572 656e 6365 2061 0a20 2020 2020  eference a.     
-00000eb0: 2073 7065 6369 6669 6320 7665 7273 696f   specific versio
-00000ec0: 6e20 6f66 2061 6e20 6f62 6a65 6374 2028  n of an object (
-00000ed0: 6f74 6865 7220 7468 616e 2074 6167 6769  other than taggi
-00000ee0: 6e67 206f 626a 6563 7473 2c20 7768 6963  ng objects, whic
-00000ef0: 6820 616c 736f 2061 6c6c 6f77 7320 666f  h also allows fo
-00000f00: 7220 6561 7379 2072 6566 6572 656e 6369  r easy referenci
-00000f10: 6e67 292e 0a20 2020 202d 204d 616e 7920  ng)..    - Many 
-00000f20: 6f62 6a65 6374 7320 6861 7665 2062 6f74  objects have bot
-00000f30: 6820 6120 6060 7374 6f72 6560 6020 6675  h a ``store`` fu
-00000f40: 6e63 7469 6f6e 2061 6e64 2061 2060 6070  nction and a ``p
-00000f50: 6174 6368 6060 2066 756e 6374 696f 6e2e  atch`` function.
-00000f60: 2054 6865 7365 2061 7265 2075 7365 6420   These are used 
-00000f70: 696e 2074 6865 2073 616d 6520 7761 7920  in the same way 
-00000f80: 6173 2074 6865 0a20 2020 2020 2063 6f72  as the.      cor
-00000f90: 7265 7370 6f6e 6469 6e67 2052 4553 5420  responding REST 
-00000fa0: 7665 7262 7320 2d20 6120 6060 7374 6f72  verbs - a ``stor
-00000fb0: 6560 6020 6973 2070 6173 7365 6420 6120  e`` is passed a 
-00000fc0: 6675 6c6c 206f 626a 6563 7420 616e 6420  full object and 
-00000fd0: 7769 6c6c 2062 6173 6963 616c 6c79 2070  will basically p
-00000fe0: 6572 666f 726d 2061 2050 5554 206f 7065  erform a PUT ope
-00000ff0: 7261 7469 6f6e 2c0a 2020 2020 2020 7265  ration,.      re
-00001000: 706c 6163 696e 6720 7468 6520 6675 6c6c  placing the full
-00001010: 206f 626a 6563 7420 2869 6620 6974 2065   object (if it e
-00001020: 7869 7374 7329 2077 6869 6c65 2060 6070  xists) while ``p
-00001030: 6174 6368 6060 2072 6563 6569 7665 7320  atch`` receives 
-00001040: 6a75 7374 2061 2064 6963 7469 6f6e 6172  just a dictionar
-00001050: 7920 636f 6e74 6169 6e69 6e67 2074 6865  y containing the
-00001060: 2064 6966 6665 7265 6e63 6573 2074 6f0a   differences to.
-00001070: 2020 2020 2020 6265 2061 7070 6c69 6564        be applied
-00001080: 2074 6f20 7468 6520 6f62 6a65 6374 2c20   to the object, 
-00001090: 616e 6420 7769 6c6c 206d 6572 6765 2074  and will merge t
-000010a0: 686f 7365 2063 6861 6e67 6573 2074 6f20  hose changes to 
-000010b0: 7468 6520 6578 6973 7469 6e67 206f 626a  the existing obj
-000010c0: 6563 742e 2054 6865 2060 6070 6174 6368  ect. The ``patch
-000010d0: 6060 0a20 2020 2020 206f 7065 7261 7469  ``.      operati
-000010e0: 6f6e 2061 6c73 6f20 6861 7320 6120 7374  on also has a st
-000010f0: 7261 7465 6779 2061 7373 6967 6e65 6420  rategy assigned 
-00001100: 746f 2069 7420 7768 6963 6820 6465 7465  to it which dete
-00001110: 726d 696e 6573 2068 6f77 2074 6865 206d  rmines how the m
-00001120: 6572 6765 206c 6f67 6963 2073 686f 756c  erge logic shoul
-00001130: 6420 6265 6861 7665 2e0a 2020 2020 2020  d behave..      
-00001140: 5468 6520 7374 7261 7465 6779 2063 616e  The strategy can
-00001150: 2062 6520 6569 7468 6572 2060 6072 6570   be either ``rep
-00001160: 6c61 6365 6060 206f 7220 6060 6164 6469  lace`` or ``addi
-00001170: 7469 7665 6060 2e20 466f 7220 6675 7274  tive``. For furt
-00001180: 6865 7220 6465 7461 696c 7320 6f6e 2074  her details on t
-00001190: 686f 7365 2073 7472 6174 6567 6965 732c  hose strategies,
-000011a0: 2072 6566 6572 0a20 2020 2020 2074 6f20   refer.      to 
-000011b0: 6874 7470 733a 2f2f 7079 7069 2e6f 7267  https://pypi.org
-000011c0: 2f70 726f 6a65 6374 2f6d 6572 6765 6465  /project/mergede
-000011d0: 6570 2f0a 2020 2020 2222 220a 0a20 2020  ep/.    """..   
-000011e0: 206b 696e 6420 3d20 2268 7474 7022 0a20   kind = "http". 
-000011f0: 2020 2023 2062 7920 6465 6661 756c 7420     # by default 
-00001200: 7765 2064 6f6e 2774 2072 6574 7279 206f  we don't retry o
-00001210: 6e20 504f 5354 2072 6571 7565 7374 2061  n POST request a
-00001220: 7320 7468 6579 2061 7265 2075 7375 616c  s they are usual
-00001230: 6c79 206e 6f74 2069 6465 6d70 6f74 656e  ly not idempoten
-00001240: 740a 2020 2020 2320 6865 7265 2069 7320  t.    # here is 
-00001250: 6120 6c69 7374 206f 6620 6964 656e 7469  a list of identi
-00001260: 6669 6564 2050 4f53 5420 7265 7175 6573  fied POST reques
-00001270: 7473 2074 6861 7420 6172 6520 6964 656d  ts that are idem
-00001280: 706f 7465 6e74 2028 2773 746f 7265 2720  potent ('store' 
-00001290: 7673 2027 6372 6561 7465 2729 2061 6e64  vs 'create') and
-000012a0: 2063 616e 2062 6520 7265 7472 6965 640a   can be retried.
-000012b0: 2020 2020 5245 5452 4941 424c 455f 504f      RETRIABLE_PO
-000012c0: 5354 5f50 4154 4853 203d 205b 0a20 2020  ST_PATHS = [.   
-000012d0: 2020 2020 2072 225c 2f3f 7072 6f6a 6563       r"\/?projec
-000012e0: 7473 5c2f 2e2b 5c2f 6172 7469 6661 6374  ts\/.+\/artifact
-000012f0: 735c 2f2e 2b5c 2f2e 2b22 2c0a 2020 2020  s\/.+\/.+",.    
-00001300: 2020 2020 7222 5c2f 3f72 756e 5c2f 2e2b      r"\/?run\/.+
-00001310: 5c2f 2e2b 222c 0a20 2020 205d 0a0a 2020  \/.+",.    ]..  
-00001320: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-00001330: 656c 662c 2075 726c 293a 0a20 2020 2020  elf, url):.     
-00001340: 2020 2073 656c 662e 7365 7276 6572 5f76     self.server_v
-00001350: 6572 7369 6f6e 203d 2022 220a 2020 2020  ersion = "".    
-00001360: 2020 2020 7365 6c66 2e73 6573 7369 6f6e      self.session
-00001370: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00001380: 7365 6c66 2e5f 7761 6974 5f66 6f72 5f70  self._wait_for_p
-00001390: 726f 6a65 6374 5f74 6572 6d69 6e61 6c5f  roject_terminal_
-000013a0: 7374 6174 655f 7265 7472 795f 696e 7465  state_retry_inte
-000013b0: 7276 616c 203d 2033 0a20 2020 2020 2020  rval = 3.       
-000013c0: 2073 656c 662e 5f77 6169 745f 666f 725f   self._wait_for_
-000013d0: 6261 636b 6772 6f75 6e64 5f74 6173 6b5f  background_task_
-000013e0: 7465 726d 696e 616c 5f73 7461 7465 5f72  terminal_state_r
-000013f0: 6574 7279 5f69 6e74 6572 7661 6c20 3d20  etry_interval = 
-00001400: 330a 2020 2020 2020 2020 7365 6c66 2e5f  3.        self._
-00001410: 7761 6974 5f66 6f72 5f70 726f 6a65 6374  wait_for_project
-00001420: 5f64 656c 6574 696f 6e5f 696e 7465 7276  _deletion_interv
-00001430: 616c 203d 2033 0a20 2020 2020 2020 2073  al = 3.        s
-00001440: 656c 662e 636c 6965 6e74 5f76 6572 7369  elf.client_versi
-00001450: 6f6e 203d 2076 6572 7369 6f6e 2e56 6572  on = version.Ver
-00001460: 7369 6f6e 2829 2e67 6574 2829 5b22 7665  sion().get()["ve
-00001470: 7273 696f 6e22 5d0a 2020 2020 2020 2020  rsion"].        
-00001480: 7365 6c66 2e70 7974 686f 6e5f 7665 7273  self.python_vers
-00001490: 696f 6e20 3d20 7374 7228 7665 7273 696f  ion = str(versio
-000014a0: 6e2e 5665 7273 696f 6e28 292e 6765 745f  n.Version().get_
-000014b0: 7079 7468 6f6e 5f76 6572 7369 6f6e 2829  python_version()
-000014c0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-000014d0: 5f65 6e72 6963 685f 616e 645f 7661 6c69  _enrich_and_vali
-000014e0: 6461 7465 2875 726c 290a 0a20 2020 2064  date(url)..    d
-000014f0: 6566 205f 656e 7269 6368 5f61 6e64 5f76  ef _enrich_and_v
-00001500: 616c 6964 6174 6528 7365 6c66 2c20 7572  alidate(self, ur
-00001510: 6c29 3a0a 2020 2020 2020 2020 7061 7273  l):.        pars
-00001520: 6564 5f75 726c 203d 2075 726c 7061 7273  ed_url = urlpars
-00001530: 6528 7572 6c29 0a20 2020 2020 2020 2073  e(url).        s
-00001540: 6368 656d 6520 3d20 7061 7273 6564 5f75  cheme = parsed_u
-00001550: 726c 2e73 6368 656d 652e 6c6f 7765 7228  rl.scheme.lower(
-00001560: 290a 2020 2020 2020 2020 6966 2073 6368  ).        if sch
-00001570: 656d 6520 6e6f 7420 696e 2028 2268 7474  eme not in ("htt
-00001580: 7022 2c20 2268 7474 7073 2229 3a0a 2020  p", "https"):.  
-00001590: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000015a0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-000015b0: 2020 2020 2020 2020 2020 2020 6622 496e              f"In
-000015c0: 7661 6c69 6420 5552 4c20 7363 6865 6d65  valid URL scheme
-000015d0: 207b 7363 6865 6d65 7d20 666f 7220 4854   {scheme} for HT
-000015e0: 5450 5275 6e44 422c 206f 6e6c 7920 6874  TPRunDB, only ht
-000015f0: 7470 2873 2920 6973 2073 7570 706f 7274  tp(s) is support
-00001600: 6564 220a 2020 2020 2020 2020 2020 2020  ed".            
-00001610: 290a 0a20 2020 2020 2020 2065 6e64 706f  )..        endpo
-00001620: 696e 7420 3d20 7061 7273 6564 5f75 726c  int = parsed_url
-00001630: 2e68 6f73 746e 616d 650a 2020 2020 2020  .hostname.      
-00001640: 2020 6966 2070 6172 7365 645f 7572 6c2e    if parsed_url.
-00001650: 706f 7274 3a0a 2020 2020 2020 2020 2020  port:.          
-00001660: 2020 656e 6470 6f69 6e74 202b 3d20 6622    endpoint += f"
-00001670: 3a7b 7061 7273 6564 5f75 726c 2e70 6f72  :{parsed_url.por
-00001680: 747d 220a 2020 2020 2020 2020 6261 7365  t}".        base
-00001690: 5f75 726c 203d 2066 227b 7061 7273 6564  _url = f"{parsed
-000016a0: 5f75 726c 2e73 6368 656d 657d 3a2f 2f7b  _url.scheme}://{
-000016b0: 656e 6470 6f69 6e74 7d7b 7061 7273 6564  endpoint}{parsed
-000016c0: 5f75 726c 2e70 6174 687d 220a 0a20 2020  _url.path}"..   
-000016d0: 2020 2020 2075 7365 726e 616d 6520 3d20       username = 
-000016e0: 7061 7273 6564 5f75 726c 2e75 7365 726e  parsed_url.usern
-000016f0: 616d 6520 6f72 2063 6f6e 6669 672e 6874  ame or config.ht
-00001700: 7470 6462 2e75 7365 720a 2020 2020 2020  tpdb.user.      
-00001710: 2020 7061 7373 776f 7264 203d 2070 6172    password = par
-00001720: 7365 645f 7572 6c2e 7061 7373 776f 7264  sed_url.password
-00001730: 206f 7220 636f 6e66 6967 2e68 7474 7064   or config.httpd
-00001740: 622e 7061 7373 776f 7264 0a0a 2020 2020  b.password..    
-00001750: 2020 2020 7573 6572 6e61 6d65 2c20 7061      username, pa
-00001760: 7373 776f 7264 2c20 746f 6b65 6e20 3d20  ssword, token = 
-00001770: 6d6c 7275 6e2e 706c 6174 666f 726d 732e  mlrun.platforms.
-00001780: 6164 645f 6f72 5f72 6566 7265 7368 5f63  add_or_refresh_c
-00001790: 7265 6465 6e74 6961 6c73 280a 2020 2020  redentials(.    
-000017a0: 2020 2020 2020 2020 7061 7273 6564 5f75          parsed_u
-000017b0: 726c 2e68 6f73 746e 616d 652c 2075 7365  rl.hostname, use
-000017c0: 726e 616d 652c 2070 6173 7377 6f72 642c  rname, password,
-000017d0: 2063 6f6e 6669 672e 6874 7470 6462 2e74   config.httpdb.t
-000017e0: 6f6b 656e 0a20 2020 2020 2020 2029 0a0a  oken.        )..
-000017f0: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
-00001800: 655f 7572 6c20 3d20 6261 7365 5f75 726c  e_url = base_url
-00001810: 0a20 2020 2020 2020 2073 656c 662e 7573  .        self.us
-00001820: 6572 203d 2075 7365 726e 616d 650a 2020  er = username.  
-00001830: 2020 2020 2020 7365 6c66 2e70 6173 7377        self.passw
-00001840: 6f72 6420 3d20 7061 7373 776f 7264 0a20  ord = password. 
-00001850: 2020 2020 2020 2073 656c 662e 746f 6b65         self.toke
-00001860: 6e20 3d20 746f 6b65 6e0a 0a20 2020 2064  n = token..    d
-00001870: 6566 205f 5f72 6570 725f 5f28 7365 6c66  ef __repr__(self
-00001880: 293a 0a20 2020 2020 2020 2063 6c73 203d  ):.        cls =
-00001890: 2073 656c 662e 5f5f 636c 6173 735f 5f2e   self.__class__.
-000018a0: 5f5f 6e61 6d65 5f5f 0a20 2020 2020 2020  __name__.       
-000018b0: 2072 6574 7572 6e20 6622 7b63 6c73 7d28   return f"{cls}(
-000018c0: 7b73 656c 662e 6261 7365 5f75 726c 2172  {self.base_url!r
-000018d0: 7d29 220a 0a20 2020 2040 7374 6174 6963  })"..    @static
-000018e0: 6d65 7468 6f64 0a20 2020 2064 6566 2067  method.    def g
-000018f0: 6574 5f61 7069 5f70 6174 685f 7072 6566  et_api_path_pref
-00001900: 6978 2876 6572 7369 6f6e 3a20 7374 7220  ix(version: str 
-00001910: 3d20 4e6f 6e65 2920 2d3e 2073 7472 3a0a  = None) -> str:.
-00001920: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00001930: 2020 2020 3a70 6172 616d 2076 6572 7369      :param versi
-00001940: 6f6e 3a20 4150 4920 7665 7273 696f 6e20  on: API version 
-00001950: 746f 2075 7365 2c20 4e6f 6e65 2028 7468  to use, None (th
-00001960: 6520 6465 6661 756c 7429 2077 696c 6c20  e default) will 
-00001970: 6d65 616e 2074 6f20 7573 6520 7468 6520  mean to use the 
-00001980: 6465 6661 756c 7420 7661 6c75 6520 6672  default value fr
-00001990: 6f6d 206d 6c63 6f6e 662c 0a20 2020 2020  om mlconf,.     
-000019a0: 2020 2020 666f 7220 756e 2d76 6572 7369      for un-versi
-000019b0: 6f6e 6564 2061 7069 2073 6574 2061 6e20  oned api set an 
-000019c0: 656d 7074 7920 7374 7269 6e67 2e0a 2020  empty string..  
-000019d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000019e0: 2020 6966 2076 6572 7369 6f6e 2069 7320    if version is 
-000019f0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00001a00: 2020 2020 2020 7265 7475 726e 2066 2261        return f"a
-00001a10: 7069 2f7b 7665 7273 696f 6e7d 2220 6966  pi/{version}" if
-00001a20: 2076 6572 7369 6f6e 2065 6c73 6520 2261   version else "a
-00001a30: 7069 220a 0a20 2020 2020 2020 2061 7069  pi"..        api
-00001a40: 5f76 6572 7369 6f6e 5f70 6174 6820 3d20  _version_path = 
-00001a50: 280a 2020 2020 2020 2020 2020 2020 6622  (.            f"
-00001a60: 6170 692f 7b63 6f6e 6669 672e 6170 695f  api/{config.api_
-00001a70: 6261 7365 5f76 6572 7369 6f6e 7d22 2069  base_version}" i
-00001a80: 6620 636f 6e66 6967 2e61 7069 5f62 6173  f config.api_bas
-00001a90: 655f 7665 7273 696f 6e20 656c 7365 2022  e_version else "
-00001aa0: 6170 6922 0a20 2020 2020 2020 2029 0a20  api".        ). 
-00001ab0: 2020 2020 2020 2072 6574 7572 6e20 6170         return ap
-00001ac0: 695f 7665 7273 696f 6e5f 7061 7468 0a0a  i_version_path..
-00001ad0: 2020 2020 6465 6620 6765 745f 6261 7365      def get_base
-00001ae0: 5f61 7069 5f75 726c 2873 656c 662c 2070  _api_url(self, p
-00001af0: 6174 683a 2073 7472 2c20 7665 7273 696f  ath: str, versio
-00001b00: 6e3a 2073 7472 203d 204e 6f6e 6529 202d  n: str = None) -
-00001b10: 3e20 7374 723a 0a20 2020 2020 2020 2070  > str:.        p
-00001b20: 6174 685f 7072 6566 6978 203d 2073 656c  ath_prefix = sel
-00001b30: 662e 6765 745f 6170 695f 7061 7468 5f70  f.get_api_path_p
-00001b40: 7265 6669 7828 7665 7273 696f 6e29 0a20  refix(version). 
-00001b50: 2020 2020 2020 2075 726c 203d 2066 227b         url = f"{
-00001b60: 7365 6c66 2e62 6173 655f 7572 6c7d 2f7b  self.base_url}/{
-00001b70: 7061 7468 5f70 7265 6669 787d 2f7b 7061  path_prefix}/{pa
-00001b80: 7468 7d22 0a20 2020 2020 2020 2072 6574  th}".        ret
-00001b90: 7572 6e20 7572 6c0a 0a20 2020 2064 6566  urn url..    def
-00001ba0: 2061 7069 5f63 616c 6c28 0a20 2020 2020   api_call(.     
-00001bb0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00001bc0: 206d 6574 686f 642c 0a20 2020 2020 2020   method,.       
-00001bd0: 2070 6174 682c 0a20 2020 2020 2020 2065   path,.        e
-00001be0: 7272 6f72 3d4e 6f6e 652c 0a20 2020 2020  rror=None,.     
-00001bf0: 2020 2070 6172 616d 733d 4e6f 6e65 2c0a     params=None,.
-00001c00: 2020 2020 2020 2020 626f 6479 3d4e 6f6e          body=Non
-00001c10: 652c 0a20 2020 2020 2020 206a 736f 6e3d  e,.        json=
-00001c20: 4e6f 6e65 2c0a 2020 2020 2020 2020 6865  None,.        he
-00001c30: 6164 6572 733d 4e6f 6e65 2c0a 2020 2020  aders=None,.    
-00001c40: 2020 2020 7469 6d65 6f75 743d 3435 2c0a      timeout=45,.
-00001c50: 2020 2020 2020 2020 7665 7273 696f 6e3d          version=
-00001c60: 4e6f 6e65 2c0a 2020 2020 293a 0a20 2020  None,.    ):.   
-00001c70: 2020 2020 2022 2222 5065 7266 6f72 6d20       """Perform 
-00001c80: 6120 6469 7265 6374 2052 4553 5420 4150  a direct REST AP
-00001c90: 4920 6361 6c6c 206f 6e20 7468 6520 3a70  I call on the :p
-00001ca0: 793a 6d6f 643a 606d 6c72 756e 6020 4150  y:mod:`mlrun` AP
-00001cb0: 4920 7365 7276 6572 2e0a 0a20 2020 2020  I server...     
-00001cc0: 2020 2043 6175 7469 6f6e 3a0a 2020 2020     Caution:.    
-00001cd0: 2020 2020 2020 2020 466f 7220 6164 7661          For adva
-00001ce0: 6e63 6564 2075 7361 6765 202d 2070 7265  nced usage - pre
-00001cf0: 6665 7220 7573 696e 6720 7468 6520 7661  fer using the va
-00001d00: 7269 6f75 7320 4150 4973 2065 7870 6f73  rious APIs expos
-00001d10: 6564 2074 6872 6f75 6768 2074 6869 7320  ed through this 
-00001d20: 636c 6173 732c 2072 6174 6865 7220 7468  class, rather th
-00001d30: 616e 0a20 2020 2020 2020 2020 2020 2064  an.            d
-00001d40: 6972 6563 746c 7920 696e 766f 6b69 6e67  irectly invoking
-00001d50: 2052 4553 5420 6361 6c6c 732e 0a0a 2020   REST calls...  
-00001d60: 2020 2020 2020 3a70 6172 616d 206d 6574        :param met
-00001d70: 686f 643a 2052 4553 5420 6d65 7468 6f64  hod: REST method
-00001d80: 2028 504f 5354 2c20 4745 542c 2050 5554   (POST, GET, PUT
-00001d90: 2e2e 2e29 0a20 2020 2020 2020 203a 7061  ...).        :pa
-00001da0: 7261 6d20 7061 7468 3a20 5061 7468 2074  ram path: Path t
-00001db0: 6f20 656e 6470 6f69 6e74 2065 7865 6375  o endpoint execu
-00001dc0: 7465 642c 2066 6f72 2065 7861 6d70 6c65  ted, for example
-00001dd0: 2060 6022 7072 6f6a 6563 7473 2260 600a   ``"projects"``.
-00001de0: 2020 2020 2020 2020 3a70 6172 616d 2065          :param e
-00001df0: 7272 6f72 3a20 4572 726f 7220 746f 2072  rror: Error to r
-00001e00: 6574 7572 6e20 6966 2041 5049 2069 6e76  eturn if API inv
-00001e10: 6f63 6174 696f 6e20 6661 696c 730a 2020  ocation fails.  
-00001e20: 2020 2020 2020 3a70 6172 616d 2070 6172        :param par
-00001e30: 616d 733a 2052 6573 7420 7061 7261 6d65  ams: Rest parame
-00001e40: 7465 7273 2c20 7061 7373 6564 2061 7320  ters, passed as 
-00001e50: 6120 6469 6374 696f 6e61 7279 3a20 6060  a dictionary: ``
-00001e60: 7b22 3c70 6172 616d 2d6e 616d 653e 223a  {"<param-name>":
-00001e70: 203c 2270 6172 616d 2d76 616c 7565 223e   <"param-value">
-00001e80: 7d60 600a 2020 2020 2020 2020 3a70 6172  }``.        :par
-00001e90: 616d 2062 6f64 793a 2050 6179 6c6f 6164  am body: Payload
-00001ea0: 2074 6f20 6265 2070 6173 7365 6420 696e   to be passed in
-00001eb0: 2074 6865 2063 616c 6c2e 2049 6620 7573   the call. If us
-00001ec0: 696e 6720 4a53 4f4e 206f 626a 6563 7473  ing JSON objects
-00001ed0: 2c20 7072 6566 6572 2075 7369 6e67 2074  , prefer using t
-00001ee0: 6865 2060 606a 736f 6e60 6020 7061 7261  he ``json`` para
-00001ef0: 6d0a 2020 2020 2020 2020 3a70 6172 616d  m.        :param
-00001f00: 206a 736f 6e3a 204a 534f 4e20 7061 796c   json: JSON payl
-00001f10: 6f61 6420 746f 2062 6520 7061 7373 6564  oad to be passed
-00001f20: 2069 6e20 7468 6520 6361 6c6c 0a20 2020   in the call.   
-00001f30: 2020 2020 203a 7061 7261 6d20 6865 6164       :param head
-00001f40: 6572 733a 2052 4553 5420 6865 6164 6572  ers: REST header
-00001f50: 732c 2070 6173 7365 6420 6173 2061 2064  s, passed as a d
-00001f60: 6963 7469 6f6e 6172 793a 2060 607b 223c  ictionary: ``{"<
-00001f70: 6865 6164 6572 2d6e 616d 653e 223a 2022  header-name>": "
-00001f80: 3c68 6561 6465 722d 7661 6c75 653e 227d  <header-value>"}
-00001f90: 6060 0a20 2020 2020 2020 203a 7061 7261  ``.        :para
-00001fa0: 6d20 7469 6d65 6f75 743a 2041 5049 2063  m timeout: API c
-00001fb0: 616c 6c20 7469 6d65 6f75 740a 2020 2020  all timeout.    
-00001fc0: 2020 2020 3a70 6172 616d 2076 6572 7369      :param versi
-00001fd0: 6f6e 3a20 4150 4920 7665 7273 696f 6e20  on: API version 
-00001fe0: 746f 2075 7365 2c20 4e6f 6e65 2028 7468  to use, None (th
-00001ff0: 6520 6465 6661 756c 7429 2077 696c 6c20  e default) will 
-00002000: 6d65 616e 2074 6f20 7573 6520 7468 6520  mean to use the 
-00002010: 6465 6661 756c 7420 7661 6c75 6520 6672  default value fr
-00002020: 6f6d 2063 6f6e 6669 672c 0a20 2020 2020  om config,.     
-00002030: 2020 2020 666f 7220 756e 2d76 6572 7369      for un-versi
-00002040: 6f6e 6564 2061 7069 2073 6574 2061 6e20  oned api set an 
-00002050: 656d 7074 7920 7374 7269 6e67 2e0a 0a20  empty string... 
-00002060: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-00002070: 5079 7468 6f6e 2048 5454 5020 7265 7370  Python HTTP resp
-00002080: 6f6e 7365 206f 626a 6563 740a 2020 2020  onse object.    
-00002090: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000020a0: 7572 6c20 3d20 7365 6c66 2e67 6574 5f62  url = self.get_b
-000020b0: 6173 655f 6170 695f 7572 6c28 7061 7468  ase_api_url(path
-000020c0: 2c20 7665 7273 696f 6e29 0a20 2020 2020  , version).     
-000020d0: 2020 206b 7720 3d20 7b0a 2020 2020 2020     kw = {.      
-000020e0: 2020 2020 2020 6b65 793a 2076 616c 7565        key: value
-000020f0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00002100: 206b 6579 2c20 7661 6c75 6520 696e 2028   key, value in (
-00002110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002120: 2028 2270 6172 616d 7322 2c20 7061 7261   ("params", para
-00002130: 6d73 292c 0a20 2020 2020 2020 2020 2020  ms),.           
-00002140: 2020 2020 2028 2264 6174 6122 2c20 626f       ("data", bo
-00002150: 6479 292c 0a20 2020 2020 2020 2020 2020  dy),.           
-00002160: 2020 2020 2028 226a 736f 6e22 2c20 6a73       ("json", js
-00002170: 6f6e 292c 0a20 2020 2020 2020 2020 2020  on),.           
-00002180: 2020 2020 2028 2268 6561 6465 7273 222c       ("headers",
-00002190: 2068 6561 6465 7273 292c 0a20 2020 2020   headers),.     
-000021a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000021b0: 2020 2020 2069 6620 7661 6c75 6520 6973       if value is
-000021c0: 206e 6f74 204e 6f6e 650a 2020 2020 2020   not None.      
-000021d0: 2020 7d0a 0a20 2020 2020 2020 2069 6620    }..        if 
-000021e0: 7365 6c66 2e75 7365 723a 0a20 2020 2020  self.user:.     
-000021f0: 2020 2020 2020 206b 775b 2261 7574 6822         kw["auth"
-00002200: 5d20 3d20 2873 656c 662e 7573 6572 2c20  ] = (self.user, 
-00002210: 7365 6c66 2e70 6173 7377 6f72 6429 0a20  self.password). 
-00002220: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-00002230: 2e74 6f6b 656e 3a0a 2020 2020 2020 2020  .token:.        
-00002240: 2020 2020 2320 4967 7561 7a69 6f20 6175      # Iguazio au
-00002250: 7468 2064 6f65 736e 2774 2073 7570 706f  th doesn't suppo
-00002260: 7274 2070 6173 7369 6e67 2074 6f6b 656e  rt passing token
-00002270: 2074 6872 6f75 6768 2062 6561 7265 722c   through bearer,
-00002280: 2073 6f20 7573 6520 636f 6f6b 6965 2069   so use cookie i
-00002290: 6e73 7465 6164 0a20 2020 2020 2020 2020  nstead.         
-000022a0: 2020 2069 6620 6d6c 7275 6e2e 706c 6174     if mlrun.plat
-000022b0: 666f 726d 732e 6967 7561 7a69 6f2e 6973  forms.iguazio.is
-000022c0: 5f69 6775 617a 696f 5f73 6573 7369 6f6e  _iguazio_session
-000022d0: 2873 656c 662e 746f 6b65 6e29 3a0a 2020  (self.token):.  
-000022e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000022f0: 7373 696f 6e5f 636f 6f6b 6965 203d 2066  ssion_cookie = f
-00002300: 276a 3a7b 7b22 7369 6422 3a20 227b 7365  'j:{{"sid": "{se
-00002310: 6c66 2e74 6f6b 656e 7d22 7d7d 270a 2020  lf.token}"}}'.  
-00002320: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00002330: 6f6b 6965 7320 3d20 7b0a 2020 2020 2020  okies = {.      
-00002340: 2020 2020 2020 2020 2020 2020 2020 2273                "s
-00002350: 6573 7369 6f6e 223a 2073 6573 7369 6f6e  ession": session
-00002360: 5f63 6f6f 6b69 652c 0a20 2020 2020 2020  _cookie,.       
-00002370: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00002380: 2020 2020 2020 2020 2020 206b 775b 2263             kw["c
-00002390: 6f6f 6b69 6573 225d 203d 2063 6f6f 6b69  ookies"] = cooki
-000023a0: 6573 0a20 2020 2020 2020 2020 2020 2065  es.            e
-000023b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000023c0: 2020 2020 2069 6620 2241 7574 686f 7269       if "Authori
-000023d0: 7a61 7469 6f6e 2220 6e6f 7420 696e 206b  zation" not in k
-000023e0: 772e 7365 7464 6566 6175 6c74 2822 6865  w.setdefault("he
-000023f0: 6164 6572 7322 2c20 7b7d 293a 0a20 2020  aders", {}):.   
-00002400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002410: 206b 775b 2268 6561 6465 7273 225d 2e75   kw["headers"].u
-00002420: 7064 6174 6528 7b22 4175 7468 6f72 697a  pdate({"Authoriz
-00002430: 6174 696f 6e22 3a20 2242 6561 7265 7220  ation": "Bearer 
-00002440: 2220 2b20 7365 6c66 2e74 6f6b 656e 7d29  " + self.token})
-00002450: 0a0a 2020 2020 2020 2020 6966 206d 6c72  ..        if mlr
-00002460: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00002470: 732e 4865 6164 6572 4e61 6d65 732e 636c  s.HeaderNames.cl
-00002480: 6965 6e74 5f76 6572 7369 6f6e 206e 6f74  ient_version not
-00002490: 2069 6e20 6b77 2e73 6574 6465 6661 756c   in kw.setdefaul
-000024a0: 7428 0a20 2020 2020 2020 2020 2020 2022  t(.            "
-000024b0: 6865 6164 6572 7322 2c20 7b7d 0a20 2020  headers", {}.   
-000024c0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-000024d0: 2020 2020 6b77 5b22 6865 6164 6572 7322      kw["headers"
-000024e0: 5d2e 7570 6461 7465 280a 2020 2020 2020  ].update(.      
-000024f0: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00002500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002510: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00002520: 656d 6173 2e48 6561 6465 724e 616d 6573  emas.HeaderNames
-00002530: 2e63 6c69 656e 745f 7665 7273 696f 6e3a  .client_version:
-00002540: 2073 656c 662e 636c 6965 6e74 5f76 6572   self.client_ver
-00002550: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
-00002560: 2020 2020 2020 2020 2020 6d6c 7275 6e2e            mlrun.
-00002570: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e48  common.schemas.H
-00002580: 6561 6465 724e 616d 6573 2e70 7974 686f  eaderNames.pytho
-00002590: 6e5f 7665 7273 696f 6e3a 2073 656c 662e  n_version: self.
-000025a0: 7079 7468 6f6e 5f76 6572 7369 6f6e 2c0a  python_version,.
-000025b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000025c0: 7d0a 2020 2020 2020 2020 2020 2020 290a  }.            ).
-000025d0: 0a20 2020 2020 2020 2023 2072 6571 7565  .        # reque
-000025e0: 7374 7320 6e6f 206c 6f6e 6765 7220 7375  sts no longer su
-000025f0: 7070 6f72 7473 2068 6561 6465 7220 7661  pports header va
-00002600: 6c75 6573 2074 6f20 6265 2065 6e75 6d20  lues to be enum 
-00002610: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
-00002620: 636f 6d2f 7073 662f 7265 7175 6573 7473  com/psf/requests
-00002630: 2f70 756c 6c2f 3631 3534 290a 2020 2020  /pull/6154).    
-00002640: 2020 2020 2320 636f 6e76 6572 7420 746f      # convert to
-00002650: 2073 7472 696e 6773 2e20 446f 2074 6865   strings. Do the
-00002660: 2073 616d 6520 666f 7220 7061 7261 6d73   same for params
-00002670: 2066 6f72 206e 6963 656e 6573 730a 2020   for niceness.  
-00002680: 2020 2020 2020 666f 7220 6469 6374 5f20        for dict_ 
-00002690: 696e 205b 6865 6164 6572 732c 2070 6172  in [headers, par
-000026a0: 616d 735d 3a0a 2020 2020 2020 2020 2020  ams]:.          
-000026b0: 2020 6966 2064 6963 745f 2069 7320 6e6f    if dict_ is no
-000026c0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-000026d0: 2020 2020 2020 2020 666f 7220 6b65 7920          for key 
-000026e0: 696e 2064 6963 745f 2e6b 6579 7328 293a  in dict_.keys():
-000026f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002700: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00002710: 6365 2864 6963 745f 5b6b 6579 5d2c 2065  ce(dict_[key], e
-00002720: 6e75 6d2e 456e 756d 293a 0a20 2020 2020  num.Enum):.     
-00002730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002740: 2020 2064 6963 745f 5b6b 6579 5d20 3d20     dict_[key] = 
-00002750: 6469 6374 5f5b 6b65 795d 2e76 616c 7565  dict_[key].value
-00002760: 0a0a 2020 2020 2020 2020 2320 6966 2074  ..        # if t
-00002770: 6865 206d 6574 686f 6420 6973 2050 4f53  he method is POS
-00002780: 542c 2077 6520 6e65 6564 2074 6f20 7570  T, we need to up
-00002790: 6461 7465 2074 6865 2073 6573 7369 6f6e  date the session
-000027a0: 2077 6974 6820 7468 6520 6170 7072 6f70   with the approp
-000027b0: 7269 6174 6520 7265 7472 7920 706f 6c69  riate retry poli
-000027c0: 6379 0a20 2020 2020 2020 2069 6620 6e6f  cy.        if no
-000027d0: 7420 7365 6c66 2e73 6573 7369 6f6e 206f  t self.session o
-000027e0: 7220 6d65 7468 6f64 203d 3d20 2250 4f53  r method == "POS
-000027f0: 5422 3a0a 2020 2020 2020 2020 2020 2020  T":.            
-00002800: 7265 7472 795f 6f6e 5f70 6f73 7420 3d20  retry_on_post = 
-00002810: 7365 6c66 2e5f 6973 5f72 6574 7279 5f6f  self._is_retry_o
-00002820: 6e5f 706f 7374 5f61 6c6c 6f77 6564 286d  n_post_allowed(m
-00002830: 6574 686f 642c 2070 6174 6829 0a20 2020  ethod, path).   
-00002840: 2020 2020 2020 2020 2073 656c 662e 7365           self.se
-00002850: 7373 696f 6e20 3d20 7365 6c66 2e5f 696e  ssion = self._in
-00002860: 6974 5f73 6573 7369 6f6e 2872 6574 7279  it_session(retry
-00002870: 5f6f 6e5f 706f 7374 290a 0a20 2020 2020  _on_post)..     
-00002880: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-00002890: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
-000028a0: 656c 662e 7365 7373 696f 6e2e 7265 7175  elf.session.requ
-000028b0: 6573 7428 0a20 2020 2020 2020 2020 2020  est(.           
-000028c0: 2020 2020 206d 6574 686f 642c 2075 726c       method, url
-000028d0: 2c20 7469 6d65 6f75 743d 7469 6d65 6f75  , timeout=timeou
-000028e0: 742c 2076 6572 6966 793d 4661 6c73 652c  t, verify=False,
-000028f0: 202a 2a6b 770a 2020 2020 2020 2020 2020   **kw.          
-00002900: 2020 290a 2020 2020 2020 2020 6578 6365    ).        exce
-00002910: 7074 2072 6571 7565 7374 732e 5265 7175  pt requests.Requ
-00002920: 6573 7445 7863 6570 7469 6f6e 2061 7320  estException as 
-00002930: 6578 633a 0a20 2020 2020 2020 2020 2020  exc:.           
-00002940: 2065 7272 6f72 203d 2066 227b 6572 725f   error = f"{err_
-00002950: 746f 5f73 7472 2865 7863 297d 3a20 7b65  to_str(exc)}: {e
-00002960: 7272 6f72 7d22 2069 6620 6572 726f 7220  rror}" if error 
-00002970: 656c 7365 2065 7272 5f74 6f5f 7374 7228  else err_to_str(
-00002980: 6578 6329 0a20 2020 2020 2020 2020 2020  exc).           
-00002990: 2072 6169 7365 206d 6c72 756e 2e65 7272   raise mlrun.err
-000029a0: 6f72 732e 4d4c 5275 6e52 756e 7469 6d65  ors.MLRunRuntime
-000029b0: 4572 726f 7228 6572 726f 7229 2066 726f  Error(error) fro
-000029c0: 6d20 6578 630a 0a20 2020 2020 2020 2069  m exc..        i
-000029d0: 6620 6e6f 7420 7265 7370 6f6e 7365 2e6f  f not response.o
-000029e0: 6b3a 0a20 2020 2020 2020 2020 2020 2069  k:.            i
-000029f0: 6620 7265 7370 6f6e 7365 2e63 6f6e 7465  f response.conte
-00002a00: 6e74 3a0a 2020 2020 2020 2020 2020 2020  nt:.            
-00002a10: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-00002a20: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-00002a30: 6120 3d20 7265 7370 6f6e 7365 2e6a 736f  a = response.jso
-00002a40: 6e28 290a 2020 2020 2020 2020 2020 2020  n().            
-00002a50: 2020 2020 2020 2020 6572 726f 725f 6465          error_de
-00002a60: 7461 696c 7320 3d20 6461 7461 2e67 6574  tails = data.get
-00002a70: 2822 6465 7461 696c 222c 207b 7d29 0a20  ("detail", {}). 
-00002a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002a90: 2020 2069 6620 6e6f 7420 6572 726f 725f     if not error_
-00002aa0: 6465 7461 696c 733a 0a20 2020 2020 2020  details:.       
-00002ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002ac0: 206c 6f67 6765 722e 7761 726e 696e 6728   logger.warning(
-00002ad0: 2246 6169 6c65 6420 7061 7273 696e 6720  "Failed parsing 
-00002ae0: 6572 726f 7220 7265 7370 6f6e 7365 2062  error response b
-00002af0: 6f64 7922 2c20 6461 7461 3d64 6174 6129  ody", data=data)
-00002b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002b10: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
-00002b20: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
-00002b30: 2020 2020 2020 2065 7272 6f72 5f64 6574         error_det
-00002b40: 6169 6c73 203d 2022 220a 2020 2020 2020  ails = "".      
-00002b50: 2020 2020 2020 2020 2020 6966 2065 7272            if err
-00002b60: 6f72 5f64 6574 6169 6c73 3a0a 2020 2020  or_details:.    
+00000250: 0a69 6d70 6f72 7420 6a73 6f6e 0a69 6d70  .import json.imp
+00000260: 6f72 7420 7265 0a69 6d70 6f72 7420 7465  ort re.import te
+00000270: 6d70 6669 6c65 0a69 6d70 6f72 7420 7469  mpfile.import ti
+00000280: 6d65 0a69 6d70 6f72 7420 7472 6163 6562  me.import traceb
+00000290: 6163 6b0a 696d 706f 7274 2074 7970 696e  ack.import typin
+000002a0: 670a 6672 6f6d 2064 6174 6574 696d 6520  g.from datetime 
+000002b0: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
+000002c0: 6672 6f6d 206f 7320 696d 706f 7274 2070  from os import p
+000002d0: 6174 682c 2072 656d 6f76 650a 6672 6f6d  ath, remove.from
+000002e0: 2074 7970 696e 6720 696d 706f 7274 2044   typing import D
+000002f0: 6963 742c 204c 6973 742c 204f 7074 696f  ict, List, Optio
+00000300: 6e61 6c2c 2055 6e69 6f6e 0a66 726f 6d20  nal, Union.from 
+00000310: 7572 6c6c 6962 2e70 6172 7365 2069 6d70  urllib.parse imp
+00000320: 6f72 7420 7572 6c70 6172 7365 0a0a 696d  ort urlparse..im
+00000330: 706f 7274 206b 6670 0a69 6d70 6f72 7420  port kfp.import 
+00000340: 7265 7175 6573 7473 0a69 6d70 6f72 7420  requests.import 
+00000350: 7365 6d76 6572 0a0a 696d 706f 7274 206d  semver..import m
+00000360: 6c72 756e 0a69 6d70 6f72 7420 6d6c 7275  lrun.import mlru
+00000370: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+00000380: 0a69 6d70 6f72 7420 6d6c 7275 6e2e 6d6f  .import mlrun.mo
+00000390: 6465 6c5f 6d6f 6e69 746f 7269 6e67 2e6d  del_monitoring.m
+000003a0: 6f64 656c 5f65 6e64 706f 696e 740a 696d  odel_endpoint.im
+000003b0: 706f 7274 206d 6c72 756e 2e70 6c61 7466  port mlrun.platf
+000003c0: 6f72 6d73 0a69 6d70 6f72 7420 6d6c 7275  orms.import mlru
+000003d0: 6e2e 7072 6f6a 6563 7473 0a66 726f 6d20  n.projects.from 
+000003e0: 6d6c 7275 6e2e 6572 726f 7273 2069 6d70  mlrun.errors imp
+000003f0: 6f72 7420 4d4c 5275 6e49 6e76 616c 6964  ort MLRunInvalid
+00000400: 4172 6775 6d65 6e74 4572 726f 722c 2065  ArgumentError, e
+00000410: 7272 5f74 6f5f 7374 720a 0a66 726f 6d20  rr_to_str..from 
+00000420: 2e2e 6172 7469 6661 6374 7320 696d 706f  ..artifacts impo
+00000430: 7274 2041 7274 6966 6163 740a 6672 6f6d  rt Artifact.from
+00000440: 202e 2e63 6f6e 6669 6720 696d 706f 7274   ..config import
+00000450: 2063 6f6e 6669 670a 6672 6f6d 202e 2e64   config.from ..d
+00000460: 6174 6173 746f 7265 2e64 6174 6173 746f  atastore.datasto
+00000470: 7265 5f70 726f 6669 6c65 2069 6d70 6f72  re_profile impor
+00000480: 7420 4461 7461 7374 6f72 6550 726f 6669  t DatastoreProfi
+00000490: 6c65 324a 736f 6e0a 6672 6f6d 202e 2e66  le2Json.from ..f
+000004a0: 6561 7475 7265 5f73 746f 7265 2069 6d70  eature_store imp
+000004b0: 6f72 7420 4665 6174 7572 6553 6574 2c20  ort FeatureSet, 
+000004c0: 4665 6174 7572 6556 6563 746f 720a 6672  FeatureVector.fr
+000004d0: 6f6d 202e 2e6c 6973 7473 2069 6d70 6f72  om ..lists impor
+000004e0: 7420 4172 7469 6661 6374 4c69 7374 2c20  t ArtifactList, 
+000004f0: 5275 6e4c 6973 740a 6672 6f6d 202e 2e72  RunList.from ..r
+00000500: 756e 7469 6d65 7320 696d 706f 7274 2042  untimes import B
+00000510: 6173 6552 756e 7469 6d65 0a66 726f 6d20  aseRuntime.from 
+00000520: 2e2e 7574 696c 7320 696d 706f 7274 2028  ..utils import (
+00000530: 0a20 2020 2064 6174 6574 696d 655f 746f  .    datetime_to
+00000540: 5f69 736f 2c0a 2020 2020 6469 6374 5f74  _iso,.    dict_t
+00000550: 6f5f 6a73 6f6e 2c0a 2020 2020 6c6f 6767  o_json,.    logg
+00000560: 6572 2c0a 2020 2020 6e65 775f 7069 7065  er,.    new_pipe
+00000570: 5f6d 6574 6164 6174 612c 0a20 2020 206e  _metadata,.    n
+00000580: 6f72 6d61 6c69 7a65 5f6e 616d 652c 0a20  ormalize_name,. 
+00000590: 2020 2076 6572 7369 6f6e 2c0a 290a 6672     version,.).fr
+000005a0: 6f6d 202e 6261 7365 2069 6d70 6f72 7420  om .base import 
+000005b0: 5275 6e44 4245 7272 6f72 2c20 5275 6e44  RunDBError, RunD
+000005c0: 4249 6e74 6572 6661 6365 0a0a 5f61 7274  BInterface.._art
+000005d0: 6966 6163 745f 6b65 7973 203d 205b 0a20  ifact_keys = [. 
+000005e0: 2020 2022 666f 726d 6174 222c 0a20 2020     "format",.   
+000005f0: 2022 696e 6c69 6e65 222c 0a20 2020 2022   "inline",.    "
+00000600: 6b65 7922 2c0a 2020 2020 2273 7263 5f70  key",.    "src_p
+00000610: 6174 6822 2c0a 2020 2020 2274 6172 6765  ath",.    "targe
+00000620: 745f 7061 7468 222c 0a20 2020 2022 7669  t_path",.    "vi
+00000630: 6577 6572 222c 0a5d 0a0a 0a64 6566 2062  ewer",.]...def b
+00000640: 6f6f 6c32 7374 7228 7661 6c29 3a0a 2020  ool2str(val):.  
+00000650: 2020 7265 7475 726e 2022 7965 7322 2069    return "yes" i
+00000660: 6620 7661 6c20 656c 7365 2022 6e6f 220a  f val else "no".
+00000670: 0a0a 636c 6173 7320 4854 5450 5275 6e44  ..class HTTPRunD
+00000680: 4228 5275 6e44 4249 6e74 6572 6661 6365  B(RunDBInterface
+00000690: 293a 0a20 2020 2022 2222 496e 7465 7266  ):.    """Interf
+000006a0: 6163 6520 666f 7220 6163 6365 7373 696e  ace for accessin
+000006b0: 6720 616e 6420 6d61 6e69 7075 6c61 7469  g and manipulati
+000006c0: 6e67 2074 6865 203a 7079 3a6d 6f64 3a60  ng the :py:mod:`
+000006d0: 6d6c 7275 6e60 2070 6572 7369 7374 656e  mlrun` persisten
+000006e0: 7420 7374 6f72 652c 206d 6169 6e74 6169  t store, maintai
+000006f0: 6e69 6e67 2074 6865 2066 756c 6c20 7374  ning the full st
+00000700: 6174 650a 2020 2020 616e 6420 6361 7461  ate.    and cata
+00000710: 6c6f 6720 6f66 206f 626a 6563 7473 2074  log of objects t
+00000720: 6861 7420 4d4c 5275 6e20 7573 6573 2e20  hat MLRun uses. 
+00000730: 5468 6520 3a70 793a 636c 6173 733a 6048  The :py:class:`H
+00000740: 5454 5052 756e 4442 6020 636c 6173 7320  TTPRunDB` class 
+00000750: 7365 7276 6573 2061 7320 6120 636c 6965  serves as a clie
+00000760: 6e74 2d73 6964 6520 7072 6f78 7920 746f  nt-side proxy to
+00000770: 2074 6865 204d 4c52 756e 0a20 2020 2041   the MLRun.    A
+00000780: 5049 2073 6572 7669 6365 2077 6869 6368  PI service which
+00000790: 206d 6169 6e74 6169 6e73 2074 6865 2061   maintains the a
+000007a0: 6374 7561 6c20 6461 7461 2d73 746f 7265  ctual data-store
+000007b0: 2c20 6163 6365 7373 6573 2074 6865 2073  , accesses the s
+000007c0: 6572 7665 7220 7468 726f 7567 6820 5245  erver through RE
+000007d0: 5354 2041 5049 732e 0a0a 2020 2020 5468  ST APIs...    Th
+000007e0: 6520 636c 6173 7320 7072 6f76 6964 6573  e class provides
+000007f0: 2066 756e 6374 696f 6e73 2066 6f72 2061   functions for a
+00000800: 6363 6573 7369 6e67 2061 6e64 206d 6f64  ccessing and mod
+00000810: 6966 7969 6e67 2074 6865 2076 6172 696f  ifying the vario
+00000820: 7573 206f 626a 6563 7473 2074 6861 7420  us objects that 
+00000830: 6172 6520 7573 6564 2062 7920 4d4c 5275  are used by MLRu
+00000840: 6e20 696e 2069 7473 0a20 2020 206f 7065  n in its.    ope
+00000850: 7261 7469 6f6e 2e20 5468 6520 6675 6e63  ration. The func
+00000860: 7469 6f6e 7320 7072 6f76 6964 6564 2066  tions provided f
+00000870: 6f6c 6c6f 7720 736f 6d65 2073 7461 6e64  ollow some stand
+00000880: 6172 6420 6775 6964 656c 696e 6573 2c20  ard guidelines, 
+00000890: 7768 6963 6820 6172 653a 0a0a 2020 2020  which are:..    
+000008a0: 2d20 4576 6572 7920 6f62 6a65 6374 2069  - Every object i
+000008b0: 6e20 4d4c 5275 6e20 6578 6973 7473 2069  n MLRun exists i
+000008c0: 6e20 7468 6520 636f 6e74 6578 7420 6f66  n the context of
+000008d0: 2061 2070 726f 6a65 6374 2028 6578 6365   a project (exce
+000008e0: 7074 2070 726f 6a65 6374 7320 7468 656d  pt projects them
+000008f0: 7365 6c76 6573 292e 2057 6865 6e20 7265  selves). When re
+00000900: 6665 7265 6e63 696e 6720 616e 206f 626a  ferencing an obj
+00000910: 6563 740a 2020 2020 2020 7468 726f 7567  ect.      throug
+00000920: 6820 616e 7920 4150 492c 2061 2070 726f  h any API, a pro
+00000930: 6a65 6374 206e 616d 6520 6d75 7374 2062  ject name must b
+00000940: 6520 7072 6f76 6964 6564 2e20 5468 6520  e provided. The 
+00000950: 6465 6661 756c 7420 666f 7220 6d6f 7374  default for most
+00000960: 2041 5049 7320 6973 2066 6f72 2061 6e20   APIs is for an 
+00000970: 656d 7074 7920 7072 6f6a 6563 7420 6e61  empty project na
+00000980: 6d65 2c20 7768 6963 680a 2020 2020 2020  me, which.      
+00000990: 7769 6c6c 2062 6520 7265 706c 6163 6564  will be replaced
+000009a0: 2062 7920 7468 6520 6e61 6d65 206f 6620   by the name of 
+000009b0: 7468 6520 6465 6661 756c 7420 7072 6f6a  the default proj
+000009c0: 6563 7420 2875 7375 616c 6c79 2060 6064  ect (usually ``d
+000009d0: 6566 6175 6c74 6060 292e 2054 6865 7265  efault``). There
+000009e0: 666f 7265 2c20 6966 2070 6572 666f 726d  fore, if perform
+000009f0: 696e 6720 616e 2041 5049 2074 6f0a 2020  ing an API to.  
+00000a00: 2020 2020 6c69 7374 2066 756e 6374 696f      list functio
+00000a10: 6e73 2c20 666f 7220 6578 616d 706c 652c  ns, for example,
+00000a20: 2061 6e64 206e 6f74 2070 726f 7669 6469   and not providi
+00000a30: 6e67 2061 2070 726f 6a65 6374 206e 616d  ng a project nam
+00000a40: 6520 2d20 7468 6520 7265 7375 6c74 2077  e - the result w
+00000a50: 696c 6c20 6e6f 7420 6265 2066 756e 6374  ill not be funct
+00000a60: 696f 6e73 2066 726f 6d20 616c 6c0a 2020  ions from all.  
+00000a70: 2020 2020 7072 6f6a 6563 7473 2062 7574      projects but
+00000a80: 2072 6174 6865 7220 6672 6f6d 2074 6865   rather from the
+00000a90: 2060 6064 6566 6175 6c74 6060 2070 726f   ``default`` pro
+00000aa0: 6a65 6374 2e0a 2020 2020 2d20 4d61 6e79  ject..    - Many
+00000ab0: 206f 626a 6563 7473 2063 616e 2062 6520   objects can be 
+00000ac0: 6173 7369 676e 6564 206c 6162 656c 732c  assigned labels,
+00000ad0: 2061 6e64 206c 6973 7465 642f 7175 6572   and listed/quer
+00000ae0: 6965 6420 6279 206c 6162 656c 2e20 5468  ied by label. Th
+00000af0: 6520 6c61 6265 6c20 7061 7261 6d65 7465  e label paramete
+00000b00: 7220 666f 7220 7175 6572 7920 4150 4973  r for query APIs
+00000b10: 2061 6c6c 6f77 7320 666f 720a 2020 2020   allows for.    
+00000b20: 2020 6c69 7374 696e 6720 6f62 6a65 6374    listing object
+00000b30: 7320 7468 6174 3a0a 0a20 2020 2020 202d  s that:..      -
+00000b40: 2048 6176 6520 6120 7370 6563 6966 6963   Have a specific
+00000b50: 206c 6162 656c 2c20 6279 2061 736b 696e   label, by askin
+00000b60: 6720 666f 7220 6060 6c61 6265 6c3d 223c  g for ``label="<
+00000b70: 6c61 6265 6c5f 6e61 6d65 3e22 6060 2e20  label_name>"``. 
+00000b80: 496e 2074 6869 7320 6361 7365 2074 6865  In this case the
+00000b90: 2061 6374 7561 6c20 7661 6c75 6520 6f66   actual value of
+00000ba0: 2074 6865 206c 6162 656c 0a20 2020 2020   the label.     
+00000bb0: 2020 2064 6f65 736e 2774 206d 6174 7465     doesn't matte
+00000bc0: 7220 616e 6420 6576 6572 7920 6f62 6a65  r and every obje
+00000bd0: 6374 2077 6974 6820 7468 6174 206c 6162  ct with that lab
+00000be0: 656c 2077 696c 6c20 6265 2072 6574 7572  el will be retur
+00000bf0: 6e65 640a 2020 2020 2020 2d20 4861 7665  ned.      - Have
+00000c00: 2061 206c 6162 656c 2077 6974 6820 6120   a label with a 
+00000c10: 7370 6563 6966 6963 2076 616c 7565 2e20  specific value. 
+00000c20: 5468 6973 2069 7320 646f 6e65 2062 7920  This is done by 
+00000c30: 7370 6563 6966 7969 6e67 2060 606c 6162  specifying ``lab
+00000c40: 656c 3d22 3c6c 6162 656c 5f6e 616d 653e  el="<label_name>
+00000c50: 3d3c 6c61 6265 6c5f 7661 6c75 653e 2260  =<label_value>"`
+00000c60: 602e 2049 6e20 7468 6973 0a20 2020 2020  `. In this.     
+00000c70: 2020 2063 6173 6520 6f6e 6c79 206f 626a     case only obj
+00000c80: 6563 7473 2077 686f 7365 206c 6162 656c  ects whose label
+00000c90: 206d 6174 6368 6573 2074 6865 2076 616c   matches the val
+00000ca0: 7565 2077 696c 6c20 6265 2072 6574 7572  ue will be retur
+00000cb0: 6e65 640a 0a20 2020 202d 204d 6f73 7420  ned..    - Most 
+00000cc0: 6f62 6a65 6374 7320 6861 7665 2061 2060  objects have a `
+00000cd0: 6063 7265 6174 6560 6020 6d65 7468 6f64  `create`` method
+00000ce0: 2061 7320 7765 6c6c 2061 7320 6120 6060   as well as a ``
+00000cf0: 7374 6f72 6560 6020 6d65 7468 6f64 2e20  store`` method. 
+00000d00: 4372 6561 7465 2063 616e 206f 6e6c 7920  Create can only 
+00000d10: 6265 2063 616c 6c65 6420 7768 656e 2073  be called when s
+00000d20: 7563 6820 616e 0a20 2020 2020 2064 6f65  uch an.      doe
+00000d30: 7320 6e6f 7420 6578 6973 7420 7965 742c  s not exist yet,
+00000d40: 2077 6869 6c65 2073 746f 7265 2061 6c6c   while store all
+00000d50: 6f77 7320 666f 7220 6569 7468 6572 2063  ows for either c
+00000d60: 7265 6174 696e 6720 6120 6e65 7720 6f62  reating a new ob
+00000d70: 6a65 6374 206f 7220 6f76 6572 7772 6974  ject or overwrit
+00000d80: 696e 6720 616e 2065 7869 7374 696e 6720  ing an existing 
+00000d90: 6f62 6a65 6374 2e0a 2020 2020 2d20 536f  object..    - So
+00000da0: 6d65 206f 626a 6563 7473 2068 6176 6520  me objects have 
+00000db0: 6120 6060 7665 7273 696f 6e65 6460 6020  a ``versioned`` 
+00000dc0: 6f70 7469 6f6e 2c20 696e 2077 6869 6368  option, in which
+00000dd0: 2063 6173 6520 6f76 6572 7772 6974 696e   case overwritin
+00000de0: 6720 7468 6520 7361 6d65 206f 626a 6563  g the same objec
+00000df0: 7420 7769 7468 2061 2064 6966 6665 7265  t with a differe
+00000e00: 6e74 2076 6572 7369 6f6e 206f 660a 2020  nt version of.  
+00000e10: 2020 2020 6974 2064 6f65 7320 6e6f 7420      it does not 
+00000e20: 6465 6c65 7465 2074 6865 2070 7265 7669  delete the previ
+00000e30: 6f75 7320 7665 7273 696f 6e2c 2062 7574  ous version, but
+00000e40: 2072 6174 6865 7220 6372 6561 7465 7320   rather creates 
+00000e50: 6120 6e65 7720 7665 7273 696f 6e20 6f66  a new version of
+00000e60: 2074 6865 206f 626a 6563 7420 616e 6420   the object and 
+00000e70: 6b65 6570 7320 626f 7468 2076 6572 7369  keeps both versi
+00000e80: 6f6e 732e 0a20 2020 2020 2056 6572 7369  ons..      Versi
+00000e90: 6f6e 6564 206f 626a 6563 7473 2075 7375  oned objects usu
+00000ea0: 616c 6c79 2068 6176 6520 6120 6060 7569  ally have a ``ui
+00000eb0: 6460 6020 7072 6f70 6572 7479 2077 6869  d`` property whi
+00000ec0: 6368 2069 7320 6261 7365 6420 6f6e 2074  ch is based on t
+00000ed0: 6865 6972 2063 6f6e 7465 6e74 2061 6e64  heir content and
+00000ee0: 2061 6c6c 6f77 7320 746f 2072 6566 6572   allows to refer
+00000ef0: 656e 6365 2061 0a20 2020 2020 2073 7065  ence a.      spe
+00000f00: 6369 6669 6320 7665 7273 696f 6e20 6f66  cific version of
+00000f10: 2061 6e20 6f62 6a65 6374 2028 6f74 6865   an object (othe
+00000f20: 7220 7468 616e 2074 6167 6769 6e67 206f  r than tagging o
+00000f30: 626a 6563 7473 2c20 7768 6963 6820 616c  bjects, which al
+00000f40: 736f 2061 6c6c 6f77 7320 666f 7220 6561  so allows for ea
+00000f50: 7379 2072 6566 6572 656e 6369 6e67 292e  sy referencing).
+00000f60: 0a20 2020 202d 204d 616e 7920 6f62 6a65  .    - Many obje
+00000f70: 6374 7320 6861 7665 2062 6f74 6820 6120  cts have both a 
+00000f80: 6060 7374 6f72 6560 6020 6675 6e63 7469  ``store`` functi
+00000f90: 6f6e 2061 6e64 2061 2060 6070 6174 6368  on and a ``patch
+00000fa0: 6060 2066 756e 6374 696f 6e2e 2054 6865  `` function. The
+00000fb0: 7365 2061 7265 2075 7365 6420 696e 2074  se are used in t
+00000fc0: 6865 2073 616d 6520 7761 7920 6173 2074  he same way as t
+00000fd0: 6865 0a20 2020 2020 2063 6f72 7265 7370  he.      corresp
+00000fe0: 6f6e 6469 6e67 2052 4553 5420 7665 7262  onding REST verb
+00000ff0: 7320 2d20 6120 6060 7374 6f72 6560 6020  s - a ``store`` 
+00001000: 6973 2070 6173 7365 6420 6120 6675 6c6c  is passed a full
+00001010: 206f 626a 6563 7420 616e 6420 7769 6c6c   object and will
+00001020: 2062 6173 6963 616c 6c79 2070 6572 666f   basically perfo
+00001030: 726d 2061 2050 5554 206f 7065 7261 7469  rm a PUT operati
+00001040: 6f6e 2c0a 2020 2020 2020 7265 706c 6163  on,.      replac
+00001050: 696e 6720 7468 6520 6675 6c6c 206f 626a  ing the full obj
+00001060: 6563 7420 2869 6620 6974 2065 7869 7374  ect (if it exist
+00001070: 7329 2077 6869 6c65 2060 6070 6174 6368  s) while ``patch
+00001080: 6060 2072 6563 6569 7665 7320 6a75 7374  `` receives just
+00001090: 2061 2064 6963 7469 6f6e 6172 7920 636f   a dictionary co
+000010a0: 6e74 6169 6e69 6e67 2074 6865 2064 6966  ntaining the dif
+000010b0: 6665 7265 6e63 6573 2074 6f0a 2020 2020  ferences to.    
+000010c0: 2020 6265 2061 7070 6c69 6564 2074 6f20    be applied to 
+000010d0: 7468 6520 6f62 6a65 6374 2c20 616e 6420  the object, and 
+000010e0: 7769 6c6c 206d 6572 6765 2074 686f 7365  will merge those
+000010f0: 2063 6861 6e67 6573 2074 6f20 7468 6520   changes to the 
+00001100: 6578 6973 7469 6e67 206f 626a 6563 742e  existing object.
+00001110: 2054 6865 2060 6070 6174 6368 6060 0a20   The ``patch``. 
+00001120: 2020 2020 206f 7065 7261 7469 6f6e 2061       operation a
+00001130: 6c73 6f20 6861 7320 6120 7374 7261 7465  lso has a strate
+00001140: 6779 2061 7373 6967 6e65 6420 746f 2069  gy assigned to i
+00001150: 7420 7768 6963 6820 6465 7465 726d 696e  t which determin
+00001160: 6573 2068 6f77 2074 6865 206d 6572 6765  es how the merge
+00001170: 206c 6f67 6963 2073 686f 756c 6420 6265   logic should be
+00001180: 6861 7665 2e0a 2020 2020 2020 5468 6520  have..      The 
+00001190: 7374 7261 7465 6779 2063 616e 2062 6520  strategy can be 
+000011a0: 6569 7468 6572 2060 6072 6570 6c61 6365  either ``replace
+000011b0: 6060 206f 7220 6060 6164 6469 7469 7665  `` or ``additive
+000011c0: 6060 2e20 466f 7220 6675 7274 6865 7220  ``. For further 
+000011d0: 6465 7461 696c 7320 6f6e 2074 686f 7365  details on those
+000011e0: 2073 7472 6174 6567 6965 732c 2072 6566   strategies, ref
+000011f0: 6572 0a20 2020 2020 2074 6f20 6874 7470  er.      to http
+00001200: 733a 2f2f 7079 7069 2e6f 7267 2f70 726f  s://pypi.org/pro
+00001210: 6a65 6374 2f6d 6572 6765 6465 6570 2f0a  ject/mergedeep/.
+00001220: 2020 2020 2222 220a 0a20 2020 206b 696e      """..    kin
+00001230: 6420 3d20 2268 7474 7022 0a20 2020 2023  d = "http".    #
+00001240: 2062 7920 6465 6661 756c 7420 7765 2064   by default we d
+00001250: 6f6e 2774 2072 6574 7279 206f 6e20 504f  on't retry on PO
+00001260: 5354 2072 6571 7565 7374 2061 7320 7468  ST request as th
+00001270: 6579 2061 7265 2075 7375 616c 6c79 206e  ey are usually n
+00001280: 6f74 2069 6465 6d70 6f74 656e 740a 2020  ot idempotent.  
+00001290: 2020 2320 6865 7265 2069 7320 6120 6c69    # here is a li
+000012a0: 7374 206f 6620 6964 656e 7469 6669 6564  st of identified
+000012b0: 2050 4f53 5420 7265 7175 6573 7473 2074   POST requests t
+000012c0: 6861 7420 6172 6520 6964 656d 706f 7465  hat are idempote
+000012d0: 6e74 2028 2773 746f 7265 2720 7673 2027  nt ('store' vs '
+000012e0: 6372 6561 7465 2729 2061 6e64 2063 616e  create') and can
+000012f0: 2062 6520 7265 7472 6965 640a 2020 2020   be retried.    
+00001300: 5245 5452 4941 424c 455f 504f 5354 5f50  RETRIABLE_POST_P
+00001310: 4154 4853 203d 205b 0a20 2020 2020 2020  ATHS = [.       
+00001320: 2072 225c 2f3f 7072 6f6a 6563 7473 5c2f   r"\/?projects\/
+00001330: 2e2b 5c2f 6172 7469 6661 6374 735c 2f2e  .+\/artifacts\/.
+00001340: 2b5c 2f2e 2b22 2c0a 2020 2020 2020 2020  +\/.+",.        
+00001350: 7222 5c2f 3f72 756e 5c2f 2e2b 5c2f 2e2b  r"\/?run\/.+\/.+
+00001360: 222c 0a20 2020 205d 0a0a 2020 2020 6465  ",.    ]..    de
+00001370: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+00001380: 2075 726c 293a 0a20 2020 2020 2020 2073   url):.        s
+00001390: 656c 662e 7365 7276 6572 5f76 6572 7369  elf.server_versi
+000013a0: 6f6e 203d 2022 220a 2020 2020 2020 2020  on = "".        
+000013b0: 7365 6c66 2e73 6573 7369 6f6e 203d 204e  self.session = N
+000013c0: 6f6e 650a 2020 2020 2020 2020 7365 6c66  one.        self
+000013d0: 2e5f 7761 6974 5f66 6f72 5f70 726f 6a65  ._wait_for_proje
+000013e0: 6374 5f74 6572 6d69 6e61 6c5f 7374 6174  ct_terminal_stat
+000013f0: 655f 7265 7472 795f 696e 7465 7276 616c  e_retry_interval
+00001400: 203d 2033 0a20 2020 2020 2020 2073 656c   = 3.        sel
+00001410: 662e 5f77 6169 745f 666f 725f 6261 636b  f._wait_for_back
+00001420: 6772 6f75 6e64 5f74 6173 6b5f 7465 726d  ground_task_term
+00001430: 696e 616c 5f73 7461 7465 5f72 6574 7279  inal_state_retry
+00001440: 5f69 6e74 6572 7661 6c20 3d20 330a 2020  _interval = 3.  
+00001450: 2020 2020 2020 7365 6c66 2e5f 7761 6974        self._wait
+00001460: 5f66 6f72 5f70 726f 6a65 6374 5f64 656c  _for_project_del
+00001470: 6574 696f 6e5f 696e 7465 7276 616c 203d  etion_interval =
+00001480: 2033 0a20 2020 2020 2020 2073 656c 662e   3.        self.
+00001490: 636c 6965 6e74 5f76 6572 7369 6f6e 203d  client_version =
+000014a0: 2076 6572 7369 6f6e 2e56 6572 7369 6f6e   version.Version
+000014b0: 2829 2e67 6574 2829 5b22 7665 7273 696f  ().get()["versio
+000014c0: 6e22 5d0a 2020 2020 2020 2020 7365 6c66  n"].        self
+000014d0: 2e70 7974 686f 6e5f 7665 7273 696f 6e20  .python_version 
+000014e0: 3d20 7374 7228 7665 7273 696f 6e2e 5665  = str(version.Ve
+000014f0: 7273 696f 6e28 292e 6765 745f 7079 7468  rsion().get_pyth
+00001500: 6f6e 5f76 6572 7369 6f6e 2829 290a 0a20  on_version()).. 
+00001510: 2020 2020 2020 2073 656c 662e 5f65 6e72         self._enr
+00001520: 6963 685f 616e 645f 7661 6c69 6461 7465  ich_and_validate
+00001530: 2875 726c 290a 0a20 2020 2064 6566 205f  (url)..    def _
+00001540: 656e 7269 6368 5f61 6e64 5f76 616c 6964  enrich_and_valid
+00001550: 6174 6528 7365 6c66 2c20 7572 6c29 3a0a  ate(self, url):.
+00001560: 2020 2020 2020 2020 7061 7273 6564 5f75          parsed_u
+00001570: 726c 203d 2075 726c 7061 7273 6528 7572  rl = urlparse(ur
+00001580: 6c29 0a20 2020 2020 2020 2073 6368 656d  l).        schem
+00001590: 6520 3d20 7061 7273 6564 5f75 726c 2e73  e = parsed_url.s
+000015a0: 6368 656d 652e 6c6f 7765 7228 290a 2020  cheme.lower().  
+000015b0: 2020 2020 2020 6966 2073 6368 656d 6520        if scheme 
+000015c0: 6e6f 7420 696e 2028 2268 7474 7022 2c20  not in ("http", 
+000015d0: 2268 7474 7073 2229 3a0a 2020 2020 2020  "https"):.      
+000015e0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+000015f0: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00001600: 2020 2020 2020 2020 6622 496e 7661 6c69          f"Invali
+00001610: 6420 5552 4c20 7363 6865 6d65 207b 7363  d URL scheme {sc
+00001620: 6865 6d65 7d20 666f 7220 4854 5450 5275  heme} for HTTPRu
+00001630: 6e44 422c 206f 6e6c 7920 6874 7470 2873  nDB, only http(s
+00001640: 2920 6973 2073 7570 706f 7274 6564 220a  ) is supported".
+00001650: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00001660: 2020 2020 2020 2065 6e64 706f 696e 7420         endpoint 
+00001670: 3d20 7061 7273 6564 5f75 726c 2e68 6f73  = parsed_url.hos
+00001680: 746e 616d 650a 2020 2020 2020 2020 6966  tname.        if
+00001690: 2070 6172 7365 645f 7572 6c2e 706f 7274   parsed_url.port
+000016a0: 3a0a 2020 2020 2020 2020 2020 2020 656e  :.            en
+000016b0: 6470 6f69 6e74 202b 3d20 6622 3a7b 7061  dpoint += f":{pa
+000016c0: 7273 6564 5f75 726c 2e70 6f72 747d 220a  rsed_url.port}".
+000016d0: 2020 2020 2020 2020 6261 7365 5f75 726c          base_url
+000016e0: 203d 2066 227b 7061 7273 6564 5f75 726c   = f"{parsed_url
+000016f0: 2e73 6368 656d 657d 3a2f 2f7b 656e 6470  .scheme}://{endp
+00001700: 6f69 6e74 7d7b 7061 7273 6564 5f75 726c  oint}{parsed_url
+00001710: 2e70 6174 687d 220a 0a20 2020 2020 2020  .path}"..       
+00001720: 2075 7365 726e 616d 6520 3d20 7061 7273   username = pars
+00001730: 6564 5f75 726c 2e75 7365 726e 616d 6520  ed_url.username 
+00001740: 6f72 2063 6f6e 6669 672e 6874 7470 6462  or config.httpdb
+00001750: 2e75 7365 720a 2020 2020 2020 2020 7061  .user.        pa
+00001760: 7373 776f 7264 203d 2070 6172 7365 645f  ssword = parsed_
+00001770: 7572 6c2e 7061 7373 776f 7264 206f 7220  url.password or 
+00001780: 636f 6e66 6967 2e68 7474 7064 622e 7061  config.httpdb.pa
+00001790: 7373 776f 7264 0a0a 2020 2020 2020 2020  ssword..        
+000017a0: 7573 6572 6e61 6d65 2c20 7061 7373 776f  username, passwo
+000017b0: 7264 2c20 746f 6b65 6e20 3d20 6d6c 7275  rd, token = mlru
+000017c0: 6e2e 706c 6174 666f 726d 732e 6164 645f  n.platforms.add_
+000017d0: 6f72 5f72 6566 7265 7368 5f63 7265 6465  or_refresh_crede
+000017e0: 6e74 6961 6c73 280a 2020 2020 2020 2020  ntials(.        
+000017f0: 2020 2020 7061 7273 6564 5f75 726c 2e68      parsed_url.h
+00001800: 6f73 746e 616d 652c 2075 7365 726e 616d  ostname, usernam
+00001810: 652c 2070 6173 7377 6f72 642c 2063 6f6e  e, password, con
+00001820: 6669 672e 6874 7470 6462 2e74 6f6b 656e  fig.httpdb.token
+00001830: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00001840: 2020 2020 7365 6c66 2e62 6173 655f 7572      self.base_ur
+00001850: 6c20 3d20 6261 7365 5f75 726c 0a20 2020  l = base_url.   
+00001860: 2020 2020 2073 656c 662e 7573 6572 203d       self.user =
+00001870: 2075 7365 726e 616d 650a 2020 2020 2020   username.      
+00001880: 2020 7365 6c66 2e70 6173 7377 6f72 6420    self.password 
+00001890: 3d20 7061 7373 776f 7264 0a20 2020 2020  = password.     
+000018a0: 2020 2073 656c 662e 746f 6b65 6e20 3d20     self.token = 
+000018b0: 746f 6b65 6e0a 0a20 2020 2064 6566 205f  token..    def _
+000018c0: 5f72 6570 725f 5f28 7365 6c66 293a 0a20  _repr__(self):. 
+000018d0: 2020 2020 2020 2063 6c73 203d 2073 656c         cls = sel
+000018e0: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
+000018f0: 6d65 5f5f 0a20 2020 2020 2020 2072 6574  me__.        ret
+00001900: 7572 6e20 6622 7b63 6c73 7d28 7b73 656c  urn f"{cls}({sel
+00001910: 662e 6261 7365 5f75 726c 2172 7d29 220a  f.base_url!r})".
+00001920: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+00001930: 6f64 0a20 2020 2064 6566 2067 6574 5f61  od.    def get_a
+00001940: 7069 5f70 6174 685f 7072 6566 6978 2876  pi_path_prefix(v
+00001950: 6572 7369 6f6e 3a20 7374 7220 3d20 4e6f  ersion: str = No
+00001960: 6e65 2920 2d3e 2073 7472 3a0a 2020 2020  ne) -> str:.    
+00001970: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00001980: 3a70 6172 616d 2076 6572 7369 6f6e 3a20  :param version: 
+00001990: 4150 4920 7665 7273 696f 6e20 746f 2075  API version to u
+000019a0: 7365 2c20 4e6f 6e65 2028 7468 6520 6465  se, None (the de
+000019b0: 6661 756c 7429 2077 696c 6c20 6d65 616e  fault) will mean
+000019c0: 2074 6f20 7573 6520 7468 6520 6465 6661   to use the defa
+000019d0: 756c 7420 7661 6c75 6520 6672 6f6d 206d  ult value from m
+000019e0: 6c63 6f6e 662c 0a20 2020 2020 2020 2020  lconf,.         
+000019f0: 666f 7220 756e 2d76 6572 7369 6f6e 6564  for un-versioned
+00001a00: 2061 7069 2073 6574 2061 6e20 656d 7074   api set an empt
+00001a10: 7920 7374 7269 6e67 2e0a 2020 2020 2020  y string..      
+00001a20: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+00001a30: 2076 6572 7369 6f6e 2069 7320 6e6f 7420   version is not 
+00001a40: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00001a50: 2020 7265 7475 726e 2066 2261 7069 2f7b    return f"api/{
+00001a60: 7665 7273 696f 6e7d 2220 6966 2076 6572  version}" if ver
+00001a70: 7369 6f6e 2065 6c73 6520 2261 7069 220a  sion else "api".
+00001a80: 0a20 2020 2020 2020 2061 7069 5f76 6572  .        api_ver
+00001a90: 7369 6f6e 5f70 6174 6820 3d20 280a 2020  sion_path = (.  
+00001aa0: 2020 2020 2020 2020 2020 6622 6170 692f            f"api/
+00001ab0: 7b63 6f6e 6669 672e 6170 695f 6261 7365  {config.api_base
+00001ac0: 5f76 6572 7369 6f6e 7d22 2069 6620 636f  _version}" if co
+00001ad0: 6e66 6967 2e61 7069 5f62 6173 655f 7665  nfig.api_base_ve
+00001ae0: 7273 696f 6e20 656c 7365 2022 6170 6922  rsion else "api"
+00001af0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00001b00: 2020 2072 6574 7572 6e20 6170 695f 7665     return api_ve
+00001b10: 7273 696f 6e5f 7061 7468 0a0a 2020 2020  rsion_path..    
+00001b20: 6465 6620 6765 745f 6261 7365 5f61 7069  def get_base_api
+00001b30: 5f75 726c 2873 656c 662c 2070 6174 683a  _url(self, path:
+00001b40: 2073 7472 2c20 7665 7273 696f 6e3a 2073   str, version: s
+00001b50: 7472 203d 204e 6f6e 6529 202d 3e20 7374  tr = None) -> st
+00001b60: 723a 0a20 2020 2020 2020 2070 6174 685f  r:.        path_
+00001b70: 7072 6566 6978 203d 2073 656c 662e 6765  prefix = self.ge
+00001b80: 745f 6170 695f 7061 7468 5f70 7265 6669  t_api_path_prefi
+00001b90: 7828 7665 7273 696f 6e29 0a20 2020 2020  x(version).     
+00001ba0: 2020 2075 726c 203d 2066 227b 7365 6c66     url = f"{self
+00001bb0: 2e62 6173 655f 7572 6c7d 2f7b 7061 7468  .base_url}/{path
+00001bc0: 5f70 7265 6669 787d 2f7b 7061 7468 7d22  _prefix}/{path}"
+00001bd0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00001be0: 7572 6c0a 0a20 2020 2064 6566 2061 7069  url..    def api
+00001bf0: 5f63 616c 6c28 0a20 2020 2020 2020 2073  _call(.        s
+00001c00: 656c 662c 0a20 2020 2020 2020 206d 6574  elf,.        met
+00001c10: 686f 642c 0a20 2020 2020 2020 2070 6174  hod,.        pat
+00001c20: 682c 0a20 2020 2020 2020 2065 7272 6f72  h,.        error
+00001c30: 3d4e 6f6e 652c 0a20 2020 2020 2020 2070  =None,.        p
+00001c40: 6172 616d 733d 4e6f 6e65 2c0a 2020 2020  arams=None,.    
+00001c50: 2020 2020 626f 6479 3d4e 6f6e 652c 0a20      body=None,. 
+00001c60: 2020 2020 2020 206a 736f 6e3d 4e6f 6e65         json=None
+00001c70: 2c0a 2020 2020 2020 2020 6865 6164 6572  ,.        header
+00001c80: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
+00001c90: 7469 6d65 6f75 743d 3435 2c0a 2020 2020  timeout=45,.    
+00001ca0: 2020 2020 7665 7273 696f 6e3d 4e6f 6e65      version=None
+00001cb0: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+00001cc0: 2022 2222 5065 7266 6f72 6d20 6120 6469   """Perform a di
+00001cd0: 7265 6374 2052 4553 5420 4150 4920 6361  rect REST API ca
+00001ce0: 6c6c 206f 6e20 7468 6520 3a70 793a 6d6f  ll on the :py:mo
+00001cf0: 643a 606d 6c72 756e 6020 4150 4920 7365  d:`mlrun` API se
+00001d00: 7276 6572 2e0a 0a20 2020 2020 2020 2043  rver...        C
+00001d10: 6175 7469 6f6e 3a0a 2020 2020 2020 2020  aution:.        
+00001d20: 2020 2020 466f 7220 6164 7661 6e63 6564      For advanced
+00001d30: 2075 7361 6765 202d 2070 7265 6665 7220   usage - prefer 
+00001d40: 7573 696e 6720 7468 6520 7661 7269 6f75  using the variou
+00001d50: 7320 4150 4973 2065 7870 6f73 6564 2074  s APIs exposed t
+00001d60: 6872 6f75 6768 2074 6869 7320 636c 6173  hrough this clas
+00001d70: 732c 2072 6174 6865 7220 7468 616e 0a20  s, rather than. 
+00001d80: 2020 2020 2020 2020 2020 2064 6972 6563             direc
+00001d90: 746c 7920 696e 766f 6b69 6e67 2052 4553  tly invoking RES
+00001da0: 5420 6361 6c6c 732e 0a0a 2020 2020 2020  T calls...      
+00001db0: 2020 3a70 6172 616d 206d 6574 686f 643a    :param method:
+00001dc0: 2052 4553 5420 6d65 7468 6f64 2028 504f   REST method (PO
+00001dd0: 5354 2c20 4745 542c 2050 5554 2e2e 2e29  ST, GET, PUT...)
+00001de0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00001df0: 7061 7468 3a20 5061 7468 2074 6f20 656e  path: Path to en
+00001e00: 6470 6f69 6e74 2065 7865 6375 7465 642c  dpoint executed,
+00001e10: 2066 6f72 2065 7861 6d70 6c65 2060 6022   for example ``"
+00001e20: 7072 6f6a 6563 7473 2260 600a 2020 2020  projects"``.    
+00001e30: 2020 2020 3a70 6172 616d 2065 7272 6f72      :param error
+00001e40: 3a20 4572 726f 7220 746f 2072 6574 7572  : Error to retur
+00001e50: 6e20 6966 2041 5049 2069 6e76 6f63 6174  n if API invocat
+00001e60: 696f 6e20 6661 696c 730a 2020 2020 2020  ion fails.      
+00001e70: 2020 3a70 6172 616d 2070 6172 616d 733a    :param params:
+00001e80: 2052 6573 7420 7061 7261 6d65 7465 7273   Rest parameters
+00001e90: 2c20 7061 7373 6564 2061 7320 6120 6469  , passed as a di
+00001ea0: 6374 696f 6e61 7279 3a20 6060 7b22 3c70  ctionary: ``{"<p
+00001eb0: 6172 616d 2d6e 616d 653e 223a 203c 2270  aram-name>": <"p
+00001ec0: 6172 616d 2d76 616c 7565 223e 7d60 600a  aram-value">}``.
+00001ed0: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
+00001ee0: 6f64 793a 2050 6179 6c6f 6164 2074 6f20  ody: Payload to 
+00001ef0: 6265 2070 6173 7365 6420 696e 2074 6865  be passed in the
+00001f00: 2063 616c 6c2e 2049 6620 7573 696e 6720   call. If using 
+00001f10: 4a53 4f4e 206f 626a 6563 7473 2c20 7072  JSON objects, pr
+00001f20: 6566 6572 2075 7369 6e67 2074 6865 2060  efer using the `
+00001f30: 606a 736f 6e60 6020 7061 7261 6d0a 2020  `json`` param.  
+00001f40: 2020 2020 2020 3a70 6172 616d 206a 736f        :param jso
+00001f50: 6e3a 204a 534f 4e20 7061 796c 6f61 6420  n: JSON payload 
+00001f60: 746f 2062 6520 7061 7373 6564 2069 6e20  to be passed in 
+00001f70: 7468 6520 6361 6c6c 0a20 2020 2020 2020  the call.       
+00001f80: 203a 7061 7261 6d20 6865 6164 6572 733a   :param headers:
+00001f90: 2052 4553 5420 6865 6164 6572 732c 2070   REST headers, p
+00001fa0: 6173 7365 6420 6173 2061 2064 6963 7469  assed as a dicti
+00001fb0: 6f6e 6172 793a 2060 607b 223c 6865 6164  onary: ``{"<head
+00001fc0: 6572 2d6e 616d 653e 223a 2022 3c68 6561  er-name>": "<hea
+00001fd0: 6465 722d 7661 6c75 653e 227d 6060 0a20  der-value>"}``. 
+00001fe0: 2020 2020 2020 203a 7061 7261 6d20 7469         :param ti
+00001ff0: 6d65 6f75 743a 2041 5049 2063 616c 6c20  meout: API call 
+00002000: 7469 6d65 6f75 740a 2020 2020 2020 2020  timeout.        
+00002010: 3a70 6172 616d 2076 6572 7369 6f6e 3a20  :param version: 
+00002020: 4150 4920 7665 7273 696f 6e20 746f 2075  API version to u
+00002030: 7365 2c20 4e6f 6e65 2028 7468 6520 6465  se, None (the de
+00002040: 6661 756c 7429 2077 696c 6c20 6d65 616e  fault) will mean
+00002050: 2074 6f20 7573 6520 7468 6520 6465 6661   to use the defa
+00002060: 756c 7420 7661 6c75 6520 6672 6f6d 2063  ult value from c
+00002070: 6f6e 6669 672c 0a20 2020 2020 2020 2020  onfig,.         
+00002080: 666f 7220 756e 2d76 6572 7369 6f6e 6564  for un-versioned
+00002090: 2061 7069 2073 6574 2061 6e20 656d 7074   api set an empt
+000020a0: 7920 7374 7269 6e67 2e0a 0a20 2020 2020  y string...     
+000020b0: 2020 203a 7265 7475 726e 3a20 5079 7468     :return: Pyth
+000020c0: 6f6e 2048 5454 5020 7265 7370 6f6e 7365  on HTTP response
+000020d0: 206f 626a 6563 740a 2020 2020 2020 2020   object.        
+000020e0: 2222 220a 2020 2020 2020 2020 7572 6c20  """.        url 
+000020f0: 3d20 7365 6c66 2e67 6574 5f62 6173 655f  = self.get_base_
+00002100: 6170 695f 7572 6c28 7061 7468 2c20 7665  api_url(path, ve
+00002110: 7273 696f 6e29 0a20 2020 2020 2020 206b  rsion).        k
+00002120: 7720 3d20 7b0a 2020 2020 2020 2020 2020  w = {.          
+00002130: 2020 6b65 793a 2076 616c 7565 0a20 2020    key: value.   
+00002140: 2020 2020 2020 2020 2066 6f72 206b 6579           for key
+00002150: 2c20 7661 6c75 6520 696e 2028 0a20 2020  , value in (.   
+00002160: 2020 2020 2020 2020 2020 2020 2028 2270               ("p
+00002170: 6172 616d 7322 2c20 7061 7261 6d73 292c  arams", params),
+00002180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002190: 2028 2264 6174 6122 2c20 626f 6479 292c   ("data", body),
+000021a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000021b0: 2028 226a 736f 6e22 2c20 6a73 6f6e 292c   ("json", json),
+000021c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000021d0: 2028 2268 6561 6465 7273 222c 2068 6561   ("headers", hea
+000021e0: 6465 7273 292c 0a20 2020 2020 2020 2020  ders),.         
+000021f0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00002200: 2069 6620 7661 6c75 6520 6973 206e 6f74   if value is not
+00002210: 204e 6f6e 650a 2020 2020 2020 2020 7d0a   None.        }.
+00002220: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00002230: 2e75 7365 723a 0a20 2020 2020 2020 2020  .user:.         
+00002240: 2020 206b 775b 2261 7574 6822 5d20 3d20     kw["auth"] = 
+00002250: 2873 656c 662e 7573 6572 2c20 7365 6c66  (self.user, self
+00002260: 2e70 6173 7377 6f72 6429 0a20 2020 2020  .password).     
+00002270: 2020 2065 6c69 6620 7365 6c66 2e74 6f6b     elif self.tok
+00002280: 656e 3a0a 2020 2020 2020 2020 2020 2020  en:.            
+00002290: 2320 4967 7561 7a69 6f20 6175 7468 2064  # Iguazio auth d
+000022a0: 6f65 736e 2774 2073 7570 706f 7274 2070  oesn't support p
+000022b0: 6173 7369 6e67 2074 6f6b 656e 2074 6872  assing token thr
+000022c0: 6f75 6768 2062 6561 7265 722c 2073 6f20  ough bearer, so 
+000022d0: 7573 6520 636f 6f6b 6965 2069 6e73 7465  use cookie inste
+000022e0: 6164 0a20 2020 2020 2020 2020 2020 2069  ad.            i
+000022f0: 6620 6d6c 7275 6e2e 706c 6174 666f 726d  f mlrun.platform
+00002300: 732e 6967 7561 7a69 6f2e 6973 5f69 6775  s.iguazio.is_igu
+00002310: 617a 696f 5f73 6573 7369 6f6e 2873 656c  azio_session(sel
+00002320: 662e 746f 6b65 6e29 3a0a 2020 2020 2020  f.token):.      
+00002330: 2020 2020 2020 2020 2020 7365 7373 696f            sessio
+00002340: 6e5f 636f 6f6b 6965 203d 2066 276a 3a7b  n_cookie = f'j:{
+00002350: 7b22 7369 6422 3a20 227b 7365 6c66 2e74  {"sid": "{self.t
+00002360: 6f6b 656e 7d22 7d7d 270a 2020 2020 2020  oken}"}}'.      
+00002370: 2020 2020 2020 2020 2020 636f 6f6b 6965            cookie
+00002380: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+00002390: 2020 2020 2020 2020 2020 2273 6573 7369            "sessi
+000023a0: 6f6e 223a 2073 6573 7369 6f6e 5f63 6f6f  on": session_coo
+000023b0: 6b69 652c 0a20 2020 2020 2020 2020 2020  kie,.           
+000023c0: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
+000023d0: 2020 2020 2020 206b 775b 2263 6f6f 6b69         kw["cooki
+000023e0: 6573 225d 203d 2063 6f6f 6b69 6573 0a20  es"] = cookies. 
+000023f0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00002400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002410: 2069 6620 2241 7574 686f 7269 7a61 7469   if "Authorizati
+00002420: 6f6e 2220 6e6f 7420 696e 206b 772e 7365  on" not in kw.se
+00002430: 7464 6566 6175 6c74 2822 6865 6164 6572  tdefault("header
+00002440: 7322 2c20 7b7d 293a 0a20 2020 2020 2020  s", {}):.       
+00002450: 2020 2020 2020 2020 2020 2020 206b 775b               kw[
+00002460: 2268 6561 6465 7273 225d 2e75 7064 6174  "headers"].updat
+00002470: 6528 7b22 4175 7468 6f72 697a 6174 696f  e({"Authorizatio
+00002480: 6e22 3a20 2242 6561 7265 7220 2220 2b20  n": "Bearer " + 
+00002490: 7365 6c66 2e74 6f6b 656e 7d29 0a0a 2020  self.token})..  
+000024a0: 2020 2020 2020 6966 206d 6c72 756e 2e63        if mlrun.c
+000024b0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4865  ommon.schemas.He
+000024c0: 6164 6572 4e61 6d65 732e 636c 6965 6e74  aderNames.client
+000024d0: 5f76 6572 7369 6f6e 206e 6f74 2069 6e20  _version not in 
+000024e0: 6b77 2e73 6574 6465 6661 756c 7428 0a20  kw.setdefault(. 
+000024f0: 2020 2020 2020 2020 2020 2022 6865 6164             "head
+00002500: 6572 7322 2c20 7b7d 0a20 2020 2020 2020  ers", {}.       
+00002510: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+00002520: 6b77 5b22 6865 6164 6572 7322 5d2e 7570  kw["headers"].up
+00002530: 6461 7465 280a 2020 2020 2020 2020 2020  date(.          
+00002540: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+00002550: 2020 2020 2020 2020 2020 2020 6d6c 7275              mlru
+00002560: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+00002570: 2e48 6561 6465 724e 616d 6573 2e63 6c69  .HeaderNames.cli
+00002580: 656e 745f 7665 7273 696f 6e3a 2073 656c  ent_version: sel
+00002590: 662e 636c 6965 6e74 5f76 6572 7369 6f6e  f.client_version
+000025a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000025b0: 2020 2020 2020 6d6c 7275 6e2e 636f 6d6d        mlrun.comm
+000025c0: 6f6e 2e73 6368 656d 6173 2e48 6561 6465  on.schemas.Heade
+000025d0: 724e 616d 6573 2e70 7974 686f 6e5f 7665  rNames.python_ve
+000025e0: 7273 696f 6e3a 2073 656c 662e 7079 7468  rsion: self.pyth
+000025f0: 6f6e 5f76 6572 7369 6f6e 2c0a 2020 2020  on_version,.    
+00002600: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+00002610: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00002620: 2020 2020 2023 2072 6571 7565 7374 7320       # requests 
+00002630: 6e6f 206c 6f6e 6765 7220 7375 7070 6f72  no longer suppor
+00002640: 7473 2068 6561 6465 7220 7661 6c75 6573  ts header values
+00002650: 2074 6f20 6265 2065 6e75 6d20 2868 7474   to be enum (htt
+00002660: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
+00002670: 7073 662f 7265 7175 6573 7473 2f70 756c  psf/requests/pul
+00002680: 6c2f 3631 3534 290a 2020 2020 2020 2020  l/6154).        
+00002690: 2320 636f 6e76 6572 7420 746f 2073 7472  # convert to str
+000026a0: 696e 6773 2e20 446f 2074 6865 2073 616d  ings. Do the sam
+000026b0: 6520 666f 7220 7061 7261 6d73 2066 6f72  e for params for
+000026c0: 206e 6963 656e 6573 730a 2020 2020 2020   niceness.      
+000026d0: 2020 666f 7220 6469 6374 5f20 696e 205b    for dict_ in [
+000026e0: 6865 6164 6572 732c 2070 6172 616d 735d  headers, params]
+000026f0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00002700: 2064 6963 745f 2069 7320 6e6f 7420 4e6f   dict_ is not No
+00002710: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00002720: 2020 2020 666f 7220 6b65 7920 696e 2064      for key in d
+00002730: 6963 745f 2e6b 6579 7328 293a 0a20 2020  ict_.keys():.   
+00002740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002750: 2069 6620 6973 696e 7374 616e 6365 2864   if isinstance(d
+00002760: 6963 745f 5b6b 6579 5d2c 2065 6e75 6d2e  ict_[key], enum.
+00002770: 456e 756d 293a 0a20 2020 2020 2020 2020  Enum):.         
+00002780: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00002790: 6963 745f 5b6b 6579 5d20 3d20 6469 6374  ict_[key] = dict
+000027a0: 5f5b 6b65 795d 2e76 616c 7565 0a0a 2020  _[key].value..  
+000027b0: 2020 2020 2020 2320 6966 2074 6865 206d        # if the m
+000027c0: 6574 686f 6420 6973 2050 4f53 542c 2077  ethod is POST, w
+000027d0: 6520 6e65 6564 2074 6f20 7570 6461 7465  e need to update
+000027e0: 2074 6865 2073 6573 7369 6f6e 2077 6974   the session wit
+000027f0: 6820 7468 6520 6170 7072 6f70 7269 6174  h the appropriat
+00002800: 6520 7265 7472 7920 706f 6c69 6379 0a20  e retry policy. 
+00002810: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
+00002820: 6c66 2e73 6573 7369 6f6e 206f 7220 6d65  lf.session or me
+00002830: 7468 6f64 203d 3d20 2250 4f53 5422 3a0a  thod == "POST":.
+00002840: 2020 2020 2020 2020 2020 2020 7265 7472              retr
+00002850: 795f 6f6e 5f70 6f73 7420 3d20 7365 6c66  y_on_post = self
+00002860: 2e5f 6973 5f72 6574 7279 5f6f 6e5f 706f  ._is_retry_on_po
+00002870: 7374 5f61 6c6c 6f77 6564 286d 6574 686f  st_allowed(metho
+00002880: 642c 2070 6174 6829 0a20 2020 2020 2020  d, path).       
+00002890: 2020 2020 2073 656c 662e 7365 7373 696f       self.sessio
+000028a0: 6e20 3d20 7365 6c66 2e5f 696e 6974 5f73  n = self._init_s
+000028b0: 6573 7369 6f6e 2872 6574 7279 5f6f 6e5f  ession(retry_on_
+000028c0: 706f 7374 290a 0a20 2020 2020 2020 2074  post)..        t
+000028d0: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+000028e0: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
+000028f0: 7365 7373 696f 6e2e 7265 7175 6573 7428  session.request(
+00002900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002910: 206d 6574 686f 642c 2075 726c 2c20 7469   method, url, ti
+00002920: 6d65 6f75 743d 7469 6d65 6f75 742c 2076  meout=timeout, v
+00002930: 6572 6966 793d 4661 6c73 652c 202a 2a6b  erify=False, **k
+00002940: 770a 2020 2020 2020 2020 2020 2020 290a  w.            ).
+00002950: 2020 2020 2020 2020 6578 6365 7074 2072          except r
+00002960: 6571 7565 7374 732e 5265 7175 6573 7445  equests.RequestE
+00002970: 7863 6570 7469 6f6e 2061 7320 6578 633a  xception as exc:
+00002980: 0a20 2020 2020 2020 2020 2020 2065 7272  .            err
+00002990: 6f72 203d 2066 227b 6572 725f 746f 5f73  or = f"{err_to_s
+000029a0: 7472 2865 7863 297d 3a20 7b65 7272 6f72  tr(exc)}: {error
+000029b0: 7d22 2069 6620 6572 726f 7220 656c 7365  }" if error else
+000029c0: 2065 7272 5f74 6f5f 7374 7228 6578 6329   err_to_str(exc)
+000029d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+000029e0: 7365 206d 6c72 756e 2e65 7272 6f72 732e  se mlrun.errors.
+000029f0: 4d4c 5275 6e52 756e 7469 6d65 4572 726f  MLRunRuntimeErro
+00002a00: 7228 6572 726f 7229 2066 726f 6d20 6578  r(error) from ex
+00002a10: 630a 0a20 2020 2020 2020 2069 6620 6e6f  c..        if no
+00002a20: 7420 7265 7370 6f6e 7365 2e6f 6b3a 0a20  t response.ok:. 
+00002a30: 2020 2020 2020 2020 2020 2069 6620 7265             if re
+00002a40: 7370 6f6e 7365 2e63 6f6e 7465 6e74 3a0a  sponse.content:.
+00002a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002a60: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00002a70: 2020 2020 2020 2020 2064 6174 6120 3d20           data = 
+00002a80: 7265 7370 6f6e 7365 2e6a 736f 6e28 290a  response.json().
+00002a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002aa0: 2020 2020 6572 726f 725f 6465 7461 696c      error_detail
+00002ab0: 7320 3d20 6461 7461 2e67 6574 2822 6465  s = data.get("de
+00002ac0: 7461 696c 222c 207b 7d29 0a20 2020 2020  tail", {}).     
+00002ad0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00002ae0: 6620 6e6f 7420 6572 726f 725f 6465 7461  f not error_deta
+00002af0: 696c 733a 0a20 2020 2020 2020 2020 2020  ils:.           
+00002b00: 2020 2020 2020 2020 2020 2020 206c 6f67               log
+00002b10: 6765 722e 7761 726e 696e 6728 2246 6169  ger.warning("Fai
+00002b20: 6c65 6420 7061 7273 696e 6720 6572 726f  led parsing erro
+00002b30: 7220 7265 7370 6f6e 7365 2062 6f64 7922  r response body"
+00002b40: 2c20 6461 7461 3d64 6174 6129 0a20 2020  , data=data).   
+00002b50: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+00002b60: 6570 7420 4578 6365 7074 696f 6e3a 0a20  ept Exception:. 
 00002b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002b80: 6572 726f 725f 6465 7461 696c 7320 3d20  error_details = 
-00002b90: 6622 6465 7461 696c 733a 207b 6572 726f  f"details: {erro
-00002ba0: 725f 6465 7461 696c 737d 220a 2020 2020  r_details}".    
-00002bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002bc0: 6572 726f 7220 3d20 6622 7b65 7272 6f72  error = f"{error
-00002bd0: 7d20 7b65 7272 6f72 5f64 6574 6169 6c73  } {error_details
-00002be0: 7d22 2069 6620 6572 726f 7220 656c 7365  }" if error else
-00002bf0: 2065 7272 6f72 5f64 6574 6169 6c73 0a20   error_details. 
-00002c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c10: 2020 206d 6c72 756e 2e65 7272 6f72 732e     mlrun.errors.
-00002c20: 7261 6973 655f 666f 725f 7374 6174 7573  raise_for_status
-00002c30: 2872 6573 706f 6e73 652c 2065 7272 6f72  (response, error
-00002c40: 290a 0a20 2020 2020 2020 2020 2020 206d  )..            m
-00002c50: 6c72 756e 2e65 7272 6f72 732e 7261 6973  lrun.errors.rais
-00002c60: 655f 666f 725f 7374 6174 7573 2872 6573  e_for_status(res
-00002c70: 706f 6e73 652c 2065 7272 6f72 290a 0a20  ponse, error).. 
-00002c80: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-00002c90: 7370 6f6e 7365 0a0a 2020 2020 6465 6620  sponse..    def 
-00002ca0: 5f69 6e69 745f 7365 7373 696f 6e28 7365  _init_session(se
-00002cb0: 6c66 2c20 7265 7472 795f 6f6e 5f70 6f73  lf, retry_on_pos
-00002cc0: 743a 2062 6f6f 6c20 3d20 4661 6c73 6529  t: bool = False)
-00002cd0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00002ce0: 206d 6c72 756e 2e75 7469 6c73 2e48 5454   mlrun.utils.HTT
-00002cf0: 5053 6573 7369 6f6e 5769 7468 5265 7472  PSessionWithRetr
-00002d00: 7928 0a20 2020 2020 2020 2020 2020 2072  y(.            r
-00002d10: 6574 7279 5f6f 6e5f 6578 6365 7074 696f  etry_on_exceptio
-00002d20: 6e3d 636f 6e66 6967 2e68 7474 7064 622e  n=config.httpdb.
-00002d30: 7265 7472 795f 6170 695f 6361 6c6c 5f6f  retry_api_call_o
-00002d40: 6e5f 6578 6365 7074 696f 6e0a 2020 2020  n_exception.    
-00002d50: 2020 2020 2020 2020 3d3d 206d 6c72 756e          == mlrun
-00002d60: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00002d70: 4854 5450 5365 7373 696f 6e52 6574 7279  HTTPSessionRetry
-00002d80: 4d6f 6465 2e65 6e61 626c 6564 2e76 616c  Mode.enabled.val
-00002d90: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-00002da0: 7265 7472 795f 6f6e 5f70 6f73 743d 7265  retry_on_post=re
-00002db0: 7472 795f 6f6e 5f70 6f73 742c 0a20 2020  try_on_post,.   
-00002dc0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-00002dd0: 5f70 6174 685f 6f66 2873 656c 662c 2070  _path_of(self, p
-00002de0: 7265 6669 782c 2070 726f 6a65 6374 2c20  refix, project, 
-00002df0: 7569 6429 3a0a 2020 2020 2020 2020 7072  uid):.        pr
-00002e00: 6f6a 6563 7420 3d20 7072 6f6a 6563 7420  oject = project 
-00002e10: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
-00002e20: 745f 7072 6f6a 6563 740a 2020 2020 2020  t_project.      
-00002e30: 2020 7265 7475 726e 2066 227b 7072 6566    return f"{pref
-00002e40: 6978 7d2f 7b70 726f 6a65 6374 7d2f 7b75  ix}/{project}/{u
-00002e50: 6964 7d22 0a0a 2020 2020 6465 6620 5f69  id}"..    def _i
-00002e60: 735f 7265 7472 795f 6f6e 5f70 6f73 745f  s_retry_on_post_
-00002e70: 616c 6c6f 7765 6428 7365 6c66 2c20 6d65  allowed(self, me
-00002e80: 7468 6f64 2c20 7061 7468 3a20 7374 7229  thod, path: str)
-00002e90: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00002ea0: 2020 2020 2020 4368 6563 6b20 6966 2074        Check if t
-00002eb0: 6865 2067 6976 656e 2070 6174 6820 6973  he given path is
-00002ec0: 2061 6c6c 6f77 6564 2074 6f20 6265 2072   allowed to be r
-00002ed0: 6574 7269 6564 206f 6e20 504f 5354 206d  etried on POST m
-00002ee0: 6574 686f 640a 2020 2020 2020 2020 3a70  ethod.        :p
-00002ef0: 6172 616d 206d 6574 686f 643a 2020 7573  aram method:  us
-00002f00: 6564 2074 6f20 7665 7269 6679 2074 6861  ed to verify tha
-00002f10: 7420 7468 6520 6d65 7468 6f64 2069 7320  t the method is 
-00002f20: 504f 5354 2073 696e 6365 2069 6620 7468  POST since if th
-00002f30: 6572 6520 6973 206e 6f20 7365 7373 696f  ere is no sessio
-00002f40: 6e20 696e 6974 6961 6c69 7a65 6420 7468  n initialized th
-00002f50: 6572 6520 6973 206e 6f0a 2020 2020 2020  ere is no.      
-00002f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002f70: 2020 6e65 6564 2074 6f20 696e 6974 6961    need to initia
-00002f80: 6c69 7a65 2069 7420 7769 7468 2072 6574  lize it with ret
-00002f90: 7279 2070 6f6c 6963 7920 666f 7220 504f  ry policy for PO
-00002fa0: 5354 2077 6865 6e20 7468 6520 6d65 7468  ST when the meth
-00002fb0: 6f64 2069 7320 6e6f 7420 504f 5354 0a20  od is not POST. 
-00002fc0: 2020 2020 2020 203a 7061 7261 6d20 7061         :param pa
-00002fd0: 7468 3a20 2020 2074 6865 2070 6174 6820  th:    the path 
-00002fe0: 746f 2063 6865 636b 0a20 2020 2020 2020  to check.       
-00002ff0: 203a 7265 7475 726e 3a20 2020 2020 2020   :return:       
-00003000: 2054 7275 6520 6966 2074 6865 2070 6174   True if the pat
-00003010: 6820 6973 2061 6c6c 6f77 6564 2074 6f20  h is allowed to 
-00003020: 6265 2072 6574 7269 6564 206f 6e20 504f  be retried on PO
-00003030: 5354 206d 6574 686f 6420 616e 6420 6d65  ST method and me
-00003040: 7468 6f64 2069 7320 504f 5354 2c20 4661  thod is POST, Fa
-00003050: 6c73 6520 6f74 6865 7277 6973 650a 2020  lse otherwise.  
-00003060: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00003070: 2020 7265 7475 726e 206d 6574 686f 6420    return method 
-00003080: 3d3d 2022 504f 5354 2220 616e 6420 616e  == "POST" and an
-00003090: 7928 0a20 2020 2020 2020 2020 2020 2072  y(.            r
-000030a0: 652e 6d61 7463 6828 7265 6765 782c 2070  e.match(regex, p
-000030b0: 6174 6829 2066 6f72 2072 6567 6578 2069  ath) for regex i
-000030c0: 6e20 7365 6c66 2e52 4554 5249 4142 4c45  n self.RETRIABLE
-000030d0: 5f50 4f53 545f 5041 5448 530a 2020 2020  _POST_PATHS.    
-000030e0: 2020 2020 290a 0a20 2020 2064 6566 2063      )..    def c
-000030f0: 6f6e 6e65 6374 2873 656c 662c 2073 6563  onnect(self, sec
-00003100: 7265 7473 3d4e 6f6e 6529 3a0a 2020 2020  rets=None):.    
-00003110: 2020 2020 2222 2243 6f6e 6e65 6374 2074      """Connect t
-00003120: 6f20 7468 6520 4d4c 5275 6e20 4150 4920  o the MLRun API 
-00003130: 7365 7276 6572 2e20 4d75 7374 2062 6520  server. Must be 
-00003140: 6361 6c6c 6564 2070 7269 6f72 2074 6f20  called prior to 
-00003150: 6578 6563 7574 696e 6720 616e 7920 6f74  executing any ot
-00003160: 6865 7220 6d65 7468 6f64 2e0a 2020 2020  her method..    
-00003170: 2020 2020 5468 6520 636f 6465 2075 7469      The code uti
-00003180: 6c69 7a65 7320 7468 6520 5552 4c20 666f  lizes the URL fo
-00003190: 7220 7468 6520 4150 4920 7365 7276 6572  r the API server
-000031a0: 2066 726f 6d20 7468 6520 636f 6e66 6967   from the config
-000031b0: 7572 6174 696f 6e20 2d20 6060 6d6c 636f  uration - ``mlco
-000031c0: 6e66 2e64 6270 6174 6860 602e 0a0a 2020  nf.dbpath``...  
-000031d0: 2020 2020 2020 466f 7220 6578 616d 706c        For exampl
-000031e0: 653a 3a0a 0a20 2020 2020 2020 2020 2020  e::..           
-000031f0: 206d 6c63 6f6e 662e 6462 7061 7468 203d   mlconf.dbpath =
-00003200: 206d 6c63 6f6e 662e 6462 7061 7468 206f   mlconf.dbpath o
-00003210: 7220 2768 7474 703a 2f2f 6d6c 7275 6e2d  r 'http://mlrun-
-00003220: 6170 693a 3830 3830 270a 2020 2020 2020  api:8080'.      
-00003230: 2020 2020 2020 6462 203d 2067 6574 5f72        db = get_r
-00003240: 756e 5f64 6228 292e 636f 6e6e 6563 7428  un_db().connect(
-00003250: 290a 2020 2020 2020 2020 2222 220a 2020  ).        """.  
-00003260: 2020 2020 2020 2320 6861 636b 2074 6f20        # hack to 
-00003270: 616c 6c6f 7720 756e 6974 2074 6573 7473  allow unit tests
-00003280: 2074 6f20 696e 7374 616e 7469 6174 6520   to instantiate 
-00003290: 4854 5450 5275 6e44 4220 7769 7468 6f75  HTTPRunDB withou
-000032a0: 7420 6120 7265 616c 2073 6572 7665 7220  t a real server 
-000032b0: 6265 6869 6e64 0a20 2020 2020 2020 2069  behind.        i
-000032c0: 6620 226d 6f63 6b2d 7365 7276 6572 2220  f "mock-server" 
-000032d0: 696e 2073 656c 662e 6261 7365 5f75 726c  in self.base_url
-000032e0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-000032f0: 7475 726e 0a20 2020 2020 2020 2072 6573  turn.        res
-00003300: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
-00003310: 6c28 2247 4554 222c 2022 636c 6965 6e74  l("GET", "client
-00003320: 2d73 7065 6322 2c20 7469 6d65 6f75 743d  -spec", timeout=
-00003330: 3529 0a20 2020 2020 2020 2074 7279 3a0a  5).        try:.
-00003340: 2020 2020 2020 2020 2020 2020 7365 7276              serv
-00003350: 6572 5f63 6667 203d 2072 6573 702e 6a73  er_cfg = resp.js
-00003360: 6f6e 2829 0a20 2020 2020 2020 2020 2020  on().           
-00003370: 2073 656c 662e 7365 7276 6572 5f76 6572   self.server_ver
-00003380: 7369 6f6e 203d 2073 6572 7665 725f 6366  sion = server_cf
-00003390: 675b 2276 6572 7369 6f6e 225d 0a20 2020  g["version"].   
-000033a0: 2020 2020 2020 2020 2073 656c 662e 5f76           self._v
-000033b0: 616c 6964 6174 655f 7665 7273 696f 6e5f  alidate_version_
-000033c0: 636f 6d70 6174 6962 696c 6974 7928 7365  compatibility(se
-000033d0: 6c66 2e73 6572 7665 725f 7665 7273 696f  lf.server_versio
-000033e0: 6e2c 2063 6f6e 6669 672e 7665 7273 696f  n, config.versio
-000033f0: 6e29 0a20 2020 2020 2020 2020 2020 2063  n).            c
-00003400: 6f6e 6669 672e 6e61 6d65 7370 6163 6520  onfig.namespace 
-00003410: 3d20 636f 6e66 6967 2e6e 616d 6573 7061  = config.namespa
-00003420: 6365 206f 7220 7365 7276 6572 5f63 6667  ce or server_cfg
-00003430: 2e67 6574 2822 6e61 6d65 7370 6163 6522  .get("namespace"
-00003440: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00003450: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00003460: 2020 2022 6e61 6d65 7370 6163 6522 2069     "namespace" i
-00003470: 6e20 7365 7276 6572 5f63 6667 0a20 2020  n server_cfg.   
-00003480: 2020 2020 2020 2020 2020 2020 2061 6e64               and
-00003490: 2073 6572 7665 725f 6366 675b 226e 616d   server_cfg["nam
-000034a0: 6573 7061 6365 225d 2021 3d20 636f 6e66  espace"] != conf
-000034b0: 6967 2e6e 616d 6573 7061 6365 0a20 2020  ig.namespace.   
-000034c0: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
-000034d0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-000034e0: 6572 2e77 6172 6e69 6e67 280a 2020 2020  er.warning(.    
-000034f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003500: 6622 7761 726e 696e 6721 2c20 7365 7276  f"warning!, serv
-00003510: 6572 2028 7b73 6572 7665 725f 6366 675b  er ({server_cfg[
-00003520: 276e 616d 6573 7061 6365 275d 7d29 2061  'namespace']}) a
-00003530: 6e64 2063 6c69 656e 7420 287b 636f 6e66  nd client ({conf
-00003540: 6967 2e6e 616d 6573 7061 6365 7d29 220a  ig.namespace})".
-00003550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003560: 2020 2020 2220 6e61 6d65 7370 6163 6520      " namespace 
-00003570: 646f 6e27 7420 6d61 7463 6822 0a20 2020  don't match".   
-00003580: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00003590: 2020 2020 2020 2020 2020 2069 6620 636f             if co
-000035a0: 6e66 6967 2e63 652e 6d6f 6465 2061 6e64  nfig.ce.mode and
-000035b0: 2063 6f6e 6669 672e 6365 2e6d 6f64 6520   config.ce.mode 
-000035c0: 213d 2073 6572 7665 725f 6366 672e 6765  != server_cfg.ge
-000035d0: 7428 2263 655f 6d6f 6465 222c 2022 2229  t("ce_mode", "")
-000035e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000035f0: 2020 6c6f 6767 6572 2e77 6172 6e69 6e67    logger.warning
-00003600: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00003610: 2020 2020 2020 6622 7761 726e 696e 6721        f"warning!
-00003620: 2c20 7365 7276 6572 2028 7b73 6572 7665  , server ({serve
-00003630: 725f 6366 675b 2763 655f 6d6f 6465 275d  r_cfg['ce_mode']
-00003640: 7d29 2061 6e64 2063 6c69 656e 7420 287b  }) and client ({
-00003650: 636f 6e66 6967 2e63 652e 6d6f 6465 7d29  config.ce.mode})
-00003660: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00003670: 2020 2020 2020 2220 4345 206d 6f64 6520        " CE mode 
-00003680: 646f 6e27 7420 6d61 7463 6822 0a20 2020  don't match".   
-00003690: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-000036a0: 2020 2020 2020 2020 2020 2063 6f6e 6669             confi
-000036b0: 672e 6365 203d 2073 6572 7665 725f 6366  g.ce = server_cf
-000036c0: 672e 6765 7428 2263 6522 2920 6f72 2063  g.get("ce") or c
-000036d0: 6f6e 6669 672e 6365 0a0a 2020 2020 2020  onfig.ce..      
-000036e0: 2020 2020 2020 2320 6765 7420 6465 6661        # get defa
-000036f0: 756c 7473 2066 726f 6d20 7265 6d6f 7465  ults from remote
-00003700: 2073 6572 7665 720a 2020 2020 2020 2020   server.        
-00003710: 2020 2020 636f 6e66 6967 2e72 656d 6f74      config.remot
-00003720: 655f 686f 7374 203d 2063 6f6e 6669 672e  e_host = config.
-00003730: 7265 6d6f 7465 5f68 6f73 7420 6f72 2073  remote_host or s
-00003740: 6572 7665 725f 6366 672e 6765 7428 2272  erver_cfg.get("r
-00003750: 656d 6f74 655f 686f 7374 2229 0a20 2020  emote_host").   
-00003760: 2020 2020 2020 2020 2063 6f6e 6669 672e           config.
-00003770: 6d70 696a 6f62 5f63 7264 5f76 6572 7369  mpijob_crd_versi
-00003780: 6f6e 203d 2063 6f6e 6669 672e 6d70 696a  on = config.mpij
-00003790: 6f62 5f63 7264 5f76 6572 7369 6f6e 206f  ob_crd_version o
-000037a0: 7220 7365 7276 6572 5f63 6667 2e67 6574  r server_cfg.get
-000037b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000037c0: 2020 226d 7069 6a6f 625f 6372 645f 7665    "mpijob_crd_ve
-000037d0: 7273 696f 6e22 0a20 2020 2020 2020 2020  rsion".         
-000037e0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-000037f0: 2063 6f6e 6669 672e 7569 2e75 726c 203d   config.ui.url =
-00003800: 2063 6f6e 6669 672e 7265 736f 6c76 655f   config.resolve_
-00003810: 7569 5f75 726c 2829 206f 7220 7365 7276  ui_url() or serv
-00003820: 6572 5f63 6667 2e67 6574 2822 7569 5f75  er_cfg.get("ui_u
-00003830: 726c 2229 0a20 2020 2020 2020 2020 2020  rl").           
-00003840: 2063 6f6e 6669 672e 6172 7469 6661 6374   config.artifact
-00003850: 5f70 6174 6820 3d20 636f 6e66 6967 2e61  _path = config.a
-00003860: 7274 6966 6163 745f 7061 7468 206f 7220  rtifact_path or 
-00003870: 7365 7276 6572 5f63 6667 2e67 6574 280a  server_cfg.get(.
-00003880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003890: 2261 7274 6966 6163 745f 7061 7468 220a  "artifact_path".
-000038a0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000038b0: 2020 2020 2020 2020 2020 636f 6e66 6967            config
-000038c0: 2e66 6561 7475 7265 5f73 746f 7265 2e64  .feature_store.d
-000038d0: 6174 615f 7072 6566 6978 6573 203d 2028  ata_prefixes = (
-000038e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000038f0: 2063 6f6e 6669 672e 6665 6174 7572 655f   config.feature_
-00003900: 7374 6f72 652e 6461 7461 5f70 7265 6669  store.data_prefi
-00003910: 7865 730a 2020 2020 2020 2020 2020 2020  xes.            
-00003920: 2020 2020 6f72 2073 6572 7665 725f 6366      or server_cf
-00003930: 672e 6765 7428 2266 6561 7475 7265 5f73  g.get("feature_s
-00003940: 746f 7265 5f64 6174 615f 7072 6566 6978  tore_data_prefix
-00003950: 6573 2229 0a20 2020 2020 2020 2020 2020  es").           
-00003960: 2029 0a20 2020 2020 2020 2020 2020 2063   ).            c
-00003970: 6f6e 6669 672e 7370 6172 6b5f 6170 705f  onfig.spark_app_
-00003980: 696d 6167 6520 3d20 636f 6e66 6967 2e73  image = config.s
-00003990: 7061 726b 5f61 7070 5f69 6d61 6765 206f  park_app_image o
-000039a0: 7220 7365 7276 6572 5f63 6667 2e67 6574  r server_cfg.get
-000039b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000039c0: 2020 2273 7061 726b 5f61 7070 5f69 6d61    "spark_app_ima
-000039d0: 6765 220a 2020 2020 2020 2020 2020 2020  ge".            
-000039e0: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
-000039f0: 6e66 6967 2e73 7061 726b 5f61 7070 5f69  nfig.spark_app_i
-00003a00: 6d61 6765 5f74 6167 203d 2063 6f6e 6669  mage_tag = confi
-00003a10: 672e 7370 6172 6b5f 6170 705f 696d 6167  g.spark_app_imag
-00003a20: 655f 7461 6720 6f72 2073 6572 7665 725f  e_tag or server_
-00003a30: 6366 672e 6765 7428 0a20 2020 2020 2020  cfg.get(.       
-00003a40: 2020 2020 2020 2020 2022 7370 6172 6b5f           "spark_
-00003a50: 6170 705f 696d 6167 655f 7461 6722 0a20  app_image_tag". 
-00003a60: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00003a70: 2020 2020 2020 2020 2063 6f6e 6669 672e           config.
-00003a80: 7370 6172 6b5f 6869 7374 6f72 795f 7365  spark_history_se
-00003a90: 7276 6572 5f70 6174 6820 3d20 280a 2020  rver_path = (.  
-00003aa0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00003ab0: 6e66 6967 2e73 7061 726b 5f68 6973 746f  nfig.spark_histo
-00003ac0: 7279 5f73 6572 7665 725f 7061 7468 0a20  ry_server_path. 
-00003ad0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00003ae0: 7220 7365 7276 6572 5f63 6667 2e67 6574  r server_cfg.get
-00003af0: 2822 7370 6172 6b5f 6869 7374 6f72 795f  ("spark_history_
-00003b00: 7365 7276 6572 5f70 6174 6822 290a 2020  server_path").  
-00003b10: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00003b20: 2020 2020 2020 2020 636f 6e66 6967 2e68          config.h
-00003b30: 7474 7064 622e 6275 696c 6465 722e 646f  ttpdb.builder.do
-00003b40: 636b 6572 5f72 6567 6973 7472 7920 3d20  cker_registry = 
-00003b50: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00003b60: 2020 636f 6e66 6967 2e68 7474 7064 622e    config.httpdb.
-00003b70: 6275 696c 6465 722e 646f 636b 6572 5f72  builder.docker_r
-00003b80: 6567 6973 7472 790a 2020 2020 2020 2020  egistry.        
-00003b90: 2020 2020 2020 2020 6f72 2073 6572 7665          or serve
-00003ba0: 725f 6366 672e 6765 7428 2264 6f63 6b65  r_cfg.get("docke
-00003bb0: 725f 7265 6769 7374 7279 2229 0a20 2020  r_registry").   
-00003bc0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00003bd0: 2020 2020 2020 2063 6f6e 6669 672e 6874         config.ht
-00003be0: 7470 6462 2e61 7069 5f75 726c 203d 2063  tpdb.api_url = c
-00003bf0: 6f6e 6669 672e 6874 7470 6462 2e61 7069  onfig.httpdb.api
-00003c00: 5f75 726c 206f 7220 7365 7276 6572 5f63  _url or server_c
-00003c10: 6667 2e67 6574 2822 6170 695f 7572 6c22  fg.get("api_url"
-00003c20: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
-00003c30: 6e66 6967 2e6e 7563 6c69 6f5f 7665 7273  nfig.nuclio_vers
-00003c40: 696f 6e20 3d20 636f 6e66 6967 2e6e 7563  ion = config.nuc
-00003c50: 6c69 6f5f 7665 7273 696f 6e20 6f72 2073  lio_version or s
-00003c60: 6572 7665 725f 6366 672e 6765 7428 0a20  erver_cfg.get(. 
-00003c70: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00003c80: 6e75 636c 696f 5f76 6572 7369 6f6e 220a  nuclio_version".
-00003c90: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00003ca0: 2020 2020 2020 2020 2020 636f 6e66 6967            config
-00003cb0: 2e64 6566 6175 6c74 5f66 756e 6374 696f  .default_functio
-00003cc0: 6e5f 7072 696f 7269 7479 5f63 6c61 7373  n_priority_class
-00003cd0: 5f6e 616d 6520 3d20 280a 2020 2020 2020  _name = (.      
-00003ce0: 2020 2020 2020 2020 2020 636f 6e66 6967            config
-00003cf0: 2e64 6566 6175 6c74 5f66 756e 6374 696f  .default_functio
-00003d00: 6e5f 7072 696f 7269 7479 5f63 6c61 7373  n_priority_class
-00003d10: 5f6e 616d 650a 2020 2020 2020 2020 2020  _name.          
-00003d20: 2020 2020 2020 6f72 2073 6572 7665 725f        or server_
-00003d30: 6366 672e 6765 7428 2264 6566 6175 6c74  cfg.get("default
-00003d40: 5f66 756e 6374 696f 6e5f 7072 696f 7269  _function_priori
-00003d50: 7479 5f63 6c61 7373 5f6e 616d 6522 290a  ty_class_name").
-00003d60: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00003d70: 2020 2020 2020 2020 2020 636f 6e66 6967            config
-00003d80: 2e76 616c 6964 5f66 756e 6374 696f 6e5f  .valid_function_
-00003d90: 7072 696f 7269 7479 5f63 6c61 7373 5f6e  priority_class_n
-00003da0: 616d 6573 203d 2028 0a20 2020 2020 2020  ames = (.       
-00003db0: 2020 2020 2020 2020 2063 6f6e 6669 672e           config.
-00003dc0: 7661 6c69 645f 6675 6e63 7469 6f6e 5f70  valid_function_p
-00003dd0: 7269 6f72 6974 795f 636c 6173 735f 6e61  riority_class_na
-00003de0: 6d65 730a 2020 2020 2020 2020 2020 2020  mes.            
-00003df0: 2020 2020 6f72 2073 6572 7665 725f 6366      or server_cf
-00003e00: 672e 6765 7428 2276 616c 6964 5f66 756e  g.get("valid_fun
-00003e10: 6374 696f 6e5f 7072 696f 7269 7479 5f63  ction_priority_c
-00003e20: 6c61 7373 5f6e 616d 6573 2229 0a20 2020  lass_names").   
-00003e30: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00003e40: 2020 2020 2020 2063 6f6e 6669 672e 6172         config.ar
-00003e50: 7469 6661 6374 732e 6361 6c63 756c 6174  tifacts.calculat
-00003e60: 655f 6861 7368 203d 2028 0a20 2020 2020  e_hash = (.     
-00003e70: 2020 2020 2020 2020 2020 2063 6f6e 6669             confi
-00003e80: 672e 6172 7469 6661 6374 732e 6361 6c63  g.artifacts.calc
-00003e90: 756c 6174 655f 6861 7368 0a20 2020 2020  ulate_hash.     
-00003ea0: 2020 2020 2020 2020 2020 2069 6620 636f             if co
-00003eb0: 6e66 6967 2e61 7274 6966 6163 7473 2e63  nfig.artifacts.c
-00003ec0: 616c 6375 6c61 7465 5f68 6173 6820 6973  alculate_hash is
-00003ed0: 206e 6f74 204e 6f6e 650a 2020 2020 2020   not None.      
-00003ee0: 2020 2020 2020 2020 2020 656c 7365 2073            else s
-00003ef0: 6572 7665 725f 6366 672e 6765 7428 2263  erver_cfg.get("c
-00003f00: 616c 6375 6c61 7465 5f61 7274 6966 6163  alculate_artifac
-00003f10: 745f 6861 7368 2229 0a20 2020 2020 2020  t_hash").       
-00003f20: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00003f30: 2020 2063 6f6e 6669 672e 6172 7469 6661     config.artifa
-00003f40: 6374 732e 6765 6e65 7261 7465 5f74 6172  cts.generate_tar
-00003f50: 6765 745f 7061 7468 5f66 726f 6d5f 6172  get_path_from_ar
-00003f60: 7469 6661 6374 5f68 6173 6820 3d20 280a  tifact_hash = (.
-00003f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003f80: 636f 6e66 6967 2e61 7274 6966 6163 7473  config.artifacts
-00003f90: 2e67 656e 6572 6174 655f 7461 7267 6574  .generate_target
-00003fa0: 5f70 6174 685f 6672 6f6d 5f61 7274 6966  _path_from_artif
-00003fb0: 6163 745f 6861 7368 0a20 2020 2020 2020  act_hash.       
-00003fc0: 2020 2020 2020 2020 2069 6620 636f 6e66           if conf
-00003fd0: 6967 2e61 7274 6966 6163 7473 2e67 656e  ig.artifacts.gen
-00003fe0: 6572 6174 655f 7461 7267 6574 5f70 6174  erate_target_pat
-00003ff0: 685f 6672 6f6d 5f61 7274 6966 6163 745f  h_from_artifact_
-00004000: 6861 7368 2069 7320 6e6f 7420 4e6f 6e65  hash is not None
-00004010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004020: 2065 6c73 6520 7365 7276 6572 5f63 6667   else server_cfg
-00004030: 2e67 6574 2822 6765 6e65 7261 7465 5f61  .get("generate_a
-00004040: 7274 6966 6163 745f 7461 7267 6574 5f70  rtifact_target_p
-00004050: 6174 685f 6672 6f6d 5f61 7274 6966 6163  ath_from_artifac
-00004060: 745f 6861 7368 2229 0a20 2020 2020 2020  t_hash").       
-00004070: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00004080: 2020 2020 636f 6e66 6967 2e72 6564 6973      config.redis
-00004090: 2e75 726c 203d 2063 6f6e 6669 672e 7265  .url = config.re
-000040a0: 6469 732e 7572 6c20 6f72 2073 6572 7665  dis.url or serve
-000040b0: 725f 6366 672e 6765 7428 2272 6564 6973  r_cfg.get("redis
-000040c0: 5f75 726c 2229 0a20 2020 2020 2020 2020  _url").         
-000040d0: 2020 2023 2061 6c6c 6f77 2063 6c69 656e     # allow clien
-000040e0: 7420 746f 2073 6574 2074 6865 2064 6566  t to set the def
-000040f0: 6175 6c74 2070 6172 7469 616c 2057 4120  ault partial WA 
-00004100: 666f 7220 6c61 636b 206f 6620 7375 7070  for lack of supp
-00004110: 6f72 7420 6f66 2070 6572 2d74 6172 6765  ort of per-targe
-00004120: 7420 6175 7869 6c69 6172 7920 6f70 7469  t auxiliary opti
-00004130: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
-00004140: 636f 6e66 6967 2e72 6564 6973 2e74 7970  config.redis.typ
-00004150: 6520 3d20 636f 6e66 6967 2e72 6564 6973  e = config.redis
-00004160: 2e74 7970 6520 6f72 2073 6572 7665 725f  .type or server_
-00004170: 6366 672e 6765 7428 2272 6564 6973 5f74  cfg.get("redis_t
-00004180: 7970 6522 290a 0a20 2020 2020 2020 2020  ype")..         
-00004190: 2020 2063 6f6e 6669 672e 7371 6c2e 7572     config.sql.ur
-000041a0: 6c20 3d20 636f 6e66 6967 2e73 716c 2e75  l = config.sql.u
-000041b0: 726c 206f 7220 7365 7276 6572 5f63 6667  rl or server_cfg
-000041c0: 2e67 6574 2822 7371 6c5f 7572 6c22 290a  .get("sql_url").
-000041d0: 2020 2020 2020 2020 2020 2020 2320 5468              # Th
-000041e0: 6573 6520 6861 7665 2061 2064 6566 6175  ese have a defau
-000041f0: 6c74 2076 616c 7565 2c20 7468 6572 6566  lt value, theref
-00004200: 6f72 6520 6c6f 6361 6c20 636f 6e66 6967  ore local config
-00004210: 2077 696c 6c20 616c 7761 7973 2068 6176   will always hav
-00004220: 6520 6120 7661 6c75 652c 2070 7269 6f72  e a value, prior
-00004230: 6974 697a 6520 7468 650a 2020 2020 2020  itize the.      
-00004240: 2020 2020 2020 2320 4150 4920 7661 6c75        # API valu
-00004250: 6520 6669 7273 740a 2020 2020 2020 2020  e first.        
-00004260: 2020 2020 636f 6e66 6967 2e75 692e 7072      config.ui.pr
-00004270: 6f6a 6563 7473 5f70 7265 6669 7820 3d20  ojects_prefix = 
-00004280: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00004290: 2020 7365 7276 6572 5f63 6667 2e67 6574    server_cfg.get
-000042a0: 2822 7569 5f70 726f 6a65 6374 735f 7072  ("ui_projects_pr
-000042b0: 6566 6978 2229 206f 7220 636f 6e66 6967  efix") or config
-000042c0: 2e75 692e 7072 6f6a 6563 7473 5f70 7265  .ui.projects_pre
-000042d0: 6669 780a 2020 2020 2020 2020 2020 2020  fix.            
-000042e0: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
-000042f0: 6e66 6967 2e6b 6670 5f69 6d61 6765 203d  nfig.kfp_image =
-00004300: 2073 6572 7665 725f 6366 672e 6765 7428   server_cfg.get(
-00004310: 226b 6670 5f69 6d61 6765 2229 206f 7220  "kfp_image") or 
-00004320: 636f 6e66 6967 2e6b 6670 5f69 6d61 6765  config.kfp_image
-00004330: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-00004340: 6669 672e 6b66 705f 7572 6c20 3d20 7365  fig.kfp_url = se
-00004350: 7276 6572 5f63 6667 2e67 6574 2822 6b66  rver_cfg.get("kf
-00004360: 705f 7572 6c22 2920 6f72 2063 6f6e 6669  p_url") or confi
-00004370: 672e 6b66 705f 7572 6c0a 2020 2020 2020  g.kfp_url.      
-00004380: 2020 2020 2020 636f 6e66 6967 2e64 6173        config.das
-00004390: 6b5f 6b66 705f 696d 6167 6520 3d20 280a  k_kfp_image = (.
-000043a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000043b0: 7365 7276 6572 5f63 6667 2e67 6574 2822  server_cfg.get("
-000043c0: 6461 736b 5f6b 6670 5f69 6d61 6765 2229  dask_kfp_image")
-000043d0: 206f 7220 636f 6e66 6967 2e64 6173 6b5f   or config.dask_
-000043e0: 6b66 705f 696d 6167 650a 2020 2020 2020  kfp_image.      
-000043f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00004400: 2020 2020 636f 6e66 6967 2e73 6372 6170      config.scrap
-00004410: 655f 6d65 7472 6963 7320 3d20 280a 2020  e_metrics = (.  
-00004420: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00004430: 7276 6572 5f63 6667 2e67 6574 2822 7363  rver_cfg.get("sc
-00004440: 7261 7065 5f6d 6574 7269 6373 2229 0a20  rape_metrics"). 
-00004450: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00004460: 6620 7365 7276 6572 5f63 6667 2e67 6574  f server_cfg.get
-00004470: 2822 7363 7261 7065 5f6d 6574 7269 6373  ("scrape_metrics
-00004480: 2229 2069 7320 6e6f 7420 4e6f 6e65 0a20  ") is not None. 
-00004490: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000044a0: 6c73 6520 636f 6e66 6967 2e73 6372 6170  lse config.scrap
-000044b0: 655f 6d65 7472 6963 730a 2020 2020 2020  e_metrics.      
-000044c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000044d0: 2020 2020 636f 6e66 6967 2e68 7562 5f75      config.hub_u
-000044e0: 726c 203d 2073 6572 7665 725f 6366 672e  rl = server_cfg.
-000044f0: 6765 7428 2268 7562 5f75 726c 2229 206f  get("hub_url") o
-00004500: 7220 636f 6e66 6967 2e68 7562 5f75 726c  r config.hub_url
-00004510: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-00004520: 6669 672e 6465 6661 756c 745f 6675 6e63  fig.default_func
-00004530: 7469 6f6e 5f6e 6f64 655f 7365 6c65 6374  tion_node_select
-00004540: 6f72 203d 2028 0a20 2020 2020 2020 2020  or = (.         
-00004550: 2020 2020 2020 2073 6572 7665 725f 6366         server_cf
-00004560: 672e 6765 7428 2264 6566 6175 6c74 5f66  g.get("default_f
-00004570: 756e 6374 696f 6e5f 6e6f 6465 5f73 656c  unction_node_sel
-00004580: 6563 746f 7222 290a 2020 2020 2020 2020  ector").        
-00004590: 2020 2020 2020 2020 6f72 2063 6f6e 6669          or confi
-000045a0: 672e 6465 6661 756c 745f 6675 6e63 7469  g.default_functi
-000045b0: 6f6e 5f6e 6f64 655f 7365 6c65 6374 6f72  on_node_selector
-000045c0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-000045d0: 2020 2020 2020 2020 2020 2063 6f6e 6669             confi
-000045e0: 672e 6967 7a5f 7665 7273 696f 6e20 3d20  g.igz_version = 
-000045f0: 7365 7276 6572 5f63 6667 2e67 6574 2822  server_cfg.get("
-00004600: 6967 7a5f 7665 7273 696f 6e22 2920 6f72  igz_version") or
-00004610: 2063 6f6e 6669 672e 6967 7a5f 7665 7273   config.igz_vers
-00004620: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-00004630: 636f 6e66 6967 2e73 746f 7261 6765 2e61  config.storage.a
-00004640: 7574 6f5f 6d6f 756e 745f 7479 7065 203d  uto_mount_type =
-00004650: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00004660: 2020 2073 6572 7665 725f 6366 672e 6765     server_cfg.ge
-00004670: 7428 2261 7574 6f5f 6d6f 756e 745f 7479  t("auto_mount_ty
-00004680: 7065 2229 206f 7220 636f 6e66 6967 2e73  pe") or config.s
-00004690: 746f 7261 6765 2e61 7574 6f5f 6d6f 756e  torage.auto_moun
-000046a0: 745f 7479 7065 0a20 2020 2020 2020 2020  t_type.         
-000046b0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-000046c0: 2063 6f6e 6669 672e 7374 6f72 6167 652e   config.storage.
-000046d0: 6175 746f 5f6d 6f75 6e74 5f70 6172 616d  auto_mount_param
-000046e0: 7320 3d20 280a 2020 2020 2020 2020 2020  s = (.          
-000046f0: 2020 2020 2020 7365 7276 6572 5f63 6667        server_cfg
-00004700: 2e67 6574 2822 6175 746f 5f6d 6f75 6e74  .get("auto_mount
-00004710: 5f70 6172 616d 7322 2920 6f72 2063 6f6e  _params") or con
-00004720: 6669 672e 7374 6f72 6167 652e 6175 746f  fig.storage.auto
-00004730: 5f6d 6f75 6e74 5f70 6172 616d 730a 2020  _mount_params.  
-00004740: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00004750: 2020 2020 2020 2020 636f 6e66 6967 2e73          config.s
-00004760: 7061 726b 5f6f 7065 7261 746f 725f 7665  park_operator_ve
-00004770: 7273 696f 6e20 3d20 280a 2020 2020 2020  rsion = (.      
-00004780: 2020 2020 2020 2020 2020 7365 7276 6572            server
-00004790: 5f63 6667 2e67 6574 2822 7370 6172 6b5f  _cfg.get("spark_
-000047a0: 6f70 6572 6174 6f72 5f76 6572 7369 6f6e  operator_version
-000047b0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-000047c0: 2020 206f 7220 636f 6e66 6967 2e73 7061     or config.spa
-000047d0: 726b 5f6f 7065 7261 746f 725f 7665 7273  rk_operator_vers
-000047e0: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-000047f0: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
-00004800: 6e66 6967 2e64 6566 6175 6c74 5f74 656e  nfig.default_ten
-00004810: 736f 7262 6f61 7264 5f6c 6f67 735f 7061  sorboard_logs_pa
-00004820: 7468 203d 2028 0a20 2020 2020 2020 2020  th = (.         
-00004830: 2020 2020 2020 2073 6572 7665 725f 6366         server_cf
-00004840: 672e 6765 7428 2264 6566 6175 6c74 5f74  g.get("default_t
-00004850: 656e 736f 7262 6f61 7264 5f6c 6f67 735f  ensorboard_logs_
-00004860: 7061 7468 2229 0a20 2020 2020 2020 2020  path").         
-00004870: 2020 2020 2020 206f 7220 636f 6e66 6967         or config
-00004880: 2e64 6566 6175 6c74 5f74 656e 736f 7262  .default_tensorb
-00004890: 6f61 7264 5f6c 6f67 735f 7061 7468 0a20  oard_logs_path. 
-000048a0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000048b0: 2020 2020 2020 2020 2063 6f6e 6669 672e           config.
-000048c0: 6465 6661 756c 745f 6675 6e63 7469 6f6e  default_function
-000048d0: 5f70 6f64 5f72 6573 6f75 7263 6573 203d  _pod_resources =
-000048e0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-000048f0: 2020 2073 6572 7665 725f 6366 672e 6765     server_cfg.ge
-00004900: 7428 2264 6566 6175 6c74 5f66 756e 6374  t("default_funct
-00004910: 696f 6e5f 706f 645f 7265 736f 7572 6365  ion_pod_resource
-00004920: 7322 290a 2020 2020 2020 2020 2020 2020  s").            
-00004930: 2020 2020 6f72 2063 6f6e 6669 672e 6465      or config.de
-00004940: 6661 756c 745f 6675 6e63 7469 6f6e 5f70  fault_function_p
-00004950: 6f64 5f72 6573 6f75 7263 6573 0a20 2020  od_resources.   
-00004960: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00004970: 2020 2020 2020 2063 6f6e 6669 672e 6675         config.fu
-00004980: 6e63 7469 6f6e 5f64 6566 6175 6c74 732e  nction_defaults.
-00004990: 7072 6565 6d70 7469 6f6e 5f6d 6f64 6520  preemption_mode 
-000049a0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-000049b0: 2020 2020 7365 7276 6572 5f63 6667 2e67      server_cfg.g
-000049c0: 6574 2822 6465 6661 756c 745f 7072 6565  et("default_pree
-000049d0: 6d70 7469 6f6e 5f6d 6f64 6522 290a 2020  mption_mode").  
-000049e0: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-000049f0: 2063 6f6e 6669 672e 6675 6e63 7469 6f6e   config.function
-00004a00: 5f64 6566 6175 6c74 732e 7072 6565 6d70  _defaults.preemp
-00004a10: 7469 6f6e 5f6d 6f64 650a 2020 2020 2020  tion_mode.      
-00004a20: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00004a30: 2020 2020 636f 6e66 6967 2e70 7265 656d      config.preem
-00004a40: 7074 6962 6c65 5f6e 6f64 6573 2e6e 6f64  ptible_nodes.nod
-00004a50: 655f 7365 6c65 6374 6f72 203d 2028 0a20  e_selector = (. 
-00004a60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00004a70: 6572 7665 725f 6366 672e 6765 7428 2270  erver_cfg.get("p
-00004a80: 7265 656d 7074 6962 6c65 5f6e 6f64 6573  reemptible_nodes
-00004a90: 5f6e 6f64 655f 7365 6c65 6374 6f72 2229  _node_selector")
-00004aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004ab0: 206f 7220 636f 6e66 6967 2e70 7265 656d   or config.preem
-00004ac0: 7074 6962 6c65 5f6e 6f64 6573 2e6e 6f64  ptible_nodes.nod
-00004ad0: 655f 7365 6c65 6374 6f72 0a20 2020 2020  e_selector.     
-00004ae0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00004af0: 2020 2020 2063 6f6e 6669 672e 7072 6565       config.pree
-00004b00: 6d70 7469 626c 655f 6e6f 6465 732e 746f  mptible_nodes.to
-00004b10: 6c65 7261 7469 6f6e 7320 3d20 280a 2020  lerations = (.  
-00004b20: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00004b30: 7276 6572 5f63 6667 2e67 6574 2822 7072  rver_cfg.get("pr
-00004b40: 6565 6d70 7469 626c 655f 6e6f 6465 735f  eemptible_nodes_
-00004b50: 746f 6c65 7261 7469 6f6e 7322 290a 2020  tolerations").  
-00004b60: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-00004b70: 2063 6f6e 6669 672e 7072 6565 6d70 7469   config.preempti
-00004b80: 626c 655f 6e6f 6465 732e 746f 6c65 7261  ble_nodes.tolera
-00004b90: 7469 6f6e 730a 2020 2020 2020 2020 2020  tions.          
-00004ba0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00004bb0: 636f 6e66 6967 2e66 6f72 6365 5f72 756e  config.force_run
-00004bc0: 5f6c 6f63 616c 203d 2028 0a20 2020 2020  _local = (.     
-00004bd0: 2020 2020 2020 2020 2020 2073 6572 7665             serve
-00004be0: 725f 6366 672e 6765 7428 2266 6f72 6365  r_cfg.get("force
-00004bf0: 5f72 756e 5f6c 6f63 616c 2229 206f 7220  _run_local") or 
-00004c00: 636f 6e66 6967 2e66 6f72 6365 5f72 756e  config.force_run
-00004c10: 5f6c 6f63 616c 0a20 2020 2020 2020 2020  _local.         
-00004c20: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00004c30: 2063 6f6e 6669 672e 6675 6e63 7469 6f6e   config.function
-00004c40: 203d 2073 6572 7665 725f 6366 672e 6765   = server_cfg.ge
-00004c50: 7428 2266 756e 6374 696f 6e22 2920 6f72  t("function") or
-00004c60: 2063 6f6e 6669 672e 6675 6e63 7469 6f6e   config.function
-00004c70: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-00004c80: 6669 672e 6874 7470 6462 2e6c 6f67 7320  fig.httpdb.logs 
-00004c90: 3d20 7365 7276 6572 5f63 6667 2e67 6574  = server_cfg.get
-00004ca0: 2822 6c6f 6773 2229 206f 7220 636f 6e66  ("logs") or conf
-00004cb0: 6967 2e68 7474 7064 622e 6c6f 6773 0a20  ig.httpdb.logs. 
-00004cc0: 2020 2020 2020 2020 2020 2063 6f6e 6669             confi
-00004cd0: 672e 6d6f 6465 6c5f 656e 6470 6f69 6e74  g.model_endpoint
-00004ce0: 5f6d 6f6e 6974 6f72 696e 672e 7374 6f72  _monitoring.stor
-00004cf0: 655f 7479 7065 203d 2028 0a20 2020 2020  e_type = (.     
-00004d00: 2020 2020 2020 2020 2020 2073 6572 7665             serve
-00004d10: 725f 6366 672e 6765 7428 226d 6f64 656c  r_cfg.get("model
-00004d20: 5f65 6e64 706f 696e 745f 6d6f 6e69 746f  _endpoint_monito
-00004d30: 7269 6e67 5f73 746f 7265 5f74 7970 6522  ring_store_type"
-00004d40: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00004d50: 2020 6f72 2063 6f6e 6669 672e 6d6f 6465    or config.mode
-00004d60: 6c5f 656e 6470 6f69 6e74 5f6d 6f6e 6974  l_endpoint_monit
-00004d70: 6f72 696e 672e 7374 6f72 655f 7479 7065  oring.store_type
-00004d80: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00004d90: 2020 2020 2020 2020 6578 6365 7074 2045          except E
-00004da0: 7863 6570 7469 6f6e 2061 7320 6578 633a  xception as exc:
-00004db0: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
-00004dc0: 6765 722e 7761 726e 696e 6728 0a20 2020  ger.warning(.   
-00004dd0: 2020 2020 2020 2020 2020 2020 2022 4661               "Fa
-00004de0: 696c 6564 2073 796e 6369 6e67 2063 6f6e  iled syncing con
-00004df0: 6669 6720 6672 6f6d 2073 6572 7665 7222  fig from server"
-00004e00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00004e10: 2020 6578 633d 6572 725f 746f 5f73 7472    exc=err_to_str
-00004e20: 2865 7863 292c 0a20 2020 2020 2020 2020  (exc),.         
-00004e30: 2020 2020 2020 2074 7261 6365 6261 636b         traceback
-00004e40: 3d74 7261 6365 6261 636b 2e66 6f72 6d61  =traceback.forma
-00004e50: 745f 6578 6328 292c 0a20 2020 2020 2020  t_exc(),.       
-00004e60: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-00004e70: 6574 7572 6e20 7365 6c66 0a0a 2020 2020  eturn self..    
-00004e80: 6465 6620 7374 6f72 655f 6c6f 6728 7365  def store_log(se
-00004e90: 6c66 2c20 7569 642c 2070 726f 6a65 6374  lf, uid, project
-00004ea0: 3d22 222c 2062 6f64 793d 4e6f 6e65 2c20  ="", body=None, 
-00004eb0: 6170 7065 6e64 3d46 616c 7365 293a 0a20  append=False):. 
-00004ec0: 2020 2020 2020 2022 2222 5361 7665 2061         """Save a
-00004ed0: 206c 6f67 2070 6572 7369 7374 656e 746c   log persistentl
-00004ee0: 792e 0a0a 2020 2020 2020 2020 3a70 6172  y...        :par
-00004ef0: 616d 2075 6964 3a20 4c6f 6720 756e 6971  am uid: Log uniq
-00004f00: 7565 2049 440a 2020 2020 2020 2020 3a70  ue ID.        :p
-00004f10: 6172 616d 2070 726f 6a65 6374 3a20 5072  aram project: Pr
-00004f20: 6f6a 6563 7420 6e61 6d65 2066 6f72 2077  oject name for w
-00004f30: 6869 6368 2074 6869 7320 6c6f 6720 6265  hich this log be
-00004f40: 6c6f 6e67 730a 2020 2020 2020 2020 3a70  longs.        :p
-00004f50: 6172 616d 2062 6f64 793a 2054 6865 2061  aram body: The a
-00004f60: 6374 7561 6c20 6c6f 6720 746f 2073 746f  ctual log to sto
-00004f70: 7265 0a20 2020 2020 2020 203a 7061 7261  re.        :para
-00004f80: 6d20 6170 7065 6e64 3a20 5768 6574 6865  m append: Whethe
-00004f90: 7220 746f 2061 7070 656e 6420 7468 6520  r to append the 
-00004fa0: 6c6f 6720 7072 6f76 6964 6564 2069 6e20  log provided in 
-00004fb0: 6060 626f 6479 6060 2074 6f20 616e 2065  ``body`` to an e
-00004fc0: 7869 7374 696e 6720 6c6f 6720 7769 7468  xisting log with
-00004fd0: 2074 6865 2073 616d 6520 6060 7569 6460   the same ``uid`
-00004fe0: 6020 6f72 2074 6f0a 2020 2020 2020 2020  ` or to.        
-00004ff0: 2020 2020 6372 6561 7465 2061 206e 6577      create a new
-00005000: 206c 6f67 2e20 4966 2073 6574 2074 6f20   log. If set to 
-00005010: 6060 4661 6c73 6560 602c 2061 6e20 6578  ``False``, an ex
-00005020: 6973 7469 6e67 206c 6f67 2077 6974 6820  isting log with 
-00005030: 7361 6d65 2060 6075 6964 6060 2077 696c  same ``uid`` wil
-00005040: 6c20 6265 206f 7665 7277 7269 7474 656e  l be overwritten
-00005050: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00005060: 2020 2020 2020 6966 206e 6f74 2062 6f64        if not bod
-00005070: 793a 0a20 2020 2020 2020 2020 2020 2072  y:.            r
-00005080: 6574 7572 6e0a 0a20 2020 2020 2020 2070  eturn..        p
-00005090: 6174 6820 3d20 7365 6c66 2e5f 7061 7468  ath = self._path
-000050a0: 5f6f 6628 226c 6f67 222c 2070 726f 6a65  _of("log", proje
-000050b0: 6374 2c20 7569 6429 0a20 2020 2020 2020  ct, uid).       
-000050c0: 2070 6172 616d 7320 3d20 7b22 6170 7065   params = {"appe
-000050d0: 6e64 223a 2062 6f6f 6c32 7374 7228 6170  nd": bool2str(ap
-000050e0: 7065 6e64 297d 0a20 2020 2020 2020 2065  pend)}.        e
-000050f0: 7272 6f72 203d 2066 2273 746f 7265 206c  rror = f"store l
-00005100: 6f67 207b 7072 6f6a 6563 747d 2f7b 7569  og {project}/{ui
-00005110: 647d 220a 2020 2020 2020 2020 7365 6c66  d}".        self
-00005120: 2e61 7069 5f63 616c 6c28 2250 4f53 5422  .api_call("POST"
-00005130: 2c20 7061 7468 2c20 6572 726f 722c 2070  , path, error, p
-00005140: 6172 616d 732c 2062 6f64 7929 0a0a 2020  arams, body)..  
-00005150: 2020 6465 6620 6765 745f 6c6f 6728 7365    def get_log(se
-00005160: 6c66 2c20 7569 642c 2070 726f 6a65 6374  lf, uid, project
-00005170: 3d22 222c 206f 6666 7365 743d 302c 2073  ="", offset=0, s
-00005180: 697a 653d 2d31 293a 0a20 2020 2020 2020  ize=-1):.       
-00005190: 2022 2222 5265 7472 6965 7665 2061 206c   """Retrieve a l
-000051a0: 6f67 2e0a 0a20 2020 2020 2020 203a 7061  og...        :pa
-000051b0: 7261 6d20 7569 643a 204c 6f67 2075 6e69  ram uid: Log uni
-000051c0: 7175 6520 4944 0a20 2020 2020 2020 203a  que ID.        :
-000051d0: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
-000051e0: 726f 6a65 6374 206e 616d 6520 666f 7220  roject name for 
-000051f0: 7768 6963 6820 7468 6520 6c6f 6720 6265  which the log be
-00005200: 6c6f 6e67 730a 2020 2020 2020 2020 3a70  longs.        :p
-00005210: 6172 616d 206f 6666 7365 743a 2052 6574  aram offset: Ret
-00005220: 7269 6576 6520 7061 7274 6961 6c20 6c6f  rieve partial lo
-00005230: 672c 2067 6574 2075 7020 746f 2060 6073  g, get up to ``s
-00005240: 697a 6560 6020 6279 7465 7320 7374 6172  ize`` bytes star
-00005250: 7469 6e67 2061 7420 6f66 6673 6574 2060  ting at offset `
-00005260: 606f 6666 7365 7460 600a 2020 2020 2020  `offset``.      
-00005270: 2020 2020 2020 6672 6f6d 2062 6567 696e        from begin
-00005280: 6e69 6e67 206f 6620 6c6f 670a 2020 2020  ning of log.    
-00005290: 2020 2020 3a70 6172 616d 2073 697a 653a      :param size:
-000052a0: 2053 6565 2060 606f 6666 7365 7460 602e   See ``offset``.
-000052b0: 2049 6620 7365 7420 746f 2060 602d 3160   If set to ``-1`
-000052c0: 6020 2874 6865 2064 6566 6175 6c74 2920  ` (the default) 
-000052d0: 7769 6c6c 2072 6574 7269 6576 6520 616c  will retrieve al
-000052e0: 6c20 6461 7461 2074 6f20 656e 6420 6f66  l data to end of
-000052f0: 206c 6f67 2e0a 2020 2020 2020 2020 3a72   log..        :r
-00005300: 6574 7572 6e73 3a20 5468 6520 666f 6c6c  eturns: The foll
-00005310: 6f77 696e 6720 6f62 6a65 6374 733a 0a0a  owing objects:..
-00005320: 2020 2020 2020 2020 2020 2020 2d20 7374              - st
-00005330: 6174 6520 2d20 5468 6520 7374 6174 6520  ate - The state 
-00005340: 6f66 2074 6865 2072 756e 7469 6d65 206f  of the runtime o
-00005350: 626a 6563 7420 7768 6963 6820 6765 6e65  bject which gene
-00005360: 7261 7465 7320 7468 6973 206c 6f67 2c20  rates this log, 
-00005370: 6966 2069 7420 6578 6973 7473 2e20 496e  if it exists. In
-00005380: 2063 6173 6520 6e6f 206b 6e6f 776e 2073   case no known s
-00005390: 7461 7465 0a20 2020 2020 2020 2020 2020  tate.           
-000053a0: 2020 2065 7869 7374 732c 2074 6869 7320     exists, this 
-000053b0: 7769 6c6c 2062 6520 6060 756e 6b6e 6f77  will be ``unknow
-000053c0: 6e60 602e 0a20 2020 2020 2020 2020 2020  n``..           
-000053d0: 202d 2063 6f6e 7465 6e74 202d 2054 6865   - content - The
-000053e0: 2061 6374 7561 6c20 6c6f 6720 636f 6e74   actual log cont
-000053f0: 656e 742e 0a20 2020 2020 2020 2022 2222  ent..        """
-00005400: 0a0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
-00005410: 203d 207b 226f 6666 7365 7422 3a20 6f66   = {"offset": of
-00005420: 6673 6574 2c20 2273 697a 6522 3a20 7369  fset, "size": si
-00005430: 7a65 7d0a 2020 2020 2020 2020 7061 7468  ze}.        path
-00005440: 203d 2073 656c 662e 5f70 6174 685f 6f66   = self._path_of
-00005450: 2822 6c6f 6722 2c20 7072 6f6a 6563 742c  ("log", project,
-00005460: 2075 6964 290a 2020 2020 2020 2020 6572   uid).        er
-00005470: 726f 7220 3d20 6622 6765 7420 6c6f 6720  ror = f"get log 
-00005480: 7b70 726f 6a65 6374 7d2f 7b75 6964 7d22  {project}/{uid}"
-00005490: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
-000054a0: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
-000054b0: 4554 222c 2070 6174 682c 2065 7272 6f72  ET", path, error
-000054c0: 2c20 7061 7261 6d73 3d70 6172 616d 7329  , params=params)
-000054d0: 0a20 2020 2020 2020 2069 6620 7265 7370  .        if resp
-000054e0: 2e68 6561 6465 7273 3a0a 2020 2020 2020  .headers:.      
-000054f0: 2020 2020 2020 7374 6174 6520 3d20 7265        state = re
-00005500: 7370 2e68 6561 6465 7273 2e67 6574 2822  sp.headers.get("
-00005510: 782d 6d6c 7275 6e2d 7275 6e2d 7374 6174  x-mlrun-run-stat
-00005520: 6522 2c20 2222 290a 2020 2020 2020 2020  e", "").        
-00005530: 2020 2020 7265 7475 726e 2073 7461 7465      return state
-00005540: 2e6c 6f77 6572 2829 2c20 7265 7370 2e63  .lower(), resp.c
-00005550: 6f6e 7465 6e74 0a0a 2020 2020 2020 2020  ontent..        
-00005560: 7265 7475 726e 2022 756e 6b6e 6f77 6e22  return "unknown"
-00005570: 2c20 7265 7370 2e63 6f6e 7465 6e74 0a0a  , resp.content..
-00005580: 2020 2020 6465 6620 7761 7463 685f 6c6f      def watch_lo
-00005590: 6728 7365 6c66 2c20 7569 642c 2070 726f  g(self, uid, pro
-000055a0: 6a65 6374 3d22 222c 2077 6174 6368 3d54  ject="", watch=T
-000055b0: 7275 652c 206f 6666 7365 743d 3029 3a0a  rue, offset=0):.
-000055c0: 2020 2020 2020 2020 2222 2252 6574 7269          """Retri
-000055d0: 6576 6520 6c6f 6773 206f 6620 6120 7275  eve logs of a ru
-000055e0: 6e6e 696e 6720 7072 6f63 6573 732c 2061  nning process, a
-000055f0: 6e64 2077 6174 6368 2074 6865 2070 726f  nd watch the pro
-00005600: 6772 6573 7320 6f66 2074 6865 2065 7865  gress of the exe
-00005610: 6375 7469 6f6e 2075 6e74 696c 2069 7420  cution until it 
-00005620: 636f 6d70 6c65 7465 732e 2054 6869 730a  completes. This.
-00005630: 2020 2020 2020 2020 6d65 7468 6f64 2077          method w
-00005640: 696c 6c20 7072 696e 7420 6f75 7420 7468  ill print out th
-00005650: 6520 6c6f 6773 2061 6e64 2063 6f6e 7469  e logs and conti
-00005660: 6e75 6520 746f 2070 6572 696f 6469 6361  nue to periodica
-00005670: 6c6c 7920 706f 6c6c 2066 6f72 2c20 616e  lly poll for, an
-00005680: 6420 7072 696e 742c 206e 6577 206c 6f67  d print, new log
-00005690: 7320 6173 206c 6f6e 6720 6173 2074 6865  s as long as the
-000056a0: 0a20 2020 2020 2020 2073 7461 7465 206f  .        state o
-000056b0: 6620 7468 6520 7275 6e74 696d 6520 7768  f the runtime wh
-000056c0: 6963 6820 6765 6e65 7261 7465 7320 7468  ich generates th
-000056d0: 6973 206c 6f67 2069 7320 6569 7468 6572  is log is either
-000056e0: 2060 6070 656e 6469 6e67 6060 206f 7220   ``pending`` or 
-000056f0: 6060 7275 6e6e 696e 6760 602e 0a0a 2020  ``running``...  
-00005700: 2020 2020 2020 3a70 6172 616d 2075 6964        :param uid
-00005710: 3a20 5468 6520 7569 6420 6f66 2074 6865  : The uid of the
-00005720: 206c 6f67 206f 626a 6563 7420 746f 2077   log object to w
-00005730: 6174 6368 2e0a 2020 2020 2020 2020 3a70  atch..        :p
-00005740: 6172 616d 2070 726f 6a65 6374 3a20 5072  aram project: Pr
-00005750: 6f6a 6563 7420 7468 6174 2074 6865 206c  oject that the l
-00005760: 6f67 2062 656c 6f6e 6773 2074 6f2e 0a20  og belongs to.. 
-00005770: 2020 2020 2020 203a 7061 7261 6d20 7761         :param wa
-00005780: 7463 683a 2049 6620 7365 7420 746f 2060  tch: If set to `
-00005790: 6054 7275 6560 6020 7769 6c6c 2063 6f6e  `True`` will con
-000057a0: 7469 6e75 6520 7472 6163 6b69 6e67 2074  tinue tracking t
-000057b0: 6865 206c 6f67 2061 7320 6465 7363 7269  he log as descri
-000057c0: 6265 6420 6162 6f76 652e 204f 7468 6572  bed above. Other
-000057d0: 7769 7365 2074 6869 7320 6675 6e63 7469  wise this functi
-000057e0: 6f6e 0a20 2020 2020 2020 2020 2020 2069  on.            i
-000057f0: 7320 7072 6163 7469 6361 6c6c 7920 6571  s practically eq
-00005800: 7569 7661 6c65 6e74 2074 6f20 7468 6520  uivalent to the 
-00005810: 3a70 793a 6675 6e63 3a60 7e67 6574 5f6c  :py:func:`~get_l
-00005820: 6f67 6020 6675 6e63 7469 6f6e 2e0a 2020  og` function..  
-00005830: 2020 2020 2020 3a70 6172 616d 206f 6666        :param off
-00005840: 7365 743a 204d 696e 696d 616c 206f 6666  set: Minimal off
-00005850: 7365 7420 696e 2074 6865 206c 6f67 2074  set in the log t
-00005860: 6f20 7761 7463 682e 0a20 2020 2020 2020  o watch..       
-00005870: 203a 7265 7475 726e 733a 2054 6865 2066   :returns: The f
-00005880: 696e 616c 2073 7461 7465 206f 6620 7468  inal state of th
-00005890: 6520 6c6f 6720 6265 696e 6720 7761 7463  e log being watc
-000058a0: 6865 642e 0a20 2020 2020 2020 2022 2222  hed..        """
-000058b0: 0a0a 2020 2020 2020 2020 7374 6174 652c  ..        state,
-000058c0: 2074 6578 7420 3d20 7365 6c66 2e67 6574   text = self.get
-000058d0: 5f6c 6f67 2875 6964 2c20 7072 6f6a 6563  _log(uid, projec
-000058e0: 742c 206f 6666 7365 743d 6f66 6673 6574  t, offset=offset
-000058f0: 290a 2020 2020 2020 2020 6966 2074 6578  ).        if tex
-00005900: 743a 0a20 2020 2020 2020 2020 2020 2070  t:.            p
-00005910: 7269 6e74 2874 6578 742e 6465 636f 6465  rint(text.decode
-00005920: 2865 7272 6f72 733d 6d6c 7275 6e2e 6d6c  (errors=mlrun.ml
-00005930: 636f 6e66 2e68 7474 7064 622e 6c6f 6773  conf.httpdb.logs
-00005940: 2e64 6563 6f64 652e 6572 726f 7273 2929  .decode.errors))
-00005950: 0a20 2020 2020 2020 2069 6620 7761 7463  .        if watc
-00005960: 683a 0a20 2020 2020 2020 2020 2020 206e  h:.            n
-00005970: 696c 5f72 6573 7020 3d20 300a 2020 2020  il_resp = 0.    
-00005980: 2020 2020 2020 2020 7768 696c 6520 7374          while st
-00005990: 6174 6520 696e 205b 2270 656e 6469 6e67  ate in ["pending
-000059a0: 222c 2022 7275 6e6e 696e 6722 5d3a 0a20  ", "running"]:. 
-000059b0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-000059c0: 6666 7365 7420 2b3d 206c 656e 2874 6578  ffset += len(tex
-000059d0: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
-000059e0: 2020 2023 2069 6620 7765 2067 6574 2033     # if we get 3
-000059f0: 206e 696c 2072 6573 706f 6e73 6573 2069   nil responses i
-00005a00: 6e20 6120 726f 772c 2069 6e63 7265 6173  n a row, increas
-00005a10: 6520 7468 6520 736c 6565 7020 7469 6d65  e the sleep time
-00005a20: 2074 6f20 3130 2073 6563 6f6e 6473 0a20   to 10 seconds. 
-00005a30: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00005a40: 2054 4f44 4f3a 2072 6566 6163 746f 7220   TODO: refactor 
-00005a50: 7468 6973 2074 6f20 7573 6520 6120 636f  this to use a co
-00005a60: 6e64 6974 696f 6e61 6c20 6261 636b 6f66  nditional backof
-00005a70: 6620 6d65 6368 616e 6973 6d0a 2020 2020  f mechanism.    
-00005a80: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00005a90: 696c 5f72 6573 7020 3c20 333a 0a20 2020  il_resp < 3:.   
-00005aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005ab0: 2074 696d 652e 736c 6565 7028 696e 7428   time.sleep(int(
-00005ac0: 6d6c 7275 6e2e 6d6c 636f 6e66 2e68 7474  mlrun.mlconf.htt
-00005ad0: 7064 622e 6c6f 6773 2e70 756c 6c5f 6c6f  pdb.logs.pull_lo
-00005ae0: 6773 5f64 6566 6175 6c74 5f69 6e74 6572  gs_default_inter
-00005af0: 7661 6c29 290a 2020 2020 2020 2020 2020  val)).          
-00005b00: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00005b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005b20: 7469 6d65 2e73 6c65 6570 280a 2020 2020  time.sleep(.    
-00005b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005b40: 2020 2020 696e 7428 0a20 2020 2020 2020      int(.       
-00005b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005b60: 2020 2020 206d 6c72 756e 2e6d 6c63 6f6e       mlrun.mlcon
-00005b70: 662e 6874 7470 6462 2e6c 6f67 732e 7075  f.httpdb.logs.pu
-00005b80: 6c6c 5f6c 6f67 735f 6261 636b 6f66 665f  ll_logs_backoff_
-00005b90: 6e6f 5f6c 6f67 735f 6465 6661 756c 745f  no_logs_default_
-00005ba0: 696e 7465 7276 616c 0a20 2020 2020 2020  interval.       
-00005bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005bc0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00005bd0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00005be0: 2020 2020 2020 2020 2073 7461 7465 2c20           state, 
-00005bf0: 7465 7874 203d 2073 656c 662e 6765 745f  text = self.get_
-00005c00: 6c6f 6728 7569 642c 2070 726f 6a65 6374  log(uid, project
-00005c10: 2c20 6f66 6673 6574 3d6f 6666 7365 7429  , offset=offset)
-00005c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005c30: 2069 6620 7465 7874 3a0a 2020 2020 2020   if text:.      
-00005c40: 2020 2020 2020 2020 2020 2020 2020 6e69                ni
-00005c50: 6c5f 7265 7370 203d 2030 0a20 2020 2020  l_resp = 0.     
-00005c60: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00005c70: 7269 6e74 280a 2020 2020 2020 2020 2020  rint(.          
-00005c80: 2020 2020 2020 2020 2020 2020 2020 7465                te
-00005c90: 7874 2e64 6563 6f64 6528 6572 726f 7273  xt.decode(errors
-00005ca0: 3d6d 6c72 756e 2e6d 6c63 6f6e 662e 6874  =mlrun.mlconf.ht
-00005cb0: 7470 6462 2e6c 6f67 732e 6465 636f 6465  tpdb.logs.decode
-00005cc0: 2e65 7272 6f72 7329 2c0a 2020 2020 2020  .errors),.      
-00005cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005ce0: 2020 656e 643d 2222 2c0a 2020 2020 2020    end="",.      
-00005cf0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00005d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005d10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00005d20: 2020 2020 2020 2020 2020 6e69 6c5f 7265            nil_re
-00005d30: 7370 202b 3d20 310a 2020 2020 2020 2020  sp += 1.        
-00005d40: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00005d50: 2020 6f66 6673 6574 202b 3d20 6c65 6e28    offset += len(
-00005d60: 7465 7874 290a 0a20 2020 2020 2020 2072  text)..        r
-00005d70: 6574 7572 6e20 7374 6174 652c 206f 6666  eturn state, off
-00005d80: 7365 740a 0a20 2020 2064 6566 2073 746f  set..    def sto
-00005d90: 7265 5f72 756e 2873 656c 662c 2073 7472  re_run(self, str
-00005da0: 7563 742c 2075 6964 2c20 7072 6f6a 6563  uct, uid, projec
-00005db0: 743d 2222 2c20 6974 6572 3d30 293a 0a20  t="", iter=0):. 
-00005dc0: 2020 2020 2020 2022 2222 5374 6f72 6520         """Store 
-00005dd0: 7275 6e20 6465 7461 696c 7320 696e 2074  run details in t
-00005de0: 6865 2044 422e 2054 6869 7320 6d65 7468  he DB. This meth
-00005df0: 6f64 2069 7320 7573 7561 6c6c 7920 6361  od is usually ca
-00005e00: 6c6c 6564 2066 726f 6d20 7769 7468 696e  lled from within
-00005e10: 206f 7468 6572 203a 7079 3a6d 6f64 3a60   other :py:mod:`
-00005e20: 6d6c 7275 6e60 2066 6c6f 7773 0a20 2020  mlrun` flows.   
-00005e30: 2020 2020 2061 6e64 206e 6f74 2063 616c       and not cal
-00005e40: 6c65 6420 6469 7265 6374 6c79 2062 7920  led directly by 
-00005e50: 7468 6520 7573 6572 2e22 2222 0a0a 2020  the user."""..  
-00005e60: 2020 2020 2020 7061 7468 203d 2073 656c        path = sel
-00005e70: 662e 5f70 6174 685f 6f66 2822 7275 6e22  f._path_of("run"
-00005e80: 2c20 7072 6f6a 6563 742c 2075 6964 290a  , project, uid).
-00005e90: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
-00005ea0: 207b 2269 7465 7222 3a20 6974 6572 7d0a   {"iter": iter}.
-00005eb0: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
-00005ec0: 6622 7374 6f72 6520 7275 6e20 7b70 726f  f"store run {pro
-00005ed0: 6a65 6374 7d2f 7b75 6964 7d22 0a20 2020  ject}/{uid}".   
-00005ee0: 2020 2020 2062 6f64 7920 3d20 5f61 735f       body = _as_
-00005ef0: 6a73 6f6e 2873 7472 7563 7429 0a20 2020  json(struct).   
-00005f00: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
-00005f10: 6c6c 2822 504f 5354 222c 2070 6174 682c  ll("POST", path,
-00005f20: 2065 7272 6f72 2c20 7061 7261 6d73 3d70   error, params=p
-00005f30: 6172 616d 732c 2062 6f64 793d 626f 6479  arams, body=body
-00005f40: 290a 0a20 2020 2064 6566 2075 7064 6174  )..    def updat
-00005f50: 655f 7275 6e28 7365 6c66 2c20 7570 6461  e_run(self, upda
-00005f60: 7465 733a 2064 6963 742c 2075 6964 2c20  tes: dict, uid, 
-00005f70: 7072 6f6a 6563 743d 2222 2c20 6974 6572  project="", iter
-00005f80: 3d30 2c20 7469 6d65 6f75 743d 3435 293a  =0, timeout=45):
-00005f90: 0a20 2020 2020 2020 2022 2222 5570 6461  .        """Upda
-00005fa0: 7465 2074 6865 2064 6574 6169 6c73 206f  te the details o
-00005fb0: 6620 6120 7374 6f72 6564 2072 756e 2069  f a stored run i
-00005fc0: 6e20 7468 6520 4442 2e22 2222 0a0a 2020  n the DB."""..  
-00005fd0: 2020 2020 2020 7061 7468 203d 2073 656c        path = sel
-00005fe0: 662e 5f70 6174 685f 6f66 2822 7275 6e22  f._path_of("run"
-00005ff0: 2c20 7072 6f6a 6563 742c 2075 6964 290a  , project, uid).
-00006000: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
-00006010: 207b 2269 7465 7222 3a20 6974 6572 7d0a   {"iter": iter}.
-00006020: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
-00006030: 6622 7570 6461 7465 2072 756e 207b 7072  f"update run {pr
-00006040: 6f6a 6563 747d 2f7b 7569 647d 220a 2020  oject}/{uid}".  
-00006050: 2020 2020 2020 626f 6479 203d 205f 6173        body = _as
-00006060: 5f6a 736f 6e28 7570 6461 7465 7329 0a20  _json(updates). 
-00006070: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
-00006080: 6361 6c6c 2822 5041 5443 4822 2c20 7061  call("PATCH", pa
-00006090: 7468 2c20 6572 726f 722c 2070 6172 616d  th, error, param
-000060a0: 733d 7061 7261 6d73 2c20 626f 6479 3d62  s=params, body=b
-000060b0: 6f64 792c 2074 696d 656f 7574 3d74 696d  ody, timeout=tim
-000060c0: 656f 7574 290a 0a20 2020 2064 6566 2061  eout)..    def a
-000060d0: 626f 7274 5f72 756e 2873 656c 662c 2075  bort_run(self, u
-000060e0: 6964 2c20 7072 6f6a 6563 743d 2222 2c20  id, project="", 
-000060f0: 6974 6572 3d30 2c20 7469 6d65 6f75 743d  iter=0, timeout=
-00006100: 3435 293a 0a20 2020 2020 2020 2022 2222  45):.        """
-00006110: 0a20 2020 2020 2020 2041 626f 7274 2061  .        Abort a
-00006120: 2072 756e 6e69 6e67 2072 756e 202d 2077   running run - w
-00006130: 696c 6c20 7265 6d6f 7665 2074 6865 2072  ill remove the r
-00006140: 756e 2773 2072 756e 7469 6d65 2072 6573  un's runtime res
-00006150: 6f75 7263 6573 2061 6e64 206d 6172 6b20  ources and mark 
-00006160: 6974 7320 7374 6174 6520 6173 2061 626f  its state as abo
-00006170: 7274 6564 0a20 2020 2020 2020 2022 2222  rted.        """
-00006180: 0a20 2020 2020 2020 2073 656c 662e 7570  .        self.up
-00006190: 6461 7465 5f72 756e 280a 2020 2020 2020  date_run(.      
-000061a0: 2020 2020 2020 7b22 7374 6174 7573 2e73        {"status.s
-000061b0: 7461 7465 223a 206d 6c72 756e 2e72 756e  tate": mlrun.run
-000061c0: 7469 6d65 732e 636f 6e73 7461 6e74 732e  times.constants.
-000061d0: 5275 6e53 7461 7465 732e 6162 6f72 7465  RunStates.aborte
-000061e0: 647d 2c0a 2020 2020 2020 2020 2020 2020  d},.            
-000061f0: 7569 642c 0a20 2020 2020 2020 2020 2020  uid,.           
-00006200: 2070 726f 6a65 6374 2c0a 2020 2020 2020   project,.      
-00006210: 2020 2020 2020 6974 6572 2c0a 2020 2020        iter,.    
-00006220: 2020 2020 2020 2020 7469 6d65 6f75 742c          timeout,
-00006230: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00006240: 6465 6620 7265 6164 5f72 756e 2873 656c  def read_run(sel
-00006250: 662c 2075 6964 2c20 7072 6f6a 6563 743d  f, uid, project=
-00006260: 2222 2c20 6974 6572 3d30 293a 0a20 2020  "", iter=0):.   
-00006270: 2020 2020 2022 2222 5265 6164 2074 6865       """Read the
-00006280: 2064 6574 6169 6c73 206f 6620 6120 7374   details of a st
-00006290: 6f72 6564 2072 756e 2066 726f 6d20 7468  ored run from th
-000062a0: 6520 4442 2e0a 0a20 2020 2020 2020 203a  e DB...        :
-000062b0: 7061 7261 6d20 7569 643a 2054 6865 2072  param uid: The r
-000062c0: 756e 2773 2075 6e69 7175 6520 4944 2e0a  un's unique ID..
-000062d0: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-000062e0: 726f 6a65 6374 3a20 5072 6f6a 6563 7420  roject: Project 
-000062f0: 6e61 6d65 2e0a 2020 2020 2020 2020 3a70  name..        :p
-00006300: 6172 616d 2069 7465 723a 2049 7465 7261  aram iter: Itera
-00006310: 7469 6f6e 2077 6974 6869 6e20 6120 7370  tion within a sp
-00006320: 6563 6966 6963 2065 7865 6375 7469 6f6e  ecific execution
-00006330: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-00006340: 2020 2020 2020 2070 6174 6820 3d20 7365         path = se
-00006350: 6c66 2e5f 7061 7468 5f6f 6628 2272 756e  lf._path_of("run
-00006360: 222c 2070 726f 6a65 6374 2c20 7569 6429  ", project, uid)
-00006370: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
-00006380: 3d20 7b22 6974 6572 223a 2069 7465 727d  = {"iter": iter}
-00006390: 0a20 2020 2020 2020 2065 7272 6f72 203d  .        error =
-000063a0: 2066 2267 6574 2072 756e 207b 7072 6f6a   f"get run {proj
-000063b0: 6563 747d 2f7b 7569 647d 220a 2020 2020  ect}/{uid}".    
-000063c0: 2020 2020 7265 7370 203d 2073 656c 662e      resp = self.
-000063d0: 6170 695f 6361 6c6c 2822 4745 5422 2c20  api_call("GET", 
-000063e0: 7061 7468 2c20 6572 726f 722c 2070 6172  path, error, par
-000063f0: 616d 733d 7061 7261 6d73 290a 2020 2020  ams=params).    
-00006400: 2020 2020 7265 7475 726e 2072 6573 702e      return resp.
-00006410: 6a73 6f6e 2829 5b22 6461 7461 225d 0a0a  json()["data"]..
-00006420: 2020 2020 6465 6620 6465 6c5f 7275 6e28      def del_run(
-00006430: 7365 6c66 2c20 7569 642c 2070 726f 6a65  self, uid, proje
-00006440: 6374 3d22 222c 2069 7465 723d 3029 3a0a  ct="", iter=0):.
-00006450: 2020 2020 2020 2020 2222 2244 656c 6574          """Delet
-00006460: 6520 6465 7461 696c 7320 6f66 2061 2073  e details of a s
-00006470: 7065 6369 6669 6320 7275 6e20 6672 6f6d  pecific run from
-00006480: 2044 422e 0a0a 2020 2020 2020 2020 3a70   DB...        :p
-00006490: 6172 616d 2075 6964 3a20 556e 6971 7565  aram uid: Unique
-000064a0: 2049 4420 666f 7220 7468 6520 7370 6563   ID for the spec
-000064b0: 6966 6963 2072 756e 2074 6f20 6465 6c65  ific run to dele
-000064c0: 7465 2e0a 2020 2020 2020 2020 3a70 6172  te..        :par
-000064d0: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
-000064e0: 6563 7420 7468 6174 2074 6865 2072 756e  ect that the run
-000064f0: 2062 656c 6f6e 6773 2074 6f2e 0a20 2020   belongs to..   
-00006500: 2020 2020 203a 7061 7261 6d20 6974 6572       :param iter
-00006510: 3a20 4974 6572 6174 696f 6e20 7769 7468  : Iteration with
-00006520: 696e 2061 2073 7065 6369 6669 6320 7461  in a specific ta
-00006530: 736b 2e0a 2020 2020 2020 2020 2222 220a  sk..        """.
-00006540: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-00006550: 7365 6c66 2e5f 7061 7468 5f6f 6628 2272  self._path_of("r
-00006560: 756e 222c 2070 726f 6a65 6374 2c20 7569  un", project, ui
-00006570: 6429 0a20 2020 2020 2020 2070 6172 616d  d).        param
-00006580: 7320 3d20 7b22 6974 6572 223a 2069 7465  s = {"iter": ite
-00006590: 727d 0a20 2020 2020 2020 2065 7272 6f72  r}.        error
-000065a0: 203d 2066 2264 656c 2072 756e 207b 7072   = f"del run {pr
-000065b0: 6f6a 6563 747d 2f7b 7569 647d 220a 2020  oject}/{uid}".  
-000065c0: 2020 2020 2020 7365 6c66 2e61 7069 5f63        self.api_c
-000065d0: 616c 6c28 2244 454c 4554 4522 2c20 7061  all("DELETE", pa
-000065e0: 7468 2c20 6572 726f 722c 2070 6172 616d  th, error, param
-000065f0: 733d 7061 7261 6d73 290a 0a20 2020 2064  s=params)..    d
-00006600: 6566 206c 6973 745f 7275 6e73 280a 2020  ef list_runs(.  
-00006610: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00006620: 2020 2020 6e61 6d65 3a20 4f70 7469 6f6e      name: Option
-00006630: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-00006640: 2020 2020 2020 2020 7569 643a 204f 7074          uid: Opt
-00006650: 696f 6e61 6c5b 556e 696f 6e5b 7374 722c  ional[Union[str,
-00006660: 204c 6973 745b 7374 725d 5d5d 203d 204e   List[str]]] = N
-00006670: 6f6e 652c 0a20 2020 2020 2020 2070 726f  one,.        pro
-00006680: 6a65 6374 3a20 4f70 7469 6f6e 616c 5b73  ject: Optional[s
-00006690: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-000066a0: 2020 2020 6c61 6265 6c73 3a20 4f70 7469      labels: Opti
-000066b0: 6f6e 616c 5b55 6e69 6f6e 5b73 7472 2c20  onal[Union[str, 
-000066c0: 4c69 7374 5b73 7472 5d5d 5d20 3d20 4e6f  List[str]]] = No
-000066d0: 6e65 2c0a 2020 2020 2020 2020 7374 6174  ne,.        stat
-000066e0: 653a 204f 7074 696f 6e61 6c5b 7374 725d  e: Optional[str]
-000066f0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00006700: 2073 6f72 743a 2062 6f6f 6c20 3d20 5472   sort: bool = Tr
-00006710: 7565 2c0a 2020 2020 2020 2020 6c61 7374  ue,.        last
-00006720: 3a20 696e 7420 3d20 302c 0a20 2020 2020  : int = 0,.     
-00006730: 2020 2069 7465 723a 2062 6f6f 6c20 3d20     iter: bool = 
-00006740: 4661 6c73 652c 0a20 2020 2020 2020 2073  False,.        s
-00006750: 7461 7274 5f74 696d 655f 6672 6f6d 3a20  tart_time_from: 
-00006760: 4f70 7469 6f6e 616c 5b64 6174 6574 696d  Optional[datetim
-00006770: 655d 203d 204e 6f6e 652c 0a20 2020 2020  e] = None,.     
-00006780: 2020 2073 7461 7274 5f74 696d 655f 746f     start_time_to
-00006790: 3a20 4f70 7469 6f6e 616c 5b64 6174 6574  : Optional[datet
-000067a0: 696d 655d 203d 204e 6f6e 652c 0a20 2020  ime] = None,.   
-000067b0: 2020 2020 206c 6173 745f 7570 6461 7465       last_update
-000067c0: 5f74 696d 655f 6672 6f6d 3a20 4f70 7469  _time_from: Opti
-000067d0: 6f6e 616c 5b64 6174 6574 696d 655d 203d  onal[datetime] =
-000067e0: 204e 6f6e 652c 0a20 2020 2020 2020 206c   None,.        l
-000067f0: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
-00006800: 746f 3a20 4f70 7469 6f6e 616c 5b64 6174  to: Optional[dat
-00006810: 6574 696d 655d 203d 204e 6f6e 652c 0a20  etime] = None,. 
-00006820: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00006830: 5f62 793a 204f 7074 696f 6e61 6c5b 0a20  _by: Optional[. 
-00006840: 2020 2020 2020 2020 2020 2055 6e69 6f6e             Union
-00006850: 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  [mlrun.common.sc
-00006860: 6865 6d61 732e 5275 6e50 6172 7469 7469  hemas.RunPartiti
-00006870: 6f6e 4279 4669 656c 642c 2073 7472 5d0a  onByField, str].
-00006880: 2020 2020 2020 2020 5d20 3d20 4e6f 6e65          ] = None
-00006890: 2c0a 2020 2020 2020 2020 726f 7773 5f70  ,.        rows_p
-000068a0: 6572 5f70 6172 7469 7469 6f6e 3a20 696e  er_partition: in
-000068b0: 7420 3d20 312c 0a20 2020 2020 2020 2070  t = 1,.        p
-000068c0: 6172 7469 7469 6f6e 5f73 6f72 745f 6279  artition_sort_by
-000068d0: 3a20 4f70 7469 6f6e 616c 5b55 6e69 6f6e  : Optional[Union
-000068e0: 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  [mlrun.common.sc
-000068f0: 6865 6d61 732e 536f 7274 4669 656c 642c  hemas.SortField,
-00006900: 2073 7472 5d5d 203d 204e 6f6e 652c 0a20   str]] = None,. 
-00006910: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00006920: 5f6f 7264 6572 3a20 556e 696f 6e5b 0a20  _order: Union[. 
-00006930: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
-00006940: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00006950: 4f72 6465 7254 7970 652c 2073 7472 0a20  OrderType, str. 
-00006960: 2020 2020 2020 205d 203d 206d 6c72 756e         ] = mlrun
-00006970: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00006980: 4f72 6465 7254 7970 652e 6465 7363 2c0a  OrderType.desc,.
-00006990: 2020 2020 2020 2020 6d61 785f 7061 7274          max_part
-000069a0: 6974 696f 6e73 3a20 696e 7420 3d20 302c  itions: int = 0,
-000069b0: 0a20 2020 2020 2020 2077 6974 685f 6e6f  .        with_no
-000069c0: 7469 6669 6361 7469 6f6e 733a 2062 6f6f  tifications: boo
-000069d0: 6c20 3d20 4661 6c73 652c 0a20 2020 2029  l = False,.    )
-000069e0: 202d 3e20 5275 6e4c 6973 743a 0a20 2020   -> RunList:.   
-000069f0: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
-00006a00: 2061 206c 6973 7420 6f66 2072 756e 732c   a list of runs,
-00006a10: 2066 696c 7465 7265 6420 6279 2076 6172   filtered by var
-00006a20: 696f 7573 206f 7074 696f 6e73 2e0a 2020  ious options..  
-00006a30: 2020 2020 2020 4578 616d 706c 653a 3a0a        Example::.
-00006a40: 0a20 2020 2020 2020 2020 2020 2072 756e  .            run
-00006a50: 7320 3d20 6462 2e6c 6973 745f 7275 6e73  s = db.list_runs
-00006a60: 286e 616d 653d 2764 6f77 6e6c 6f61 6427  (name='download'
-00006a70: 2c20 7072 6f6a 6563 743d 2769 7269 7327  , project='iris'
-00006a80: 2c20 6c61 6265 6c73 3d5b 276f 776e 6572  , labels=['owner
-00006a90: 3d61 646d 696e 272c 2027 6b69 6e64 3d6a  =admin', 'kind=j
-00006aa0: 6f62 275d 290a 2020 2020 2020 2020 2020  ob']).          
-00006ab0: 2020 2320 4966 2072 756e 6e69 6e67 2069    # If running i
-00006ac0: 6e20 4a75 7079 7465 722c 2063 616e 2075  n Jupyter, can u
-00006ad0: 7365 2074 6865 202e 7368 6f77 2829 2066  se the .show() f
-00006ae0: 756e 6374 696f 6e20 746f 2064 6973 706c  unction to displ
-00006af0: 6179 2074 6865 2072 6573 756c 7473 0a20  ay the results. 
-00006b00: 2020 2020 2020 2020 2020 2064 622e 6c69             db.li
-00006b10: 7374 5f72 756e 7328 6e61 6d65 3d27 272c  st_runs(name='',
-00006b20: 2070 726f 6a65 6374 3d70 726f 6a65 6374   project=project
-00006b30: 5f6e 616d 6529 2e73 686f 7728 290a 0a0a  _name).show()...
-00006b40: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-00006b50: 616d 653a 204e 616d 6520 6f66 2074 6865  ame: Name of the
-00006b60: 2072 756e 2074 6f20 7265 7472 6965 7665   run to retrieve
-00006b70: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00006b80: 2075 6964 3a20 556e 6971 7565 2049 4420   uid: Unique ID 
-00006b90: 6f66 2074 6865 2072 756e 2c20 6f72 2061  of the run, or a
-00006ba0: 206c 6973 7420 6f66 2072 756e 2055 4944   list of run UID
-00006bb0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-00006bc0: 6d20 7072 6f6a 6563 743a 2050 726f 6a65  m project: Proje
-00006bd0: 6374 2074 6861 7420 7468 6520 7275 6e73  ct that the runs
-00006be0: 2062 656c 6f6e 6773 2074 6f2e 0a20 2020   belongs to..   
-00006bf0: 2020 2020 203a 7061 7261 6d20 6c61 6265       :param labe
-00006c00: 6c73 3a20 4c69 7374 2072 756e 7320 7468  ls: List runs th
-00006c10: 6174 2068 6176 6520 7370 6563 6966 6963  at have specific
-00006c20: 206c 6162 656c 7320 6173 7369 676e 6564   labels assigned
-00006c30: 2e20 6120 7369 6e67 6c65 206f 7220 6d75  . a single or mu
-00006c40: 6c74 6920 6c61 6265 6c20 6669 6c74 6572  lti label filter
-00006c50: 2063 616e 2062 650a 2020 2020 2020 2020   can be.        
-00006c60: 2020 2020 6170 706c 6965 642e 0a20 2020      applied..   
-00006c70: 2020 2020 203a 7061 7261 6d20 7374 6174       :param stat
-00006c80: 653a 204c 6973 7420 6f6e 6c79 2072 756e  e: List only run
-00006c90: 7320 7768 6f73 6520 7374 6174 6520 6973  s whose state is
-00006ca0: 2073 7065 6369 6669 6564 2e0a 2020 2020   specified..    
-00006cb0: 2020 2020 3a70 6172 616d 2073 6f72 743a      :param sort:
-00006cc0: 2057 6865 7468 6572 2074 6f20 736f 7274   Whether to sort
-00006cd0: 2074 6865 2072 6573 756c 7420 6163 636f   the result acco
-00006ce0: 7264 696e 6720 746f 2074 6865 6972 2073  rding to their s
-00006cf0: 7461 7274 2074 696d 652e 204f 7468 6572  tart time. Other
-00006d00: 7769 7365 2c20 7265 7375 6c74 7320 7769  wise, results wi
-00006d10: 6c6c 2062 650a 2020 2020 2020 2020 2020  ll be.          
-00006d20: 2020 7265 7475 726e 6564 2062 7920 7468    returned by th
-00006d30: 6569 7220 696e 7465 726e 616c 206f 7264  eir internal ord
-00006d40: 6572 2069 6e20 7468 6520 4442 2028 6f72  er in the DB (or
-00006d50: 6465 7220 7769 6c6c 206e 6f74 2062 6520  der will not be 
-00006d60: 6775 6172 616e 7465 6564 292e 0a20 2020  guaranteed)..   
-00006d70: 2020 2020 203a 7061 7261 6d20 6c61 7374       :param last
-00006d80: 3a20 4465 7072 6563 6174 6564 202d 2063  : Deprecated - c
-00006d90: 7572 7265 6e74 6c79 206e 6f74 2075 7365  urrently not use
-00006da0: 642e 0a20 2020 2020 2020 203a 7061 7261  d..        :para
-00006db0: 6d20 6974 6572 3a20 4966 2060 6054 7275  m iter: If ``Tru
-00006dc0: 6560 6020 7265 7475 726e 2072 756e 7320  e`` return runs 
-00006dd0: 6672 6f6d 2061 6c6c 2069 7465 7261 7469  from all iterati
-00006de0: 6f6e 732e 204f 7468 6572 7769 7365 2c20  ons. Otherwise, 
-00006df0: 7265 7475 726e 206f 6e6c 7920 7275 6e73  return only runs
-00006e00: 2077 686f 7365 2060 6069 7465 7260 6020   whose ``iter`` 
-00006e10: 6973 2030 2e0a 2020 2020 2020 2020 3a70  is 0..        :p
-00006e20: 6172 616d 2073 7461 7274 5f74 696d 655f  aram start_time_
-00006e30: 6672 6f6d 3a20 4669 6c74 6572 2062 7920  from: Filter by 
-00006e40: 7275 6e20 7374 6172 7420 7469 6d65 2069  run start time i
-00006e50: 6e20 6060 5b73 7461 7274 5f74 696d 655f  n ``[start_time_
-00006e60: 6672 6f6d 2c20 7374 6172 745f 7469 6d65  from, start_time
-00006e70: 5f74 6f5d 6060 2e0a 2020 2020 2020 2020  _to]``..        
-00006e80: 3a70 6172 616d 2073 7461 7274 5f74 696d  :param start_tim
-00006e90: 655f 746f 3a20 4669 6c74 6572 2062 7920  e_to: Filter by 
-00006ea0: 7275 6e20 7374 6172 7420 7469 6d65 2069  run start time i
-00006eb0: 6e20 6060 5b73 7461 7274 5f74 696d 655f  n ``[start_time_
-00006ec0: 6672 6f6d 2c20 7374 6172 745f 7469 6d65  from, start_time
-00006ed0: 5f74 6f5d 6060 2e0a 2020 2020 2020 2020  _to]``..        
-00006ee0: 3a70 6172 616d 206c 6173 745f 7570 6461  :param last_upda
-00006ef0: 7465 5f74 696d 655f 6672 6f6d 3a20 4669  te_time_from: Fi
-00006f00: 6c74 6572 2062 7920 7275 6e20 6c61 7374  lter by run last
-00006f10: 2075 7064 6174 6520 7469 6d65 2069 6e20   update time in 
-00006f20: 6060 286c 6173 745f 7570 6461 7465 5f74  ``(last_update_t
-00006f30: 696d 655f 6672 6f6d 2c0a 2020 2020 2020  ime_from,.      
-00006f40: 2020 2020 2020 6c61 7374 5f75 7064 6174        last_updat
-00006f50: 655f 7469 6d65 5f74 6f29 6060 2e0a 2020  e_time_to)``..  
-00006f60: 2020 2020 2020 3a70 6172 616d 206c 6173        :param las
-00006f70: 745f 7570 6461 7465 5f74 696d 655f 746f  t_update_time_to
-00006f80: 3a20 4669 6c74 6572 2062 7920 7275 6e20  : Filter by run 
-00006f90: 6c61 7374 2075 7064 6174 6520 7469 6d65  last update time
-00006fa0: 2069 6e20 6060 286c 6173 745f 7570 6461   in ``(last_upda
-00006fb0: 7465 5f74 696d 655f 6672 6f6d 2c20 6c61  te_time_from, la
-00006fc0: 7374 5f75 7064 6174 655f 7469 6d65 5f74  st_update_time_t
-00006fd0: 6f29 6060 2e0a 2020 2020 2020 2020 3a70  o)``..        :p
-00006fe0: 6172 616d 2070 6172 7469 7469 6f6e 5f62  aram partition_b
-00006ff0: 793a 2046 6965 6c64 2074 6f20 6772 6f75  y: Field to grou
-00007000: 7020 7265 7375 6c74 7320 6279 2e20 4f6e  p results by. On
-00007010: 6c79 2061 6c6c 6f77 6564 2076 616c 7565  ly allowed value
-00007020: 2069 7320 606e 616d 6560 2e20 5768 656e   is `name`. When
-00007030: 2060 7061 7274 6974 696f 6e5f 6279 6020   `partition_by` 
-00007040: 6973 2073 7065 6369 6669 6564 2c0a 2020  is specified,.  
-00007050: 2020 2020 2020 2020 2020 7468 6520 6070            the `p
-00007060: 6172 7469 7469 6f6e 5f73 6f72 745f 6279  artition_sort_by
-00007070: 6020 7061 7261 6d65 7465 7220 6d75 7374  ` parameter must
-00007080: 2062 6520 7072 6f76 6964 6564 2061 7320   be provided as 
-00007090: 7765 6c6c 2e0a 2020 2020 2020 2020 3a70  well..        :p
-000070a0: 6172 616d 2072 6f77 735f 7065 725f 7061  aram rows_per_pa
-000070b0: 7274 6974 696f 6e3a 2048 6f77 206d 616e  rtition: How man
-000070c0: 7920 746f 7020 726f 7773 2028 7065 7220  y top rows (per 
-000070d0: 736f 7274 696e 6720 6465 6669 6e65 6420  sorting defined 
-000070e0: 6279 2060 7061 7274 6974 696f 6e5f 736f  by `partition_so
-000070f0: 7274 5f62 7960 2061 6e64 2060 7061 7274  rt_by` and `part
-00007100: 6974 696f 6e5f 6f72 6465 7260 290a 2020  ition_order`).  
-00007110: 2020 2020 2020 2020 2020 746f 2072 6574            to ret
-00007120: 7572 6e20 7065 7220 6772 6f75 702e 2044  urn per group. D
-00007130: 6566 6175 6c74 2076 616c 7565 2069 7320  efault value is 
-00007140: 312e 0a20 2020 2020 2020 203a 7061 7261  1..        :para
-00007150: 6d20 7061 7274 6974 696f 6e5f 736f 7274  m partition_sort
-00007160: 5f62 793a 2057 6861 7420 6669 656c 6420  _by: What field 
-00007170: 746f 2073 6f72 7420 7468 6520 7265 7375  to sort the resu
-00007180: 6c74 7320 6279 2c20 7769 7468 696e 2065  lts by, within e
-00007190: 6163 6820 7061 7274 6974 696f 6e20 6465  ach partition de
-000071a0: 6669 6e65 6420 6279 2060 7061 7274 6974  fined by `partit
-000071b0: 696f 6e5f 6279 602e 0a20 2020 2020 2020  ion_by`..       
-000071c0: 2020 2020 2043 7572 7265 6e74 6c79 2074       Currently t
-000071d0: 6865 206f 6e6c 7920 616c 6c6f 7765 6420  he only allowed 
-000071e0: 7661 6c75 6573 2061 7265 2060 6372 6561  values are `crea
-000071f0: 7465 6460 2061 6e64 2060 7570 6461 7465  ted` and `update
-00007200: 6460 2e0a 2020 2020 2020 2020 3a70 6172  d`..        :par
-00007210: 616d 2070 6172 7469 7469 6f6e 5f6f 7264  am partition_ord
-00007220: 6572 3a20 4f72 6465 7220 6f66 2073 6f72  er: Order of sor
-00007230: 7469 6e67 2077 6974 6869 6e20 7061 7274  ting within part
-00007240: 6974 696f 6e73 202d 2060 6173 6360 206f  itions - `asc` o
-00007250: 7220 6064 6573 6360 2e20 4465 6661 756c  r `desc`. Defaul
-00007260: 7420 6973 2060 6465 7363 602e 0a20 2020  t is `desc`..   
-00007270: 2020 2020 203a 7061 7261 6d20 6d61 785f       :param max_
-00007280: 7061 7274 6974 696f 6e73 3a20 4d61 7869  partitions: Maxi
-00007290: 6d61 6c20 6e75 6d62 6572 206f 6620 7061  mal number of pa
-000072a0: 7274 6974 696f 6e73 2074 6f20 696e 636c  rtitions to incl
-000072b0: 7564 6520 696e 2074 6865 2072 6573 756c  ude in the resul
-000072c0: 742e 2044 6566 6175 6c74 2069 7320 6030  t. Default is `0
-000072d0: 6020 7768 6963 6820 6d65 616e 7320 6e6f  ` which means no
-000072e0: 0a20 2020 2020 2020 2020 2020 206c 696d  .            lim
-000072f0: 6974 2e0a 2020 2020 2020 2020 3a70 6172  it..        :par
-00007300: 616d 2077 6974 685f 6e6f 7469 6669 6361  am with_notifica
-00007310: 7469 6f6e 733a 2052 6574 7572 6e20 7275  tions: Return ru
-00007320: 6e73 2077 6974 6820 6e6f 7469 6669 6361  ns with notifica
-00007330: 7469 6f6e 732c 2061 6e64 206a 6f69 6e20  tions, and join 
-00007340: 7468 656d 2074 6f20 7468 6520 7265 7370  them to the resp
-00007350: 6f6e 7365 2e20 4465 6661 756c 7420 6973  onse. Default is
-00007360: 2060 4661 6c73 6560 2e0a 2020 2020 2020   `False`..      
-00007370: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
-00007380: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
-00007390: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
-000073a0: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
-000073b0: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
-000073c0: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
-000073d0: 3a20 6e61 6d65 2c0a 2020 2020 2020 2020  : name,.        
-000073e0: 2020 2020 2275 6964 223a 2075 6964 2c0a      "uid": uid,.
-000073f0: 2020 2020 2020 2020 2020 2020 2270 726f              "pro
-00007400: 6a65 6374 223a 2070 726f 6a65 6374 2c0a  ject": project,.
-00007410: 2020 2020 2020 2020 2020 2020 226c 6162              "lab
-00007420: 656c 223a 206c 6162 656c 7320 6f72 205b  el": labels or [
-00007430: 5d2c 0a20 2020 2020 2020 2020 2020 2022  ],.            "
-00007440: 7374 6174 6522 3a20 7374 6174 652c 0a20  state": state,. 
-00007450: 2020 2020 2020 2020 2020 2022 736f 7274             "sort
-00007460: 223a 2062 6f6f 6c32 7374 7228 736f 7274  ": bool2str(sort
-00007470: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-00007480: 6974 6572 223a 2062 6f6f 6c32 7374 7228  iter": bool2str(
-00007490: 6974 6572 292c 0a20 2020 2020 2020 2020  iter),.         
-000074a0: 2020 2022 7374 6172 745f 7469 6d65 5f66     "start_time_f
-000074b0: 726f 6d22 3a20 6461 7465 7469 6d65 5f74  rom": datetime_t
-000074c0: 6f5f 6973 6f28 7374 6172 745f 7469 6d65  o_iso(start_time
-000074d0: 5f66 726f 6d29 2c0a 2020 2020 2020 2020  _from),.        
-000074e0: 2020 2020 2273 7461 7274 5f74 696d 655f      "start_time_
-000074f0: 746f 223a 2064 6174 6574 696d 655f 746f  to": datetime_to
-00007500: 5f69 736f 2873 7461 7274 5f74 696d 655f  _iso(start_time_
-00007510: 746f 292c 0a20 2020 2020 2020 2020 2020  to),.           
-00007520: 2022 6c61 7374 5f75 7064 6174 655f 7469   "last_update_ti
-00007530: 6d65 5f66 726f 6d22 3a20 6461 7465 7469  me_from": dateti
-00007540: 6d65 5f74 6f5f 6973 6f28 6c61 7374 5f75  me_to_iso(last_u
-00007550: 7064 6174 655f 7469 6d65 5f66 726f 6d29  pdate_time_from)
-00007560: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
-00007570: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
-00007580: 746f 223a 2064 6174 6574 696d 655f 746f  to": datetime_to
-00007590: 5f69 736f 286c 6173 745f 7570 6461 7465  _iso(last_update
-000075a0: 5f74 696d 655f 746f 292c 0a20 2020 2020  _time_to),.     
-000075b0: 2020 2020 2020 2022 7769 7468 2d6e 6f74         "with-not
-000075c0: 6966 6963 6174 696f 6e73 223a 2077 6974  ifications": wit
-000075d0: 685f 6e6f 7469 6669 6361 7469 6f6e 732c  h_notifications,
-000075e0: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
-000075f0: 2020 2020 6966 2070 6172 7469 7469 6f6e      if partition
-00007600: 5f62 793a 0a20 2020 2020 2020 2020 2020  _by:.           
-00007610: 2070 6172 616d 732e 7570 6461 7465 280a   params.update(.
-00007620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007630: 7365 6c66 2e5f 6765 6e65 7261 7465 5f70  self._generate_p
-00007640: 6172 7469 7469 6f6e 5f62 795f 7061 7261  artition_by_para
-00007650: 6d73 280a 2020 2020 2020 2020 2020 2020  ms(.            
-00007660: 2020 2020 2020 2020 6d6c 7275 6e2e 636f          mlrun.co
-00007670: 6d6d 6f6e 2e73 6368 656d 6173 2e52 756e  mmon.schemas.Run
-00007680: 5061 7274 6974 696f 6e42 7946 6965 6c64  PartitionByField
-00007690: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000076a0: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
-000076b0: 6279 2c0a 2020 2020 2020 2020 2020 2020  by,.            
-000076c0: 2020 2020 2020 2020 726f 7773 5f70 6572          rows_per
-000076d0: 5f70 6172 7469 7469 6f6e 2c0a 2020 2020  _partition,.    
-000076e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000076f0: 7061 7274 6974 696f 6e5f 736f 7274 5f62  partition_sort_b
-00007700: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-00007710: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00007720: 5f6f 7264 6572 2c0a 2020 2020 2020 2020  _order,.        
-00007730: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
-00007740: 7061 7274 6974 696f 6e73 2c0a 2020 2020  partitions,.    
-00007750: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00007760: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00007770: 2020 2020 6572 726f 7220 3d20 226c 6973      error = "lis
-00007780: 7420 7275 6e73 220a 2020 2020 2020 2020  t runs".        
-00007790: 7265 7370 203d 2073 656c 662e 6170 695f  resp = self.api_
-000077a0: 6361 6c6c 2822 4745 5422 2c20 2272 756e  call("GET", "run
-000077b0: 7322 2c20 6572 726f 722c 2070 6172 616d  s", error, param
-000077c0: 733d 7061 7261 6d73 290a 2020 2020 2020  s=params).      
-000077d0: 2020 7265 7475 726e 2052 756e 4c69 7374    return RunList
-000077e0: 2872 6573 702e 6a73 6f6e 2829 5b22 7275  (resp.json()["ru
-000077f0: 6e73 225d 290a 0a20 2020 2064 6566 2064  ns"])..    def d
-00007800: 656c 5f72 756e 7328 7365 6c66 2c20 6e61  el_runs(self, na
-00007810: 6d65 3d4e 6f6e 652c 2070 726f 6a65 6374  me=None, project
-00007820: 3d4e 6f6e 652c 206c 6162 656c 733d 4e6f  =None, labels=No
-00007830: 6e65 2c20 7374 6174 653d 4e6f 6e65 2c20  ne, state=None, 
-00007840: 6461 7973 5f61 676f 3d30 293a 0a20 2020  days_ago=0):.   
-00007850: 2020 2020 2022 2222 4465 6c65 7465 2061       """Delete a
-00007860: 2067 726f 7570 206f 6620 7275 6e73 2069   group of runs i
-00007870: 6465 6e74 6966 6965 6420 6279 2074 6865  dentified by the
-00007880: 2070 6172 616d 6574 6572 7320 6f66 2074   parameters of t
-00007890: 6865 2066 756e 6374 696f 6e2e 0a0a 2020  he function...  
-000078a0: 2020 2020 2020 4578 616d 706c 653a 3a0a        Example::.
-000078b0: 0a20 2020 2020 2020 2020 2020 2064 622e  .            db.
-000078c0: 6465 6c5f 7275 6e73 2873 7461 7465 3d27  del_runs(state='
-000078d0: 636f 6d70 6c65 7465 6427 290a 0a20 2020  completed')..   
-000078e0: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
-000078f0: 3a20 4e61 6d65 206f 6620 7468 6520 7461  : Name of the ta
-00007900: 736b 2077 6869 6368 2074 6865 2072 756e  sk which the run
-00007910: 7320 6265 6c6f 6e67 2074 6f2e 0a20 2020  s belong to..   
-00007920: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-00007930: 6563 743a 2050 726f 6a65 6374 2074 6f20  ect: Project to 
-00007940: 7768 6963 6820 7468 6520 7275 6e73 2062  which the runs b
-00007950: 656c 6f6e 672e 0a20 2020 2020 2020 203a  elong..        :
-00007960: 7061 7261 6d20 6c61 6265 6c73 3a20 4669  param labels: Fi
-00007970: 6c74 6572 2072 756e 7320 7468 6174 2061  lter runs that a
-00007980: 7265 206c 6162 656c 6564 2075 7369 6e67  re labeled using
-00007990: 2074 6865 7365 2073 7065 6369 6669 6320   these specific 
-000079a0: 6c61 6265 6c20 7661 6c75 6573 2e0a 2020  label values..  
-000079b0: 2020 2020 2020 3a70 6172 616d 2073 7461        :param sta
-000079c0: 7465 3a20 4669 6c74 6572 206f 6e6c 7920  te: Filter only 
-000079d0: 7275 6e73 2077 6869 6368 2061 7265 2069  runs which are i
-000079e0: 6e20 7468 6973 2073 7461 7465 2e0a 2020  n this state..  
-000079f0: 2020 2020 2020 3a70 6172 616d 2064 6179        :param day
-00007a00: 735f 6167 6f3a 2046 696c 7465 7220 7275  s_ago: Filter ru
-00007a10: 6e73 2077 686f 7365 2073 7461 7274 2074  ns whose start t
-00007a20: 696d 6520 6973 206e 6577 6572 2074 6861  ime is newer tha
-00007a30: 6e20 7468 6973 2070 6172 616d 6574 6572  n this parameter
-00007a40: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-00007a50: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
-00007a60: 2070 726f 6a65 6374 206f 7220 636f 6e66   project or conf
-00007a70: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
-00007a80: 6374 0a20 2020 2020 2020 2070 6172 616d  ct.        param
-00007a90: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-00007aa0: 2020 226e 616d 6522 3a20 6e61 6d65 2c0a    "name": name,.
-00007ab0: 2020 2020 2020 2020 2020 2020 2270 726f              "pro
-00007ac0: 6a65 6374 223a 2070 726f 6a65 6374 2c0a  ject": project,.
-00007ad0: 2020 2020 2020 2020 2020 2020 226c 6162              "lab
-00007ae0: 656c 223a 206c 6162 656c 7320 6f72 205b  el": labels or [
-00007af0: 5d2c 0a20 2020 2020 2020 2020 2020 2022  ],.            "
-00007b00: 7374 6174 6522 3a20 7374 6174 652c 0a20  state": state,. 
-00007b10: 2020 2020 2020 2020 2020 2022 6461 7973             "days
-00007b20: 5f61 676f 223a 2073 7472 2864 6179 735f  _ago": str(days_
-00007b30: 6167 6f29 2c0a 2020 2020 2020 2020 7d0a  ago),.        }.
-00007b40: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
-00007b50: 2264 656c 2072 756e 7322 0a20 2020 2020  "del runs".     
-00007b60: 2020 2073 656c 662e 6170 695f 6361 6c6c     self.api_call
-00007b70: 2822 4445 4c45 5445 222c 2022 7275 6e73  ("DELETE", "runs
-00007b80: 222c 2065 7272 6f72 2c20 7061 7261 6d73  ", error, params
-00007b90: 3d70 6172 616d 7329 0a0a 2020 2020 6465  =params)..    de
-00007ba0: 6620 7374 6f72 655f 6172 7469 6661 6374  f store_artifact
-00007bb0: 2873 656c 662c 206b 6579 2c20 6172 7469  (self, key, arti
-00007bc0: 6661 6374 2c20 7569 642c 2069 7465 723d  fact, uid, iter=
-00007bd0: 4e6f 6e65 2c20 7461 673d 4e6f 6e65 2c20  None, tag=None, 
-00007be0: 7072 6f6a 6563 743d 2222 293a 0a20 2020  project=""):.   
-00007bf0: 2020 2020 2022 2222 5374 6f72 6520 616e       """Store an
-00007c00: 2061 7274 6966 6163 7420 696e 2074 6865   artifact in the
-00007c10: 2044 422e 0a0a 2020 2020 2020 2020 3a70   DB...        :p
-00007c20: 6172 616d 206b 6579 3a20 4964 656e 7469  aram key: Identi
-00007c30: 6679 696e 6720 6b65 7920 6f66 2074 6865  fying key of the
-00007c40: 2061 7274 6966 6163 742e 0a20 2020 2020   artifact..     
-00007c50: 2020 203a 7061 7261 6d20 6172 7469 6661     :param artifa
-00007c60: 6374 3a20 5468 6520 6163 7475 616c 2061  ct: The actual a
-00007c70: 7274 6966 6163 7420 746f 2073 746f 7265  rtifact to store
-00007c80: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00007c90: 2075 6964 3a20 4120 756e 6971 7565 2049   uid: A unique I
-00007ca0: 4420 666f 7220 7468 6973 2073 7065 6369  D for this speci
-00007cb0: 6669 6320 7665 7273 696f 6e20 6f66 2074  fic version of t
-00007cc0: 6865 2061 7274 6966 6163 742e 0a20 2020  he artifact..   
-00007cd0: 2020 2020 203a 7061 7261 6d20 6974 6572       :param iter
-00007ce0: 3a20 5468 6520 7461 736b 2069 7465 7261  : The task itera
-00007cf0: 7469 6f6e 2077 6869 6368 2067 656e 6572  tion which gener
-00007d00: 6174 6564 2074 6869 7320 6172 7469 6661  ated this artifa
-00007d10: 6374 2e20 4966 2060 6069 7465 7260 6020  ct. If ``iter`` 
-00007d20: 6973 206e 6f74 2060 604e 6f6e 6560 6020  is not ``None`` 
-00007d30: 7468 6520 6974 6572 6174 696f 6e20 7769  the iteration wi
-00007d40: 6c6c 0a20 2020 2020 2020 2020 2020 2062  ll.            b
-00007d50: 6520 6164 6465 6420 746f 2074 6865 206b  e added to the k
-00007d60: 6579 2070 726f 7669 6465 6420 746f 2067  ey provided to g
-00007d70: 656e 6572 6174 6520 6120 756e 6971 7565  enerate a unique
-00007d80: 206b 6579 2066 6f72 2074 6865 2061 7274   key for the art
-00007d90: 6966 6163 7420 6f66 2074 6865 2073 7065  ifact of the spe
-00007da0: 6369 6669 6320 6974 6572 6174 696f 6e2e  cific iteration.
-00007db0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00007dc0: 7461 673a 2054 6167 206f 6620 7468 6520  tag: Tag of the 
-00007dd0: 6172 7469 6661 6374 2e0a 2020 2020 2020  artifact..      
-00007de0: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
-00007df0: 3a20 5072 6f6a 6563 7420 7468 6174 2074  : Project that t
-00007e00: 6865 2061 7274 6966 6163 7420 6265 6c6f  he artifact belo
-00007e10: 6e67 7320 746f 2e0a 2020 2020 2020 2020  ngs to..        
-00007e20: 2222 220a 0a20 2020 2020 2020 2065 6e64  """..        end
-00007e30: 706f 696e 745f 7061 7468 203d 2066 2270  point_path = f"p
-00007e40: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
-00007e50: 7d2f 6172 7469 6661 6374 732f 7b75 6964  }/artifacts/{uid
-00007e60: 7d2f 7b6b 6579 7d22 0a20 2020 2020 2020  }/{key}".       
-00007e70: 2070 6172 616d 7320 3d20 7b0a 2020 2020   params = {.    
-00007e80: 2020 2020 2020 2020 2274 6167 223a 2074          "tag": t
-00007e90: 6167 2c0a 2020 2020 2020 2020 7d0a 2020  ag,.        }.  
-00007ea0: 2020 2020 2020 6966 2069 7465 723a 0a20        if iter:. 
-00007eb0: 2020 2020 2020 2020 2020 2070 6172 616d             param
-00007ec0: 735b 2269 7465 7222 5d20 3d20 7374 7228  s["iter"] = str(
-00007ed0: 6974 6572 290a 0a20 2020 2020 2020 2065  iter)..        e
-00007ee0: 7272 6f72 203d 2066 2273 746f 7265 2061  rror = f"store a
-00007ef0: 7274 6966 6163 7420 7b70 726f 6a65 6374  rtifact {project
-00007f00: 7d2f 7b75 6964 7d2f 7b6b 6579 7d22 0a0a  }/{uid}/{key}"..
-00007f10: 2020 2020 2020 2020 626f 6479 203d 205f          body = _
-00007f20: 6173 5f6a 736f 6e28 6172 7469 6661 6374  as_json(artifact
-00007f30: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00007f40: 7069 5f63 616c 6c28 2250 4f53 5422 2c20  pi_call("POST", 
-00007f50: 656e 6470 6f69 6e74 5f70 6174 682c 2065  endpoint_path, e
-00007f60: 7272 6f72 2c20 7061 7261 6d73 3d70 6172  rror, params=par
-00007f70: 616d 732c 2062 6f64 793d 626f 6479 290a  ams, body=body).
-00007f80: 0a20 2020 2064 6566 2072 6561 645f 6172  .    def read_ar
-00007f90: 7469 6661 6374 2873 656c 662c 206b 6579  tifact(self, key
-00007fa0: 2c20 7461 673d 4e6f 6e65 2c20 6974 6572  , tag=None, iter
-00007fb0: 3d4e 6f6e 652c 2070 726f 6a65 6374 3d22  =None, project="
-00007fc0: 2229 3a0a 2020 2020 2020 2020 2222 2252  "):.        """R
-00007fd0: 6561 6420 616e 2061 7274 6966 6163 742c  ead an artifact,
-00007fe0: 2069 6465 6e74 6966 6965 6420 6279 2069   identified by i
-00007ff0: 7473 206b 6579 2c20 7461 6720 616e 6420  ts key, tag and 
-00008000: 6974 6572 6174 696f 6e2e 2222 220a 0a20  iteration.""".. 
-00008010: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
-00008020: 2070 726f 6a65 6374 206f 7220 636f 6e66   project or conf
-00008030: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
-00008040: 6374 0a20 2020 2020 2020 2074 6167 203d  ct.        tag =
-00008050: 2074 6167 206f 7220 226c 6174 6573 7422   tag or "latest"
-00008060: 0a20 2020 2020 2020 2065 6e64 706f 696e  .        endpoin
-00008070: 745f 7061 7468 203d 2066 2270 726f 6a65  t_path = f"proje
-00008080: 6374 732f 7b70 726f 6a65 6374 7d2f 6172  cts/{project}/ar
-00008090: 7469 6661 6374 732f 7b6b 6579 7d3f 7461  tifacts/{key}?ta
-000080a0: 673d 7b74 6167 7d22 0a20 2020 2020 2020  g={tag}".       
-000080b0: 2065 7272 6f72 203d 2066 2272 6561 6420   error = f"read 
-000080c0: 6172 7469 6661 6374 207b 7072 6f6a 6563  artifact {projec
-000080d0: 747d 2f7b 6b65 797d 220a 2020 2020 2020  t}/{key}".      
-000080e0: 2020 2320 6578 706c 6963 6974 6c79 2073    # explicitly s
-000080f0: 6574 2061 7274 6966 6163 7473 2066 6f72  et artifacts for
-00008100: 6d61 7420 746f 2027 6675 6c6c 2720 7369  mat to 'full' si
-00008110: 6e63 6520 6f6c 6420 7365 7276 6572 7320  nce old servers 
-00008120: 6d61 7920 6465 6661 756c 7420 746f 2027  may default to '
-00008130: 6c65 6761 6379 270a 2020 2020 2020 2020  legacy'.        
-00008140: 7061 7261 6d73 203d 207b 2266 6f72 6d61  params = {"forma
-00008150: 7422 3a20 6d6c 7275 6e2e 636f 6d6d 6f6e  t": mlrun.common
-00008160: 2e73 6368 656d 6173 2e41 7274 6966 6163  .schemas.Artifac
-00008170: 7473 466f 726d 6174 2e66 756c 6c2e 7661  tsFormat.full.va
-00008180: 6c75 657d 0a20 2020 2020 2020 2069 6620  lue}.        if 
-00008190: 6974 6572 3a0a 2020 2020 2020 2020 2020  iter:.          
-000081a0: 2020 7061 7261 6d73 5b22 6974 6572 225d    params["iter"]
-000081b0: 203d 2073 7472 2869 7465 7229 0a20 2020   = str(iter).   
-000081c0: 2020 2020 2072 6573 7020 3d20 7365 6c66       resp = self
-000081d0: 2e61 7069 5f63 616c 6c28 2247 4554 222c  .api_call("GET",
-000081e0: 2065 6e64 706f 696e 745f 7061 7468 2c20   endpoint_path, 
-000081f0: 6572 726f 722c 2070 6172 616d 733d 7061  error, params=pa
-00008200: 7261 6d73 290a 2020 2020 2020 2020 7265  rams).        re
-00008210: 7475 726e 2072 6573 702e 6a73 6f6e 2829  turn resp.json()
-00008220: 5b22 6461 7461 225d 0a0a 2020 2020 6465  ["data"]..    de
-00008230: 6620 6465 6c5f 6172 7469 6661 6374 2873  f del_artifact(s
-00008240: 656c 662c 206b 6579 2c20 7461 673d 4e6f  elf, key, tag=No
-00008250: 6e65 2c20 7072 6f6a 6563 743d 2222 293a  ne, project=""):
-00008260: 0a20 2020 2020 2020 2022 2222 4465 6c65  .        """Dele
-00008270: 7465 2061 6e20 6172 7469 6661 6374 2e22  te an artifact."
-00008280: 2222 0a0a 2020 2020 2020 2020 656e 6470  ""..        endp
-00008290: 6f69 6e74 5f70 6174 6820 3d20 6622 7072  oint_path = f"pr
-000082a0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
-000082b0: 2f61 7274 6966 6163 7473 2f7b 6b65 797d  /artifacts/{key}
-000082c0: 220a 2020 2020 2020 2020 7061 7261 6d73  ".        params
-000082d0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-000082e0: 2022 6b65 7922 3a20 6b65 792c 0a20 2020   "key": key,.   
-000082f0: 2020 2020 2020 2020 2022 7461 6722 3a20           "tag": 
-00008300: 7461 672c 0a20 2020 2020 2020 207d 0a20  tag,.        }. 
-00008310: 2020 2020 2020 2065 7272 6f72 203d 2066         error = f
-00008320: 2264 656c 2061 7274 6966 6163 7420 7b70  "del artifact {p
-00008330: 726f 6a65 6374 7d2f 7b6b 6579 7d22 0a20  roject}/{key}". 
-00008340: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
-00008350: 6361 6c6c 2822 4445 4c45 5445 222c 2065  call("DELETE", e
-00008360: 6e64 706f 696e 745f 7061 7468 2c20 6572  ndpoint_path, er
-00008370: 726f 722c 2070 6172 616d 733d 7061 7261  ror, params=para
-00008380: 6d73 290a 0a20 2020 2064 6566 206c 6973  ms)..    def lis
-00008390: 745f 6172 7469 6661 6374 7328 0a20 2020  t_artifacts(.   
-000083a0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-000083b0: 2020 206e 616d 653d 4e6f 6e65 2c0a 2020     name=None,.  
-000083c0: 2020 2020 2020 7072 6f6a 6563 743d 4e6f        project=No
-000083d0: 6e65 2c0a 2020 2020 2020 2020 7461 673d  ne,.        tag=
-000083e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6c61  None,.        la
-000083f0: 6265 6c73 3a20 4f70 7469 6f6e 616c 5b55  bels: Optional[U
-00008400: 6e69 6f6e 5b44 6963 745b 7374 722c 2073  nion[Dict[str, s
-00008410: 7472 5d2c 204c 6973 745b 7374 725d 5d5d  tr], List[str]]]
-00008420: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00008430: 2073 696e 6365 3d4e 6f6e 652c 0a20 2020   since=None,.   
-00008440: 2020 2020 2075 6e74 696c 3d4e 6f6e 652c       until=None,
-00008450: 0a20 2020 2020 2020 2069 7465 723a 2069  .        iter: i
-00008460: 6e74 203d 204e 6f6e 652c 0a20 2020 2020  nt = None,.     
-00008470: 2020 2062 6573 745f 6974 6572 6174 696f     best_iteratio
-00008480: 6e3a 2062 6f6f 6c20 3d20 4661 6c73 652c  n: bool = False,
-00008490: 0a20 2020 2020 2020 206b 696e 643a 2073  .        kind: s
-000084a0: 7472 203d 204e 6f6e 652c 0a20 2020 2020  tr = None,.     
-000084b0: 2020 2063 6174 6567 6f72 793a 2055 6e69     category: Uni
-000084c0: 6f6e 5b73 7472 2c20 6d6c 7275 6e2e 636f  on[str, mlrun.co
-000084d0: 6d6d 6f6e 2e73 6368 656d 6173 2e41 7274  mmon.schemas.Art
-000084e0: 6966 6163 7443 6174 6567 6f72 6965 735d  ifactCategories]
-000084f0: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
-00008500: 3e20 4172 7469 6661 6374 4c69 7374 3a0a  > ArtifactList:.
-00008510: 2020 2020 2020 2020 2222 224c 6973 7420          """List 
-00008520: 6172 7469 6661 6374 7320 6669 6c74 6572  artifacts filter
-00008530: 6564 2062 7920 7661 7269 6f75 7320 7061  ed by various pa
-00008540: 7261 6d65 7465 7273 2e0a 0a20 2020 2020  rameters...     
-00008550: 2020 2045 7861 6d70 6c65 733a 3a0a 0a20     Examples::.. 
-00008560: 2020 2020 2020 2020 2020 2023 2053 686f             # Sho
-00008570: 7720 6c61 7465 7374 2076 6572 7369 6f6e  w latest version
-00008580: 206f 6620 616c 6c20 6172 7469 6661 6374   of all artifact
-00008590: 7320 696e 2070 726f 6a65 6374 0a20 2020  s in project.   
-000085a0: 2020 2020 2020 2020 206c 6174 6573 745f           latest_
-000085b0: 6172 7469 6661 6374 7320 3d20 6462 2e6c  artifacts = db.l
-000085c0: 6973 745f 6172 7469 6661 6374 7328 2727  ist_artifacts(''
-000085d0: 2c20 7461 673d 276c 6174 6573 7427 2c20  , tag='latest', 
-000085e0: 7072 6f6a 6563 743d 2769 7269 7327 290a  project='iris').
-000085f0: 2020 2020 2020 2020 2020 2020 2320 6368              # ch
-00008600: 6563 6b20 6469 6666 6572 656e 7420 6172  eck different ar
-00008610: 7469 6661 6374 2076 6572 7369 6f6e 7320  tifact versions 
-00008620: 666f 7220 6120 7370 6563 6966 6963 2061  for a specific a
-00008630: 7274 6966 6163 740a 2020 2020 2020 2020  rtifact.        
-00008640: 2020 2020 7265 7375 6c74 5f76 6572 7369      result_versi
-00008650: 6f6e 7320 3d20 6462 2e6c 6973 745f 6172  ons = db.list_ar
-00008660: 7469 6661 6374 7328 2772 6573 756c 7473  tifacts('results
-00008670: 272c 2074 6167 3d27 2a27 2c20 7072 6f6a  ', tag='*', proj
-00008680: 6563 743d 2769 7269 7327 290a 2020 2020  ect='iris').    
-00008690: 2020 2020 2020 2020 2320 5368 6f77 2061          # Show a
-000086a0: 7274 6966 6163 7473 2077 6974 6820 6c61  rtifacts with la
-000086b0: 6265 6c20 6669 6c74 6572 7320 2d20 626f  bel filters - bo
-000086c0: 7468 2075 706c 6f61 6465 6420 616e 6420  th uploaded and 
-000086d0: 6f66 2062 696e 6172 7920 7479 7065 0a20  of binary type. 
-000086e0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-000086f0: 745f 6c61 6265 6c73 203d 2064 622e 6c69  t_labels = db.li
-00008700: 7374 5f61 7274 6966 6163 7473 2827 7265  st_artifacts('re
-00008710: 7375 6c74 7327 2c20 7461 673d 272a 272c  sults', tag='*',
-00008720: 2070 726f 6a65 6374 3d27 6972 6973 272c   project='iris',
-00008730: 206c 6162 656c 733d 5b27 7570 6c6f 6164   labels=['upload
-00008740: 6564 272c 2027 7479 7065 3d62 696e 6172  ed', 'type=binar
-00008750: 7927 5d29 0a0a 2020 2020 2020 2020 3a70  y'])..        :p
-00008760: 6172 616d 206e 616d 653a 204e 616d 6520  aram name: Name 
-00008770: 6f66 2061 7274 6966 6163 7473 2074 6f20  of artifacts to 
-00008780: 7265 7472 6965 7665 2e20 4e61 6d65 2077  retrieve. Name w
-00008790: 6974 6820 277e 2720 7072 6566 6978 2069  ith '~' prefix i
-000087a0: 7320 7573 6564 2061 7320 6120 6c69 6b65  s used as a like
-000087b0: 2071 7565 7279 2c20 616e 6420 6973 206e   query, and is n
-000087c0: 6f74 0a20 2020 2020 2020 2020 2020 2063  ot.            c
-000087d0: 6173 652d 7365 6e73 6974 6976 652e 2054  ase-sensitive. T
-000087e0: 6869 7320 6d65 616e 7320 7468 6174 2071  his means that q
-000087f0: 7565 7279 696e 6720 666f 7220 6060 7e6e  uerying for ``~n
-00008800: 616d 6560 6020 6d61 7920 7265 7475 726e  ame`` may return
-00008810: 2061 7274 6966 6163 7473 206e 616d 6564   artifacts named
-00008820: 0a20 2020 2020 2020 2020 2020 2060 606d  .            ``m
-00008830: 795f 4e61 6d65 5f31 6060 206f 7220 6060  y_Name_1`` or ``
-00008840: 7375 726e 616d 6560 602e 0a20 2020 2020  surname``..     
-00008850: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-00008860: 743a 2050 726f 6a65 6374 206e 616d 652e  t: Project name.
-00008870: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00008880: 7461 673a 2052 6574 7572 6e20 6172 7469  tag: Return arti
-00008890: 6661 6374 7320 6173 7369 676e 6564 2074  facts assigned t
-000088a0: 6869 7320 7461 672e 0a20 2020 2020 2020  his tag..       
-000088b0: 203a 7061 7261 6d20 6c61 6265 6c73 3a20   :param labels: 
-000088c0: 5265 7475 726e 2061 7274 6966 6163 7473  Return artifacts
-000088d0: 2074 6861 7420 6861 7665 2074 6865 7365   that have these
-000088e0: 206c 6162 656c 732e 204c 6162 656c 7320   labels. Labels 
-000088f0: 6361 6e20 6569 7468 6572 2062 6520 6120  can either be a 
-00008900: 6469 6374 696f 6e61 7279 207b 226c 6162  dictionary {"lab
-00008910: 656c 223a 2022 7661 6c75 6522 7d20 6f72  el": "value"} or
-00008920: 0a20 2020 2020 2020 2020 2020 2061 206c  .            a l
-00008930: 6973 7420 6f66 2022 6c61 6265 6c3d 7661  ist of "label=va
-00008940: 6c75 6522 2028 6d61 7463 6820 6c61 6265  lue" (match labe
-00008950: 6c20 6b65 7920 616e 6420 7661 6c75 6529  l key and value)
-00008960: 206f 7220 226c 6162 656c 2220 286d 6174   or "label" (mat
-00008970: 6368 206a 7573 7420 6c61 6265 6c20 6b65  ch just label ke
-00008980: 7929 2073 7472 696e 6773 2e0a 2020 2020  y) strings..    
-00008990: 2020 2020 3a70 6172 616d 2073 696e 6365      :param since
-000089a0: 3a20 4e6f 7420 696e 2075 7365 2069 6e20  : Not in use in 
-000089b0: 3a70 793a 636c 6173 733a 6048 5454 5052  :py:class:`HTTPR
-000089c0: 756e 4442 602e 0a20 2020 2020 2020 203a  unDB`..        :
-000089d0: 7061 7261 6d20 756e 7469 6c3a 204e 6f74  param until: Not
-000089e0: 2069 6e20 7573 6520 696e 203a 7079 3a63   in use in :py:c
-000089f0: 6c61 7373 3a60 4854 5450 5275 6e44 4260  lass:`HTTPRunDB`
-00008a00: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00008a10: 2069 7465 723a 2052 6574 7572 6e20 6172   iter: Return ar
-00008a20: 7469 6661 6374 7320 6672 6f6d 2061 2073  tifacts from a s
-00008a30: 7065 6369 6669 6320 6974 6572 6174 696f  pecific iteratio
-00008a40: 6e20 2877 6865 7265 2060 6069 7465 723d  n (where ``iter=
-00008a50: 3060 6020 6d65 616e 7320 7468 6520 726f  0`` means the ro
-00008a60: 6f74 2069 7465 7261 7469 6f6e 292e 2049  ot iteration). I
-00008a70: 660a 2020 2020 2020 2020 2020 2020 6060  f.            ``
-00008a80: 4e6f 6e65 6060 2028 6465 6661 756c 7429  None`` (default)
-00008a90: 2072 6574 7572 6e20 6172 7469 6661 6374   return artifact
-00008aa0: 7320 6672 6f6d 2061 6c6c 2069 7465 7261  s from all itera
-00008ab0: 7469 6f6e 732e 0a20 2020 2020 2020 203a  tions..        :
-00008ac0: 7061 7261 6d20 6265 7374 5f69 7465 7261  param best_itera
-00008ad0: 7469 6f6e 3a20 5265 7475 726e 7320 7468  tion: Returns th
-00008ae0: 6520 6172 7469 6661 6374 2077 6869 6368  e artifact which
-00008af0: 2062 656c 6f6e 6773 2074 6f20 7468 6520   belongs to the 
-00008b00: 6265 7374 2069 7465 7261 7469 6f6e 206f  best iteration o
-00008b10: 6620 6120 6769 7665 6e20 7275 6e2c 2069  f a given run, i
-00008b20: 6e20 7468 6520 6361 7365 206f 660a 2020  n the case of.  
-00008b30: 2020 2020 2020 2020 2020 6172 7469 6661            artifa
-00008b40: 6374 7320 6765 6e65 7261 7465 6420 6672  cts generated fr
-00008b50: 6f6d 2061 2068 7970 6572 2d70 6172 616d  om a hyper-param
-00008b60: 2072 756e 2e20 4966 206f 6e6c 7920 6120   run. If only a 
-00008b70: 7369 6e67 6c65 2069 7465 7261 7469 6f6e  single iteration
-00008b80: 2065 7869 7374 732c 2077 696c 6c20 7265   exists, will re
-00008b90: 7475 726e 2074 6865 2061 7274 6966 6163  turn the artifac
-00008ba0: 740a 2020 2020 2020 2020 2020 2020 6672  t.            fr
-00008bb0: 6f6d 2074 6861 7420 6974 6572 6174 696f  om that iteratio
-00008bc0: 6e2e 2049 6620 7573 696e 6720 6060 6265  n. If using ``be
-00008bd0: 7374 5f69 7465 7260 602c 2074 6865 2060  st_iter``, the `
-00008be0: 6069 7465 7260 6020 7061 7261 6d65 7465  `iter`` paramete
-00008bf0: 7220 6d75 7374 206e 6f74 2062 6520 7573  r must not be us
-00008c00: 6564 2e0a 2020 2020 2020 2020 3a70 6172  ed..        :par
-00008c10: 616d 206b 696e 643a 2052 6574 7572 6e20  am kind: Return 
-00008c20: 6172 7469 6661 6374 7320 6f66 2074 6865  artifacts of the
-00008c30: 2072 6571 7565 7374 6564 206b 696e 642e   requested kind.
-00008c40: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00008c50: 6361 7465 676f 7279 3a20 5265 7475 726e  category: Return
-00008c60: 2061 7274 6966 6163 7473 206f 6620 7468   artifacts of th
-00008c70: 6520 7265 7175 6573 7465 6420 6361 7465  e requested cate
-00008c80: 676f 7279 2e0a 2020 2020 2020 2020 2222  gory..        ""
-00008c90: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
-00008ca0: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
-00008cb0: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
-00008cc0: 726f 6a65 6374 0a0a 2020 2020 2020 2020  roject..        
-00008cd0: 6c61 6265 6c73 203d 206c 6162 656c 7320  labels = labels 
-00008ce0: 6f72 205b 5d0a 2020 2020 2020 2020 6966  or [].        if
-00008cf0: 2069 7369 6e73 7461 6e63 6528 6c61 6265   isinstance(labe
-00008d00: 6c73 2c20 6469 6374 293a 0a20 2020 2020  ls, dict):.     
-00008d10: 2020 2020 2020 206c 6162 656c 7320 3d20         labels = 
-00008d20: 5b66 227b 6b65 797d 3d7b 7661 6c75 657d  [f"{key}={value}
-00008d30: 2220 666f 7220 6b65 792c 2076 616c 7565  " for key, value
-00008d40: 2069 6e20 6c61 6265 6c73 2e69 7465 6d73   in labels.items
-00008d50: 2829 5d0a 0a20 2020 2020 2020 2070 6172  ()]..        par
-00008d60: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-00008d70: 2020 2020 226e 616d 6522 3a20 6e61 6d65      "name": name
-00008d80: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-00008d90: 6167 223a 2074 6167 2c0a 2020 2020 2020  ag": tag,.      
-00008da0: 2020 2020 2020 226c 6162 656c 223a 206c        "label": l
-00008db0: 6162 656c 732c 0a20 2020 2020 2020 2020  abels,.         
-00008dc0: 2020 2022 6974 6572 223a 2069 7465 722c     "iter": iter,
-00008dd0: 0a20 2020 2020 2020 2020 2020 2022 6265  .            "be
-00008de0: 7374 2d69 7465 7261 7469 6f6e 223a 2062  st-iteration": b
-00008df0: 6573 745f 6974 6572 6174 696f 6e2c 0a20  est_iteration,. 
-00008e00: 2020 2020 2020 2020 2020 2022 6b69 6e64             "kind
-00008e10: 223a 206b 696e 642c 0a20 2020 2020 2020  ": kind,.       
-00008e20: 2020 2020 2022 6361 7465 676f 7279 223a       "category":
-00008e30: 2063 6174 6567 6f72 792c 0a20 2020 2020   category,.     
-00008e40: 2020 2020 2020 2022 666f 726d 6174 223a         "format":
-00008e50: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-00008e60: 6865 6d61 732e 4172 7469 6661 6374 7346  hemas.ArtifactsF
-00008e70: 6f72 6d61 742e 6675 6c6c 2e76 616c 7565  ormat.full.value
-00008e80: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
-00008e90: 2020 2020 6572 726f 7220 3d20 226c 6973      error = "lis
-00008ea0: 7420 6172 7469 6661 6374 7322 0a20 2020  t artifacts".   
-00008eb0: 2020 2020 2065 6e64 706f 696e 745f 7061       endpoint_pa
-00008ec0: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-00008ed0: 7b70 726f 6a65 6374 7d2f 6172 7469 6661  {project}/artifa
-00008ee0: 6374 7322 0a20 2020 2020 2020 2072 6573  cts".        res
-00008ef0: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
-00008f00: 6c28 2247 4554 222c 2065 6e64 706f 696e  l("GET", endpoin
-00008f10: 745f 7061 7468 2c20 6572 726f 722c 2070  t_path, error, p
-00008f20: 6172 616d 733d 7061 7261 6d73 290a 2020  arams=params).  
-00008f30: 2020 2020 2020 7661 6c75 6573 203d 2041        values = A
-00008f40: 7274 6966 6163 744c 6973 7428 7265 7370  rtifactList(resp
-00008f50: 2e6a 736f 6e28 295b 2261 7274 6966 6163  .json()["artifac
-00008f60: 7473 225d 290a 2020 2020 2020 2020 7661  ts"]).        va
-00008f70: 6c75 6573 2e74 6167 203d 2074 6167 0a20  lues.tag = tag. 
-00008f80: 2020 2020 2020 2072 6574 7572 6e20 7661         return va
-00008f90: 6c75 6573 0a0a 2020 2020 6465 6620 6465  lues..    def de
-00008fa0: 6c5f 6172 7469 6661 6374 7328 7365 6c66  l_artifacts(self
-00008fb0: 2c20 6e61 6d65 3d4e 6f6e 652c 2070 726f  , name=None, pro
-00008fc0: 6a65 6374 3d4e 6f6e 652c 2074 6167 3d4e  ject=None, tag=N
-00008fd0: 6f6e 652c 206c 6162 656c 733d 4e6f 6e65  one, labels=None
-00008fe0: 2c20 6461 7973 5f61 676f 3d30 293a 0a20  , days_ago=0):. 
-00008ff0: 2020 2020 2020 2022 2222 4465 6c65 7465         """Delete
-00009000: 2061 7274 6966 6163 7473 2072 6566 6572   artifacts refer
-00009010: 656e 6365 6420 6279 2074 6865 2070 6172  enced by the par
-00009020: 616d 6574 6572 732e 0a0a 2020 2020 2020  ameters...      
-00009030: 2020 3a70 6172 616d 206e 616d 653a 204e    :param name: N
-00009040: 616d 6520 6f66 2061 7274 6966 6163 7473  ame of artifacts
-00009050: 2074 6f20 6465 6c65 7465 2e20 4e6f 7465   to delete. Note
-00009060: 2074 6861 7420 7468 6973 2069 7320 6120   that this is a 
-00009070: 6c69 6b65 2071 7565 7279 2c20 616e 6420  like query, and 
-00009080: 6973 2063 6173 652d 696e 7365 6e73 6974  is case-insensit
-00009090: 6976 652e 2053 6565 0a20 2020 2020 2020  ive. See.       
-000090a0: 2020 2020 203a 7079 3a66 756e 633a 607e       :py:func:`~
-000090b0: 6c69 7374 5f61 7274 6966 6163 7473 6020  list_artifacts` 
-000090c0: 666f 7220 6d6f 7265 2064 6574 6169 6c73  for more details
-000090d0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000090e0: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
-000090f0: 7420 7468 6174 2061 7274 6966 6163 7473  t that artifacts
-00009100: 2062 656c 6f6e 6720 746f 2e0a 2020 2020   belong to..    
-00009110: 2020 2020 3a70 6172 616d 2074 6167 3a20      :param tag: 
-00009120: 4368 6f6f 7365 2061 7274 6966 6163 7473  Choose artifacts
-00009130: 2077 686f 2061 7265 2061 7373 6967 6e65   who are assigne
-00009140: 6420 7468 6973 2074 6167 2e0a 2020 2020  d this tag..    
-00009150: 2020 2020 3a70 6172 616d 206c 6162 656c      :param label
-00009160: 733a 2043 686f 6f73 6520 6172 7469 6661  s: Choose artifa
-00009170: 6374 7320 7768 6963 6820 6172 6520 6c61  cts which are la
-00009180: 6265 6c65 642e 0a20 2020 2020 2020 203a  beled..        :
-00009190: 7061 7261 6d20 6461 7973 5f61 676f 3a20  param days_ago: 
-000091a0: 5468 6973 2070 6172 616d 6574 6572 2069  This parameter i
-000091b0: 7320 6465 7072 6563 6174 6564 2061 6e64  s deprecated and
-000091c0: 206e 6f74 2075 7365 642e 0a20 2020 2020   not used..     
-000091d0: 2020 2022 2222 0a20 2020 2020 2020 2070     """.        p
-000091e0: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
-000091f0: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
-00009200: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
-00009210: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
-00009220: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
-00009230: 3a20 6e61 6d65 2c0a 2020 2020 2020 2020  : name,.        
-00009240: 2020 2020 2274 6167 223a 2074 6167 2c0a      "tag": tag,.
-00009250: 2020 2020 2020 2020 2020 2020 226c 6162              "lab
-00009260: 656c 223a 206c 6162 656c 7320 6f72 205b  el": labels or [
-00009270: 5d2c 0a20 2020 2020 2020 2020 2020 2022  ],.            "
-00009280: 6461 7973 5f61 676f 223a 2073 7472 2864  days_ago": str(d
-00009290: 6179 735f 6167 6f29 2c0a 2020 2020 2020  ays_ago),.      
-000092a0: 2020 7d0a 2020 2020 2020 2020 6572 726f    }.        erro
-000092b0: 7220 3d20 2264 656c 2061 7274 6966 6163  r = "del artifac
-000092c0: 7473 220a 2020 2020 2020 2020 656e 6470  ts".        endp
-000092d0: 6f69 6e74 5f70 6174 6820 3d20 6622 7072  oint_path = f"pr
-000092e0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
-000092f0: 2f61 7274 6966 6163 7473 220a 2020 2020  /artifacts".    
-00009300: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
-00009310: 6c28 2244 454c 4554 4522 2c20 656e 6470  l("DELETE", endp
-00009320: 6f69 6e74 5f70 6174 682c 2065 7272 6f72  oint_path, error
-00009330: 2c20 7061 7261 6d73 3d70 6172 616d 7329  , params=params)
-00009340: 0a0a 2020 2020 6465 6620 6c69 7374 5f61  ..    def list_a
-00009350: 7274 6966 6163 745f 7461 6773 280a 2020  rtifact_tags(.  
-00009360: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00009370: 2020 2020 7072 6f6a 6563 743d 4e6f 6e65      project=None
-00009380: 2c0a 2020 2020 2020 2020 6361 7465 676f  ,.        catego
-00009390: 7279 3a20 556e 696f 6e5b 7374 722c 206d  ry: Union[str, m
-000093a0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-000093b0: 6d61 732e 4172 7469 6661 6374 4361 7465  mas.ArtifactCate
-000093c0: 676f 7269 6573 5d20 3d20 4e6f 6e65 2c0a  gories] = None,.
-000093d0: 2020 2020 2920 2d3e 204c 6973 745b 7374      ) -> List[st
-000093e0: 725d 3a0a 2020 2020 2020 2020 2222 2252  r]:.        """R
-000093f0: 6574 7572 6e20 6120 6c69 7374 206f 6620  eturn a list of 
-00009400: 616c 6c20 7468 6520 7461 6773 2061 7373  all the tags ass
-00009410: 6967 6e65 6420 746f 2061 7274 6966 6163  igned to artifac
-00009420: 7473 2069 6e20 7468 6520 7363 6f70 6520  ts in the scope 
-00009430: 6f66 2074 6865 2067 6976 656e 2070 726f  of the given pro
-00009440: 6a65 6374 2e22 2222 0a0a 2020 2020 2020  ject."""..      
-00009450: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
-00009460: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
-00009470: 6661 756c 745f 7072 6f6a 6563 740a 2020  fault_project.  
-00009480: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00009490: 6167 6520 3d20 6622 4661 696c 6564 206c  age = f"Failed l
-000094a0: 6973 7469 6e67 2061 7274 6966 6163 7420  isting artifact 
-000094b0: 7461 6773 2e20 7072 6f6a 6563 743d 7b70  tags. project={p
-000094c0: 726f 6a65 6374 7d22 0a20 2020 2020 2020  roject}".       
-000094d0: 2070 6172 616d 7320 3d20 7b22 6361 7465   params = {"cate
-000094e0: 676f 7279 223a 2063 6174 6567 6f72 797d  gory": category}
-000094f0: 2069 6620 6361 7465 676f 7279 2065 6c73   if category els
-00009500: 6520 7b7d 0a0a 2020 2020 2020 2020 7265  e {}..        re
-00009510: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
-00009520: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
-00009530: 2020 2020 2247 4554 222c 2066 2270 726f      "GET", f"pro
-00009540: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
-00009550: 6172 7469 6661 6374 2d74 6167 7322 2c20  artifact-tags", 
-00009560: 6572 726f 725f 6d65 7373 6167 652c 2070  error_message, p
-00009570: 6172 616d 733d 7061 7261 6d73 0a20 2020  arams=params.   
-00009580: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-00009590: 6574 7572 6e20 7265 7370 6f6e 7365 2e6a  eturn response.j
-000095a0: 736f 6e28 295b 2274 6167 7322 5d0a 0a20  son()["tags"].. 
-000095b0: 2020 2064 6566 2073 746f 7265 5f66 756e     def store_fun
-000095c0: 6374 696f 6e28 0a20 2020 2020 2020 2073  ction(.        s
-000095d0: 656c 662c 0a20 2020 2020 2020 2066 756e  elf,.        fun
-000095e0: 6374 696f 6e3a 2074 7970 696e 672e 556e  ction: typing.Un
-000095f0: 696f 6e5b 6d6c 7275 6e2e 7275 6e74 696d  ion[mlrun.runtim
-00009600: 6573 2e42 6173 6552 756e 7469 6d65 2c20  es.BaseRuntime, 
-00009610: 6469 6374 5d2c 0a20 2020 2020 2020 206e  dict],.        n
-00009620: 616d 652c 0a20 2020 2020 2020 2070 726f  ame,.        pro
-00009630: 6a65 6374 3d22 222c 0a20 2020 2020 2020  ject="",.       
-00009640: 2074 6167 3d4e 6f6e 652c 0a20 2020 2020   tag=None,.     
-00009650: 2020 2076 6572 7369 6f6e 6564 3d46 616c     versioned=Fal
-00009660: 7365 2c0a 2020 2020 293a 0a20 2020 2020  se,.    ):.     
-00009670: 2020 2022 2222 5374 6f72 6520 6120 6675     """Store a fu
-00009680: 6e63 7469 6f6e 206f 626a 6563 742e 2046  nction object. F
-00009690: 756e 6374 696f 6e20 6973 2069 6465 6e74  unction is ident
-000096a0: 6966 6965 6420 6279 2069 7473 206e 616d  ified by its nam
-000096b0: 6520 616e 6420 7461 672c 2061 6e64 2063  e and tag, and c
-000096c0: 616e 2062 6520 7665 7273 696f 6e65 642e  an be versioned.
-000096d0: 2222 220a 2020 2020 2020 2020 6e61 6d65  """.        name
-000096e0: 203d 206d 6c72 756e 2e75 7469 6c73 2e6e   = mlrun.utils.n
-000096f0: 6f72 6d61 6c69 7a65 5f6e 616d 6528 6e61  ormalize_name(na
-00009700: 6d65 290a 2020 2020 2020 2020 6966 2068  me).        if h
-00009710: 6173 6174 7472 2866 756e 6374 696f 6e2c  asattr(function,
-00009720: 2022 746f 5f64 6963 7422 293a 0a20 2020   "to_dict"):.   
-00009730: 2020 2020 2020 2020 2066 756e 6374 696f           functio
-00009740: 6e20 3d20 6675 6e63 7469 6f6e 2e74 6f5f  n = function.to_
-00009750: 6469 6374 2829 0a0a 2020 2020 2020 2020  dict()..        
-00009760: 7061 7261 6d73 203d 207b 2274 6167 223a  params = {"tag":
-00009770: 2074 6167 2c20 2276 6572 7369 6f6e 6564   tag, "versioned
-00009780: 223a 2076 6572 7369 6f6e 6564 7d0a 2020  ": versioned}.  
-00009790: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
-000097a0: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
-000097b0: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
-000097c0: 740a 2020 2020 2020 2020 7061 7468 203d  t.        path =
-000097d0: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-000097e0: 6a65 6374 7d2f 6675 6e63 7469 6f6e 732f  ject}/functions/
-000097f0: 7b6e 616d 657d 220a 0a20 2020 2020 2020  {name}"..       
-00009800: 2065 7272 6f72 203d 2066 2273 746f 7265   error = f"store
-00009810: 2066 756e 6374 696f 6e20 7b70 726f 6a65   function {proje
-00009820: 6374 7d2f 7b6e 616d 657d 220a 2020 2020  ct}/{name}".    
-00009830: 2020 2020 7265 7370 203d 2073 656c 662e      resp = self.
-00009840: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
-00009850: 2020 2020 2020 2250 4f53 5422 2c20 7061        "POST", pa
-00009860: 7468 2c20 6572 726f 722c 2070 6172 616d  th, error, param
-00009870: 733d 7061 7261 6d73 2c20 626f 6479 3d64  s=params, body=d
-00009880: 6963 745f 746f 5f6a 736f 6e28 6675 6e63  ict_to_json(func
-00009890: 7469 6f6e 290a 2020 2020 2020 2020 290a  tion).        ).
-000098a0: 0a20 2020 2020 2020 2023 2068 6173 6820  .        # hash 
-000098b0: 6b65 7920 6f70 7469 6f6e 616c 2074 6f20  key optional to 
-000098c0: 6265 2062 6163 6b77 6172 6473 2063 6f6d  be backwards com
-000098d0: 7061 7469 626c 6520 746f 2041 5049 2076  patible to API v
-000098e0: 3c30 2e34 2e31 3020 696e 2077 6869 6368  <0.4.10 in which
-000098f0: 2069 7420 7761 736e 2774 2069 6e20 7468   it wasn't in th
-00009900: 6520 7265 7370 6f6e 7365 0a20 2020 2020  e response.     
-00009910: 2020 2072 6574 7572 6e20 7265 7370 2e6a     return resp.j
-00009920: 736f 6e28 292e 6765 7428 2268 6173 685f  son().get("hash_
-00009930: 6b65 7922 290a 0a20 2020 2064 6566 2067  key")..    def g
-00009940: 6574 5f66 756e 6374 696f 6e28 7365 6c66  et_function(self
-00009950: 2c20 6e61 6d65 2c20 7072 6f6a 6563 743d  , name, project=
-00009960: 2222 2c20 7461 673d 4e6f 6e65 2c20 6861  "", tag=None, ha
-00009970: 7368 5f6b 6579 3d22 2229 3a0a 2020 2020  sh_key=""):.    
-00009980: 2020 2020 2222 2252 6574 7269 6576 6520      """Retrieve 
-00009990: 6465 7461 696c 7320 6f66 2061 2073 7065  details of a spe
-000099a0: 6369 6669 6320 6675 6e63 7469 6f6e 2c20  cific function, 
-000099b0: 6964 656e 7469 6669 6564 2062 7920 6974  identified by it
-000099c0: 7320 6e61 6d65 2061 6e64 2070 6f74 656e  s name and poten
-000099d0: 7469 616c 6c79 2061 2074 6167 206f 7220  tially a tag or 
-000099e0: 6675 6e63 7469 6f6e 2068 6173 682e 2222  function hash.""
-000099f0: 220a 0a20 2020 2020 2020 2070 6172 616d  "..        param
-00009a00: 7320 3d20 7b22 7461 6722 3a20 7461 672c  s = {"tag": tag,
-00009a10: 2022 6861 7368 5f6b 6579 223a 2068 6173   "hash_key": has
-00009a20: 685f 6b65 797d 0a20 2020 2020 2020 2070  h_key}.        p
-00009a30: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
-00009a40: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
-00009a50: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
-00009a60: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
-00009a70: 6563 7473 2f7b 7072 6f6a 6563 747d 2f66  ects/{project}/f
-00009a80: 756e 6374 696f 6e73 2f7b 6e61 6d65 7d22  unctions/{name}"
-00009a90: 0a20 2020 2020 2020 2065 7272 6f72 203d  .        error =
-00009aa0: 2066 2267 6574 2066 756e 6374 696f 6e20   f"get function 
-00009ab0: 7b70 726f 6a65 6374 7d2f 7b6e 616d 657d  {project}/{name}
-00009ac0: 220a 2020 2020 2020 2020 7265 7370 203d  ".        resp =
-00009ad0: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
-00009ae0: 4745 5422 2c20 7061 7468 2c20 6572 726f  GET", path, erro
-00009af0: 722c 2070 6172 616d 733d 7061 7261 6d73  r, params=params
-00009b00: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00009b10: 2072 6573 702e 6a73 6f6e 2829 5b22 6675   resp.json()["fu
-00009b20: 6e63 225d 0a0a 2020 2020 6465 6620 6465  nc"]..    def de
-00009b30: 6c65 7465 5f66 756e 6374 696f 6e28 7365  lete_function(se
-00009b40: 6c66 2c20 6e61 6d65 3a20 7374 722c 2070  lf, name: str, p
-00009b50: 726f 6a65 6374 3a20 7374 7220 3d20 2222  roject: str = ""
-00009b60: 293a 0a20 2020 2020 2020 2022 2222 4465  ):.        """De
-00009b70: 6c65 7465 2061 2066 756e 6374 696f 6e20  lete a function 
-00009b80: 6265 6c6f 6e67 696e 6720 746f 2061 2073  belonging to a s
-00009b90: 7065 6369 6669 6320 7072 6f6a 6563 742e  pecific project.
-00009ba0: 2222 220a 0a20 2020 2020 2020 2070 726f  """..        pro
-00009bb0: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
-00009bc0: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
-00009bd0: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
-00009be0: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-00009bf0: 7473 2f7b 7072 6f6a 6563 747d 2f66 756e  ts/{project}/fun
-00009c00: 6374 696f 6e73 2f7b 6e61 6d65 7d22 0a20  ctions/{name}". 
-00009c10: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00009c20: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-00009c30: 6465 6c65 7469 6e67 2066 756e 6374 696f  deleting functio
-00009c40: 6e20 7b70 726f 6a65 6374 7d2f 7b6e 616d  n {project}/{nam
-00009c50: 657d 220a 2020 2020 2020 2020 7365 6c66  e}".        self
-00009c60: 2e61 7069 5f63 616c 6c28 2244 454c 4554  .api_call("DELET
-00009c70: 4522 2c20 7061 7468 2c20 6572 726f 725f  E", path, error_
-00009c80: 6d65 7373 6167 6529 0a0a 2020 2020 6465  message)..    de
-00009c90: 6620 6c69 7374 5f66 756e 6374 696f 6e73  f list_functions
-00009ca0: 2873 656c 662c 206e 616d 653d 4e6f 6e65  (self, name=None
-00009cb0: 2c20 7072 6f6a 6563 743d 4e6f 6e65 2c20  , project=None, 
-00009cc0: 7461 673d 4e6f 6e65 2c20 6c61 6265 6c73  tag=None, labels
-00009cd0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-00009ce0: 2222 2252 6574 7269 6576 6520 6120 6c69  """Retrieve a li
-00009cf0: 7374 206f 6620 6675 6e63 7469 6f6e 732c  st of functions,
-00009d00: 2066 696c 7465 7265 6420 6279 2073 7065   filtered by spe
-00009d10: 6369 6669 6320 6372 6974 6572 6961 2e0a  cific criteria..
-00009d20: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00009d30: 6e61 6d65 3a20 5265 7475 726e 206f 6e6c  name: Return onl
-00009d40: 7920 6675 6e63 7469 6f6e 7320 7769 7468  y functions with
-00009d50: 2061 2073 7065 6369 6669 6320 6e61 6d65   a specific name
-00009d60: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00009d70: 2070 726f 6a65 6374 3a20 5265 7475 726e   project: Return
-00009d80: 2066 756e 6374 696f 6e73 2062 656c 6f6e   functions belon
-00009d90: 6769 6e67 2074 6f20 7468 6973 2070 726f  ging to this pro
-00009da0: 6a65 6374 2e20 4966 206e 6f74 2073 7065  ject. If not spe
-00009db0: 6369 6669 6564 2c20 7468 6520 6465 6661  cified, the defa
-00009dc0: 756c 7420 7072 6f6a 6563 7420 6973 2075  ult project is u
-00009dd0: 7365 642e 0a20 2020 2020 2020 203a 7061  sed..        :pa
-00009de0: 7261 6d20 7461 673a 2052 6574 7572 6e20  ram tag: Return 
-00009df0: 6675 6e63 7469 6f6e 2076 6572 7369 6f6e  function version
-00009e00: 7320 7769 7468 2073 7065 6369 6669 6320  s with specific 
-00009e10: 7461 6773 2e0a 2020 2020 2020 2020 3a70  tags..        :p
-00009e20: 6172 616d 206c 6162 656c 733a 2052 6574  aram labels: Ret
-00009e30: 7572 6e20 6675 6e63 7469 6f6e 7320 7468  urn functions th
-00009e40: 6174 2068 6176 6520 7370 6563 6966 6963  at have specific
-00009e50: 206c 6162 656c 7320 6173 7369 676e 6564   labels assigned
-00009e60: 2074 6f20 7468 656d 2e0a 2020 2020 2020   to them..      
-00009e70: 2020 3a72 6574 7572 6e73 3a20 4c69 7374    :returns: List
-00009e80: 206f 6620 6675 6e63 7469 6f6e 206f 626a   of function obj
-00009e90: 6563 7473 2028 6173 2064 6963 7469 6f6e  ects (as diction
-00009ea0: 6172 7929 2e0a 2020 2020 2020 2020 2222  ary)..        ""
-00009eb0: 220a 2020 2020 2020 2020 7072 6f6a 6563  ".        projec
-00009ec0: 7420 3d20 7072 6f6a 6563 7420 6f72 2063  t = project or c
-00009ed0: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
-00009ee0: 6f6a 6563 740a 2020 2020 2020 2020 7061  oject.        pa
-00009ef0: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
-00009f00: 2020 2020 2022 6e61 6d65 223a 206e 616d       "name": nam
-00009f10: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-00009f20: 7461 6722 3a20 7461 672c 0a20 2020 2020  tag": tag,.     
-00009f30: 2020 2020 2020 2022 6c61 6265 6c22 3a20         "label": 
-00009f40: 6c61 6265 6c73 206f 7220 5b5d 2c0a 2020  labels or [],.  
-00009f50: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00009f60: 6572 726f 7220 3d20 226c 6973 7420 6675  error = "list fu
-00009f70: 6e63 7469 6f6e 7322 0a20 2020 2020 2020  nctions".       
-00009f80: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-00009f90: 7473 2f7b 7072 6f6a 6563 747d 2f66 756e  ts/{project}/fun
-00009fa0: 6374 696f 6e73 220a 2020 2020 2020 2020  ctions".        
-00009fb0: 7265 7370 203d 2073 656c 662e 6170 695f  resp = self.api_
-00009fc0: 6361 6c6c 2822 4745 5422 2c20 7061 7468  call("GET", path
-00009fd0: 2c20 6572 726f 722c 2070 6172 616d 733d  , error, params=
-00009fe0: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
-00009ff0: 7265 7475 726e 2072 6573 702e 6a73 6f6e  return resp.json
-0000a000: 2829 5b22 6675 6e63 7322 5d0a 0a20 2020  ()["funcs"]..   
-0000a010: 2064 6566 206c 6973 745f 7275 6e74 696d   def list_runtim
-0000a020: 655f 7265 736f 7572 6365 7328 0a20 2020  e_resources(.   
-0000a030: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000a040: 2020 2070 726f 6a65 6374 3a20 4f70 7469     project: Opti
-0000a050: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
-0000a060: 2c0a 2020 2020 2020 2020 6c61 6265 6c5f  ,.        label_
-0000a070: 7365 6c65 6374 6f72 3a20 4f70 7469 6f6e  selector: Option
-0000a080: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-0000a090: 2020 2020 2020 2020 6b69 6e64 3a20 4f70          kind: Op
-0000a0a0: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
-0000a0b0: 6e65 2c0a 2020 2020 2020 2020 6f62 6a65  ne,.        obje
-0000a0c0: 6374 5f69 643a 204f 7074 696f 6e61 6c5b  ct_id: Optional[
-0000a0d0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-0000a0e0: 2020 2020 2067 726f 7570 5f62 793a 204f       group_by: O
-0000a0f0: 7074 696f 6e61 6c5b 0a20 2020 2020 2020  ptional[.       
-0000a100: 2020 2020 206d 6c72 756e 2e63 6f6d 6d6f       mlrun.commo
-0000a110: 6e2e 7363 6865 6d61 732e 4c69 7374 5275  n.schemas.ListRu
-0000a120: 6e74 696d 6552 6573 6f75 7263 6573 4772  ntimeResourcesGr
-0000a130: 6f75 7042 7946 6965 6c64 0a20 2020 2020  oupByField.     
-0000a140: 2020 205d 203d 204e 6f6e 652c 0a20 2020     ] = None,.   
-0000a150: 2029 202d 3e20 556e 696f 6e5b 0a20 2020   ) -> Union[.   
-0000a160: 2020 2020 206d 6c72 756e 2e63 6f6d 6d6f       mlrun.commo
-0000a170: 6e2e 7363 6865 6d61 732e 5275 6e74 696d  n.schemas.Runtim
-0000a180: 6552 6573 6f75 7263 6573 4f75 7470 7574  eResourcesOutput
-0000a190: 2c0a 2020 2020 2020 2020 6d6c 7275 6e2e  ,.        mlrun.
-0000a1a0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e47  common.schemas.G
-0000a1b0: 726f 7570 6564 4279 4a6f 6252 756e 7469  roupedByJobRunti
-0000a1c0: 6d65 5265 736f 7572 6365 734f 7574 7075  meResourcesOutpu
-0000a1d0: 742c 0a20 2020 2020 2020 206d 6c72 756e  t,.        mlrun
-0000a1e0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-0000a1f0: 4772 6f75 7065 6442 7950 726f 6a65 6374  GroupedByProject
-0000a200: 5275 6e74 696d 6552 6573 6f75 7263 6573  RuntimeResources
-0000a210: 4f75 7470 7574 2c0a 2020 2020 5d3a 0a20  Output,.    ]:. 
-0000a220: 2020 2020 2020 2022 2222 4c69 7374 2063         """List c
-0000a230: 7572 7265 6e74 2072 756e 7469 6d65 2072  urrent runtime r
-0000a240: 6573 6f75 7263 6573 2c20 7768 6963 6820  esources, which 
-0000a250: 6172 6520 7573 7561 6c6c 7920 2862 7574  are usually (but
-0000a260: 206e 6f74 206c 696d 6974 6564 2074 6f29   not limited to)
-0000a270: 204b 7562 6572 6e65 7465 7320 706f 6473   Kubernetes pods
-0000a280: 206f 7220 4352 4473 2e0a 2020 2020 2020   or CRDs..      
-0000a290: 2020 4675 6e63 7469 6f6e 2061 7070 6c69    Function appli
-0000a2a0: 6573 2066 6f72 2072 756e 7320 6f66 2074  es for runs of t
-0000a2b0: 7970 6520 605b 2764 6173 6b27 2c20 276a  ype `['dask', 'j
-0000a2c0: 6f62 272c 2027 7370 6172 6b27 2c20 2772  ob', 'spark', 'r
-0000a2d0: 656d 6f74 652d 7370 6172 6b27 2c20 276d  emote-spark', 'm
-0000a2e0: 7069 6a6f 6227 5d60 2c20 616e 6420 7769  pijob']`, and wi
-0000a2f0: 6c6c 2072 6574 7572 6e20 7065 720a 2020  ll return per.  
-0000a300: 2020 2020 2020 7275 6e74 696d 6520 6b69        runtime ki
-0000a310: 6e64 2061 206c 6973 7420 6f66 2074 6865  nd a list of the
-0000a320: 2072 756e 7469 6d65 2072 6573 6f75 7263   runtime resourc
-0000a330: 6573 2028 7768 6963 6820 6d61 7920 6861  es (which may ha
-0000a340: 7665 2061 6c72 6561 6479 2063 6f6d 706c  ve already compl
-0000a350: 6574 6564 2074 6865 6972 2065 7865 6375  eted their execu
-0000a360: 7469 6f6e 292e 0a0a 2020 2020 2020 2020  tion)...        
-0000a370: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
-0000a380: 4765 7420 6f6e 6c79 2072 756e 7469 6d65  Get only runtime
-0000a390: 2072 6573 6f75 7263 6573 206f 6620 6120   resources of a 
-0000a3a0: 7370 6563 6966 6963 2070 726f 6a65 6374  specific project
-0000a3b0: 2c20 6279 2064 6566 6175 6c74 204e 6f6e  , by default Non
-0000a3c0: 652c 2077 6869 6368 2077 696c 6c20 7265  e, which will re
-0000a3d0: 7475 726e 206f 6e6c 7920 7468 650a 2020  turn only the.  
-0000a3e0: 2020 2020 2020 2020 2020 7072 6f6a 6563            projec
-0000a3f0: 7473 2079 6f75 2772 6520 6175 7468 6f72  ts you're author
-0000a400: 697a 6564 2074 6f20 7365 652e 0a20 2020  ized to see..   
-0000a410: 2020 2020 203a 7061 7261 6d20 6c61 6265       :param labe
-0000a420: 6c5f 7365 6c65 6374 6f72 3a20 4120 6c61  l_selector: A la
-0000a430: 6265 6c20 6669 6c74 6572 2074 6861 7420  bel filter that 
-0000a440: 7769 6c6c 2062 6520 7061 7373 6564 2074  will be passed t
-0000a450: 6f20 4b75 6265 726e 6574 6573 2066 6f72  o Kubernetes for
-0000a460: 2066 696c 7465 7269 6e67 2074 6865 2072   filtering the r
-0000a470: 6573 756c 7473 2061 6363 6f72 6469 6e67  esults according
-0000a480: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
-0000a490: 7468 6569 7220 6c61 6265 6c73 2e0a 2020  their labels..  
-0000a4a0: 2020 2020 2020 3a70 6172 616d 206b 696e        :param kin
-0000a4b0: 643a 2054 6865 206b 696e 6420 6f66 2072  d: The kind of r
-0000a4c0: 756e 7469 6d65 2074 6f20 7175 6572 792e  untime to query.
-0000a4d0: 204d 6179 2062 6520 6f6e 6520 6f66 2060   May be one of `
-0000a4e0: 5b27 6461 736b 272c 2027 6a6f 6227 2c20  ['dask', 'job', 
-0000a4f0: 2773 7061 726b 272c 2027 7265 6d6f 7465  'spark', 'remote
-0000a500: 2d73 7061 726b 272c 2027 6d70 696a 6f62  -spark', 'mpijob
-0000a510: 275d 600a 2020 2020 2020 2020 3a70 6172  ']`.        :par
-0000a520: 616d 206f 626a 6563 745f 6964 3a20 5468  am object_id: Th
-0000a530: 6520 6964 656e 7469 6669 6572 206f 6620  e identifier of 
-0000a540: 7468 6520 6d6c 7275 6e20 6f62 6a65 6374  the mlrun object
-0000a550: 2074 6f20 7175 6572 7920 6974 7320 7275   to query its ru
-0000a560: 6e74 696d 6520 7265 736f 7572 6365 732e  ntime resources.
-0000a570: 2066 6f72 206d 6f73 7420 6675 6e63 7469   for most functi
-0000a580: 6f6e 2072 756e 7469 6d65 732c 0a20 2020  on runtimes,.   
-0000a590: 2020 2020 2020 2020 2072 756e 7469 6d65           runtime
-0000a5a0: 2072 6573 6f75 7263 6573 2061 7265 2070   resources are p
-0000a5b0: 6572 2052 756e 2c20 666f 7220 7768 6963  er Run, for whic
-0000a5c0: 6820 7468 6520 6964 656e 7469 6669 6572  h the identifier
-0000a5d0: 2069 7320 7468 6520 5275 6e27 7320 5549   is the Run's UI
-0000a5e0: 442e 2046 6f72 2064 6173 6b20 7275 6e74  D. For dask runt
-0000a5f0: 696d 652c 2074 6865 2072 756e 7469 6d65  ime, the runtime
-0000a600: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-0000a610: 6f75 7263 6573 2061 7265 2070 6572 2046  ources are per F
-0000a620: 756e 6374 696f 6e2c 2066 6f72 2077 6869  unction, for whi
-0000a630: 6368 2074 6865 2069 6465 6e74 6966 6965  ch the identifie
-0000a640: 7220 6973 2074 6865 2046 756e 6374 696f  r is the Functio
-0000a650: 6e27 7320 6e61 6d65 2e0a 2020 2020 2020  n's name..      
-0000a660: 2020 3a70 6172 616d 2067 726f 7570 5f62    :param group_b
-0000a670: 793a 204f 626a 6563 7420 746f 2067 726f  y: Object to gro
-0000a680: 7570 2072 6573 756c 7473 2062 792e 2041  up results by. A
-0000a690: 6c6c 6f77 6564 2076 616c 7565 7320 6172  llowed values ar
-0000a6a0: 6520 606a 6f62 6020 616e 6420 6070 726f  e `job` and `pro
-0000a6b0: 6a65 6374 602e 0a20 2020 2020 2020 2022  ject`..        "
-0000a6c0: 2222 0a20 2020 2020 2020 2070 6172 616d  "".        param
-0000a6d0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-0000a6e0: 2020 226c 6162 656c 5f73 656c 6563 746f    "label_selecto
-0000a6f0: 7222 3a20 6c61 6265 6c5f 7365 6c65 6374  r": label_select
-0000a700: 6f72 2c0a 2020 2020 2020 2020 2020 2020  or,.            
-0000a710: 2267 726f 7570 2d62 7922 3a20 6772 6f75  "group-by": grou
-0000a720: 705f 6279 2c0a 2020 2020 2020 2020 2020  p_by,.          
-0000a730: 2020 226b 696e 6422 3a20 6b69 6e64 2c0a    "kind": kind,.
-0000a740: 2020 2020 2020 2020 2020 2020 226f 626a              "obj
-0000a750: 6563 742d 6964 223a 206f 626a 6563 745f  ect-id": object_
-0000a760: 6964 2c0a 2020 2020 2020 2020 7d0a 2020  id,.        }.  
-0000a770: 2020 2020 2020 7072 6f6a 6563 745f 7061        project_pa
-0000a780: 7468 203d 2070 726f 6a65 6374 2069 6620  th = project if 
-0000a790: 7072 6f6a 6563 7420 656c 7365 2022 2a22  project else "*"
-0000a7a0: 0a20 2020 2020 2020 2065 7272 6f72 203d  .        error =
-0000a7b0: 2022 4661 696c 6564 206c 6973 7469 6e67   "Failed listing
-0000a7c0: 2072 756e 7469 6d65 2072 6573 6f75 7263   runtime resourc
-0000a7d0: 6573 220a 2020 2020 2020 2020 7265 7370  es".        resp
-0000a7e0: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
-0000a7f0: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
-0000a800: 2020 2247 4554 222c 2066 2270 726f 6a65    "GET", f"proje
-0000a810: 6374 732f 7b70 726f 6a65 6374 5f70 6174  cts/{project_pat
-0000a820: 687d 2f72 756e 7469 6d65 2d72 6573 6f75  h}/runtime-resou
-0000a830: 7263 6573 222c 2065 7272 6f72 2c20 7061  rces", error, pa
-0000a840: 7261 6d73 3d70 6172 616d 730a 2020 2020  rams=params.    
-0000a850: 2020 2020 290a 2020 2020 2020 2020 6966      ).        if
-0000a860: 2067 726f 7570 5f62 7920 6973 204e 6f6e   group_by is Non
-0000a870: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-0000a880: 7472 7563 7475 7265 645f 6c69 7374 203d  tructured_list =
-0000a890: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-0000a8a0: 2020 206d 6c72 756e 2e63 6f6d 6d6f 6e2e     mlrun.common.
-0000a8b0: 7363 6865 6d61 732e 4b69 6e64 5275 6e74  schemas.KindRunt
-0000a8c0: 696d 6552 6573 6f75 7263 6573 282a 2a6b  imeResources(**k
-0000a8d0: 696e 645f 7275 6e74 696d 655f 7265 736f  ind_runtime_reso
-0000a8e0: 7572 6365 7329 0a20 2020 2020 2020 2020  urces).         
-0000a8f0: 2020 2020 2020 2066 6f72 206b 696e 645f         for kind_
-0000a900: 7275 6e74 696d 655f 7265 736f 7572 6365  runtime_resource
-0000a910: 7320 696e 2072 6573 706f 6e73 652e 6a73  s in response.js
-0000a920: 6f6e 2829 0a20 2020 2020 2020 2020 2020  on().           
-0000a930: 205d 0a20 2020 2020 2020 2020 2020 2072   ].            r
-0000a940: 6574 7572 6e20 7374 7275 6374 7572 6564  eturn structured
-0000a950: 5f6c 6973 740a 2020 2020 2020 2020 656c  _list.        el
-0000a960: 6966 2067 726f 7570 5f62 7920 3d3d 206d  if group_by == m
-0000a970: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0000a980: 6d61 732e 4c69 7374 5275 6e74 696d 6552  mas.ListRuntimeR
-0000a990: 6573 6f75 7263 6573 4772 6f75 7042 7946  esourcesGroupByF
-0000a9a0: 6965 6c64 2e6a 6f62 3a0a 2020 2020 2020  ield.job:.      
-0000a9b0: 2020 2020 2020 7374 7275 6374 7572 6564        structured
-0000a9c0: 5f64 6963 7420 3d20 7b7d 0a20 2020 2020  _dict = {}.     
-0000a9d0: 2020 2020 2020 2066 6f72 2070 726f 6a65         for proje
-0000a9e0: 6374 2c20 6a6f 625f 7275 6e74 696d 655f  ct, job_runtime_
-0000a9f0: 7265 736f 7572 6365 735f 6d61 7020 696e  resources_map in
-0000aa00: 2072 6573 706f 6e73 652e 6a73 6f6e 2829   response.json()
-0000aa10: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
-0000aa20: 2020 2020 2020 2020 2020 666f 7220 6a6f            for jo
-0000aa30: 625f 6964 2c20 7275 6e74 696d 655f 7265  b_id, runtime_re
-0000aa40: 736f 7572 6365 7320 696e 206a 6f62 5f72  sources in job_r
-0000aa50: 756e 7469 6d65 5f72 6573 6f75 7263 6573  untime_resources
-0000aa60: 5f6d 6170 2e69 7465 6d73 2829 3a0a 2020  _map.items():.  
-0000aa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aa80: 2020 7374 7275 6374 7572 6564 5f64 6963    structured_dic
-0000aa90: 742e 7365 7464 6566 6175 6c74 2870 726f  t.setdefault(pro
-0000aaa0: 6a65 6374 2c20 7b7d 295b 0a20 2020 2020  ject, {})[.     
-0000aab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aac0: 2020 206a 6f62 5f69 640a 2020 2020 2020     job_id.      
-0000aad0: 2020 2020 2020 2020 2020 2020 2020 5d20                ] 
-0000aae0: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
-0000aaf0: 6368 656d 6173 2e52 756e 7469 6d65 5265  chemas.RuntimeRe
-0000ab00: 736f 7572 6365 7328 2a2a 7275 6e74 696d  sources(**runtim
-0000ab10: 655f 7265 736f 7572 6365 7329 0a20 2020  e_resources).   
-0000ab20: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000ab30: 7374 7275 6374 7572 6564 5f64 6963 740a  structured_dict.
-0000ab40: 2020 2020 2020 2020 656c 6966 2067 726f          elif gro
-0000ab50: 7570 5f62 7920 3d3d 206d 6c72 756e 2e63  up_by == mlrun.c
-0000ab60: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4c69  ommon.schemas.Li
-0000ab70: 7374 5275 6e74 696d 6552 6573 6f75 7263  stRuntimeResourc
-0000ab80: 6573 4772 6f75 7042 7946 6965 6c64 2e70  esGroupByField.p
-0000ab90: 726f 6a65 6374 3a0a 2020 2020 2020 2020  roject:.        
-0000aba0: 2020 2020 7374 7275 6374 7572 6564 5f64      structured_d
-0000abb0: 6963 7420 3d20 7b7d 0a20 2020 2020 2020  ict = {}.       
-0000abc0: 2020 2020 2066 6f72 2070 726f 6a65 6374       for project
-0000abd0: 2c20 6b69 6e64 5f72 756e 7469 6d65 5f72  , kind_runtime_r
-0000abe0: 6573 6f75 7263 6573 5f6d 6170 2069 6e20  esources_map in 
-0000abf0: 7265 7370 6f6e 7365 2e6a 736f 6e28 292e  response.json().
-0000ac00: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
-0000ac10: 2020 2020 2020 2020 2066 6f72 206b 696e           for kin
-0000ac20: 642c 2072 756e 7469 6d65 5f72 6573 6f75  d, runtime_resou
-0000ac30: 7263 6573 2069 6e20 6b69 6e64 5f72 756e  rces in kind_run
-0000ac40: 7469 6d65 5f72 6573 6f75 7263 6573 5f6d  time_resources_m
-0000ac50: 6170 2e69 7465 6d73 2829 3a0a 2020 2020  ap.items():.    
-0000ac60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ac70: 7374 7275 6374 7572 6564 5f64 6963 742e  structured_dict.
-0000ac80: 7365 7464 6566 6175 6c74 2870 726f 6a65  setdefault(proje
-0000ac90: 6374 2c20 7b7d 295b 0a20 2020 2020 2020  ct, {})[.       
-0000aca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000acb0: 206b 696e 640a 2020 2020 2020 2020 2020   kind.          
-0000acc0: 2020 2020 2020 2020 2020 5d20 3d20 6d6c            ] = ml
-0000acd0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0000ace0: 6173 2e52 756e 7469 6d65 5265 736f 7572  as.RuntimeResour
-0000acf0: 6365 7328 2a2a 7275 6e74 696d 655f 7265  ces(**runtime_re
-0000ad00: 736f 7572 6365 7329 0a20 2020 2020 2020  sources).       
-0000ad10: 2020 2020 2072 6574 7572 6e20 7374 7275       return stru
-0000ad20: 6374 7572 6564 5f64 6963 740a 2020 2020  ctured_dict.    
-0000ad30: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000ad40: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
-0000ad50: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
-0000ad60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ad70: 2066 2250 726f 7669 6465 6420 6772 6f75   f"Provided grou
-0000ad80: 7020 6279 2066 6965 6c64 2069 7320 6e6f  p by field is no
-0000ad90: 7420 7375 7070 6f72 7465 642e 2067 726f  t supported. gro
-0000ada0: 7570 5f62 793d 7b67 726f 7570 5f62 797d  up_by={group_by}
-0000adb0: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-0000adc0: 0a20 2020 2064 6566 2064 656c 6574 655f  .    def delete_
-0000add0: 7275 6e74 696d 655f 7265 736f 7572 6365  runtime_resource
-0000ade0: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
-0000adf0: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-0000ae00: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-0000ae10: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0000ae20: 6c61 6265 6c5f 7365 6c65 6374 6f72 3a20  label_selector: 
-0000ae30: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
-0000ae40: 4e6f 6e65 2c0a 2020 2020 2020 2020 6b69  None,.        ki
-0000ae50: 6e64 3a20 4f70 7469 6f6e 616c 5b73 7472  nd: Optional[str
-0000ae60: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-0000ae70: 2020 6f62 6a65 6374 5f69 643a 204f 7074    object_id: Opt
-0000ae80: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-0000ae90: 652c 0a20 2020 2020 2020 2066 6f72 6365  e,.        force
-0000aea0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-0000aeb0: 2020 2020 2020 2020 6772 6163 655f 7065          grace_pe
-0000aec0: 7269 6f64 3a20 696e 7420 3d20 4e6f 6e65  riod: int = None
-0000aed0: 2c0a 2020 2020 2920 2d3e 206d 6c72 756e  ,.    ) -> mlrun
-0000aee0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-0000aef0: 4772 6f75 7065 6442 7950 726f 6a65 6374  GroupedByProject
-0000af00: 5275 6e74 696d 6552 6573 6f75 7263 6573  RuntimeResources
-0000af10: 4f75 7470 7574 3a0a 2020 2020 2020 2020  Output:.        
-0000af20: 2222 2244 656c 6574 6520 616c 6c20 7275  """Delete all ru
-0000af30: 6e74 696d 6520 7265 736f 7572 6365 7320  ntime resources 
-0000af40: 7768 6963 6820 6172 6520 696e 2074 6572  which are in ter
-0000af50: 6d69 6e61 6c20 7374 6174 652e 0a0a 2020  minal state...  
-0000af60: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
-0000af70: 6a65 6374 3a20 4465 6c65 7465 206f 6e6c  ject: Delete onl
-0000af80: 7920 7275 6e74 696d 6520 7265 736f 7572  y runtime resour
-0000af90: 6365 7320 6f66 2061 2073 7065 6369 6669  ces of a specifi
-0000afa0: 6320 7072 6f6a 6563 742c 2062 7920 6465  c project, by de
-0000afb0: 6661 756c 7420 4e6f 6e65 2c20 7768 6963  fault None, whic
-0000afc0: 6820 7769 6c6c 2064 656c 6574 6520 6f6e  h will delete on
-0000afd0: 6c79 0a20 2020 2020 2020 2020 2020 2066  ly.            f
-0000afe0: 726f 6d20 7468 6520 7072 6f6a 6563 7473  rom the projects
-0000aff0: 2079 6f75 2772 6520 6175 7468 6f72 697a   you're authoriz
-0000b000: 6564 2074 6f20 6465 6c65 7465 2066 726f  ed to delete fro
-0000b010: 6d2e 0a20 2020 2020 2020 203a 7061 7261  m..        :para
-0000b020: 6d20 6c61 6265 6c5f 7365 6c65 6374 6f72  m label_selector
-0000b030: 3a20 4465 6c65 7465 206f 6e6c 7920 7275  : Delete only ru
-0000b040: 6e74 696d 6520 7265 736f 7572 6365 7320  ntime resources 
-0000b050: 6d61 7463 6869 6e67 2074 6865 206c 6162  matching the lab
-0000b060: 656c 2073 656c 6563 746f 722e 0a20 2020  el selector..   
-0000b070: 2020 2020 203a 7061 7261 6d20 6b69 6e64       :param kind
-0000b080: 3a20 5468 6520 6b69 6e64 206f 6620 7275  : The kind of ru
-0000b090: 6e74 696d 6520 746f 2064 656c 6574 652e  ntime to delete.
-0000b0a0: 204d 6179 2062 6520 6f6e 6520 6f66 2060   May be one of `
-0000b0b0: 5b27 6461 736b 272c 2027 6a6f 6227 2c20  ['dask', 'job', 
-0000b0c0: 2773 7061 726b 272c 2027 7265 6d6f 7465  'spark', 'remote
-0000b0d0: 2d73 7061 726b 272c 2027 6d70 696a 6f62  -spark', 'mpijob
-0000b0e0: 275d 600a 2020 2020 2020 2020 3a70 6172  ']`.        :par
-0000b0f0: 616d 206f 626a 6563 745f 6964 3a20 5468  am object_id: Th
-0000b100: 6520 6964 656e 7469 6669 6572 206f 6620  e identifier of 
-0000b110: 7468 6520 6d6c 7275 6e20 6f62 6a65 6374  the mlrun object
-0000b120: 2074 6f20 6465 6c65 7465 2069 7473 2072   to delete its r
-0000b130: 756e 7469 6d65 2072 6573 6f75 7263 6573  untime resources
-0000b140: 2e20 666f 7220 6d6f 7374 2066 756e 6374  . for most funct
-0000b150: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-0000b160: 7275 6e74 696d 6573 2c20 7275 6e74 696d  runtimes, runtim
-0000b170: 6520 7265 736f 7572 6365 7320 6172 6520  e resources are 
-0000b180: 7065 7220 5275 6e2c 2066 6f72 2077 6869  per Run, for whi
-0000b190: 6368 2074 6865 2069 6465 6e74 6966 6965  ch the identifie
-0000b1a0: 7220 6973 2074 6865 2052 756e 2773 2055  r is the Run's U
-0000b1b0: 4944 2e20 466f 7220 6461 736b 2072 756e  ID. For dask run
-0000b1c0: 7469 6d65 2c20 7468 650a 2020 2020 2020  time, the.      
-0000b1d0: 2020 2020 2020 7275 6e74 696d 6520 7265        runtime re
-0000b1e0: 736f 7572 6365 7320 6172 6520 7065 7220  sources are per 
-0000b1f0: 4675 6e63 7469 6f6e 2c20 666f 7220 7768  Function, for wh
-0000b200: 6963 6820 7468 6520 6964 656e 7469 6669  ich the identifi
-0000b210: 6572 2069 7320 7468 6520 4675 6e63 7469  er is the Functi
-0000b220: 6f6e 2773 206e 616d 652e 0a20 2020 2020  on's name..     
-0000b230: 2020 203a 7061 7261 6d20 666f 7263 653a     :param force:
-0000b240: 2046 6f72 6365 2064 656c 6574 696f 6e20   Force deletion 
-0000b250: 2d20 6465 6c65 7465 2074 6865 2072 756e  - delete the run
-0000b260: 7469 6d65 2072 6573 6f75 7263 6520 6576  time resource ev
-0000b270: 656e 2069 6620 6974 2773 206e 6f74 2069  en if it's not i
-0000b280: 6e20 7465 726d 696e 616c 2073 7461 7465  n terminal state
-0000b290: 206f 7220 6966 2074 6865 2067 7261 6365   or if the grace
-0000b2a0: 0a20 2020 2020 2020 2020 2020 2070 6572  .            per
-0000b2b0: 696f 6420 6469 646e 2774 2070 6173 732e  iod didn't pass.
-0000b2c0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000b2d0: 6772 6163 655f 7065 7269 6f64 3a20 4772  grace_period: Gr
-0000b2e0: 6163 6520 7065 7269 6f64 2067 6976 656e  ace period given
-0000b2f0: 2074 6f20 7468 6520 7275 6e74 696d 6520   to the runtime 
-0000b300: 7265 736f 7572 6365 2062 6566 6f72 6520  resource before 
-0000b310: 7468 6579 2061 7265 2061 6374 7561 6c6c  they are actuall
-0000b320: 7920 7265 6d6f 7665 642c 2063 6f75 6e74  y removed, count
-0000b330: 6564 2066 726f 6d0a 2020 2020 2020 2020  ed from.        
-0000b340: 2020 2020 7468 6520 6d6f 6d65 6e74 2074      the moment t
-0000b350: 6865 7920 6d6f 7665 6420 746f 2074 6572  hey moved to ter
-0000b360: 6d69 6e61 6c20 7374 6174 6520 2864 6566  minal state (def
-0000b370: 6175 6c74 7320 746f 206d 6c72 756e 2e6d  aults to mlrun.m
-0000b380: 6c63 6f6e 662e 7275 6e74 696d 655f 7265  lconf.runtime_re
-0000b390: 736f 7572 6365 735f 6465 6c65 7469 6f6e  sources_deletion
-0000b3a0: 5f67 7261 6365 5f70 6572 696f 6429 2e0a  _grace_period)..
-0000b3b0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-0000b3c0: 733a 203a 7079 3a63 6c61 7373 3a60 7e6d  s: :py:class:`~m
-0000b3d0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0000b3e0: 6d61 732e 4772 6f75 7065 6442 7950 726f  mas.GroupedByPro
-0000b3f0: 6a65 6374 5275 6e74 696d 6552 6573 6f75  jectRuntimeResou
-0000b400: 7263 6573 4f75 7470 7574 6020 6c69 7374  rcesOutput` list
-0000b410: 696e 6720 7468 6520 7275 6e74 696d 6520  ing the runtime 
-0000b420: 7265 736f 7572 6365 730a 2020 2020 2020  resources.      
-0000b430: 2020 2020 2020 7468 6174 2077 6572 6520        that were 
-0000b440: 7265 6d6f 7665 642e 0a20 2020 2020 2020  removed..       
-0000b450: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-0000b460: 6772 6163 655f 7065 7269 6f64 2069 7320  grace_period is 
-0000b470: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0000b480: 2020 6772 6163 655f 7065 7269 6f64 203d    grace_period =
-0000b490: 2063 6f6e 6669 672e 7275 6e74 696d 655f   config.runtime_
-0000b4a0: 7265 736f 7572 6365 735f 6465 6c65 7469  resources_deleti
-0000b4b0: 6f6e 5f67 7261 6365 5f70 6572 696f 640a  on_grace_period.
-0000b4c0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-0000b4d0: 6572 2e69 6e66 6f28 0a20 2020 2020 2020  er.info(.       
-0000b4e0: 2020 2020 2020 2020 2022 5573 696e 6720           "Using 
-0000b4f0: 6465 6661 756c 7420 6772 6163 6520 7065  default grace pe
-0000b500: 7269 6f64 2066 6f72 2072 756e 7469 6d65  riod for runtime
-0000b510: 2072 6573 6f75 7263 6573 2064 656c 6574   resources delet
-0000b520: 696f 6e22 2c0a 2020 2020 2020 2020 2020  ion",.          
-0000b530: 2020 2020 2020 6772 6163 655f 7065 7269        grace_peri
-0000b540: 6f64 3d67 7261 6365 5f70 6572 696f 642c  od=grace_period,
-0000b550: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-0000b560: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
-0000b570: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-0000b580: 6c61 6265 6c2d 7365 6c65 6374 6f72 223a  label-selector":
-0000b590: 206c 6162 656c 5f73 656c 6563 746f 722c   label_selector,
-0000b5a0: 0a20 2020 2020 2020 2020 2020 2022 6b69  .            "ki
-0000b5b0: 6e64 223a 206b 696e 642c 0a20 2020 2020  nd": kind,.     
-0000b5c0: 2020 2020 2020 2022 6f62 6a65 6374 2d69         "object-i
-0000b5d0: 6422 3a20 6f62 6a65 6374 5f69 642c 0a20  d": object_id,. 
-0000b5e0: 2020 2020 2020 2020 2020 2022 666f 7263             "forc
-0000b5f0: 6522 3a20 666f 7263 652c 0a20 2020 2020  e": force,.     
-0000b600: 2020 2020 2020 2022 6772 6163 652d 7065         "grace-pe
-0000b610: 7269 6f64 223a 2067 7261 6365 5f70 6572  riod": grace_per
-0000b620: 696f 642c 0a20 2020 2020 2020 207d 0a20  iod,.        }. 
-0000b630: 2020 2020 2020 2065 7272 6f72 203d 2022         error = "
-0000b640: 4661 696c 6564 2064 656c 6574 696e 6720  Failed deleting 
-0000b650: 7275 6e74 696d 6520 7265 736f 7572 6365  runtime resource
-0000b660: 7322 0a20 2020 2020 2020 2070 726f 6a65  s".        proje
-0000b670: 6374 5f70 6174 6820 3d20 7072 6f6a 6563  ct_path = projec
-0000b680: 7420 6966 2070 726f 6a65 6374 2065 6c73  t if project els
-0000b690: 6520 222a 220a 2020 2020 2020 2020 7265  e "*".        re
-0000b6a0: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
-0000b6b0: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
-0000b6c0: 2020 2020 2244 454c 4554 4522 2c0a 2020      "DELETE",.  
-0000b6d0: 2020 2020 2020 2020 2020 6622 7072 6f6a            f"proj
-0000b6e0: 6563 7473 2f7b 7072 6f6a 6563 745f 7061  ects/{project_pa
-0000b6f0: 7468 7d2f 7275 6e74 696d 652d 7265 736f  th}/runtime-reso
-0000b700: 7572 6365 7322 2c0a 2020 2020 2020 2020  urces",.        
-0000b710: 2020 2020 6572 726f 722c 0a20 2020 2020      error,.     
-0000b720: 2020 2020 2020 2070 6172 616d 733d 7061         params=pa
-0000b730: 7261 6d73 2c0a 2020 2020 2020 2020 290a  rams,.        ).
-0000b740: 2020 2020 2020 2020 7374 7275 6374 7572          structur
-0000b750: 6564 5f64 6963 7420 3d20 7b7d 0a20 2020  ed_dict = {}.   
-0000b760: 2020 2020 2066 6f72 2070 726f 6a65 6374       for project
-0000b770: 2c20 6b69 6e64 5f72 756e 7469 6d65 5f72  , kind_runtime_r
-0000b780: 6573 6f75 7263 6573 5f6d 6170 2069 6e20  esources_map in 
-0000b790: 7265 7370 6f6e 7365 2e6a 736f 6e28 292e  response.json().
-0000b7a0: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
-0000b7b0: 2020 2020 2066 6f72 206b 696e 642c 2072       for kind, r
-0000b7c0: 756e 7469 6d65 5f72 6573 6f75 7263 6573  untime_resources
-0000b7d0: 2069 6e20 6b69 6e64 5f72 756e 7469 6d65   in kind_runtime
-0000b7e0: 5f72 6573 6f75 7263 6573 5f6d 6170 2e69  _resources_map.i
-0000b7f0: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
-0000b800: 2020 2020 2020 2020 7374 7275 6374 7572          structur
-0000b810: 6564 5f64 6963 742e 7365 7464 6566 6175  ed_dict.setdefau
-0000b820: 6c74 2870 726f 6a65 6374 2c20 7b7d 295b  lt(project, {})[
-0000b830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b840: 2020 2020 206b 696e 640a 2020 2020 2020       kind.      
-0000b850: 2020 2020 2020 2020 2020 5d20 3d20 6d6c            ] = ml
-0000b860: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0000b870: 6173 2e52 756e 7469 6d65 5265 736f 7572  as.RuntimeResour
-0000b880: 6365 7328 2a2a 7275 6e74 696d 655f 7265  ces(**runtime_re
-0000b890: 736f 7572 6365 7329 0a20 2020 2020 2020  sources).       
-0000b8a0: 2072 6574 7572 6e20 7374 7275 6374 7572   return structur
-0000b8b0: 6564 5f64 6963 740a 0a20 2020 2064 6566  ed_dict..    def
-0000b8c0: 2063 7265 6174 655f 7363 6865 6475 6c65   create_schedule
-0000b8d0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-0000b8e0: 7072 6f6a 6563 743a 2073 7472 2c20 7363  project: str, sc
-0000b8f0: 6865 6475 6c65 3a20 6d6c 7275 6e2e 636f  hedule: mlrun.co
-0000b900: 6d6d 6f6e 2e73 6368 656d 6173 2e53 6368  mmon.schemas.Sch
-0000b910: 6564 756c 6549 6e70 7574 0a20 2020 2029  eduleInput.    )
-0000b920: 3a0a 2020 2020 2020 2020 2222 2243 7265  :.        """Cre
-0000b930: 6174 6520 6120 6e65 7720 7363 6865 6475  ate a new schedu
-0000b940: 6c65 206f 6e20 7468 6520 6769 7665 6e20  le on the given 
-0000b950: 7072 6f6a 6563 742e 2054 6865 2064 6574  project. The det
-0000b960: 6169 6c73 206f 6e20 7468 6520 6163 7475  ails on the actu
-0000b970: 616c 206f 626a 6563 7420 746f 2073 6368  al object to sch
-0000b980: 6564 756c 6520 6173 2077 656c 6c20 6173  edule as well as
-0000b990: 2074 6865 0a20 2020 2020 2020 2073 6368   the.        sch
-0000b9a0: 6564 756c 6520 6974 7365 6c66 2061 7265  edule itself are
-0000b9b0: 2077 6974 6869 6e20 7468 6520 7363 6865   within the sche
-0000b9c0: 6475 6c65 206f 626a 6563 7420 7072 6f76  dule object prov
-0000b9d0: 6964 6564 2e0a 2020 2020 2020 2020 5468  ided..        Th
-0000b9e0: 6520 3a70 793a 636c 6173 733a 607e 5363  e :py:class:`~Sc
-0000b9f0: 6865 6475 6c65 4372 6f6e 5472 6967 6765  heduleCronTrigge
-0000ba00: 7260 2066 6f6c 6c6f 7773 2074 6865 2067  r` follows the g
-0000ba10: 7569 6465 6c69 6e65 7320 696e 0a20 2020  uidelines in.   
-0000ba20: 2020 2020 2068 7474 7073 3a2f 2f61 7073       https://aps
-0000ba30: 6368 6564 756c 6572 2e72 6561 6474 6865  cheduler.readthe
-0000ba40: 646f 6373 2e69 6f2f 656e 2f33 2e78 2f6d  docs.io/en/3.x/m
-0000ba50: 6f64 756c 6573 2f74 7269 6767 6572 732f  odules/triggers/
-0000ba60: 6372 6f6e 2e68 746d 6c2e 0a20 2020 2020  cron.html..     
-0000ba70: 2020 2049 7420 616c 736f 2073 7570 706f     It also suppo
-0000ba80: 7274 7320 6120 3a70 793a 6675 6e63 3a60  rts a :py:func:`
-0000ba90: 7e53 6368 6564 756c 6543 726f 6e54 7269  ~ScheduleCronTri
-0000baa0: 6767 6572 2e66 726f 6d5f 6372 6f6e 7461  gger.from_cronta
-0000bab0: 6260 2066 756e 6374 696f 6e20 7468 6174  b` function that
-0000bac0: 2061 6363 6570 7473 2061 0a20 2020 2020   accepts a.     
-0000bad0: 2020 2063 726f 6e74 6162 2d66 6f72 6d61     crontab-forma
-0000bae0: 7474 6564 2073 7472 696e 6720 2873 6565  tted string (see
-0000baf0: 2068 7474 7073 3a2f 2f65 6e2e 7769 6b69   https://en.wiki
-0000bb00: 7065 6469 612e 6f72 672f 7769 6b69 2f43  pedia.org/wiki/C
-0000bb10: 726f 6e20 666f 7220 6d6f 7265 2069 6e66  ron for more inf
-0000bb20: 6f72 6d61 7469 6f6e 206f 6e20 7468 6520  ormation on the 
-0000bb30: 666f 726d 6174 2061 6e64 0a20 2020 2020  format and.     
-0000bb40: 2020 206e 6f74 6520 7468 6174 2074 6865     note that the
-0000bb50: 2030 2077 6565 6b64 6179 2069 7320 616c   0 weekday is al
-0000bb60: 7761 7973 206d 6f6e 6461 7929 2e0a 0a0a  ways monday)....
-0000bb70: 2020 2020 2020 2020 4578 616d 706c 653a          Example:
-0000bb80: 3a0a 0a20 2020 2020 2020 2020 2020 2066  :..            f
-0000bb90: 726f 6d20 6d6c 7275 6e2e 636f 6d6d 6f6e  rom mlrun.common
-0000bba0: 2069 6d70 6f72 7420 7363 6865 6d61 730a   import schemas.
-0000bbb0: 0a20 2020 2020 2020 2020 2020 2023 2045  .            # E
-0000bbc0: 7865 6375 7465 2074 6865 2067 6574 5f64  xecute the get_d
-0000bbd0: 6174 615f 6675 6e63 2066 756e 6374 696f  ata_func functio
-0000bbe0: 6e20 6576 6572 7920 5475 6573 6461 7920  n every Tuesday 
-0000bbf0: 6174 2031 353a 3330 0a20 2020 2020 2020  at 15:30.       
-0000bc00: 2020 2020 2073 6368 6564 756c 6520 3d20       schedule = 
-0000bc10: 7363 6865 6d61 732e 5363 6865 6475 6c65  schemas.Schedule
-0000bc20: 496e 7075 7428 0a20 2020 2020 2020 2020  Input(.         
-0000bc30: 2020 2020 2020 206e 616d 653d 2272 756e         name="run
-0000bc40: 5f66 756e 635f 6f6e 5f74 7565 7364 6179  _func_on_tuesday
-0000bc50: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
-0000bc60: 2020 2020 6b69 6e64 3d22 6a6f 6222 2c0a      kind="job",.
-0000bc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bc80: 7363 6865 6475 6c65 645f 6f62 6a65 6374  scheduled_object
-0000bc90: 3d67 6574 5f64 6174 615f 6675 6e63 2c0a  =get_data_func,.
-0000bca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bcb0: 6372 6f6e 5f74 7269 6767 6572 3d73 6368  cron_trigger=sch
-0000bcc0: 656d 6173 2e53 6368 6564 756c 6543 726f  emas.ScheduleCro
-0000bcd0: 6e54 7269 6767 6572 2864 6179 5f6f 665f  nTrigger(day_of_
-0000bce0: 7765 656b 3d27 7475 6527 2c20 686f 7572  week='tue', hour
-0000bcf0: 3d31 352c 206d 696e 7574 653d 3330 292c  =15, minute=30),
-0000bd00: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0000bd10: 2020 2020 2020 2020 2020 2064 622e 6372             db.cr
-0000bd20: 6561 7465 5f73 6368 6564 756c 6528 7072  eate_schedule(pr
-0000bd30: 6f6a 6563 745f 6e61 6d65 2c20 7363 6865  oject_name, sche
-0000bd40: 6475 6c65 290a 2020 2020 2020 2020 2222  dule).        ""
-0000bd50: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
-0000bd60: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
-0000bd70: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
-0000bd80: 726f 6a65 6374 0a20 2020 2020 2020 2070  roject.        p
-0000bd90: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
-0000bda0: 2f7b 7072 6f6a 6563 747d 2f73 6368 6564  /{project}/sched
-0000bdb0: 756c 6573 220a 0a20 2020 2020 2020 2065  ules"..        e
-0000bdc0: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
-0000bdd0: 2246 6169 6c65 6420 6372 6561 7469 6e67  "Failed creating
-0000bde0: 2073 6368 6564 756c 6520 7b70 726f 6a65   schedule {proje
-0000bdf0: 6374 7d2f 7b73 6368 6564 756c 652e 6e61  ct}/{schedule.na
-0000be00: 6d65 7d22 0a20 2020 2020 2020 2073 656c  me}".        sel
-0000be10: 662e 6170 695f 6361 6c6c 2822 504f 5354  f.api_call("POST
-0000be20: 222c 2070 6174 682c 2065 7272 6f72 5f6d  ", path, error_m
-0000be30: 6573 7361 6765 2c20 626f 6479 3d64 6963  essage, body=dic
-0000be40: 745f 746f 5f6a 736f 6e28 7363 6865 6475  t_to_json(schedu
-0000be50: 6c65 2e64 6963 7428 2929 290a 0a20 2020  le.dict()))..   
-0000be60: 2064 6566 2075 7064 6174 655f 7363 6865   def update_sche
-0000be70: 6475 6c65 280a 2020 2020 2020 2020 7365  dule(.        se
-0000be80: 6c66 2c20 7072 6f6a 6563 743a 2073 7472  lf, project: str
-0000be90: 2c20 6e61 6d65 3a20 7374 722c 2073 6368  , name: str, sch
-0000bea0: 6564 756c 653a 206d 6c72 756e 2e63 6f6d  edule: mlrun.com
-0000beb0: 6d6f 6e2e 7363 6865 6d61 732e 5363 6865  mon.schemas.Sche
-0000bec0: 6475 6c65 5570 6461 7465 0a20 2020 2029  duleUpdate.    )
-0000bed0: 3a0a 2020 2020 2020 2020 2222 2255 7064  :.        """Upd
-0000bee0: 6174 6520 616e 2065 7869 7374 696e 6720  ate an existing 
-0000bef0: 7363 6865 6475 6c65 2c20 7265 706c 6163  schedule, replac
-0000bf00: 6520 6974 2077 6974 6820 7468 6520 6465  e it with the de
-0000bf10: 7461 696c 7320 636f 6e74 6169 6e65 6420  tails contained 
-0000bf20: 696e 2074 6865 2073 6368 6564 756c 6520  in the schedule 
-0000bf30: 6f62 6a65 6374 2e22 2222 0a0a 2020 2020  object."""..    
-0000bf40: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
-0000bf50: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
-0000bf60: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
-0000bf70: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
-0000bf80: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-0000bf90: 6374 7d2f 7363 6865 6475 6c65 732f 7b6e  ct}/schedules/{n
-0000bfa0: 616d 657d 220a 0a20 2020 2020 2020 2065  ame}"..        e
-0000bfb0: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
-0000bfc0: 2246 6169 6c65 6420 7570 6461 7469 6e67  "Failed updating
-0000bfd0: 2073 6368 6564 756c 6520 7b70 726f 6a65   schedule {proje
-0000bfe0: 6374 7d2f 7b6e 616d 657d 220a 2020 2020  ct}/{name}".    
-0000bff0: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
-0000c000: 6c28 2250 5554 222c 2070 6174 682c 2065  l("PUT", path, e
-0000c010: 7272 6f72 5f6d 6573 7361 6765 2c20 626f  rror_message, bo
-0000c020: 6479 3d64 6963 745f 746f 5f6a 736f 6e28  dy=dict_to_json(
-0000c030: 7363 6865 6475 6c65 2e64 6963 7428 2929  schedule.dict())
-0000c040: 290a 0a20 2020 2064 6566 2067 6574 5f73  )..    def get_s
-0000c050: 6368 6564 756c 6528 0a20 2020 2020 2020  chedule(.       
-0000c060: 2073 656c 662c 2070 726f 6a65 6374 3a20   self, project: 
-0000c070: 7374 722c 206e 616d 653a 2073 7472 2c20  str, name: str, 
-0000c080: 696e 636c 7564 655f 6c61 7374 5f72 756e  include_last_run
-0000c090: 3a20 626f 6f6c 203d 2046 616c 7365 0a20  : bool = False. 
-0000c0a0: 2020 2029 202d 3e20 6d6c 7275 6e2e 636f     ) -> mlrun.co
-0000c0b0: 6d6d 6f6e 2e73 6368 656d 6173 2e53 6368  mmon.schemas.Sch
-0000c0c0: 6564 756c 654f 7574 7075 743a 0a20 2020  eduleOutput:.   
-0000c0d0: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
-0000c0e0: 2064 6574 6169 6c73 206f 6620 7468 6520   details of the 
-0000c0f0: 7363 6865 6475 6c65 2069 6e20 7175 6573  schedule in ques
-0000c100: 7469 6f6e 2e20 4265 7369 6465 7320 7265  tion. Besides re
-0000c110: 7475 726e 696e 6720 7468 6520 6465 7461  turning the deta
-0000c120: 696c 7320 6f66 2074 6865 2073 6368 6564  ils of the sched
-0000c130: 756c 6520 6f62 6a65 6374 2069 7473 656c  ule object itsel
-0000c140: 662c 0a20 2020 2020 2020 2074 6869 7320  f,.        this 
-0000c150: 6675 6e63 7469 6f6e 2061 6c73 6f20 7265  function also re
-0000c160: 7475 726e 7320 7468 6520 6e65 7874 2073  turns the next s
-0000c170: 6368 6564 756c 6564 2072 756e 2066 6f72  cheduled run for
-0000c180: 2074 6869 7320 7370 6563 6966 6963 2073   this specific s
-0000c190: 6368 6564 756c 652c 2061 7320 7765 6c6c  chedule, as well
-0000c1a0: 2061 7320 706f 7465 6e74 6961 6c6c 7920   as potentially 
-0000c1b0: 7468 650a 2020 2020 2020 2020 7265 7375  the.        resu
-0000c1c0: 6c74 7320 6f66 2074 6865 206c 6173 7420  lts of the last 
-0000c1d0: 7275 6e20 6578 6563 7574 6564 2074 6872  run executed thr
-0000c1e0: 6f75 6768 2074 6869 7320 7363 6865 6475  ough this schedu
-0000c1f0: 6c65 2e0a 0a20 2020 2020 2020 203a 7061  le...        :pa
-0000c200: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
-0000c210: 6a65 6374 206e 616d 652e 0a20 2020 2020  ject name..     
-0000c220: 2020 203a 7061 7261 6d20 6e61 6d65 3a20     :param name: 
-0000c230: 4e61 6d65 206f 6620 7468 6520 7363 6865  Name of the sche
-0000c240: 6475 6c65 206f 626a 6563 7420 746f 2071  dule object to q
-0000c250: 7565 7279 2e0a 2020 2020 2020 2020 3a70  uery..        :p
-0000c260: 6172 616d 2069 6e63 6c75 6465 5f6c 6173  aram include_las
-0000c270: 745f 7275 6e3a 2057 6865 7468 6572 2074  t_run: Whether t
-0000c280: 6f20 696e 636c 7564 6520 7468 6520 7265  o include the re
-0000c290: 7375 6c74 7320 6f66 2074 6865 2073 6368  sults of the sch
-0000c2a0: 6564 756c 6527 7320 6c61 7374 2072 756e  edule's last run
-0000c2b0: 2069 6e20 7468 6520 7265 7370 6f6e 7365   in the response
-0000c2c0: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-0000c2d0: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
-0000c2e0: 2070 726f 6a65 6374 206f 7220 636f 6e66   project or conf
-0000c2f0: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
-0000c300: 6374 0a20 2020 2020 2020 2070 6174 6820  ct.        path 
-0000c310: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
-0000c320: 6f6a 6563 747d 2f73 6368 6564 756c 6573  oject}/schedules
-0000c330: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
-0000c340: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-0000c350: 2066 2246 6169 6c65 6420 6765 7474 696e   f"Failed gettin
-0000c360: 6720 7363 6865 6475 6c65 2066 6f72 207b  g schedule for {
-0000c370: 7072 6f6a 6563 747d 2f7b 6e61 6d65 7d22  project}/{name}"
-0000c380: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
-0000c390: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
-0000c3a0: 2020 2020 2020 2020 2020 2022 4745 5422             "GET"
-0000c3b0: 2c20 7061 7468 2c20 6572 726f 725f 6d65  , path, error_me
-0000c3c0: 7373 6167 652c 2070 6172 616d 733d 7b22  ssage, params={"
-0000c3d0: 696e 636c 7564 655f 6c61 7374 5f72 756e  include_last_run
-0000c3e0: 223a 2069 6e63 6c75 6465 5f6c 6173 745f  ": include_last_
-0000c3f0: 7275 6e7d 0a20 2020 2020 2020 2029 0a20  run}.        ). 
-0000c400: 2020 2020 2020 2072 6574 7572 6e20 6d6c         return ml
-0000c410: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0000c420: 6173 2e53 6368 6564 756c 654f 7574 7075  as.ScheduleOutpu
-0000c430: 7428 2a2a 7265 7370 2e6a 736f 6e28 2929  t(**resp.json())
-0000c440: 0a0a 2020 2020 6465 6620 6c69 7374 5f73  ..    def list_s
-0000c450: 6368 6564 756c 6573 280a 2020 2020 2020  chedules(.      
-0000c460: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0000c470: 7072 6f6a 6563 743a 2073 7472 2c0a 2020  project: str,.  
-0000c480: 2020 2020 2020 6e61 6d65 3a20 7374 7220        name: str 
-0000c490: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0000c4a0: 6b69 6e64 3a20 6d6c 7275 6e2e 636f 6d6d  kind: mlrun.comm
-0000c4b0: 6f6e 2e73 6368 656d 6173 2e53 6368 6564  on.schemas.Sched
-0000c4c0: 756c 654b 696e 6473 203d 204e 6f6e 652c  uleKinds = None,
-0000c4d0: 0a20 2020 2020 2020 2069 6e63 6c75 6465  .        include
-0000c4e0: 5f6c 6173 745f 7275 6e3a 2062 6f6f 6c20  _last_run: bool 
-0000c4f0: 3d20 4661 6c73 652c 0a20 2020 2029 202d  = False,.    ) -
-0000c500: 3e20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  > mlrun.common.s
-0000c510: 6368 656d 6173 2e53 6368 6564 756c 6573  chemas.Schedules
-0000c520: 4f75 7470 7574 3a0a 2020 2020 2020 2020  Output:.        
-0000c530: 2222 2252 6574 7269 6576 6520 6c69 7374  """Retrieve list
-0000c540: 206f 6620 7363 6865 6475 6c65 7320 6f66   of schedules of
-0000c550: 2073 7065 6369 6669 6320 6e61 6d65 206f   specific name o
-0000c560: 7220 6b69 6e64 2e0a 0a20 2020 2020 2020  r kind...       
-0000c570: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
-0000c580: 2050 726f 6a65 6374 206e 616d 652e 0a20   Project name.. 
-0000c590: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
-0000c5a0: 6d65 3a20 4e61 6d65 206f 6620 7363 6865  me: Name of sche
-0000c5b0: 6475 6c65 2074 6f20 7265 7472 6965 7665  dule to retrieve
-0000c5c0: 2e20 4361 6e20 6265 206f 6d69 7474 6564  . Can be omitted
-0000c5d0: 2074 6f20 6c69 7374 2061 6c6c 2073 6368   to list all sch
-0000c5e0: 6564 756c 6573 2e0a 2020 2020 2020 2020  edules..        
-0000c5f0: 3a70 6172 616d 206b 696e 643a 204b 696e  :param kind: Kin
-0000c600: 6420 6f66 2073 6368 6564 756c 6520 6f62  d of schedule ob
-0000c610: 6a65 6374 7320 746f 2072 6574 7269 6576  jects to retriev
-0000c620: 652c 2063 616e 2062 6520 6569 7468 6572  e, can be either
-0000c630: 2060 606a 6f62 6060 206f 7220 6060 7069   ``job`` or ``pi
-0000c640: 7065 6c69 6e65 6060 2e0a 2020 2020 2020  peline``..      
-0000c650: 2020 3a70 6172 616d 2069 6e63 6c75 6465    :param include
-0000c660: 5f6c 6173 745f 7275 6e3a 2057 6865 7468  _last_run: Wheth
-0000c670: 6572 2074 6f20 7265 7475 726e 2066 6f72  er to return for
-0000c680: 2065 6163 6820 7363 6865 6475 6c65 2072   each schedule r
-0000c690: 6574 7572 6e65 6420 616c 736f 2074 6865  eturned also the
-0000c6a0: 2072 6573 756c 7473 206f 6620 7468 6520   results of the 
-0000c6b0: 6c61 7374 2072 756e 206f 660a 2020 2020  last run of.    
-0000c6c0: 2020 2020 2020 2020 7468 6174 2073 6368          that sch
-0000c6d0: 6564 756c 652e 0a20 2020 2020 2020 2022  edule..        "
-0000c6e0: 2222 0a0a 2020 2020 2020 2020 7072 6f6a  ""..        proj
-0000c6f0: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
-0000c700: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
-0000c710: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
-0000c720: 7061 7261 6d73 203d 207b 226b 696e 6422  params = {"kind"
-0000c730: 3a20 6b69 6e64 2c20 226e 616d 6522 3a20  : kind, "name": 
-0000c740: 6e61 6d65 2c20 2269 6e63 6c75 6465 5f6c  name, "include_l
-0000c750: 6173 745f 7275 6e22 3a20 696e 636c 7564  ast_run": includ
-0000c760: 655f 6c61 7374 5f72 756e 7d0a 2020 2020  e_last_run}.    
-0000c770: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
-0000c780: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
-0000c790: 7363 6865 6475 6c65 7322 0a20 2020 2020  schedules".     
-0000c7a0: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-0000c7b0: 203d 2066 2246 6169 6c65 6420 6c69 7374   = f"Failed list
-0000c7c0: 696e 6720 7363 6865 6475 6c65 7320 666f  ing schedules fo
-0000c7d0: 7220 7b70 726f 6a65 6374 7d20 3f20 7b6b  r {project} ? {k
-0000c7e0: 696e 647d 207b 6e61 6d65 7d22 0a20 2020  ind} {name}".   
-0000c7f0: 2020 2020 2072 6573 7020 3d20 7365 6c66       resp = self
-0000c800: 2e61 7069 5f63 616c 6c28 2247 4554 222c  .api_call("GET",
-0000c810: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
-0000c820: 7361 6765 2c20 7061 7261 6d73 3d70 6172  sage, params=par
-0000c830: 616d 7329 0a20 2020 2020 2020 2072 6574  ams).        ret
-0000c840: 7572 6e20 6d6c 7275 6e2e 636f 6d6d 6f6e  urn mlrun.common
-0000c850: 2e73 6368 656d 6173 2e53 6368 6564 756c  .schemas.Schedul
-0000c860: 6573 4f75 7470 7574 282a 2a72 6573 702e  esOutput(**resp.
-0000c870: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
-0000c880: 2064 656c 6574 655f 7363 6865 6475 6c65   delete_schedule
-0000c890: 2873 656c 662c 2070 726f 6a65 6374 3a20  (self, project: 
-0000c8a0: 7374 722c 206e 616d 653a 2073 7472 293a  str, name: str):
-0000c8b0: 0a20 2020 2020 2020 2022 2222 4465 6c65  .        """Dele
-0000c8c0: 7465 2061 2073 7065 6369 6669 6320 7363  te a specific sc
-0000c8d0: 6865 6475 6c65 2062 7920 6e61 6d65 2e22  hedule by name."
-0000c8e0: 2222 0a0a 2020 2020 2020 2020 7072 6f6a  ""..        proj
-0000c8f0: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
-0000c900: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
-0000c910: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
-0000c920: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
-0000c930: 732f 7b70 726f 6a65 6374 7d2f 7363 6865  s/{project}/sche
-0000c940: 6475 6c65 732f 7b6e 616d 657d 220a 2020  dules/{name}".  
-0000c950: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-0000c960: 6167 6520 3d20 6622 4661 696c 6564 2064  age = f"Failed d
-0000c970: 656c 6574 696e 6720 7363 6865 6475 6c65  eleting schedule
-0000c980: 207b 7072 6f6a 6563 747d 2f7b 6e61 6d65   {project}/{name
-0000c990: 7d22 0a20 2020 2020 2020 2073 656c 662e  }".        self.
-0000c9a0: 6170 695f 6361 6c6c 2822 4445 4c45 5445  api_call("DELETE
-0000c9b0: 222c 2070 6174 682c 2065 7272 6f72 5f6d  ", path, error_m
-0000c9c0: 6573 7361 6765 290a 0a20 2020 2064 6566  essage)..    def
-0000c9d0: 2069 6e76 6f6b 655f 7363 6865 6475 6c65   invoke_schedule
-0000c9e0: 2873 656c 662c 2070 726f 6a65 6374 3a20  (self, project: 
-0000c9f0: 7374 722c 206e 616d 653a 2073 7472 293a  str, name: str):
-0000ca00: 0a20 2020 2020 2020 2022 2222 4578 6563  .        """Exec
-0000ca10: 7574 6520 7468 6520 6f62 6a65 6374 2072  ute the object r
-0000ca20: 6566 6572 656e 6365 6420 6279 2074 6865  eferenced by the
-0000ca30: 2073 6368 6564 756c 6520 696d 6d65 6469   schedule immedi
-0000ca40: 6174 656c 792e 2222 220a 0a20 2020 2020  ately."""..     
-0000ca50: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
-0000ca60: 6a65 6374 206f 7220 636f 6e66 6967 2e64  ject or config.d
-0000ca70: 6566 6175 6c74 5f70 726f 6a65 6374 0a20  efault_project. 
-0000ca80: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-0000ca90: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-0000caa0: 747d 2f73 6368 6564 756c 6573 2f7b 6e61  t}/schedules/{na
-0000cab0: 6d65 7d2f 696e 766f 6b65 220a 2020 2020  me}/invoke".    
-0000cac0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-0000cad0: 6520 3d20 6622 4661 696c 6564 2069 6e76  e = f"Failed inv
-0000cae0: 6f6b 696e 6720 7363 6865 6475 6c65 207b  oking schedule {
-0000caf0: 7072 6f6a 6563 747d 2f7b 6e61 6d65 7d22  project}/{name}"
-0000cb00: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
-0000cb10: 695f 6361 6c6c 2822 504f 5354 222c 2070  i_call("POST", p
-0000cb20: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
-0000cb30: 6765 290a 0a20 2020 2064 6566 2072 656d  ge)..    def rem
-0000cb40: 6f74 655f 6275 696c 6465 7228 0a20 2020  ote_builder(.   
-0000cb50: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000cb60: 2020 2066 756e 632c 0a20 2020 2020 2020     func,.       
-0000cb70: 2077 6974 685f 6d6c 7275 6e2c 0a20 2020   with_mlrun,.   
-0000cb80: 2020 2020 206d 6c72 756e 5f76 6572 7369       mlrun_versi
-0000cb90: 6f6e 5f73 7065 6369 6669 6572 3d4e 6f6e  on_specifier=Non
-0000cba0: 652c 0a20 2020 2020 2020 2073 6b69 705f  e,.        skip_
-0000cbb0: 6465 706c 6f79 6564 3d46 616c 7365 2c0a  deployed=False,.
-0000cbc0: 2020 2020 2020 2020 6275 696c 6465 725f          builder_
-0000cbd0: 656e 763d 4e6f 6e65 2c0a 2020 2020 293a  env=None,.    ):
-0000cbe0: 0a20 2020 2020 2020 2022 2222 4275 696c  .        """Buil
-0000cbf0: 6420 7468 6520 706f 6420 696d 6167 6520  d the pod image 
-0000cc00: 666f 7220 6120 6675 6e63 7469 6f6e 2c20  for a function, 
-0000cc10: 666f 7220 6578 6563 7574 696f 6e20 6f6e  for execution on
-0000cc20: 2061 2072 656d 6f74 6520 636c 7573 7465   a remote cluste
-0000cc30: 722e 2054 6869 7320 6973 2065 7865 6375  r. This is execu
-0000cc40: 7465 6420 6279 2074 6865 204d 4c52 756e  ted by the MLRun
-0000cc50: 0a20 2020 2020 2020 2041 5049 2073 6572  .        API ser
-0000cc60: 7665 722c 2061 6e64 2063 7265 6174 6573  ver, and creates
-0000cc70: 2061 2044 6f63 6b65 7220 696d 6167 6520   a Docker image 
-0000cc80: 6f75 7420 6f66 2074 6865 2066 756e 6374  out of the funct
-0000cc90: 696f 6e20 7072 6f76 6964 6564 2061 6e64  ion provided and
-0000cca0: 2061 6e79 2073 7065 6369 6669 6320 6275   any specific bu
-0000ccb0: 696c 640a 2020 2020 2020 2020 696e 7374  ild.        inst
-0000ccc0: 7275 6374 696f 6e73 2070 726f 7669 6465  ructions provide
-0000ccd0: 6420 7769 7468 696e 2e20 5468 6973 2069  d within. This i
-0000cce0: 7320 6120 7072 652d 7265 7175 6973 6974  s a pre-requisit
-0000ccf0: 6520 666f 7220 7265 6d6f 7465 6c79 2065  e for remotely e
-0000cd00: 7865 6375 7469 6e67 2061 2066 756e 6374  xecuting a funct
-0000cd10: 696f 6e2c 2075 6e6c 6573 7320 7573 696e  ion, unless usin
-0000cd20: 670a 2020 2020 2020 2020 6120 7072 652d  g.        a pre-
-0000cd30: 6465 706c 6f79 6564 2069 6d61 6765 2e0a  deployed image..
-0000cd40: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000cd50: 6675 6e63 3a20 4675 6e63 7469 6f6e 2074  func: Function t
-0000cd60: 6f20 6275 696c 642e 0a20 2020 2020 2020  o build..       
-0000cd70: 203a 7061 7261 6d20 7769 7468 5f6d 6c72   :param with_mlr
-0000cd80: 756e 3a20 5768 6574 6865 7220 746f 2061  un: Whether to a
-0000cd90: 6464 204d 4c52 756e 2070 6163 6b61 6765  dd MLRun package
-0000cda0: 2074 6f20 7468 6520 6275 696c 7420 7061   to the built pa
-0000cdb0: 636b 6167 652e 2054 6869 7320 6973 206e  ckage. This is n
-0000cdc0: 6f74 2072 6571 7569 7265 6420 6966 2075  ot required if u
-0000cdd0: 7369 6e67 2061 2062 6173 650a 2020 2020  sing a base.    
-0000cde0: 2020 2020 2020 2020 696d 6167 6520 7468          image th
-0000cdf0: 6174 2061 6c72 6561 6479 2068 6173 204d  at already has M
-0000ce00: 4c52 756e 2069 6e20 6974 2e0a 2020 2020  LRun in it..    
-0000ce10: 2020 2020 3a70 6172 616d 206d 6c72 756e      :param mlrun
-0000ce20: 5f76 6572 7369 6f6e 5f73 7065 6369 6669  _version_specifi
-0000ce30: 6572 3a20 5665 7273 696f 6e20 6f66 204d  er: Version of M
-0000ce40: 4c52 756e 2074 6f20 696e 636c 7564 6520  LRun to include 
-0000ce50: 696e 2074 6865 2062 7569 6c74 2069 6d61  in the built ima
-0000ce60: 6765 2e0a 2020 2020 2020 2020 3a70 6172  ge..        :par
-0000ce70: 616d 2073 6b69 705f 6465 706c 6f79 6564  am skip_deployed
-0000ce80: 3a20 536b 6970 2074 6865 2062 7569 6c64  : Skip the build
-0000ce90: 2069 6620 7765 2061 6c72 6561 6479 2068   if we already h
-0000cea0: 6176 6520 616e 2069 6d61 6765 2066 6f72  ave an image for
-0000ceb0: 2074 6865 2066 756e 6374 696f 6e2e 0a20   the function.. 
-0000cec0: 2020 2020 2020 203a 7061 7261 6d20 6275         :param bu
-0000ced0: 696c 6465 725f 656e 763a 2020 204b 616e  ilder_env:   Kan
-0000cee0: 696b 6f20 6275 696c 6465 7220 706f 6420  iko builder pod 
-0000cef0: 656e 7620 7661 7273 2064 6963 7420 2866  env vars dict (f
-0000cf00: 6f72 2063 6f6e 6669 672f 6372 6564 656e  or config/creden
-0000cf10: 7469 616c 7329 0a20 2020 2020 2020 2022  tials).        "
-0000cf20: 2222 0a0a 2020 2020 2020 2020 7472 793a  ""..        try:
-0000cf30: 0a20 2020 2020 2020 2020 2020 2072 6571  .            req
-0000cf40: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0000cf50: 2020 2020 2022 6675 6e63 7469 6f6e 223a       "function":
-0000cf60: 2066 756e 632e 746f 5f64 6963 7428 292c   func.to_dict(),
-0000cf70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cf80: 2022 7769 7468 5f6d 6c72 756e 223a 2062   "with_mlrun": b
-0000cf90: 6f6f 6c32 7374 7228 7769 7468 5f6d 6c72  ool2str(with_mlr
-0000cfa0: 756e 292c 0a20 2020 2020 2020 2020 2020  un),.           
-0000cfb0: 2020 2020 2022 736b 6970 5f64 6570 6c6f       "skip_deplo
-0000cfc0: 7965 6422 3a20 736b 6970 5f64 6570 6c6f  yed": skip_deplo
-0000cfd0: 7965 642c 0a20 2020 2020 2020 2020 2020  yed,.           
-0000cfe0: 207d 0a20 2020 2020 2020 2020 2020 2069   }.            i
-0000cff0: 6620 6d6c 7275 6e5f 7665 7273 696f 6e5f  f mlrun_version_
-0000d000: 7370 6563 6966 6965 723a 0a20 2020 2020  specifier:.     
-0000d010: 2020 2020 2020 2020 2020 2072 6571 5b22             req["
-0000d020: 6d6c 7275 6e5f 7665 7273 696f 6e5f 7370  mlrun_version_sp
-0000d030: 6563 6966 6965 7222 5d20 3d20 6d6c 7275  ecifier"] = mlru
-0000d040: 6e5f 7665 7273 696f 6e5f 7370 6563 6966  n_version_specif
-0000d050: 6965 720a 2020 2020 2020 2020 2020 2020  ier.            
-0000d060: 6966 2062 7569 6c64 6572 5f65 6e76 3a0a  if builder_env:.
-0000d070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d080: 7265 715b 2262 7569 6c64 6572 5f65 6e76  req["builder_env
-0000d090: 225d 203d 2062 7569 6c64 6572 5f65 6e76  "] = builder_env
-0000d0a0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-0000d0b0: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
-0000d0c0: 6c28 2250 4f53 5422 2c20 2262 7569 6c64  l("POST", "build
-0000d0d0: 2f66 756e 6374 696f 6e22 2c20 6a73 6f6e  /function", json
-0000d0e0: 3d72 6571 290a 2020 2020 2020 2020 6578  =req).        ex
-0000d0f0: 6365 7074 204f 5345 7272 6f72 2061 7320  cept OSError as 
-0000d100: 6572 723a 0a20 2020 2020 2020 2020 2020  err:.           
-0000d110: 206c 6f67 6765 722e 6572 726f 7228 6622   logger.error(f"
-0000d120: 6572 726f 7220 7375 626d 6974 7469 6e67  error submitting
-0000d130: 2062 7569 6c64 2074 6173 6b3a 207b 6572   build task: {er
-0000d140: 725f 746f 5f73 7472 2865 7272 297d 2229  r_to_str(err)}")
-0000d150: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000d160: 7365 204f 5345 7272 6f72 2866 2265 7272  se OSError(f"err
-0000d170: 6f72 3a20 6361 6e6e 6f74 2073 7562 6d69  or: cannot submi
-0000d180: 7420 6275 696c 642c 207b 6572 725f 746f  t build, {err_to
-0000d190: 5f73 7472 2865 7272 297d 2229 0a0a 2020  _str(err)}")..  
-0000d1a0: 2020 2020 2020 6966 206e 6f74 2072 6573        if not res
-0000d1b0: 702e 6f6b 3a0a 2020 2020 2020 2020 2020  p.ok:.          
-0000d1c0: 2020 6c6f 6767 6572 2e65 7272 6f72 2866    logger.error(f
-0000d1d0: 2262 6164 2072 6573 7021 215c 6e7b 7265  "bad resp!!\n{re
-0000d1e0: 7370 2e74 6578 747d 2229 0a20 2020 2020  sp.text}").     
-0000d1f0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0000d200: 7565 4572 726f 7228 2262 6164 2066 756e  ueError("bad fun
-0000d210: 6374 696f 6e20 7275 6e20 7265 7370 6f6e  ction run respon
-0000d220: 7365 2229 0a0a 2020 2020 2020 2020 7265  se")..        re
-0000d230: 7475 726e 2072 6573 702e 6a73 6f6e 2829  turn resp.json()
-0000d240: 0a0a 2020 2020 6465 6620 6765 745f 6275  ..    def get_bu
-0000d250: 696c 6465 725f 7374 6174 7573 280a 2020  ilder_status(.  
-0000d260: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0000d270: 2020 2020 6675 6e63 3a20 4261 7365 5275      func: BaseRu
-0000d280: 6e74 696d 652c 0a20 2020 2020 2020 206f  ntime,.        o
-0000d290: 6666 7365 743a 2069 6e74 203d 2030 2c0a  ffset: int = 0,.
-0000d2a0: 2020 2020 2020 2020 6c6f 6773 3a20 626f          logs: bo
-0000d2b0: 6f6c 203d 2054 7275 652c 0a20 2020 2020  ol = True,.     
-0000d2c0: 2020 206c 6173 745f 6c6f 675f 7469 6d65     last_log_time
-0000d2d0: 7374 616d 703a 2066 6c6f 6174 203d 2030  stamp: float = 0
-0000d2e0: 2e30 2c0a 2020 2020 2020 2020 7665 7262  .0,.        verb
-0000d2f0: 6f73 653a 2062 6f6f 6c20 3d20 4661 6c73  ose: bool = Fals
-0000d300: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-0000d310: 2020 2222 2252 6574 7269 6576 6520 7468    """Retrieve th
-0000d320: 6520 7374 6174 7573 206f 6620 6120 6275  e status of a bu
-0000d330: 696c 6420 6f70 6572 6174 696f 6e20 6375  ild operation cu
-0000d340: 7272 656e 746c 7920 696e 2070 726f 6772  rrently in progr
-0000d350: 6573 732e 0a0a 2020 2020 2020 2020 3a70  ess...        :p
-0000d360: 6172 616d 2066 756e 633a 2020 2020 2020  aram func:      
-0000d370: 2020 2020 2020 2020 2020 4675 6e63 7469            Functi
-0000d380: 6f6e 206f 626a 6563 7420 7468 6174 2069  on object that i
-0000d390: 7320 6265 696e 6720 6275 696c 742e 0a20  s being built.. 
-0000d3a0: 2020 2020 2020 203a 7061 7261 6d20 6f66         :param of
-0000d3b0: 6673 6574 3a20 2020 2020 2020 2020 2020  fset:           
-0000d3c0: 2020 204f 6666 7365 7420 696e 746f 2074     Offset into t
-0000d3d0: 6865 2062 7569 6c64 206c 6f67 7320 746f  he build logs to
-0000d3e0: 2072 6574 7269 6576 6520 6c6f 6773 2066   retrieve logs f
-0000d3f0: 726f 6d2e 0a20 2020 2020 2020 203a 7061  rom..        :pa
-0000d400: 7261 6d20 6c6f 6773 3a20 2020 2020 2020  ram logs:       
-0000d410: 2020 2020 2020 2020 2053 686f 756c 6420           Should 
-0000d420: 6275 696c 6420 6c6f 6773 2062 6520 7265  build logs be re
-0000d430: 7472 6965 7665 642e 0a20 2020 2020 2020  trieved..       
-0000d440: 203a 7061 7261 6d20 6c61 7374 5f6c 6f67   :param last_log
-0000d450: 5f74 696d 6573 7461 6d70 3a20 204c 6173  _timestamp:  Las
-0000d460: 7420 7469 6d65 7374 616d 7020 6f66 206c  t timestamp of l
-0000d470: 6f67 7320 7468 6174 2077 6572 6520 616c  ogs that were al
-0000d480: 7265 6164 7920 7265 7472 6965 7665 642e  ready retrieved.
-0000d490: 2046 756e 6374 696f 6e20 7769 6c6c 2072   Function will r
-0000d4a0: 6574 7572 6e20 6f6e 6c79 206c 6f67 730a  eturn only logs.
-0000d4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d4d0: 2020 2020 6c61 7465 7220 7468 616e 2074      later than t
-0000d4e0: 6869 7320 7061 7261 6d65 7465 722e 0a20  his parameter.. 
-0000d4f0: 2020 2020 2020 203a 7061 7261 6d20 7665         :param ve
-0000d500: 7262 6f73 653a 2020 2020 2020 2020 2020  rbose:          
-0000d510: 2020 2041 6464 2076 6572 626f 7365 206c     Add verbose l
-0000d520: 6f67 7320 696e 746f 2074 6865 206f 7574  ogs into the out
-0000d530: 7075 742e 0a0a 2020 2020 2020 2020 3a72  put...        :r
-0000d540: 6574 7572 6e73 3a20 5468 6520 666f 6c6c  eturns: The foll
-0000d550: 6f77 696e 6720 7061 7261 6d65 7465 7273  owing parameters
-0000d560: 3a0a 0a20 2020 2020 2020 2020 2020 202d  :..            -
-0000d570: 2054 6578 7420 6f66 2062 7569 6c64 6572   Text of builder
-0000d580: 206c 6f67 732e 0a20 2020 2020 2020 2020   logs..         
-0000d590: 2020 202d 2054 696d 6573 7461 6d70 206f     - Timestamp o
-0000d5a0: 6620 6c61 7374 206c 6f67 2072 6574 7269  f last log retri
-0000d5b0: 6576 6564 2c20 746f 2062 6520 7573 6564  eved, to be used
-0000d5c0: 2069 6e20 7375 6273 6571 7565 6e74 2063   in subsequent c
-0000d5d0: 616c 6c73 2074 6f20 7468 6973 2066 756e  alls to this fun
-0000d5e0: 6374 696f 6e2e 0a0a 2020 2020 2020 2020  ction...        
-0000d5f0: 2020 2020 5468 6520 6675 6e63 7469 6f6e      The function
-0000d600: 2061 6c73 6f20 7570 6461 7465 7320 696e   also updates in
-0000d610: 7465 726e 616c 206d 656d 6265 7273 206f  ternal members o
-0000d620: 6620 7468 6520 6060 6675 6e63 6060 206f  f the ``func`` o
-0000d630: 626a 6563 7420 746f 2072 6566 6c65 6374  bject to reflect
-0000d640: 2062 7569 6c64 2070 726f 6365 7373 2069   build process i
-0000d650: 6e66 6f2e 0a20 2020 2020 2020 2022 2222  nfo..        """
-0000d660: 0a0a 2020 2020 2020 2020 7472 793a 0a20  ..        try:. 
-0000d670: 2020 2020 2020 2020 2020 2070 6172 616d             param
-0000d680: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-0000d690: 2020 2020 2020 226e 616d 6522 3a20 6e6f        "name": no
-0000d6a0: 726d 616c 697a 655f 6e61 6d65 2866 756e  rmalize_name(fun
-0000d6b0: 632e 6d65 7461 6461 7461 2e6e 616d 6529  c.metadata.name)
-0000d6c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000d6d0: 2020 2270 726f 6a65 6374 223a 2066 756e    "project": fun
-0000d6e0: 632e 6d65 7461 6461 7461 2e70 726f 6a65  c.metadata.proje
-0000d6f0: 6374 2c0a 2020 2020 2020 2020 2020 2020  ct,.            
-0000d700: 2020 2020 2274 6167 223a 2066 756e 632e      "tag": func.
-0000d710: 6d65 7461 6461 7461 2e74 6167 2c0a 2020  metadata.tag,.  
-0000d720: 2020 2020 2020 2020 2020 2020 2020 226c                "l
-0000d730: 6f67 7322 3a20 626f 6f6c 3273 7472 286c  ogs": bool2str(l
-0000d740: 6f67 7329 2c0a 2020 2020 2020 2020 2020  ogs),.          
-0000d750: 2020 2020 2020 226f 6666 7365 7422 3a20        "offset": 
-0000d760: 7374 7228 6f66 6673 6574 292c 0a20 2020  str(offset),.   
-0000d770: 2020 2020 2020 2020 2020 2020 2022 6c61               "la
-0000d780: 7374 5f6c 6f67 5f74 696d 6573 7461 6d70  st_log_timestamp
-0000d790: 223a 2073 7472 286c 6173 745f 6c6f 675f  ": str(last_log_
-0000d7a0: 7469 6d65 7374 616d 7029 2c0a 2020 2020  timestamp),.    
-0000d7b0: 2020 2020 2020 2020 2020 2020 2276 6572              "ver
-0000d7c0: 626f 7365 223a 2062 6f6f 6c32 7374 7228  bose": bool2str(
-0000d7d0: 7665 7262 6f73 6529 2c0a 2020 2020 2020  verbose),.      
-0000d7e0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-0000d7f0: 2020 2020 7265 7370 203d 2073 656c 662e      resp = self.
-0000d800: 6170 695f 6361 6c6c 2822 4745 5422 2c20  api_call("GET", 
-0000d810: 2262 7569 6c64 2f73 7461 7475 7322 2c20  "build/status", 
-0000d820: 7061 7261 6d73 3d70 6172 616d 7329 0a20  params=params). 
-0000d830: 2020 2020 2020 2065 7863 6570 7420 4f53         except OS
-0000d840: 4572 726f 7220 6173 2065 7272 3a0a 2020  Error as err:.  
-0000d850: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
-0000d860: 2e65 7272 6f72 2866 2265 7272 6f72 2067  .error(f"error g
-0000d870: 6574 7469 6e67 2062 7569 6c64 2073 7461  etting build sta
-0000d880: 7475 733a 207b 6572 725f 746f 5f73 7472  tus: {err_to_str
-0000d890: 2865 7272 297d 2229 0a20 2020 2020 2020  (err)}").       
-0000d8a0: 2020 2020 2072 6169 7365 204f 5345 7272       raise OSErr
-0000d8b0: 6f72 2866 2265 7272 6f72 3a20 6361 6e6e  or(f"error: cann
-0000d8c0: 6f74 2067 6574 2062 7569 6c64 2073 7461  ot get build sta
-0000d8d0: 7475 732c 207b 6572 725f 746f 5f73 7472  tus, {err_to_str
-0000d8e0: 2865 7272 297d 2229 0a0a 2020 2020 2020  (err)}")..      
-0000d8f0: 2020 6966 206e 6f74 2072 6573 702e 6f6b    if not resp.ok
-0000d900: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
-0000d910: 6767 6572 2e77 6172 6e69 6e67 2866 2266  gger.warning(f"f
-0000d920: 6169 6c65 6420 7265 7370 2c20 7b72 6573  ailed resp, {res
-0000d930: 702e 7465 7874 7d22 290a 2020 2020 2020  p.text}").      
-0000d940: 2020 2020 2020 7261 6973 6520 5275 6e44        raise RunD
-0000d950: 4245 7272 6f72 2822 6261 6420 6675 6e63  BError("bad func
-0000d960: 7469 6f6e 2062 7569 6c64 2072 6573 706f  tion build respo
-0000d970: 6e73 6522 290a 0a20 2020 2020 2020 2069  nse")..        i
-0000d980: 6620 7265 7370 2e68 6561 6465 7273 3a0a  f resp.headers:.
-0000d990: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-0000d9a0: 2e73 7461 7475 732e 7374 6174 6520 3d20  .status.state = 
-0000d9b0: 7265 7370 2e68 6561 6465 7273 2e67 6574  resp.headers.get
-0000d9c0: 2822 782d 6d6c 7275 6e2d 6675 6e63 7469  ("x-mlrun-functi
-0000d9d0: 6f6e 2d73 7461 7475 7322 2c20 2222 290a  on-status", "").
-0000d9e0: 2020 2020 2020 2020 2020 2020 6c61 7374              last
-0000d9f0: 5f6c 6f67 5f74 696d 6573 7461 6d70 203d  _log_timestamp =
-0000da00: 2066 6c6f 6174 280a 2020 2020 2020 2020   float(.        
-0000da10: 2020 2020 2020 2020 7265 7370 2e68 6561          resp.hea
-0000da20: 6465 7273 2e67 6574 2822 782d 6d6c 7275  ders.get("x-mlru
-0000da30: 6e2d 6c61 7374 2d74 696d 6573 7461 6d70  n-last-timestamp
-0000da40: 222c 2022 302e 3022 290a 2020 2020 2020  ", "0.0").      
-0000da50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000da60: 2020 2020 6966 2066 756e 632e 6b69 6e64      if func.kind
-0000da70: 2069 6e20 6d6c 7275 6e2e 7275 6e74 696d   in mlrun.runtim
-0000da80: 6573 2e52 756e 7469 6d65 4b69 6e64 732e  es.RuntimeKinds.
-0000da90: 6e75 636c 696f 5f72 756e 7469 6d65 7328  nuclio_runtimes(
-0000daa0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0000dab0: 2020 2066 756e 632e 7374 6174 7573 2e61     func.status.a
-0000dac0: 6464 7265 7373 203d 2072 6573 702e 6865  ddress = resp.he
-0000dad0: 6164 6572 732e 6765 7428 2278 2d6d 6c72  aders.get("x-mlr
-0000dae0: 756e 2d61 6464 7265 7373 222c 2022 2229  un-address", "")
-0000daf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000db00: 2066 756e 632e 7374 6174 7573 2e6e 7563   func.status.nuc
-0000db10: 6c69 6f5f 6e61 6d65 203d 2072 6573 702e  lio_name = resp.
-0000db20: 6865 6164 6572 732e 6765 7428 2278 2d6d  headers.get("x-m
-0000db30: 6c72 756e 2d6e 616d 6522 2c20 2222 290a  lrun-name", "").
+00002b80: 2020 2065 7272 6f72 5f64 6574 6169 6c73     error_details
+00002b90: 203d 2022 220a 2020 2020 2020 2020 2020   = "".          
+00002ba0: 2020 2020 2020 6966 2065 7272 6f72 5f64        if error_d
+00002bb0: 6574 6169 6c73 3a0a 2020 2020 2020 2020  etails:.        
+00002bc0: 2020 2020 2020 2020 2020 2020 6572 726f              erro
+00002bd0: 725f 6465 7461 696c 7320 3d20 6622 6465  r_details = f"de
+00002be0: 7461 696c 733a 207b 6572 726f 725f 6465  tails: {error_de
+00002bf0: 7461 696c 737d 220a 2020 2020 2020 2020  tails}".        
+00002c00: 2020 2020 2020 2020 2020 2020 6572 726f              erro
+00002c10: 7220 3d20 6622 7b65 7272 6f72 7d20 7b65  r = f"{error} {e
+00002c20: 7272 6f72 5f64 6574 6169 6c73 7d22 2069  rror_details}" i
+00002c30: 6620 6572 726f 7220 656c 7365 2065 7272  f error else err
+00002c40: 6f72 5f64 6574 6169 6c73 0a20 2020 2020  or_details.     
+00002c50: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00002c60: 6c72 756e 2e65 7272 6f72 732e 7261 6973  lrun.errors.rais
+00002c70: 655f 666f 725f 7374 6174 7573 2872 6573  e_for_status(res
+00002c80: 706f 6e73 652c 2065 7272 6f72 290a 0a20  ponse, error).. 
+00002c90: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
+00002ca0: 2e65 7272 6f72 732e 7261 6973 655f 666f  .errors.raise_fo
+00002cb0: 725f 7374 6174 7573 2872 6573 706f 6e73  r_status(respons
+00002cc0: 652c 2065 7272 6f72 290a 0a20 2020 2020  e, error)..     
+00002cd0: 2020 2072 6574 7572 6e20 7265 7370 6f6e     return respon
+00002ce0: 7365 0a0a 2020 2020 6465 6620 5f69 6e69  se..    def _ini
+00002cf0: 745f 7365 7373 696f 6e28 7365 6c66 2c20  t_session(self, 
+00002d00: 7265 7472 795f 6f6e 5f70 6f73 743a 2062  retry_on_post: b
+00002d10: 6f6f 6c20 3d20 4661 6c73 6529 3a0a 2020  ool = False):.  
+00002d20: 2020 2020 2020 7265 7475 726e 206d 6c72        return mlr
+00002d30: 756e 2e75 7469 6c73 2e48 5454 5053 6573  un.utils.HTTPSes
+00002d40: 7369 6f6e 5769 7468 5265 7472 7928 0a20  sionWithRetry(. 
+00002d50: 2020 2020 2020 2020 2020 2072 6574 7279             retry
+00002d60: 5f6f 6e5f 6578 6365 7074 696f 6e3d 636f  _on_exception=co
+00002d70: 6e66 6967 2e68 7474 7064 622e 7265 7472  nfig.httpdb.retr
+00002d80: 795f 6170 695f 6361 6c6c 5f6f 6e5f 6578  y_api_call_on_ex
+00002d90: 6365 7074 696f 6e0a 2020 2020 2020 2020  ception.        
+00002da0: 2020 2020 3d3d 206d 6c72 756e 2e63 6f6d      == mlrun.com
+00002db0: 6d6f 6e2e 7363 6865 6d61 732e 4854 5450  mon.schemas.HTTP
+00002dc0: 5365 7373 696f 6e52 6574 7279 4d6f 6465  SessionRetryMode
+00002dd0: 2e65 6e61 626c 6564 2e76 616c 7565 2c0a  .enabled.value,.
+00002de0: 2020 2020 2020 2020 2020 2020 7265 7472              retr
+00002df0: 795f 6f6e 5f70 6f73 743d 7265 7472 795f  y_on_post=retry_
+00002e00: 6f6e 5f70 6f73 742c 0a20 2020 2020 2020  on_post,.       
+00002e10: 2029 0a0a 2020 2020 6465 6620 5f70 6174   )..    def _pat
+00002e20: 685f 6f66 2873 656c 662c 2070 7265 6669  h_of(self, prefi
+00002e30: 782c 2070 726f 6a65 6374 2c20 7569 6429  x, project, uid)
+00002e40: 3a0a 2020 2020 2020 2020 7072 6f6a 6563  :.        projec
+00002e50: 7420 3d20 7072 6f6a 6563 7420 6f72 2063  t = project or c
+00002e60: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
+00002e70: 6f6a 6563 740a 2020 2020 2020 2020 7265  oject.        re
+00002e80: 7475 726e 2066 227b 7072 6566 6978 7d2f  turn f"{prefix}/
+00002e90: 7b70 726f 6a65 6374 7d2f 7b75 6964 7d22  {project}/{uid}"
+00002ea0: 0a0a 2020 2020 6465 6620 5f69 735f 7265  ..    def _is_re
+00002eb0: 7472 795f 6f6e 5f70 6f73 745f 616c 6c6f  try_on_post_allo
+00002ec0: 7765 6428 7365 6c66 2c20 6d65 7468 6f64  wed(self, method
+00002ed0: 2c20 7061 7468 3a20 7374 7229 3a0a 2020  , path: str):.  
+00002ee0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00002ef0: 2020 4368 6563 6b20 6966 2074 6865 2067    Check if the g
+00002f00: 6976 656e 2070 6174 6820 6973 2061 6c6c  iven path is all
+00002f10: 6f77 6564 2074 6f20 6265 2072 6574 7269  owed to be retri
+00002f20: 6564 206f 6e20 504f 5354 206d 6574 686f  ed on POST metho
+00002f30: 640a 2020 2020 2020 2020 3a70 6172 616d  d.        :param
+00002f40: 206d 6574 686f 643a 2020 7573 6564 2074   method:  used t
+00002f50: 6f20 7665 7269 6679 2074 6861 7420 7468  o verify that th
+00002f60: 6520 6d65 7468 6f64 2069 7320 504f 5354  e method is POST
+00002f70: 2073 696e 6365 2069 6620 7468 6572 6520   since if there 
+00002f80: 6973 206e 6f20 7365 7373 696f 6e20 696e  is no session in
+00002f90: 6974 6961 6c69 7a65 6420 7468 6572 6520  itialized there 
+00002fa0: 6973 206e 6f0a 2020 2020 2020 2020 2020  is no.          
+00002fb0: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+00002fc0: 6564 2074 6f20 696e 6974 6961 6c69 7a65  ed to initialize
+00002fd0: 2069 7420 7769 7468 2072 6574 7279 2070   it with retry p
+00002fe0: 6f6c 6963 7920 666f 7220 504f 5354 2077  olicy for POST w
+00002ff0: 6865 6e20 7468 6520 6d65 7468 6f64 2069  hen the method i
+00003000: 7320 6e6f 7420 504f 5354 0a20 2020 2020  s not POST.     
+00003010: 2020 203a 7061 7261 6d20 7061 7468 3a20     :param path: 
+00003020: 2020 2074 6865 2070 6174 6820 746f 2063     the path to c
+00003030: 6865 636b 0a20 2020 2020 2020 203a 7265  heck.        :re
+00003040: 7475 726e 3a20 2020 2020 2020 2054 7275  turn:        Tru
+00003050: 6520 6966 2074 6865 2070 6174 6820 6973  e if the path is
+00003060: 2061 6c6c 6f77 6564 2074 6f20 6265 2072   allowed to be r
+00003070: 6574 7269 6564 206f 6e20 504f 5354 206d  etried on POST m
+00003080: 6574 686f 6420 616e 6420 6d65 7468 6f64  ethod and method
+00003090: 2069 7320 504f 5354 2c20 4661 6c73 6520   is POST, False 
+000030a0: 6f74 6865 7277 6973 650a 2020 2020 2020  otherwise.      
+000030b0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+000030c0: 7475 726e 206d 6574 686f 6420 3d3d 2022  turn method == "
+000030d0: 504f 5354 2220 616e 6420 616e 7928 0a20  POST" and any(. 
+000030e0: 2020 2020 2020 2020 2020 2072 652e 6d61             re.ma
+000030f0: 7463 6828 7265 6765 782c 2070 6174 6829  tch(regex, path)
+00003100: 2066 6f72 2072 6567 6578 2069 6e20 7365   for regex in se
+00003110: 6c66 2e52 4554 5249 4142 4c45 5f50 4f53  lf.RETRIABLE_POS
+00003120: 545f 5041 5448 530a 2020 2020 2020 2020  T_PATHS.        
+00003130: 290a 0a20 2020 2064 6566 2063 6f6e 6e65  )..    def conne
+00003140: 6374 2873 656c 662c 2073 6563 7265 7473  ct(self, secrets
+00003150: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00003160: 2222 2243 6f6e 6e65 6374 2074 6f20 7468  """Connect to th
+00003170: 6520 4d4c 5275 6e20 4150 4920 7365 7276  e MLRun API serv
+00003180: 6572 2e20 4d75 7374 2062 6520 6361 6c6c  er. Must be call
+00003190: 6564 2070 7269 6f72 2074 6f20 6578 6563  ed prior to exec
+000031a0: 7574 696e 6720 616e 7920 6f74 6865 7220  uting any other 
+000031b0: 6d65 7468 6f64 2e0a 2020 2020 2020 2020  method..        
+000031c0: 5468 6520 636f 6465 2075 7469 6c69 7a65  The code utilize
+000031d0: 7320 7468 6520 5552 4c20 666f 7220 7468  s the URL for th
+000031e0: 6520 4150 4920 7365 7276 6572 2066 726f  e API server fro
+000031f0: 6d20 7468 6520 636f 6e66 6967 7572 6174  m the configurat
+00003200: 696f 6e20 2d20 6060 6d6c 636f 6e66 2e64  ion - ``mlconf.d
+00003210: 6270 6174 6860 602e 0a0a 2020 2020 2020  bpath``...      
+00003220: 2020 466f 7220 6578 616d 706c 653a 3a0a    For example::.
+00003230: 0a20 2020 2020 2020 2020 2020 206d 6c63  .            mlc
+00003240: 6f6e 662e 6462 7061 7468 203d 206d 6c63  onf.dbpath = mlc
+00003250: 6f6e 662e 6462 7061 7468 206f 7220 2768  onf.dbpath or 'h
+00003260: 7474 703a 2f2f 6d6c 7275 6e2d 6170 693a  ttp://mlrun-api:
+00003270: 3830 3830 270a 2020 2020 2020 2020 2020  8080'.          
+00003280: 2020 6462 203d 2067 6574 5f72 756e 5f64    db = get_run_d
+00003290: 6228 292e 636f 6e6e 6563 7428 290a 2020  b().connect().  
+000032a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000032b0: 2020 2320 6861 636b 2074 6f20 616c 6c6f    # hack to allo
+000032c0: 7720 756e 6974 2074 6573 7473 2074 6f20  w unit tests to 
+000032d0: 696e 7374 616e 7469 6174 6520 4854 5450  instantiate HTTP
+000032e0: 5275 6e44 4220 7769 7468 6f75 7420 6120  RunDB without a 
+000032f0: 7265 616c 2073 6572 7665 7220 6265 6869  real server behi
+00003300: 6e64 0a20 2020 2020 2020 2069 6620 226d  nd.        if "m
+00003310: 6f63 6b2d 7365 7276 6572 2220 696e 2073  ock-server" in s
+00003320: 656c 662e 6261 7365 5f75 726c 3a0a 2020  elf.base_url:.  
+00003330: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00003340: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
+00003350: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
+00003360: 4554 222c 2022 636c 6965 6e74 2d73 7065  ET", "client-spe
+00003370: 6322 2c20 7469 6d65 6f75 743d 3529 0a20  c", timeout=5). 
+00003380: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00003390: 2020 2020 2020 2020 7365 7276 6572 5f63          server_c
+000033a0: 6667 203d 2072 6573 702e 6a73 6f6e 2829  fg = resp.json()
+000033b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000033c0: 662e 7365 7276 6572 5f76 6572 7369 6f6e  f.server_version
+000033d0: 203d 2073 6572 7665 725f 6366 675b 2276   = server_cfg["v
+000033e0: 6572 7369 6f6e 225d 0a20 2020 2020 2020  ersion"].       
+000033f0: 2020 2020 2073 656c 662e 5f76 616c 6964       self._valid
+00003400: 6174 655f 7665 7273 696f 6e5f 636f 6d70  ate_version_comp
+00003410: 6174 6962 696c 6974 7928 7365 6c66 2e73  atibility(self.s
+00003420: 6572 7665 725f 7665 7273 696f 6e2c 2063  erver_version, c
+00003430: 6f6e 6669 672e 7665 7273 696f 6e29 0a20  onfig.version). 
+00003440: 2020 2020 2020 2020 2020 2063 6f6e 6669             confi
+00003450: 672e 6e61 6d65 7370 6163 6520 3d20 636f  g.namespace = co
+00003460: 6e66 6967 2e6e 616d 6573 7061 6365 206f  nfig.namespace o
+00003470: 7220 7365 7276 6572 5f63 6667 2e67 6574  r server_cfg.get
+00003480: 2822 6e61 6d65 7370 6163 6522 290a 2020  ("namespace").  
+00003490: 2020 2020 2020 2020 2020 6966 2028 0a20            if (. 
+000034a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000034b0: 6e61 6d65 7370 6163 6522 2069 6e20 7365  namespace" in se
+000034c0: 7276 6572 5f63 6667 0a20 2020 2020 2020  rver_cfg.       
+000034d0: 2020 2020 2020 2020 2061 6e64 2073 6572           and ser
+000034e0: 7665 725f 6366 675b 226e 616d 6573 7061  ver_cfg["namespa
+000034f0: 6365 225d 2021 3d20 636f 6e66 6967 2e6e  ce"] != config.n
+00003500: 616d 6573 7061 6365 0a20 2020 2020 2020  amespace.       
+00003510: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+00003520: 2020 2020 2020 2020 6c6f 6767 6572 2e77          logger.w
+00003530: 6172 6e69 6e67 280a 2020 2020 2020 2020  arning(.        
+00003540: 2020 2020 2020 2020 2020 2020 6622 7761              f"wa
+00003550: 726e 696e 6721 2c20 7365 7276 6572 2028  rning!, server (
+00003560: 7b73 6572 7665 725f 6366 675b 276e 616d  {server_cfg['nam
+00003570: 6573 7061 6365 275d 7d29 2061 6e64 2063  espace']}) and c
+00003580: 6c69 656e 7420 287b 636f 6e66 6967 2e6e  lient ({config.n
+00003590: 616d 6573 7061 6365 7d29 220a 2020 2020  amespace})".    
+000035a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000035b0: 2220 6e61 6d65 7370 6163 6520 646f 6e27  " namespace don'
+000035c0: 7420 6d61 7463 6822 0a20 2020 2020 2020  t match".       
+000035d0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000035e0: 2020 2020 2020 2069 6620 636f 6e66 6967         if config
+000035f0: 2e63 652e 6d6f 6465 2061 6e64 2063 6f6e  .ce.mode and con
+00003600: 6669 672e 6365 2e6d 6f64 6520 213d 2073  fig.ce.mode != s
+00003610: 6572 7665 725f 6366 672e 6765 7428 2263  erver_cfg.get("c
+00003620: 655f 6d6f 6465 222c 2022 2229 3a0a 2020  e_mode", ""):.  
+00003630: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+00003640: 6767 6572 2e77 6172 6e69 6e67 280a 2020  gger.warning(.  
+00003650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003660: 2020 6622 7761 726e 696e 6721 2c20 7365    f"warning!, se
+00003670: 7276 6572 2028 7b73 6572 7665 725f 6366  rver ({server_cf
+00003680: 675b 2763 655f 6d6f 6465 275d 7d29 2061  g['ce_mode']}) a
+00003690: 6e64 2063 6c69 656e 7420 287b 636f 6e66  nd client ({conf
+000036a0: 6967 2e63 652e 6d6f 6465 7d29 220a 2020  ig.ce.mode})".  
+000036b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000036c0: 2020 2220 4345 206d 6f64 6520 646f 6e27    " CE mode don'
+000036d0: 7420 6d61 7463 6822 0a20 2020 2020 2020  t match".       
+000036e0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000036f0: 2020 2020 2020 2063 6f6e 6669 672e 6365         config.ce
+00003700: 203d 2073 6572 7665 725f 6366 672e 6765   = server_cfg.ge
+00003710: 7428 2263 6522 2920 6f72 2063 6f6e 6669  t("ce") or confi
+00003720: 672e 6365 0a0a 2020 2020 2020 2020 2020  g.ce..          
+00003730: 2020 2320 6765 7420 6465 6661 756c 7473    # get defaults
+00003740: 2066 726f 6d20 7265 6d6f 7465 2073 6572   from remote ser
+00003750: 7665 720a 2020 2020 2020 2020 2020 2020  ver.            
+00003760: 636f 6e66 6967 2e72 656d 6f74 655f 686f  config.remote_ho
+00003770: 7374 203d 2063 6f6e 6669 672e 7265 6d6f  st = config.remo
+00003780: 7465 5f68 6f73 7420 6f72 2073 6572 7665  te_host or serve
+00003790: 725f 6366 672e 6765 7428 2272 656d 6f74  r_cfg.get("remot
+000037a0: 655f 686f 7374 2229 0a20 2020 2020 2020  e_host").       
+000037b0: 2020 2020 2063 6f6e 6669 672e 6d70 696a       config.mpij
+000037c0: 6f62 5f63 7264 5f76 6572 7369 6f6e 203d  ob_crd_version =
+000037d0: 2063 6f6e 6669 672e 6d70 696a 6f62 5f63   config.mpijob_c
+000037e0: 7264 5f76 6572 7369 6f6e 206f 7220 7365  rd_version or se
+000037f0: 7276 6572 5f63 6667 2e67 6574 280a 2020  rver_cfg.get(.  
+00003800: 2020 2020 2020 2020 2020 2020 2020 226d                "m
+00003810: 7069 6a6f 625f 6372 645f 7665 7273 696f  pijob_crd_versio
+00003820: 6e22 0a20 2020 2020 2020 2020 2020 2029  n".            )
+00003830: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+00003840: 6669 672e 7569 2e75 726c 203d 2063 6f6e  fig.ui.url = con
+00003850: 6669 672e 7265 736f 6c76 655f 7569 5f75  fig.resolve_ui_u
+00003860: 726c 2829 206f 7220 7365 7276 6572 5f63  rl() or server_c
+00003870: 6667 2e67 6574 2822 7569 5f75 726c 2229  fg.get("ui_url")
+00003880: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+00003890: 6669 672e 6172 7469 6661 6374 5f70 6174  fig.artifact_pat
+000038a0: 6820 3d20 636f 6e66 6967 2e61 7274 6966  h = config.artif
+000038b0: 6163 745f 7061 7468 206f 7220 7365 7276  act_path or serv
+000038c0: 6572 5f63 6667 2e67 6574 280a 2020 2020  er_cfg.get(.    
+000038d0: 2020 2020 2020 2020 2020 2020 2261 7274              "art
+000038e0: 6966 6163 745f 7061 7468 220a 2020 2020  ifact_path".    
+000038f0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00003900: 2020 2020 2020 636f 6e66 6967 2e73 7061        config.spa
+00003910: 726b 5f61 7070 5f69 6d61 6765 203d 2063  rk_app_image = c
+00003920: 6f6e 6669 672e 7370 6172 6b5f 6170 705f  onfig.spark_app_
+00003930: 696d 6167 6520 6f72 2073 6572 7665 725f  image or server_
+00003940: 6366 672e 6765 7428 0a20 2020 2020 2020  cfg.get(.       
+00003950: 2020 2020 2020 2020 2022 7370 6172 6b5f           "spark_
+00003960: 6170 705f 696d 6167 6522 0a20 2020 2020  app_image".     
+00003970: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00003980: 2020 2020 2063 6f6e 6669 672e 7370 6172       config.spar
+00003990: 6b5f 6170 705f 696d 6167 655f 7461 6720  k_app_image_tag 
+000039a0: 3d20 636f 6e66 6967 2e73 7061 726b 5f61  = config.spark_a
+000039b0: 7070 5f69 6d61 6765 5f74 6167 206f 7220  pp_image_tag or 
+000039c0: 7365 7276 6572 5f63 6667 2e67 6574 280a  server_cfg.get(.
+000039d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000039e0: 2273 7061 726b 5f61 7070 5f69 6d61 6765  "spark_app_image
+000039f0: 5f74 6167 220a 2020 2020 2020 2020 2020  _tag".          
+00003a00: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00003a10: 636f 6e66 6967 2e73 7061 726b 5f68 6973  config.spark_his
+00003a20: 746f 7279 5f73 6572 7665 725f 7061 7468  tory_server_path
+00003a30: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00003a40: 2020 2020 2063 6f6e 6669 672e 7370 6172       config.spar
+00003a50: 6b5f 6869 7374 6f72 795f 7365 7276 6572  k_history_server
+00003a60: 5f70 6174 680a 2020 2020 2020 2020 2020  _path.          
+00003a70: 2020 2020 2020 6f72 2073 6572 7665 725f        or server_
+00003a80: 6366 672e 6765 7428 2273 7061 726b 5f68  cfg.get("spark_h
+00003a90: 6973 746f 7279 5f73 6572 7665 725f 7061  istory_server_pa
+00003aa0: 7468 2229 0a20 2020 2020 2020 2020 2020  th").           
+00003ab0: 2029 0a20 2020 2020 2020 2020 2020 2063   ).            c
+00003ac0: 6f6e 6669 672e 6874 7470 6462 2e62 7569  onfig.httpdb.bui
+00003ad0: 6c64 6572 2e64 6f63 6b65 725f 7265 6769  lder.docker_regi
+00003ae0: 7374 7279 203d 2028 0a20 2020 2020 2020  stry = (.       
+00003af0: 2020 2020 2020 2020 2063 6f6e 6669 672e           config.
+00003b00: 6874 7470 6462 2e62 7569 6c64 6572 2e64  httpdb.builder.d
+00003b10: 6f63 6b65 725f 7265 6769 7374 7279 0a20  ocker_registry. 
+00003b20: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00003b30: 7220 7365 7276 6572 5f63 6667 2e67 6574  r server_cfg.get
+00003b40: 2822 646f 636b 6572 5f72 6567 6973 7472  ("docker_registr
+00003b50: 7922 290a 2020 2020 2020 2020 2020 2020  y").            
+00003b60: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
+00003b70: 6e66 6967 2e68 7474 7064 622e 6170 695f  nfig.httpdb.api_
+00003b80: 7572 6c20 3d20 636f 6e66 6967 2e68 7474  url = config.htt
+00003b90: 7064 622e 6170 695f 7572 6c20 6f72 2073  pdb.api_url or s
+00003ba0: 6572 7665 725f 6366 672e 6765 7428 2261  erver_cfg.get("a
+00003bb0: 7069 5f75 726c 2229 0a20 2020 2020 2020  pi_url").       
+00003bc0: 2020 2020 2063 6f6e 6669 672e 6e75 636c       config.nucl
+00003bd0: 696f 5f76 6572 7369 6f6e 203d 2063 6f6e  io_version = con
+00003be0: 6669 672e 6e75 636c 696f 5f76 6572 7369  fig.nuclio_versi
+00003bf0: 6f6e 206f 7220 7365 7276 6572 5f63 6667  on or server_cfg
+00003c00: 2e67 6574 280a 2020 2020 2020 2020 2020  .get(.          
+00003c10: 2020 2020 2020 226e 7563 6c69 6f5f 7665        "nuclio_ve
+00003c20: 7273 696f 6e22 0a20 2020 2020 2020 2020  rsion".         
+00003c30: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00003c40: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
+00003c50: 6675 6e63 7469 6f6e 5f70 7269 6f72 6974  function_priorit
+00003c60: 795f 636c 6173 735f 6e61 6d65 203d 2028  y_class_name = (
+00003c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003c80: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
+00003c90: 6675 6e63 7469 6f6e 5f70 7269 6f72 6974  function_priorit
+00003ca0: 795f 636c 6173 735f 6e61 6d65 0a20 2020  y_class_name.   
+00003cb0: 2020 2020 2020 2020 2020 2020 206f 7220               or 
+00003cc0: 7365 7276 6572 5f63 6667 2e67 6574 2822  server_cfg.get("
+00003cd0: 6465 6661 756c 745f 6675 6e63 7469 6f6e  default_function
+00003ce0: 5f70 7269 6f72 6974 795f 636c 6173 735f  _priority_class_
+00003cf0: 6e61 6d65 2229 0a20 2020 2020 2020 2020  name").         
+00003d00: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00003d10: 2063 6f6e 6669 672e 7661 6c69 645f 6675   config.valid_fu
+00003d20: 6e63 7469 6f6e 5f70 7269 6f72 6974 795f  nction_priority_
+00003d30: 636c 6173 735f 6e61 6d65 7320 3d20 280a  class_names = (.
+00003d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003d50: 636f 6e66 6967 2e76 616c 6964 5f66 756e  config.valid_fun
+00003d60: 6374 696f 6e5f 7072 696f 7269 7479 5f63  ction_priority_c
+00003d70: 6c61 7373 5f6e 616d 6573 0a20 2020 2020  lass_names.     
+00003d80: 2020 2020 2020 2020 2020 206f 7220 7365             or se
+00003d90: 7276 6572 5f63 6667 2e67 6574 2822 7661  rver_cfg.get("va
+00003da0: 6c69 645f 6675 6e63 7469 6f6e 5f70 7269  lid_function_pri
+00003db0: 6f72 6974 795f 636c 6173 735f 6e61 6d65  ority_class_name
+00003dc0: 7322 290a 2020 2020 2020 2020 2020 2020  s").            
+00003dd0: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
+00003de0: 6e66 6967 2e61 7274 6966 6163 7473 2e63  nfig.artifacts.c
+00003df0: 616c 6375 6c61 7465 5f68 6173 6820 3d20  alculate_hash = 
+00003e00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00003e10: 2020 636f 6e66 6967 2e61 7274 6966 6163    config.artifac
+00003e20: 7473 2e63 616c 6375 6c61 7465 5f68 6173  ts.calculate_has
+00003e30: 680a 2020 2020 2020 2020 2020 2020 2020  h.              
+00003e40: 2020 6966 2063 6f6e 6669 672e 6172 7469    if config.arti
+00003e50: 6661 6374 732e 6361 6c63 756c 6174 655f  facts.calculate_
+00003e60: 6861 7368 2069 7320 6e6f 7420 4e6f 6e65  hash is not None
+00003e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003e80: 2065 6c73 6520 7365 7276 6572 5f63 6667   else server_cfg
+00003e90: 2e67 6574 2822 6361 6c63 756c 6174 655f  .get("calculate_
+00003ea0: 6172 7469 6661 6374 5f68 6173 6822 290a  artifact_hash").
+00003eb0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00003ec0: 2020 2020 2020 2020 2020 636f 6e66 6967            config
+00003ed0: 2e61 7274 6966 6163 7473 2e67 656e 6572  .artifacts.gener
+00003ee0: 6174 655f 7461 7267 6574 5f70 6174 685f  ate_target_path_
+00003ef0: 6672 6f6d 5f61 7274 6966 6163 745f 6861  from_artifact_ha
+00003f00: 7368 203d 2028 0a20 2020 2020 2020 2020  sh = (.         
+00003f10: 2020 2020 2020 2063 6f6e 6669 672e 6172         config.ar
+00003f20: 7469 6661 6374 732e 6765 6e65 7261 7465  tifacts.generate
+00003f30: 5f74 6172 6765 745f 7061 7468 5f66 726f  _target_path_fro
+00003f40: 6d5f 6172 7469 6661 6374 5f68 6173 680a  m_artifact_hash.
+00003f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003f60: 6966 2063 6f6e 6669 672e 6172 7469 6661  if config.artifa
+00003f70: 6374 732e 6765 6e65 7261 7465 5f74 6172  cts.generate_tar
+00003f80: 6765 745f 7061 7468 5f66 726f 6d5f 6172  get_path_from_ar
+00003f90: 7469 6661 6374 5f68 6173 6820 6973 206e  tifact_hash is n
+00003fa0: 6f74 204e 6f6e 650a 2020 2020 2020 2020  ot None.        
+00003fb0: 2020 2020 2020 2020 656c 7365 2073 6572          else ser
+00003fc0: 7665 725f 6366 672e 6765 7428 2267 656e  ver_cfg.get("gen
+00003fd0: 6572 6174 655f 6172 7469 6661 6374 5f74  erate_artifact_t
+00003fe0: 6172 6765 745f 7061 7468 5f66 726f 6d5f  arget_path_from_
+00003ff0: 6172 7469 6661 6374 5f68 6173 6822 290a  artifact_hash").
+00004000: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00004010: 2020 2020 2020 2020 2020 2063 6f6e 6669             confi
+00004020: 672e 7265 6469 732e 7572 6c20 3d20 636f  g.redis.url = co
+00004030: 6e66 6967 2e72 6564 6973 2e75 726c 206f  nfig.redis.url o
+00004040: 7220 7365 7276 6572 5f63 6667 2e67 6574  r server_cfg.get
+00004050: 2822 7265 6469 735f 7572 6c22 290a 2020  ("redis_url").  
+00004060: 2020 2020 2020 2020 2020 2320 616c 6c6f            # allo
+00004070: 7720 636c 6965 6e74 2074 6f20 7365 7420  w client to set 
+00004080: 7468 6520 6465 6661 756c 7420 7061 7274  the default part
+00004090: 6961 6c20 5741 2066 6f72 206c 6163 6b20  ial WA for lack 
+000040a0: 6f66 2073 7570 706f 7274 206f 6620 7065  of support of pe
+000040b0: 722d 7461 7267 6574 2061 7578 696c 6961  r-target auxilia
+000040c0: 7279 206f 7074 696f 6e73 0a20 2020 2020  ry options.     
+000040d0: 2020 2020 2020 2063 6f6e 6669 672e 7265         config.re
+000040e0: 6469 732e 7479 7065 203d 2063 6f6e 6669  dis.type = confi
+000040f0: 672e 7265 6469 732e 7479 7065 206f 7220  g.redis.type or 
+00004100: 7365 7276 6572 5f63 6667 2e67 6574 2822  server_cfg.get("
+00004110: 7265 6469 735f 7479 7065 2229 0a0a 2020  redis_type")..  
+00004120: 2020 2020 2020 2020 2020 636f 6e66 6967            config
+00004130: 2e73 716c 2e75 726c 203d 2063 6f6e 6669  .sql.url = confi
+00004140: 672e 7371 6c2e 7572 6c20 6f72 2073 6572  g.sql.url or ser
+00004150: 7665 725f 6366 672e 6765 7428 2273 716c  ver_cfg.get("sql
+00004160: 5f75 726c 2229 0a20 2020 2020 2020 2020  _url").         
+00004170: 2020 2023 2054 6865 7365 2068 6176 6520     # These have 
+00004180: 6120 6465 6661 756c 7420 7661 6c75 652c  a default value,
+00004190: 2074 6865 7265 666f 7265 206c 6f63 616c   therefore local
+000041a0: 2063 6f6e 6669 6720 7769 6c6c 2061 6c77   config will alw
+000041b0: 6179 7320 6861 7665 2061 2076 616c 7565  ays have a value
+000041c0: 2c20 7072 696f 7269 7469 7a65 2074 6865  , prioritize the
+000041d0: 0a20 2020 2020 2020 2020 2020 2023 2041  .            # A
+000041e0: 5049 2076 616c 7565 2066 6972 7374 0a20  PI value first. 
+000041f0: 2020 2020 2020 2020 2020 2063 6f6e 6669             confi
+00004200: 672e 7569 2e70 726f 6a65 6374 735f 7072  g.ui.projects_pr
+00004210: 6566 6978 203d 2028 0a20 2020 2020 2020  efix = (.       
+00004220: 2020 2020 2020 2020 2073 6572 7665 725f           server_
+00004230: 6366 672e 6765 7428 2275 695f 7072 6f6a  cfg.get("ui_proj
+00004240: 6563 7473 5f70 7265 6669 7822 2920 6f72  ects_prefix") or
+00004250: 2063 6f6e 6669 672e 7569 2e70 726f 6a65   config.ui.proje
+00004260: 6374 735f 7072 6566 6978 0a20 2020 2020  cts_prefix.     
+00004270: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00004280: 2020 2020 2063 6f6e 6669 672e 6b66 705f       config.kfp_
+00004290: 696d 6167 6520 3d20 7365 7276 6572 5f63  image = server_c
+000042a0: 6667 2e67 6574 2822 6b66 705f 696d 6167  fg.get("kfp_imag
+000042b0: 6522 2920 6f72 2063 6f6e 6669 672e 6b66  e") or config.kf
+000042c0: 705f 696d 6167 650a 2020 2020 2020 2020  p_image.        
+000042d0: 2020 2020 636f 6e66 6967 2e6b 6670 5f75      config.kfp_u
+000042e0: 726c 203d 2073 6572 7665 725f 6366 672e  rl = server_cfg.
+000042f0: 6765 7428 226b 6670 5f75 726c 2229 206f  get("kfp_url") o
+00004300: 7220 636f 6e66 6967 2e6b 6670 5f75 726c  r config.kfp_url
+00004310: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+00004320: 6669 672e 6461 736b 5f6b 6670 5f69 6d61  fig.dask_kfp_ima
+00004330: 6765 203d 2028 0a20 2020 2020 2020 2020  ge = (.         
+00004340: 2020 2020 2020 2073 6572 7665 725f 6366         server_cf
+00004350: 672e 6765 7428 2264 6173 6b5f 6b66 705f  g.get("dask_kfp_
+00004360: 696d 6167 6522 2920 6f72 2063 6f6e 6669  image") or confi
+00004370: 672e 6461 736b 5f6b 6670 5f69 6d61 6765  g.dask_kfp_image
+00004380: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00004390: 2020 2020 2020 2020 2020 2063 6f6e 6669             confi
+000043a0: 672e 7363 7261 7065 5f6d 6574 7269 6373  g.scrape_metrics
+000043b0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+000043c0: 2020 2020 2073 6572 7665 725f 6366 672e       server_cfg.
+000043d0: 6765 7428 2273 6372 6170 655f 6d65 7472  get("scrape_metr
+000043e0: 6963 7322 290a 2020 2020 2020 2020 2020  ics").          
+000043f0: 2020 2020 2020 6966 2073 6572 7665 725f        if server_
+00004400: 6366 672e 6765 7428 2273 6372 6170 655f  cfg.get("scrape_
+00004410: 6d65 7472 6963 7322 2920 6973 206e 6f74  metrics") is not
+00004420: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+00004430: 2020 2020 2020 656c 7365 2063 6f6e 6669        else confi
+00004440: 672e 7363 7261 7065 5f6d 6574 7269 6373  g.scrape_metrics
+00004450: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00004460: 2020 2020 2020 2020 2020 2063 6f6e 6669             confi
+00004470: 672e 6465 6661 756c 745f 6675 6e63 7469  g.default_functi
+00004480: 6f6e 5f6e 6f64 655f 7365 6c65 6374 6f72  on_node_selector
+00004490: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+000044a0: 2020 2020 2073 6572 7665 725f 6366 672e       server_cfg.
+000044b0: 6765 7428 2264 6566 6175 6c74 5f66 756e  get("default_fun
+000044c0: 6374 696f 6e5f 6e6f 6465 5f73 656c 6563  ction_node_selec
+000044d0: 746f 7222 290a 2020 2020 2020 2020 2020  tor").          
+000044e0: 2020 2020 2020 6f72 2063 6f6e 6669 672e        or config.
+000044f0: 6465 6661 756c 745f 6675 6e63 7469 6f6e  default_function
+00004500: 5f6e 6f64 655f 7365 6c65 6374 6f72 0a20  _node_selector. 
+00004510: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00004520: 2020 2020 2020 2020 2063 6f6e 6669 672e           config.
+00004530: 6967 7a5f 7665 7273 696f 6e20 3d20 7365  igz_version = se
+00004540: 7276 6572 5f63 6667 2e67 6574 2822 6967  rver_cfg.get("ig
+00004550: 7a5f 7665 7273 696f 6e22 2920 6f72 2063  z_version") or c
+00004560: 6f6e 6669 672e 6967 7a5f 7665 7273 696f  onfig.igz_versio
+00004570: 6e0a 2020 2020 2020 2020 2020 2020 636f  n.            co
+00004580: 6e66 6967 2e73 746f 7261 6765 2e61 7574  nfig.storage.aut
+00004590: 6f5f 6d6f 756e 745f 7479 7065 203d 2028  o_mount_type = (
+000045a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000045b0: 2073 6572 7665 725f 6366 672e 6765 7428   server_cfg.get(
+000045c0: 2261 7574 6f5f 6d6f 756e 745f 7479 7065  "auto_mount_type
+000045d0: 2229 206f 7220 636f 6e66 6967 2e73 746f  ") or config.sto
+000045e0: 7261 6765 2e61 7574 6f5f 6d6f 756e 745f  rage.auto_mount_
+000045f0: 7479 7065 0a20 2020 2020 2020 2020 2020  type.           
+00004600: 2029 0a20 2020 2020 2020 2020 2020 2063   ).            c
+00004610: 6f6e 6669 672e 7374 6f72 6167 652e 6175  onfig.storage.au
+00004620: 746f 5f6d 6f75 6e74 5f70 6172 616d 7320  to_mount_params 
+00004630: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00004640: 2020 2020 7365 7276 6572 5f63 6667 2e67      server_cfg.g
+00004650: 6574 2822 6175 746f 5f6d 6f75 6e74 5f70  et("auto_mount_p
+00004660: 6172 616d 7322 2920 6f72 2063 6f6e 6669  arams") or confi
+00004670: 672e 7374 6f72 6167 652e 6175 746f 5f6d  g.storage.auto_m
+00004680: 6f75 6e74 5f70 6172 616d 730a 2020 2020  ount_params.    
+00004690: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000046a0: 2020 2020 2020 636f 6e66 6967 2e73 7061        config.spa
+000046b0: 726b 5f6f 7065 7261 746f 725f 7665 7273  rk_operator_vers
+000046c0: 696f 6e20 3d20 280a 2020 2020 2020 2020  ion = (.        
+000046d0: 2020 2020 2020 2020 7365 7276 6572 5f63          server_c
+000046e0: 6667 2e67 6574 2822 7370 6172 6b5f 6f70  fg.get("spark_op
+000046f0: 6572 6174 6f72 5f76 6572 7369 6f6e 2229  erator_version")
+00004700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004710: 206f 7220 636f 6e66 6967 2e73 7061 726b   or config.spark
+00004720: 5f6f 7065 7261 746f 725f 7665 7273 696f  _operator_versio
+00004730: 6e0a 2020 2020 2020 2020 2020 2020 290a  n.            ).
+00004740: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
+00004750: 6967 2e64 6566 6175 6c74 5f74 656e 736f  ig.default_tenso
+00004760: 7262 6f61 7264 5f6c 6f67 735f 7061 7468  rboard_logs_path
+00004770: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00004780: 2020 2020 2073 6572 7665 725f 6366 672e       server_cfg.
+00004790: 6765 7428 2264 6566 6175 6c74 5f74 656e  get("default_ten
+000047a0: 736f 7262 6f61 7264 5f6c 6f67 735f 7061  sorboard_logs_pa
+000047b0: 7468 2229 0a20 2020 2020 2020 2020 2020  th").           
+000047c0: 2020 2020 206f 7220 636f 6e66 6967 2e64       or config.d
+000047d0: 6566 6175 6c74 5f74 656e 736f 7262 6f61  efault_tensorboa
+000047e0: 7264 5f6c 6f67 735f 7061 7468 0a20 2020  rd_logs_path.   
+000047f0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00004800: 2020 2020 2020 2063 6f6e 6669 672e 6465         config.de
+00004810: 6661 756c 745f 6675 6e63 7469 6f6e 5f70  fault_function_p
+00004820: 6f64 5f72 6573 6f75 7263 6573 203d 2028  od_resources = (
+00004830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004840: 2073 6572 7665 725f 6366 672e 6765 7428   server_cfg.get(
+00004850: 2264 6566 6175 6c74 5f66 756e 6374 696f  "default_functio
+00004860: 6e5f 706f 645f 7265 736f 7572 6365 7322  n_pod_resources"
+00004870: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00004880: 2020 6f72 2063 6f6e 6669 672e 6465 6661    or config.defa
+00004890: 756c 745f 6675 6e63 7469 6f6e 5f70 6f64  ult_function_pod
+000048a0: 5f72 6573 6f75 7263 6573 0a20 2020 2020  _resources.     
+000048b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000048c0: 2020 2020 2063 6f6e 6669 672e 6675 6e63       config.func
+000048d0: 7469 6f6e 5f64 6566 6175 6c74 732e 7072  tion_defaults.pr
+000048e0: 6565 6d70 7469 6f6e 5f6d 6f64 6520 3d20  eemption_mode = 
+000048f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00004900: 2020 7365 7276 6572 5f63 6667 2e67 6574    server_cfg.get
+00004910: 2822 6465 6661 756c 745f 7072 6565 6d70  ("default_preemp
+00004920: 7469 6f6e 5f6d 6f64 6522 290a 2020 2020  tion_mode").    
+00004930: 2020 2020 2020 2020 2020 2020 6f72 2063              or c
+00004940: 6f6e 6669 672e 6675 6e63 7469 6f6e 5f64  onfig.function_d
+00004950: 6566 6175 6c74 732e 7072 6565 6d70 7469  efaults.preempti
+00004960: 6f6e 5f6d 6f64 650a 2020 2020 2020 2020  on_mode.        
+00004970: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00004980: 2020 636f 6e66 6967 2e70 7265 656d 7074    config.preempt
+00004990: 6962 6c65 5f6e 6f64 6573 2e6e 6f64 655f  ible_nodes.node_
+000049a0: 7365 6c65 6374 6f72 203d 2028 0a20 2020  selector = (.   
+000049b0: 2020 2020 2020 2020 2020 2020 2073 6572               ser
+000049c0: 7665 725f 6366 672e 6765 7428 2270 7265  ver_cfg.get("pre
+000049d0: 656d 7074 6962 6c65 5f6e 6f64 6573 5f6e  emptible_nodes_n
+000049e0: 6f64 655f 7365 6c65 6374 6f72 2229 0a20  ode_selector"). 
+000049f0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00004a00: 7220 636f 6e66 6967 2e70 7265 656d 7074  r config.preempt
+00004a10: 6962 6c65 5f6e 6f64 6573 2e6e 6f64 655f  ible_nodes.node_
+00004a20: 7365 6c65 6374 6f72 0a20 2020 2020 2020  selector.       
+00004a30: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00004a40: 2020 2063 6f6e 6669 672e 7072 6565 6d70     config.preemp
+00004a50: 7469 626c 655f 6e6f 6465 732e 746f 6c65  tible_nodes.tole
+00004a60: 7261 7469 6f6e 7320 3d20 280a 2020 2020  rations = (.    
+00004a70: 2020 2020 2020 2020 2020 2020 7365 7276              serv
+00004a80: 6572 5f63 6667 2e67 6574 2822 7072 6565  er_cfg.get("pree
+00004a90: 6d70 7469 626c 655f 6e6f 6465 735f 746f  mptible_nodes_to
+00004aa0: 6c65 7261 7469 6f6e 7322 290a 2020 2020  lerations").    
+00004ab0: 2020 2020 2020 2020 2020 2020 6f72 2063              or c
+00004ac0: 6f6e 6669 672e 7072 6565 6d70 7469 626c  onfig.preemptibl
+00004ad0: 655f 6e6f 6465 732e 746f 6c65 7261 7469  e_nodes.tolerati
+00004ae0: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
+00004af0: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
+00004b00: 6e66 6967 2e66 6f72 6365 5f72 756e 5f6c  nfig.force_run_l
+00004b10: 6f63 616c 203d 2028 0a20 2020 2020 2020  ocal = (.       
+00004b20: 2020 2020 2020 2020 2073 6572 7665 725f           server_
+00004b30: 6366 672e 6765 7428 2266 6f72 6365 5f72  cfg.get("force_r
+00004b40: 756e 5f6c 6f63 616c 2229 206f 7220 636f  un_local") or co
+00004b50: 6e66 6967 2e66 6f72 6365 5f72 756e 5f6c  nfig.force_run_l
+00004b60: 6f63 616c 0a20 2020 2020 2020 2020 2020  ocal.           
+00004b70: 2029 0a20 2020 2020 2020 2020 2020 2063   ).            c
+00004b80: 6f6e 6669 672e 6675 6e63 7469 6f6e 203d  onfig.function =
+00004b90: 2073 6572 7665 725f 6366 672e 6765 7428   server_cfg.get(
+00004ba0: 2266 756e 6374 696f 6e22 2920 6f72 2063  "function") or c
+00004bb0: 6f6e 6669 672e 6675 6e63 7469 6f6e 0a20  onfig.function. 
+00004bc0: 2020 2020 2020 2020 2020 2063 6f6e 6669             confi
+00004bd0: 672e 6874 7470 6462 2e6c 6f67 7320 3d20  g.httpdb.logs = 
+00004be0: 7365 7276 6572 5f63 6667 2e67 6574 2822  server_cfg.get("
+00004bf0: 6c6f 6773 2229 206f 7220 636f 6e66 6967  logs") or config
+00004c00: 2e68 7474 7064 622e 6c6f 6773 0a20 2020  .httpdb.logs.   
+00004c10: 2020 2020 2020 2020 2063 6f6e 6669 672e           config.
+00004c20: 6d6f 6465 6c5f 656e 6470 6f69 6e74 5f6d  model_endpoint_m
+00004c30: 6f6e 6974 6f72 696e 672e 7374 6f72 655f  onitoring.store_
+00004c40: 7479 7065 203d 2028 0a20 2020 2020 2020  type = (.       
+00004c50: 2020 2020 2020 2020 2073 6572 7665 725f           server_
+00004c60: 6366 672e 6765 7428 226d 6f64 656c 5f65  cfg.get("model_e
+00004c70: 6e64 706f 696e 745f 6d6f 6e69 746f 7269  ndpoint_monitori
+00004c80: 6e67 5f73 746f 7265 5f74 7970 6522 290a  ng_store_type").
+00004c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ca0: 6f72 2063 6f6e 6669 672e 6d6f 6465 6c5f  or config.model_
+00004cb0: 656e 6470 6f69 6e74 5f6d 6f6e 6974 6f72  endpoint_monitor
+00004cc0: 696e 672e 7374 6f72 655f 7479 7065 0a20  ing.store_type. 
+00004cd0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00004ce0: 2020 2020 2020 2020 2063 6f6e 6669 672e           config.
+00004cf0: 7061 636b 6167 6572 7320 3d20 7365 7276  packagers = serv
+00004d00: 6572 5f63 6667 2e67 6574 2822 7061 636b  er_cfg.get("pack
+00004d10: 6167 6572 7322 2920 6f72 2063 6f6e 6669  agers") or confi
+00004d20: 672e 7061 636b 6167 6572 730a 2020 2020  g.packagers.    
+00004d30: 2020 2020 2020 2020 7365 7276 6572 5f64          server_d
+00004d40: 6174 615f 7072 6566 6978 6573 203d 2073  ata_prefixes = s
+00004d50: 6572 7665 725f 6366 672e 6765 7428 2266  erver_cfg.get("f
+00004d60: 6561 7475 7265 5f73 746f 7265 5f64 6174  eature_store_dat
+00004d70: 615f 7072 6566 6978 6573 2229 206f 7220  a_prefixes") or 
+00004d80: 7b7d 0a20 2020 2020 2020 2020 2020 2066  {}.            f
+00004d90: 6f72 2070 7265 6669 7820 696e 205b 2264  or prefix in ["d
+00004da0: 6566 6175 6c74 222c 2022 6e6f 7371 6c22  efault", "nosql"
+00004db0: 2c20 2272 6564 6973 6e6f 7371 6c22 5d3a  , "redisnosql"]:
+00004dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004dd0: 2073 6572 7665 725f 7072 6566 6978 5f76   server_prefix_v
+00004de0: 616c 7565 203d 2073 6572 7665 725f 6461  alue = server_da
+00004df0: 7461 5f70 7265 6669 7865 732e 6765 7428  ta_prefixes.get(
+00004e00: 7072 6566 6978 290a 2020 2020 2020 2020  prefix).        
+00004e10: 2020 2020 2020 2020 6966 2073 6572 7665          if serve
+00004e20: 725f 7072 6566 6978 5f76 616c 7565 2069  r_prefix_value i
+00004e30: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00004e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004e50: 7365 7461 7474 7228 0a20 2020 2020 2020  setattr(.       
+00004e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004e70: 2063 6f6e 6669 672e 6665 6174 7572 655f   config.feature_
+00004e80: 7374 6f72 652e 6461 7461 5f70 7265 6669  store.data_prefi
+00004e90: 7865 732c 2070 7265 6669 782c 2073 6572  xes, prefix, ser
+00004ea0: 7665 725f 7072 6566 6978 5f76 616c 7565  ver_prefix_value
+00004eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004ec0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00004ed0: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
+00004ee0: 2061 7320 6578 633a 0a20 2020 2020 2020   as exc:.       
+00004ef0: 2020 2020 206c 6f67 6765 722e 7761 726e       logger.warn
+00004f00: 696e 6728 0a20 2020 2020 2020 2020 2020  ing(.           
+00004f10: 2020 2020 2022 4661 696c 6564 2073 796e       "Failed syn
+00004f20: 6369 6e67 2063 6f6e 6669 6720 6672 6f6d  cing config from
+00004f30: 2073 6572 7665 7222 2c0a 2020 2020 2020   server",.      
+00004f40: 2020 2020 2020 2020 2020 6578 633d 6572            exc=er
+00004f50: 725f 746f 5f73 7472 2865 7863 292c 0a20  r_to_str(exc),. 
+00004f60: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00004f70: 7261 6365 6261 636b 3d74 7261 6365 6261  raceback=traceba
+00004f80: 636b 2e66 6f72 6d61 745f 6578 6328 292c  ck.format_exc(),
+00004f90: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00004fa0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00004fb0: 6c66 0a0a 2020 2020 6465 6620 7374 6f72  lf..    def stor
+00004fc0: 655f 6c6f 6728 7365 6c66 2c20 7569 642c  e_log(self, uid,
+00004fd0: 2070 726f 6a65 6374 3d22 222c 2062 6f64   project="", bod
+00004fe0: 793d 4e6f 6e65 2c20 6170 7065 6e64 3d46  y=None, append=F
+00004ff0: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
+00005000: 2222 5361 7665 2061 206c 6f67 2070 6572  ""Save a log per
+00005010: 7369 7374 656e 746c 792e 0a0a 2020 2020  sistently...    
+00005020: 2020 2020 3a70 6172 616d 2075 6964 3a20      :param uid: 
+00005030: 4c6f 6720 756e 6971 7565 2049 440a 2020  Log unique ID.  
+00005040: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
+00005050: 6a65 6374 3a20 5072 6f6a 6563 7420 6e61  ject: Project na
+00005060: 6d65 2066 6f72 2077 6869 6368 2074 6869  me for which thi
+00005070: 7320 6c6f 6720 6265 6c6f 6e67 730a 2020  s log belongs.  
+00005080: 2020 2020 2020 3a70 6172 616d 2062 6f64        :param bod
+00005090: 793a 2054 6865 2061 6374 7561 6c20 6c6f  y: The actual lo
+000050a0: 6720 746f 2073 746f 7265 0a20 2020 2020  g to store.     
+000050b0: 2020 203a 7061 7261 6d20 6170 7065 6e64     :param append
+000050c0: 3a20 5768 6574 6865 7220 746f 2061 7070  : Whether to app
+000050d0: 656e 6420 7468 6520 6c6f 6720 7072 6f76  end the log prov
+000050e0: 6964 6564 2069 6e20 6060 626f 6479 6060  ided in ``body``
+000050f0: 2074 6f20 616e 2065 7869 7374 696e 6720   to an existing 
+00005100: 6c6f 6720 7769 7468 2074 6865 2073 616d  log with the sam
+00005110: 6520 6060 7569 6460 6020 6f72 2074 6f0a  e ``uid`` or to.
+00005120: 2020 2020 2020 2020 2020 2020 6372 6561              crea
+00005130: 7465 2061 206e 6577 206c 6f67 2e20 4966  te a new log. If
+00005140: 2073 6574 2074 6f20 6060 4661 6c73 6560   set to ``False`
+00005150: 602c 2061 6e20 6578 6973 7469 6e67 206c  `, an existing l
+00005160: 6f67 2077 6974 6820 7361 6d65 2060 6075  og with same ``u
+00005170: 6964 6060 2077 696c 6c20 6265 206f 7665  id`` will be ove
+00005180: 7277 7269 7474 656e 0a20 2020 2020 2020  rwritten.       
+00005190: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
+000051a0: 206e 6f74 2062 6f64 793a 0a20 2020 2020   not body:.     
+000051b0: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
+000051c0: 2020 2020 2020 2070 6174 6820 3d20 7365         path = se
+000051d0: 6c66 2e5f 7061 7468 5f6f 6628 226c 6f67  lf._path_of("log
+000051e0: 222c 2070 726f 6a65 6374 2c20 7569 6429  ", project, uid)
+000051f0: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+00005200: 3d20 7b22 6170 7065 6e64 223a 2062 6f6f  = {"append": boo
+00005210: 6c32 7374 7228 6170 7065 6e64 297d 0a20  l2str(append)}. 
+00005220: 2020 2020 2020 2065 7272 6f72 203d 2066         error = f
+00005230: 2273 746f 7265 206c 6f67 207b 7072 6f6a  "store log {proj
+00005240: 6563 747d 2f7b 7569 647d 220a 2020 2020  ect}/{uid}".    
+00005250: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
+00005260: 6c28 2250 4f53 5422 2c20 7061 7468 2c20  l("POST", path, 
+00005270: 6572 726f 722c 2070 6172 616d 732c 2062  error, params, b
+00005280: 6f64 7929 0a0a 2020 2020 6465 6620 6765  ody)..    def ge
+00005290: 745f 6c6f 6728 7365 6c66 2c20 7569 642c  t_log(self, uid,
+000052a0: 2070 726f 6a65 6374 3d22 222c 206f 6666   project="", off
+000052b0: 7365 743d 302c 2073 697a 653d 2d31 293a  set=0, size=-1):
+000052c0: 0a20 2020 2020 2020 2022 2222 5265 7472  .        """Retr
+000052d0: 6965 7665 2061 206c 6f67 2e0a 0a20 2020  ieve a log...   
+000052e0: 2020 2020 203a 7061 7261 6d20 7569 643a       :param uid:
+000052f0: 204c 6f67 2075 6e69 7175 6520 4944 0a20   Log unique ID. 
+00005300: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
+00005310: 6f6a 6563 743a 2050 726f 6a65 6374 206e  oject: Project n
+00005320: 616d 6520 666f 7220 7768 6963 6820 7468  ame for which th
+00005330: 6520 6c6f 6720 6265 6c6f 6e67 730a 2020  e log belongs.  
+00005340: 2020 2020 2020 3a70 6172 616d 206f 6666        :param off
+00005350: 7365 743a 2052 6574 7269 6576 6520 7061  set: Retrieve pa
+00005360: 7274 6961 6c20 6c6f 672c 2067 6574 2075  rtial log, get u
+00005370: 7020 746f 2060 6073 697a 6560 6020 6279  p to ``size`` by
+00005380: 7465 7320 7374 6172 7469 6e67 2061 7420  tes starting at 
+00005390: 6f66 6673 6574 2060 606f 6666 7365 7460  offset ``offset`
+000053a0: 600a 2020 2020 2020 2020 2020 2020 6672  `.            fr
+000053b0: 6f6d 2062 6567 696e 6e69 6e67 206f 6620  om beginning of 
+000053c0: 6c6f 670a 2020 2020 2020 2020 3a70 6172  log.        :par
+000053d0: 616d 2073 697a 653a 2053 6565 2060 606f  am size: See ``o
+000053e0: 6666 7365 7460 602e 2049 6620 7365 7420  ffset``. If set 
+000053f0: 746f 2060 602d 3160 6020 2874 6865 2064  to ``-1`` (the d
+00005400: 6566 6175 6c74 2920 7769 6c6c 2072 6574  efault) will ret
+00005410: 7269 6576 6520 616c 6c20 6461 7461 2074  rieve all data t
+00005420: 6f20 656e 6420 6f66 206c 6f67 2e0a 2020  o end of log..  
+00005430: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
+00005440: 5468 6520 666f 6c6c 6f77 696e 6720 6f62  The following ob
+00005450: 6a65 6374 733a 0a0a 2020 2020 2020 2020  jects:..        
+00005460: 2020 2020 2d20 7374 6174 6520 2d20 5468      - state - Th
+00005470: 6520 7374 6174 6520 6f66 2074 6865 2072  e state of the r
+00005480: 756e 7469 6d65 206f 626a 6563 7420 7768  untime object wh
+00005490: 6963 6820 6765 6e65 7261 7465 7320 7468  ich generates th
+000054a0: 6973 206c 6f67 2c20 6966 2069 7420 6578  is log, if it ex
+000054b0: 6973 7473 2e20 496e 2063 6173 6520 6e6f  ists. In case no
+000054c0: 206b 6e6f 776e 2073 7461 7465 0a20 2020   known state.   
+000054d0: 2020 2020 2020 2020 2020 2065 7869 7374             exist
+000054e0: 732c 2074 6869 7320 7769 6c6c 2062 6520  s, this will be 
+000054f0: 6060 756e 6b6e 6f77 6e60 602e 0a20 2020  ``unknown``..   
+00005500: 2020 2020 2020 2020 202d 2063 6f6e 7465           - conte
+00005510: 6e74 202d 2054 6865 2061 6374 7561 6c20  nt - The actual 
+00005520: 6c6f 6720 636f 6e74 656e 742e 0a20 2020  log content..   
+00005530: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00005540: 2020 7061 7261 6d73 203d 207b 226f 6666    params = {"off
+00005550: 7365 7422 3a20 6f66 6673 6574 2c20 2273  set": offset, "s
+00005560: 697a 6522 3a20 7369 7a65 7d0a 2020 2020  ize": size}.    
+00005570: 2020 2020 7061 7468 203d 2073 656c 662e      path = self.
+00005580: 5f70 6174 685f 6f66 2822 6c6f 6722 2c20  _path_of("log", 
+00005590: 7072 6f6a 6563 742c 2075 6964 290a 2020  project, uid).  
+000055a0: 2020 2020 2020 6572 726f 7220 3d20 6622        error = f"
+000055b0: 6765 7420 6c6f 6720 7b70 726f 6a65 6374  get log {project
+000055c0: 7d2f 7b75 6964 7d22 0a20 2020 2020 2020  }/{uid}".       
+000055d0: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
+000055e0: 5f63 616c 6c28 2247 4554 222c 2070 6174  _call("GET", pat
+000055f0: 682c 2065 7272 6f72 2c20 7061 7261 6d73  h, error, params
+00005600: 3d70 6172 616d 7329 0a20 2020 2020 2020  =params).       
+00005610: 2069 6620 7265 7370 2e68 6561 6465 7273   if resp.headers
+00005620: 3a0a 2020 2020 2020 2020 2020 2020 7374  :.            st
+00005630: 6174 6520 3d20 7265 7370 2e68 6561 6465  ate = resp.heade
+00005640: 7273 2e67 6574 2822 782d 6d6c 7275 6e2d  rs.get("x-mlrun-
+00005650: 7275 6e2d 7374 6174 6522 2c20 2222 290a  run-state", "").
+00005660: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00005670: 726e 2073 7461 7465 2e6c 6f77 6572 2829  rn state.lower()
+00005680: 2c20 7265 7370 2e63 6f6e 7465 6e74 0a0a  , resp.content..
+00005690: 2020 2020 2020 2020 7265 7475 726e 2022          return "
+000056a0: 756e 6b6e 6f77 6e22 2c20 7265 7370 2e63  unknown", resp.c
+000056b0: 6f6e 7465 6e74 0a0a 2020 2020 6465 6620  ontent..    def 
+000056c0: 7761 7463 685f 6c6f 6728 7365 6c66 2c20  watch_log(self, 
+000056d0: 7569 642c 2070 726f 6a65 6374 3d22 222c  uid, project="",
+000056e0: 2077 6174 6368 3d54 7275 652c 206f 6666   watch=True, off
+000056f0: 7365 743d 3029 3a0a 2020 2020 2020 2020  set=0):.        
+00005700: 2222 2252 6574 7269 6576 6520 6c6f 6773  """Retrieve logs
+00005710: 206f 6620 6120 7275 6e6e 696e 6720 7072   of a running pr
+00005720: 6f63 6573 732c 2061 6e64 2077 6174 6368  ocess, and watch
+00005730: 2074 6865 2070 726f 6772 6573 7320 6f66   the progress of
+00005740: 2074 6865 2065 7865 6375 7469 6f6e 2075   the execution u
+00005750: 6e74 696c 2069 7420 636f 6d70 6c65 7465  ntil it complete
+00005760: 732e 2054 6869 730a 2020 2020 2020 2020  s. This.        
+00005770: 6d65 7468 6f64 2077 696c 6c20 7072 696e  method will prin
+00005780: 7420 6f75 7420 7468 6520 6c6f 6773 2061  t out the logs a
+00005790: 6e64 2063 6f6e 7469 6e75 6520 746f 2070  nd continue to p
+000057a0: 6572 696f 6469 6361 6c6c 7920 706f 6c6c  eriodically poll
+000057b0: 2066 6f72 2c20 616e 6420 7072 696e 742c   for, and print,
+000057c0: 206e 6577 206c 6f67 7320 6173 206c 6f6e   new logs as lon
+000057d0: 6720 6173 2074 6865 0a20 2020 2020 2020  g as the.       
+000057e0: 2073 7461 7465 206f 6620 7468 6520 7275   state of the ru
+000057f0: 6e74 696d 6520 7768 6963 6820 6765 6e65  ntime which gene
+00005800: 7261 7465 7320 7468 6973 206c 6f67 2069  rates this log i
+00005810: 7320 6569 7468 6572 2060 6070 656e 6469  s either ``pendi
+00005820: 6e67 6060 206f 7220 6060 7275 6e6e 696e  ng`` or ``runnin
+00005830: 6760 602e 0a0a 2020 2020 2020 2020 3a70  g``...        :p
+00005840: 6172 616d 2075 6964 3a20 5468 6520 7569  aram uid: The ui
+00005850: 6420 6f66 2074 6865 206c 6f67 206f 626a  d of the log obj
+00005860: 6563 7420 746f 2077 6174 6368 2e0a 2020  ect to watch..  
+00005870: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
+00005880: 6a65 6374 3a20 5072 6f6a 6563 7420 7468  ject: Project th
+00005890: 6174 2074 6865 206c 6f67 2062 656c 6f6e  at the log belon
+000058a0: 6773 2074 6f2e 0a20 2020 2020 2020 203a  gs to..        :
+000058b0: 7061 7261 6d20 7761 7463 683a 2049 6620  param watch: If 
+000058c0: 7365 7420 746f 2060 6054 7275 6560 6020  set to ``True`` 
+000058d0: 7769 6c6c 2063 6f6e 7469 6e75 6520 7472  will continue tr
+000058e0: 6163 6b69 6e67 2074 6865 206c 6f67 2061  acking the log a
+000058f0: 7320 6465 7363 7269 6265 6420 6162 6f76  s described abov
+00005900: 652e 204f 7468 6572 7769 7365 2074 6869  e. Otherwise thi
+00005910: 7320 6675 6e63 7469 6f6e 0a20 2020 2020  s function.     
+00005920: 2020 2020 2020 2069 7320 7072 6163 7469         is practi
+00005930: 6361 6c6c 7920 6571 7569 7661 6c65 6e74  cally equivalent
+00005940: 2074 6f20 7468 6520 3a70 793a 6675 6e63   to the :py:func
+00005950: 3a60 7e67 6574 5f6c 6f67 6020 6675 6e63  :`~get_log` func
+00005960: 7469 6f6e 2e0a 2020 2020 2020 2020 3a70  tion..        :p
+00005970: 6172 616d 206f 6666 7365 743a 204d 696e  aram offset: Min
+00005980: 696d 616c 206f 6666 7365 7420 696e 2074  imal offset in t
+00005990: 6865 206c 6f67 2074 6f20 7761 7463 682e  he log to watch.
+000059a0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+000059b0: 733a 2054 6865 2066 696e 616c 2073 7461  s: The final sta
+000059c0: 7465 206f 6620 7468 6520 6c6f 6720 6265  te of the log be
+000059d0: 696e 6720 7761 7463 6865 642e 0a20 2020  ing watched..   
+000059e0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+000059f0: 2020 7374 6174 652c 2074 6578 7420 3d20    state, text = 
+00005a00: 7365 6c66 2e67 6574 5f6c 6f67 2875 6964  self.get_log(uid
+00005a10: 2c20 7072 6f6a 6563 742c 206f 6666 7365  , project, offse
+00005a20: 743d 6f66 6673 6574 290a 2020 2020 2020  t=offset).      
+00005a30: 2020 6966 2074 6578 743a 0a20 2020 2020    if text:.     
+00005a40: 2020 2020 2020 2070 7269 6e74 2874 6578         print(tex
+00005a50: 742e 6465 636f 6465 2865 7272 6f72 733d  t.decode(errors=
+00005a60: 6d6c 7275 6e2e 6d6c 636f 6e66 2e68 7474  mlrun.mlconf.htt
+00005a70: 7064 622e 6c6f 6773 2e64 6563 6f64 652e  pdb.logs.decode.
+00005a80: 6572 726f 7273 2929 0a20 2020 2020 2020  errors)).       
+00005a90: 2069 6620 7761 7463 683a 0a20 2020 2020   if watch:.     
+00005aa0: 2020 2020 2020 206e 696c 5f72 6573 7020         nil_resp 
+00005ab0: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
+00005ac0: 7768 696c 6520 7374 6174 6520 696e 205b  while state in [
+00005ad0: 2270 656e 6469 6e67 222c 2022 7275 6e6e  "pending", "runn
+00005ae0: 696e 6722 5d3a 0a20 2020 2020 2020 2020  ing"]:.         
+00005af0: 2020 2020 2020 206f 6666 7365 7420 2b3d         offset +=
+00005b00: 206c 656e 2874 6578 7429 0a20 2020 2020   len(text).     
+00005b10: 2020 2020 2020 2020 2020 2023 2069 6620             # if 
+00005b20: 7765 2067 6574 2033 206e 696c 2072 6573  we get 3 nil res
+00005b30: 706f 6e73 6573 2069 6e20 6120 726f 772c  ponses in a row,
+00005b40: 2069 6e63 7265 6173 6520 7468 6520 736c   increase the sl
+00005b50: 6565 7020 7469 6d65 2074 6f20 3130 2073  eep time to 10 s
+00005b60: 6563 6f6e 6473 0a20 2020 2020 2020 2020  econds.         
+00005b70: 2020 2020 2020 2023 2054 4f44 4f3a 2072         # TODO: r
+00005b80: 6566 6163 746f 7220 7468 6973 2074 6f20  efactor this to 
+00005b90: 7573 6520 6120 636f 6e64 6974 696f 6e61  use a conditiona
+00005ba0: 6c20 6261 636b 6f66 6620 6d65 6368 616e  l backoff mechan
+00005bb0: 6973 6d0a 2020 2020 2020 2020 2020 2020  ism.            
+00005bc0: 2020 2020 6966 206e 696c 5f72 6573 7020      if nil_resp 
+00005bd0: 3c20 333a 0a20 2020 2020 2020 2020 2020  < 3:.           
+00005be0: 2020 2020 2020 2020 2074 696d 652e 736c           time.sl
+00005bf0: 6565 7028 696e 7428 6d6c 7275 6e2e 6d6c  eep(int(mlrun.ml
+00005c00: 636f 6e66 2e68 7474 7064 622e 6c6f 6773  conf.httpdb.logs
+00005c10: 2e70 756c 6c5f 6c6f 6773 5f64 6566 6175  .pull_logs_defau
+00005c20: 6c74 5f69 6e74 6572 7661 6c29 290a 2020  lt_interval)).  
+00005c30: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00005c40: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00005c50: 2020 2020 2020 2020 7469 6d65 2e73 6c65          time.sle
+00005c60: 6570 280a 2020 2020 2020 2020 2020 2020  ep(.            
+00005c70: 2020 2020 2020 2020 2020 2020 696e 7428              int(
+00005c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005c90: 2020 2020 2020 2020 2020 2020 206d 6c72               mlr
+00005ca0: 756e 2e6d 6c63 6f6e 662e 6874 7470 6462  un.mlconf.httpdb
+00005cb0: 2e6c 6f67 732e 7075 6c6c 5f6c 6f67 735f  .logs.pull_logs_
+00005cc0: 6261 636b 6f66 665f 6e6f 5f6c 6f67 735f  backoff_no_logs_
+00005cd0: 6465 6661 756c 745f 696e 7465 7276 616c  default_interval
+00005ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005cf0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00005d00: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00005d10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005d20: 2073 7461 7465 2c20 7465 7874 203d 2073   state, text = s
+00005d30: 656c 662e 6765 745f 6c6f 6728 7569 642c  elf.get_log(uid,
+00005d40: 2070 726f 6a65 6374 2c20 6f66 6673 6574   project, offset
+00005d50: 3d6f 6666 7365 7429 0a20 2020 2020 2020  =offset).       
+00005d60: 2020 2020 2020 2020 2069 6620 7465 7874           if text
+00005d70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00005d80: 2020 2020 2020 6e69 6c5f 7265 7370 203d        nil_resp =
+00005d90: 2030 0a20 2020 2020 2020 2020 2020 2020   0.             
+00005da0: 2020 2020 2020 2070 7269 6e74 280a 2020         print(.  
+00005db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005dc0: 2020 2020 2020 7465 7874 2e64 6563 6f64        text.decod
+00005dd0: 6528 6572 726f 7273 3d6d 6c72 756e 2e6d  e(errors=mlrun.m
+00005de0: 6c63 6f6e 662e 6874 7470 6462 2e6c 6f67  lconf.httpdb.log
+00005df0: 732e 6465 636f 6465 2e65 7272 6f72 7329  s.decode.errors)
+00005e00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00005e10: 2020 2020 2020 2020 2020 656e 643d 2222            end=""
+00005e20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00005e30: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00005e40: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00005e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005e60: 2020 6e69 6c5f 7265 7370 202b 3d20 310a    nil_resp += 1.
+00005e70: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00005e80: 2020 2020 2020 2020 2020 6f66 6673 6574            offset
+00005e90: 202b 3d20 6c65 6e28 7465 7874 290a 0a20   += len(text).. 
+00005ea0: 2020 2020 2020 2072 6574 7572 6e20 7374         return st
+00005eb0: 6174 652c 206f 6666 7365 740a 0a20 2020  ate, offset..   
+00005ec0: 2064 6566 2073 746f 7265 5f72 756e 2873   def store_run(s
+00005ed0: 656c 662c 2073 7472 7563 742c 2075 6964  elf, struct, uid
+00005ee0: 2c20 7072 6f6a 6563 743d 2222 2c20 6974  , project="", it
+00005ef0: 6572 3d30 293a 0a20 2020 2020 2020 2022  er=0):.        "
+00005f00: 2222 5374 6f72 6520 7275 6e20 6465 7461  ""Store run deta
+00005f10: 696c 7320 696e 2074 6865 2044 422e 2054  ils in the DB. T
+00005f20: 6869 7320 6d65 7468 6f64 2069 7320 7573  his method is us
+00005f30: 7561 6c6c 7920 6361 6c6c 6564 2066 726f  ually called fro
+00005f40: 6d20 7769 7468 696e 206f 7468 6572 203a  m within other :
+00005f50: 7079 3a6d 6f64 3a60 6d6c 7275 6e60 2066  py:mod:`mlrun` f
+00005f60: 6c6f 7773 0a20 2020 2020 2020 2061 6e64  lows.        and
+00005f70: 206e 6f74 2063 616c 6c65 6420 6469 7265   not called dire
+00005f80: 6374 6c79 2062 7920 7468 6520 7573 6572  ctly by the user
+00005f90: 2e22 2222 0a0a 2020 2020 2020 2020 7061  ."""..        pa
+00005fa0: 7468 203d 2073 656c 662e 5f70 6174 685f  th = self._path_
+00005fb0: 6f66 2822 7275 6e22 2c20 7072 6f6a 6563  of("run", projec
+00005fc0: 742c 2075 6964 290a 2020 2020 2020 2020  t, uid).        
+00005fd0: 7061 7261 6d73 203d 207b 2269 7465 7222  params = {"iter"
+00005fe0: 3a20 6974 6572 7d0a 2020 2020 2020 2020  : iter}.        
+00005ff0: 6572 726f 7220 3d20 6622 7374 6f72 6520  error = f"store 
+00006000: 7275 6e20 7b70 726f 6a65 6374 7d2f 7b75  run {project}/{u
+00006010: 6964 7d22 0a20 2020 2020 2020 2062 6f64  id}".        bod
+00006020: 7920 3d20 5f61 735f 6a73 6f6e 2873 7472  y = _as_json(str
+00006030: 7563 7429 0a20 2020 2020 2020 2073 656c  uct).        sel
+00006040: 662e 6170 695f 6361 6c6c 2822 504f 5354  f.api_call("POST
+00006050: 222c 2070 6174 682c 2065 7272 6f72 2c20  ", path, error, 
+00006060: 7061 7261 6d73 3d70 6172 616d 732c 2062  params=params, b
+00006070: 6f64 793d 626f 6479 290a 0a20 2020 2064  ody=body)..    d
+00006080: 6566 2075 7064 6174 655f 7275 6e28 7365  ef update_run(se
+00006090: 6c66 2c20 7570 6461 7465 733a 2064 6963  lf, updates: dic
+000060a0: 742c 2075 6964 2c20 7072 6f6a 6563 743d  t, uid, project=
+000060b0: 2222 2c20 6974 6572 3d30 2c20 7469 6d65  "", iter=0, time
+000060c0: 6f75 743d 3435 293a 0a20 2020 2020 2020  out=45):.       
+000060d0: 2022 2222 5570 6461 7465 2074 6865 2064   """Update the d
+000060e0: 6574 6169 6c73 206f 6620 6120 7374 6f72  etails of a stor
+000060f0: 6564 2072 756e 2069 6e20 7468 6520 4442  ed run in the DB
+00006100: 2e22 2222 0a0a 2020 2020 2020 2020 7061  ."""..        pa
+00006110: 7468 203d 2073 656c 662e 5f70 6174 685f  th = self._path_
+00006120: 6f66 2822 7275 6e22 2c20 7072 6f6a 6563  of("run", projec
+00006130: 742c 2075 6964 290a 2020 2020 2020 2020  t, uid).        
+00006140: 7061 7261 6d73 203d 207b 2269 7465 7222  params = {"iter"
+00006150: 3a20 6974 6572 7d0a 2020 2020 2020 2020  : iter}.        
+00006160: 6572 726f 7220 3d20 6622 7570 6461 7465  error = f"update
+00006170: 2072 756e 207b 7072 6f6a 6563 747d 2f7b   run {project}/{
+00006180: 7569 647d 220a 2020 2020 2020 2020 626f  uid}".        bo
+00006190: 6479 203d 205f 6173 5f6a 736f 6e28 7570  dy = _as_json(up
+000061a0: 6461 7465 7329 0a20 2020 2020 2020 2073  dates).        s
+000061b0: 656c 662e 6170 695f 6361 6c6c 2822 5041  elf.api_call("PA
+000061c0: 5443 4822 2c20 7061 7468 2c20 6572 726f  TCH", path, erro
+000061d0: 722c 2070 6172 616d 733d 7061 7261 6d73  r, params=params
+000061e0: 2c20 626f 6479 3d62 6f64 792c 2074 696d  , body=body, tim
+000061f0: 656f 7574 3d74 696d 656f 7574 290a 0a20  eout=timeout).. 
+00006200: 2020 2064 6566 2061 626f 7274 5f72 756e     def abort_run
+00006210: 2873 656c 662c 2075 6964 2c20 7072 6f6a  (self, uid, proj
+00006220: 6563 743d 2222 2c20 6974 6572 3d30 2c20  ect="", iter=0, 
+00006230: 7469 6d65 6f75 743d 3435 293a 0a20 2020  timeout=45):.   
+00006240: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00006250: 2041 626f 7274 2061 2072 756e 6e69 6e67   Abort a running
+00006260: 2072 756e 202d 2077 696c 6c20 7265 6d6f   run - will remo
+00006270: 7665 2074 6865 2072 756e 2773 2072 756e  ve the run's run
+00006280: 7469 6d65 2072 6573 6f75 7263 6573 2061  time resources a
+00006290: 6e64 206d 6172 6b20 6974 7320 7374 6174  nd mark its stat
+000062a0: 6520 6173 2061 626f 7274 6564 0a20 2020  e as aborted.   
+000062b0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000062c0: 2073 656c 662e 7570 6461 7465 5f72 756e   self.update_run
+000062d0: 280a 2020 2020 2020 2020 2020 2020 7b22  (.            {"
+000062e0: 7374 6174 7573 2e73 7461 7465 223a 206d  status.state": m
+000062f0: 6c72 756e 2e72 756e 7469 6d65 732e 636f  lrun.runtimes.co
+00006300: 6e73 7461 6e74 732e 5275 6e53 7461 7465  nstants.RunState
+00006310: 732e 6162 6f72 7465 647d 2c0a 2020 2020  s.aborted},.    
+00006320: 2020 2020 2020 2020 7569 642c 0a20 2020          uid,.   
+00006330: 2020 2020 2020 2020 2070 726f 6a65 6374           project
+00006340: 2c0a 2020 2020 2020 2020 2020 2020 6974  ,.            it
+00006350: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+00006360: 7469 6d65 6f75 742c 0a20 2020 2020 2020  timeout,.       
+00006370: 2029 0a0a 2020 2020 6465 6620 7265 6164   )..    def read
+00006380: 5f72 756e 2873 656c 662c 2075 6964 2c20  _run(self, uid, 
+00006390: 7072 6f6a 6563 743d 2222 2c20 6974 6572  project="", iter
+000063a0: 3d30 293a 0a20 2020 2020 2020 2022 2222  =0):.        """
+000063b0: 5265 6164 2074 6865 2064 6574 6169 6c73  Read the details
+000063c0: 206f 6620 6120 7374 6f72 6564 2072 756e   of a stored run
+000063d0: 2066 726f 6d20 7468 6520 4442 2e0a 0a20   from the DB... 
+000063e0: 2020 2020 2020 203a 7061 7261 6d20 7569         :param ui
+000063f0: 643a 2054 6865 2072 756e 2773 2075 6e69  d: The run's uni
+00006400: 7175 6520 4944 2e0a 2020 2020 2020 2020  que ID..        
+00006410: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
+00006420: 5072 6f6a 6563 7420 6e61 6d65 2e0a 2020  Project name..  
+00006430: 2020 2020 2020 3a70 6172 616d 2069 7465        :param ite
+00006440: 723a 2049 7465 7261 7469 6f6e 2077 6974  r: Iteration wit
+00006450: 6869 6e20 6120 7370 6563 6966 6963 2065  hin a specific e
+00006460: 7865 6375 7469 6f6e 2e0a 2020 2020 2020  xecution..      
+00006470: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
+00006480: 6174 6820 3d20 7365 6c66 2e5f 7061 7468  ath = self._path
+00006490: 5f6f 6628 2272 756e 222c 2070 726f 6a65  _of("run", proje
+000064a0: 6374 2c20 7569 6429 0a20 2020 2020 2020  ct, uid).       
+000064b0: 2070 6172 616d 7320 3d20 7b22 6974 6572   params = {"iter
+000064c0: 223a 2069 7465 727d 0a20 2020 2020 2020  ": iter}.       
+000064d0: 2065 7272 6f72 203d 2066 2267 6574 2072   error = f"get r
+000064e0: 756e 207b 7072 6f6a 6563 747d 2f7b 7569  un {project}/{ui
+000064f0: 647d 220a 2020 2020 2020 2020 7265 7370  d}".        resp
+00006500: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+00006510: 2822 4745 5422 2c20 7061 7468 2c20 6572  ("GET", path, er
+00006520: 726f 722c 2070 6172 616d 733d 7061 7261  ror, params=para
+00006530: 6d73 290a 2020 2020 2020 2020 7265 7475  ms).        retu
+00006540: 726e 2072 6573 702e 6a73 6f6e 2829 5b22  rn resp.json()["
+00006550: 6461 7461 225d 0a0a 2020 2020 6465 6620  data"]..    def 
+00006560: 6465 6c5f 7275 6e28 7365 6c66 2c20 7569  del_run(self, ui
+00006570: 642c 2070 726f 6a65 6374 3d22 222c 2069  d, project="", i
+00006580: 7465 723d 3029 3a0a 2020 2020 2020 2020  ter=0):.        
+00006590: 2222 2244 656c 6574 6520 6465 7461 696c  """Delete detail
+000065a0: 7320 6f66 2061 2073 7065 6369 6669 6320  s of a specific 
+000065b0: 7275 6e20 6672 6f6d 2044 422e 0a0a 2020  run from DB...  
+000065c0: 2020 2020 2020 3a70 6172 616d 2075 6964        :param uid
+000065d0: 3a20 556e 6971 7565 2049 4420 666f 7220  : Unique ID for 
+000065e0: 7468 6520 7370 6563 6966 6963 2072 756e  the specific run
+000065f0: 2074 6f20 6465 6c65 7465 2e0a 2020 2020   to delete..    
+00006600: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+00006610: 6374 3a20 5072 6f6a 6563 7420 7468 6174  ct: Project that
+00006620: 2074 6865 2072 756e 2062 656c 6f6e 6773   the run belongs
+00006630: 2074 6f2e 0a20 2020 2020 2020 203a 7061   to..        :pa
+00006640: 7261 6d20 6974 6572 3a20 4974 6572 6174  ram iter: Iterat
+00006650: 696f 6e20 7769 7468 696e 2061 2073 7065  ion within a spe
+00006660: 6369 6669 6320 7461 736b 2e0a 2020 2020  cific task..    
+00006670: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+00006680: 2070 6174 6820 3d20 7365 6c66 2e5f 7061   path = self._pa
+00006690: 7468 5f6f 6628 2272 756e 222c 2070 726f  th_of("run", pro
+000066a0: 6a65 6374 2c20 7569 6429 0a20 2020 2020  ject, uid).     
+000066b0: 2020 2070 6172 616d 7320 3d20 7b22 6974     params = {"it
+000066c0: 6572 223a 2069 7465 727d 0a20 2020 2020  er": iter}.     
+000066d0: 2020 2065 7272 6f72 203d 2066 2264 656c     error = f"del
+000066e0: 2072 756e 207b 7072 6f6a 6563 747d 2f7b   run {project}/{
+000066f0: 7569 647d 220a 2020 2020 2020 2020 7365  uid}".        se
+00006700: 6c66 2e61 7069 5f63 616c 6c28 2244 454c  lf.api_call("DEL
+00006710: 4554 4522 2c20 7061 7468 2c20 6572 726f  ETE", path, erro
+00006720: 722c 2070 6172 616d 733d 7061 7261 6d73  r, params=params
+00006730: 290a 0a20 2020 2064 6566 206c 6973 745f  )..    def list_
+00006740: 7275 6e73 280a 2020 2020 2020 2020 7365  runs(.        se
+00006750: 6c66 2c0a 2020 2020 2020 2020 6e61 6d65  lf,.        name
+00006760: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+00006770: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00006780: 7569 643a 204f 7074 696f 6e61 6c5b 556e  uid: Optional[Un
+00006790: 696f 6e5b 7374 722c 204c 6973 745b 7374  ion[str, List[st
+000067a0: 725d 5d5d 203d 204e 6f6e 652c 0a20 2020  r]]] = None,.   
+000067b0: 2020 2020 2070 726f 6a65 6374 3a20 4f70       project: Op
+000067c0: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
+000067d0: 6e65 2c0a 2020 2020 2020 2020 6c61 6265  ne,.        labe
+000067e0: 6c73 3a20 4f70 7469 6f6e 616c 5b55 6e69  ls: Optional[Uni
+000067f0: 6f6e 5b73 7472 2c20 4c69 7374 5b73 7472  on[str, List[str
+00006800: 5d5d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ]]] = None,.    
+00006810: 2020 2020 7374 6174 653a 204f 7074 696f      state: Optio
+00006820: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+00006830: 0a20 2020 2020 2020 2073 6f72 743a 2062  .        sort: b
+00006840: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
+00006850: 2020 2020 6c61 7374 3a20 696e 7420 3d20      last: int = 
+00006860: 302c 0a20 2020 2020 2020 2069 7465 723a  0,.        iter:
+00006870: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
+00006880: 2020 2020 2020 2073 7461 7274 5f74 696d         start_tim
+00006890: 655f 6672 6f6d 3a20 4f70 7469 6f6e 616c  e_from: Optional
+000068a0: 5b64 6174 6574 696d 655d 203d 204e 6f6e  [datetime] = Non
+000068b0: 652c 0a20 2020 2020 2020 2073 7461 7274  e,.        start
+000068c0: 5f74 696d 655f 746f 3a20 4f70 7469 6f6e  _time_to: Option
+000068d0: 616c 5b64 6174 6574 696d 655d 203d 204e  al[datetime] = N
+000068e0: 6f6e 652c 0a20 2020 2020 2020 206c 6173  one,.        las
+000068f0: 745f 7570 6461 7465 5f74 696d 655f 6672  t_update_time_fr
+00006900: 6f6d 3a20 4f70 7469 6f6e 616c 5b64 6174  om: Optional[dat
+00006910: 6574 696d 655d 203d 204e 6f6e 652c 0a20  etime] = None,. 
+00006920: 2020 2020 2020 206c 6173 745f 7570 6461         last_upda
+00006930: 7465 5f74 696d 655f 746f 3a20 4f70 7469  te_time_to: Opti
+00006940: 6f6e 616c 5b64 6174 6574 696d 655d 203d  onal[datetime] =
+00006950: 204e 6f6e 652c 0a20 2020 2020 2020 2070   None,.        p
+00006960: 6172 7469 7469 6f6e 5f62 793a 204f 7074  artition_by: Opt
+00006970: 696f 6e61 6c5b 0a20 2020 2020 2020 2020  ional[.         
+00006980: 2020 2055 6e69 6f6e 5b6d 6c72 756e 2e63     Union[mlrun.c
+00006990: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5275  ommon.schemas.Ru
+000069a0: 6e50 6172 7469 7469 6f6e 4279 4669 656c  nPartitionByFiel
+000069b0: 642c 2073 7472 5d0a 2020 2020 2020 2020  d, str].        
+000069c0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+000069d0: 2020 726f 7773 5f70 6572 5f70 6172 7469    rows_per_parti
+000069e0: 7469 6f6e 3a20 696e 7420 3d20 312c 0a20  tion: int = 1,. 
+000069f0: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+00006a00: 5f73 6f72 745f 6279 3a20 4f70 7469 6f6e  _sort_by: Option
+00006a10: 616c 5b55 6e69 6f6e 5b6d 6c72 756e 2e63  al[Union[mlrun.c
+00006a20: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 536f  ommon.schemas.So
+00006a30: 7274 4669 656c 642c 2073 7472 5d5d 203d  rtField, str]] =
+00006a40: 204e 6f6e 652c 0a20 2020 2020 2020 2070   None,.        p
+00006a50: 6172 7469 7469 6f6e 5f6f 7264 6572 3a20  artition_order: 
+00006a60: 556e 696f 6e5b 0a20 2020 2020 2020 2020  Union[.         
+00006a70: 2020 206d 6c72 756e 2e63 6f6d 6d6f 6e2e     mlrun.common.
+00006a80: 7363 6865 6d61 732e 4f72 6465 7254 7970  schemas.OrderTyp
+00006a90: 652c 2073 7472 0a20 2020 2020 2020 205d  e, str.        ]
+00006aa0: 203d 206d 6c72 756e 2e63 6f6d 6d6f 6e2e   = mlrun.common.
+00006ab0: 7363 6865 6d61 732e 4f72 6465 7254 7970  schemas.OrderTyp
+00006ac0: 652e 6465 7363 2c0a 2020 2020 2020 2020  e.desc,.        
+00006ad0: 6d61 785f 7061 7274 6974 696f 6e73 3a20  max_partitions: 
+00006ae0: 696e 7420 3d20 302c 0a20 2020 2020 2020  int = 0,.       
+00006af0: 2077 6974 685f 6e6f 7469 6669 6361 7469   with_notificati
+00006b00: 6f6e 733a 2062 6f6f 6c20 3d20 4661 6c73  ons: bool = Fals
+00006b10: 652c 0a20 2020 2029 202d 3e20 5275 6e4c  e,.    ) -> RunL
+00006b20: 6973 743a 0a20 2020 2020 2020 2022 2222  ist:.        """
+00006b30: 5265 7472 6965 7665 2061 206c 6973 7420  Retrieve a list 
+00006b40: 6f66 2072 756e 732c 2066 696c 7465 7265  of runs, filtere
+00006b50: 6420 6279 2076 6172 696f 7573 206f 7074  d by various opt
+00006b60: 696f 6e73 2e0a 2020 2020 2020 2020 4578  ions..        Ex
+00006b70: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00006b80: 2020 2020 2072 756e 7320 3d20 6462 2e6c       runs = db.l
+00006b90: 6973 745f 7275 6e73 286e 616d 653d 2764  ist_runs(name='d
+00006ba0: 6f77 6e6c 6f61 6427 2c20 7072 6f6a 6563  ownload', projec
+00006bb0: 743d 2769 7269 7327 2c20 6c61 6265 6c73  t='iris', labels
+00006bc0: 3d5b 276f 776e 6572 3d61 646d 696e 272c  =['owner=admin',
+00006bd0: 2027 6b69 6e64 3d6a 6f62 275d 290a 2020   'kind=job']).  
+00006be0: 2020 2020 2020 2020 2020 2320 4966 2072            # If r
+00006bf0: 756e 6e69 6e67 2069 6e20 4a75 7079 7465  unning in Jupyte
+00006c00: 722c 2063 616e 2075 7365 2074 6865 202e  r, can use the .
+00006c10: 7368 6f77 2829 2066 756e 6374 696f 6e20  show() function 
+00006c20: 746f 2064 6973 706c 6179 2074 6865 2072  to display the r
+00006c30: 6573 756c 7473 0a20 2020 2020 2020 2020  esults.         
+00006c40: 2020 2064 622e 6c69 7374 5f72 756e 7328     db.list_runs(
+00006c50: 6e61 6d65 3d27 272c 2070 726f 6a65 6374  name='', project
+00006c60: 3d70 726f 6a65 6374 5f6e 616d 6529 2e73  =project_name).s
+00006c70: 686f 7728 290a 0a0a 2020 2020 2020 2020  how()...        
+00006c80: 3a70 6172 616d 206e 616d 653a 204e 616d  :param name: Nam
+00006c90: 6520 6f66 2074 6865 2072 756e 2074 6f20  e of the run to 
+00006ca0: 7265 7472 6965 7665 2e0a 2020 2020 2020  retrieve..      
+00006cb0: 2020 3a70 6172 616d 2075 6964 3a20 556e    :param uid: Un
+00006cc0: 6971 7565 2049 4420 6f66 2074 6865 2072  ique ID of the r
+00006cd0: 756e 2c20 6f72 2061 206c 6973 7420 6f66  un, or a list of
+00006ce0: 2072 756e 2055 4944 732e 0a20 2020 2020   run UIDs..     
+00006cf0: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
+00006d00: 743a 2050 726f 6a65 6374 2074 6861 7420  t: Project that 
+00006d10: 7468 6520 7275 6e73 2062 656c 6f6e 6773  the runs belongs
+00006d20: 2074 6f2e 0a20 2020 2020 2020 203a 7061   to..        :pa
+00006d30: 7261 6d20 6c61 6265 6c73 3a20 4c69 7374  ram labels: List
+00006d40: 2072 756e 7320 7468 6174 2068 6176 6520   runs that have 
+00006d50: 7370 6563 6966 6963 206c 6162 656c 7320  specific labels 
+00006d60: 6173 7369 676e 6564 2e20 6120 7369 6e67  assigned. a sing
+00006d70: 6c65 206f 7220 6d75 6c74 6920 6c61 6265  le or multi labe
+00006d80: 6c20 6669 6c74 6572 2063 616e 2062 650a  l filter can be.
+00006d90: 2020 2020 2020 2020 2020 2020 6170 706c              appl
+00006da0: 6965 642e 0a20 2020 2020 2020 203a 7061  ied..        :pa
+00006db0: 7261 6d20 7374 6174 653a 204c 6973 7420  ram state: List 
+00006dc0: 6f6e 6c79 2072 756e 7320 7768 6f73 6520  only runs whose 
+00006dd0: 7374 6174 6520 6973 2073 7065 6369 6669  state is specifi
+00006de0: 6564 2e0a 2020 2020 2020 2020 3a70 6172  ed..        :par
+00006df0: 616d 2073 6f72 743a 2057 6865 7468 6572  am sort: Whether
+00006e00: 2074 6f20 736f 7274 2074 6865 2072 6573   to sort the res
+00006e10: 756c 7420 6163 636f 7264 696e 6720 746f  ult according to
+00006e20: 2074 6865 6972 2073 7461 7274 2074 696d   their start tim
+00006e30: 652e 204f 7468 6572 7769 7365 2c20 7265  e. Otherwise, re
+00006e40: 7375 6c74 7320 7769 6c6c 2062 650a 2020  sults will be.  
+00006e50: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00006e60: 6564 2062 7920 7468 6569 7220 696e 7465  ed by their inte
+00006e70: 726e 616c 206f 7264 6572 2069 6e20 7468  rnal order in th
+00006e80: 6520 4442 2028 6f72 6465 7220 7769 6c6c  e DB (order will
+00006e90: 206e 6f74 2062 6520 6775 6172 616e 7465   not be guarante
+00006ea0: 6564 292e 0a20 2020 2020 2020 203a 7061  ed)..        :pa
+00006eb0: 7261 6d20 6c61 7374 3a20 4465 7072 6563  ram last: Deprec
+00006ec0: 6174 6564 202d 2063 7572 7265 6e74 6c79  ated - currently
+00006ed0: 206e 6f74 2075 7365 642e 0a20 2020 2020   not used..     
+00006ee0: 2020 203a 7061 7261 6d20 6974 6572 3a20     :param iter: 
+00006ef0: 4966 2060 6054 7275 6560 6020 7265 7475  If ``True`` retu
+00006f00: 726e 2072 756e 7320 6672 6f6d 2061 6c6c  rn runs from all
+00006f10: 2069 7465 7261 7469 6f6e 732e 204f 7468   iterations. Oth
+00006f20: 6572 7769 7365 2c20 7265 7475 726e 206f  erwise, return o
+00006f30: 6e6c 7920 7275 6e73 2077 686f 7365 2060  nly runs whose `
+00006f40: 6069 7465 7260 6020 6973 2030 2e0a 2020  `iter`` is 0..  
+00006f50: 2020 2020 2020 3a70 6172 616d 2073 7461        :param sta
+00006f60: 7274 5f74 696d 655f 6672 6f6d 3a20 4669  rt_time_from: Fi
+00006f70: 6c74 6572 2062 7920 7275 6e20 7374 6172  lter by run star
+00006f80: 7420 7469 6d65 2069 6e20 6060 5b73 7461  t time in ``[sta
+00006f90: 7274 5f74 696d 655f 6672 6f6d 2c20 7374  rt_time_from, st
+00006fa0: 6172 745f 7469 6d65 5f74 6f5d 6060 2e0a  art_time_to]``..
+00006fb0: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+00006fc0: 7461 7274 5f74 696d 655f 746f 3a20 4669  tart_time_to: Fi
+00006fd0: 6c74 6572 2062 7920 7275 6e20 7374 6172  lter by run star
+00006fe0: 7420 7469 6d65 2069 6e20 6060 5b73 7461  t time in ``[sta
+00006ff0: 7274 5f74 696d 655f 6672 6f6d 2c20 7374  rt_time_from, st
+00007000: 6172 745f 7469 6d65 5f74 6f5d 6060 2e0a  art_time_to]``..
+00007010: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
+00007020: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
+00007030: 6672 6f6d 3a20 4669 6c74 6572 2062 7920  from: Filter by 
+00007040: 7275 6e20 6c61 7374 2075 7064 6174 6520  run last update 
+00007050: 7469 6d65 2069 6e20 6060 286c 6173 745f  time in ``(last_
+00007060: 7570 6461 7465 5f74 696d 655f 6672 6f6d  update_time_from
+00007070: 2c0a 2020 2020 2020 2020 2020 2020 6c61  ,.            la
+00007080: 7374 5f75 7064 6174 655f 7469 6d65 5f74  st_update_time_t
+00007090: 6f29 6060 2e0a 2020 2020 2020 2020 3a70  o)``..        :p
+000070a0: 6172 616d 206c 6173 745f 7570 6461 7465  aram last_update
+000070b0: 5f74 696d 655f 746f 3a20 4669 6c74 6572  _time_to: Filter
+000070c0: 2062 7920 7275 6e20 6c61 7374 2075 7064   by run last upd
+000070d0: 6174 6520 7469 6d65 2069 6e20 6060 286c  ate time in ``(l
+000070e0: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
+000070f0: 6672 6f6d 2c20 6c61 7374 5f75 7064 6174  from, last_updat
+00007100: 655f 7469 6d65 5f74 6f29 6060 2e0a 2020  e_time_to)``..  
+00007110: 2020 2020 2020 3a70 6172 616d 2070 6172        :param par
+00007120: 7469 7469 6f6e 5f62 793a 2046 6965 6c64  tition_by: Field
+00007130: 2074 6f20 6772 6f75 7020 7265 7375 6c74   to group result
+00007140: 7320 6279 2e20 4f6e 6c79 2061 6c6c 6f77  s by. Only allow
+00007150: 6564 2076 616c 7565 2069 7320 606e 616d  ed value is `nam
+00007160: 6560 2e20 5768 656e 2060 7061 7274 6974  e`. When `partit
+00007170: 696f 6e5f 6279 6020 6973 2073 7065 6369  ion_by` is speci
+00007180: 6669 6564 2c0a 2020 2020 2020 2020 2020  fied,.          
+00007190: 2020 7468 6520 6070 6172 7469 7469 6f6e    the `partition
+000071a0: 5f73 6f72 745f 6279 6020 7061 7261 6d65  _sort_by` parame
+000071b0: 7465 7220 6d75 7374 2062 6520 7072 6f76  ter must be prov
+000071c0: 6964 6564 2061 7320 7765 6c6c 2e0a 2020  ided as well..  
+000071d0: 2020 2020 2020 3a70 6172 616d 2072 6f77        :param row
+000071e0: 735f 7065 725f 7061 7274 6974 696f 6e3a  s_per_partition:
+000071f0: 2048 6f77 206d 616e 7920 746f 7020 726f   How many top ro
+00007200: 7773 2028 7065 7220 736f 7274 696e 6720  ws (per sorting 
+00007210: 6465 6669 6e65 6420 6279 2060 7061 7274  defined by `part
+00007220: 6974 696f 6e5f 736f 7274 5f62 7960 2061  ition_sort_by` a
+00007230: 6e64 2060 7061 7274 6974 696f 6e5f 6f72  nd `partition_or
+00007240: 6465 7260 290a 2020 2020 2020 2020 2020  der`).          
+00007250: 2020 746f 2072 6574 7572 6e20 7065 7220    to return per 
+00007260: 6772 6f75 702e 2044 6566 6175 6c74 2076  group. Default v
+00007270: 616c 7565 2069 7320 312e 0a20 2020 2020  alue is 1..     
+00007280: 2020 203a 7061 7261 6d20 7061 7274 6974     :param partit
+00007290: 696f 6e5f 736f 7274 5f62 793a 2057 6861  ion_sort_by: Wha
+000072a0: 7420 6669 656c 6420 746f 2073 6f72 7420  t field to sort 
+000072b0: 7468 6520 7265 7375 6c74 7320 6279 2c20  the results by, 
+000072c0: 7769 7468 696e 2065 6163 6820 7061 7274  within each part
+000072d0: 6974 696f 6e20 6465 6669 6e65 6420 6279  ition defined by
+000072e0: 2060 7061 7274 6974 696f 6e5f 6279 602e   `partition_by`.
+000072f0: 0a20 2020 2020 2020 2020 2020 2043 7572  .            Cur
+00007300: 7265 6e74 6c79 2074 6865 206f 6e6c 7920  rently the only 
+00007310: 616c 6c6f 7765 6420 7661 6c75 6573 2061  allowed values a
+00007320: 7265 2060 6372 6561 7465 6460 2061 6e64  re `created` and
+00007330: 2060 7570 6461 7465 6460 2e0a 2020 2020   `updated`..    
+00007340: 2020 2020 3a70 6172 616d 2070 6172 7469      :param parti
+00007350: 7469 6f6e 5f6f 7264 6572 3a20 4f72 6465  tion_order: Orde
+00007360: 7220 6f66 2073 6f72 7469 6e67 2077 6974  r of sorting wit
+00007370: 6869 6e20 7061 7274 6974 696f 6e73 202d  hin partitions -
+00007380: 2060 6173 6360 206f 7220 6064 6573 6360   `asc` or `desc`
+00007390: 2e20 4465 6661 756c 7420 6973 2060 6465  . Default is `de
+000073a0: 7363 602e 0a20 2020 2020 2020 203a 7061  sc`..        :pa
+000073b0: 7261 6d20 6d61 785f 7061 7274 6974 696f  ram max_partitio
+000073c0: 6e73 3a20 4d61 7869 6d61 6c20 6e75 6d62  ns: Maximal numb
+000073d0: 6572 206f 6620 7061 7274 6974 696f 6e73  er of partitions
+000073e0: 2074 6f20 696e 636c 7564 6520 696e 2074   to include in t
+000073f0: 6865 2072 6573 756c 742e 2044 6566 6175  he result. Defau
+00007400: 6c74 2069 7320 6030 6020 7768 6963 6820  lt is `0` which 
+00007410: 6d65 616e 7320 6e6f 0a20 2020 2020 2020  means no.       
+00007420: 2020 2020 206c 696d 6974 2e0a 2020 2020       limit..    
+00007430: 2020 2020 3a70 6172 616d 2077 6974 685f      :param with_
+00007440: 6e6f 7469 6669 6361 7469 6f6e 733a 2052  notifications: R
+00007450: 6574 7572 6e20 7275 6e73 2077 6974 6820  eturn runs with 
+00007460: 6e6f 7469 6669 6361 7469 6f6e 732c 2061  notifications, a
+00007470: 6e64 206a 6f69 6e20 7468 656d 2074 6f20  nd join them to 
+00007480: 7468 6520 7265 7370 6f6e 7365 2e20 4465  the response. De
+00007490: 6661 756c 7420 6973 2060 4661 6c73 6560  fault is `False`
+000074a0: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+000074b0: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
+000074c0: 2070 726f 6a65 6374 206f 7220 636f 6e66   project or conf
+000074d0: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
+000074e0: 6374 0a20 2020 2020 2020 2070 6172 616d  ct.        param
+000074f0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+00007500: 2020 226e 616d 6522 3a20 6e61 6d65 2c0a    "name": name,.
+00007510: 2020 2020 2020 2020 2020 2020 2275 6964              "uid
+00007520: 223a 2075 6964 2c0a 2020 2020 2020 2020  ": uid,.        
+00007530: 2020 2020 2270 726f 6a65 6374 223a 2070      "project": p
+00007540: 726f 6a65 6374 2c0a 2020 2020 2020 2020  roject,.        
+00007550: 2020 2020 226c 6162 656c 223a 206c 6162      "label": lab
+00007560: 656c 7320 6f72 205b 5d2c 0a20 2020 2020  els or [],.     
+00007570: 2020 2020 2020 2022 7374 6174 6522 3a20         "state": 
+00007580: 7374 6174 652c 0a20 2020 2020 2020 2020  state,.         
+00007590: 2020 2022 736f 7274 223a 2062 6f6f 6c32     "sort": bool2
+000075a0: 7374 7228 736f 7274 292c 0a20 2020 2020  str(sort),.     
+000075b0: 2020 2020 2020 2022 6974 6572 223a 2062         "iter": b
+000075c0: 6f6f 6c32 7374 7228 6974 6572 292c 0a20  ool2str(iter),. 
+000075d0: 2020 2020 2020 2020 2020 2022 7374 6172             "star
+000075e0: 745f 7469 6d65 5f66 726f 6d22 3a20 6461  t_time_from": da
+000075f0: 7465 7469 6d65 5f74 6f5f 6973 6f28 7374  tetime_to_iso(st
+00007600: 6172 745f 7469 6d65 5f66 726f 6d29 2c0a  art_time_from),.
+00007610: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
+00007620: 7274 5f74 696d 655f 746f 223a 2064 6174  rt_time_to": dat
+00007630: 6574 696d 655f 746f 5f69 736f 2873 7461  etime_to_iso(sta
+00007640: 7274 5f74 696d 655f 746f 292c 0a20 2020  rt_time_to),.   
+00007650: 2020 2020 2020 2020 2022 6c61 7374 5f75           "last_u
+00007660: 7064 6174 655f 7469 6d65 5f66 726f 6d22  pdate_time_from"
+00007670: 3a20 6461 7465 7469 6d65 5f74 6f5f 6973  : datetime_to_is
+00007680: 6f28 6c61 7374 5f75 7064 6174 655f 7469  o(last_update_ti
+00007690: 6d65 5f66 726f 6d29 2c0a 2020 2020 2020  me_from),.      
+000076a0: 2020 2020 2020 226c 6173 745f 7570 6461        "last_upda
+000076b0: 7465 5f74 696d 655f 746f 223a 2064 6174  te_time_to": dat
+000076c0: 6574 696d 655f 746f 5f69 736f 286c 6173  etime_to_iso(las
+000076d0: 745f 7570 6461 7465 5f74 696d 655f 746f  t_update_time_to
+000076e0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+000076f0: 7769 7468 2d6e 6f74 6966 6963 6174 696f  with-notificatio
+00007700: 6e73 223a 2077 6974 685f 6e6f 7469 6669  ns": with_notifi
+00007710: 6361 7469 6f6e 732c 0a20 2020 2020 2020  cations,.       
+00007720: 207d 0a0a 2020 2020 2020 2020 6966 2070   }..        if p
+00007730: 6172 7469 7469 6f6e 5f62 793a 0a20 2020  artition_by:.   
+00007740: 2020 2020 2020 2020 2070 6172 616d 732e           params.
+00007750: 7570 6461 7465 280a 2020 2020 2020 2020  update(.        
+00007760: 2020 2020 2020 2020 7365 6c66 2e5f 6765          self._ge
+00007770: 6e65 7261 7465 5f70 6172 7469 7469 6f6e  nerate_partition
+00007780: 5f62 795f 7061 7261 6d73 280a 2020 2020  _by_params(.    
+00007790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000077a0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+000077b0: 656d 6173 2e52 756e 5061 7274 6974 696f  emas.RunPartitio
+000077c0: 6e42 7946 6965 6c64 2c0a 2020 2020 2020  nByField,.      
+000077d0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+000077e0: 7274 6974 696f 6e5f 6279 2c0a 2020 2020  rtition_by,.    
+000077f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007800: 726f 7773 5f70 6572 5f70 6172 7469 7469  rows_per_partiti
+00007810: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00007820: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
+00007830: 6e5f 736f 7274 5f62 792c 0a20 2020 2020  n_sort_by,.     
+00007840: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00007850: 6172 7469 7469 6f6e 5f6f 7264 6572 2c0a  artition_order,.
+00007860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007870: 2020 2020 6d61 785f 7061 7274 6974 696f      max_partitio
+00007880: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
+00007890: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000078a0: 2020 290a 2020 2020 2020 2020 6572 726f    ).        erro
+000078b0: 7220 3d20 226c 6973 7420 7275 6e73 220a  r = "list runs".
+000078c0: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
+000078d0: 656c 662e 6170 695f 6361 6c6c 2822 4745  elf.api_call("GE
+000078e0: 5422 2c20 2272 756e 7322 2c20 6572 726f  T", "runs", erro
+000078f0: 722c 2070 6172 616d 733d 7061 7261 6d73  r, params=params
+00007900: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00007910: 2052 756e 4c69 7374 2872 6573 702e 6a73   RunList(resp.js
+00007920: 6f6e 2829 5b22 7275 6e73 225d 290a 0a20  on()["runs"]).. 
+00007930: 2020 2064 6566 2064 656c 5f72 756e 7328     def del_runs(
+00007940: 7365 6c66 2c20 6e61 6d65 3d4e 6f6e 652c  self, name=None,
+00007950: 2070 726f 6a65 6374 3d4e 6f6e 652c 206c   project=None, l
+00007960: 6162 656c 733d 4e6f 6e65 2c20 7374 6174  abels=None, stat
+00007970: 653d 4e6f 6e65 2c20 6461 7973 5f61 676f  e=None, days_ago
+00007980: 3d30 293a 0a20 2020 2020 2020 2022 2222  =0):.        """
+00007990: 4465 6c65 7465 2061 2067 726f 7570 206f  Delete a group o
+000079a0: 6620 7275 6e73 2069 6465 6e74 6966 6965  f runs identifie
+000079b0: 6420 6279 2074 6865 2070 6172 616d 6574  d by the paramet
+000079c0: 6572 7320 6f66 2074 6865 2066 756e 6374  ers of the funct
+000079d0: 696f 6e2e 0a0a 2020 2020 2020 2020 4578  ion...        Ex
+000079e0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+000079f0: 2020 2020 2064 622e 6465 6c5f 7275 6e73       db.del_runs
+00007a00: 2873 7461 7465 3d27 636f 6d70 6c65 7465  (state='complete
+00007a10: 6427 290a 0a20 2020 2020 2020 203a 7061  d')..        :pa
+00007a20: 7261 6d20 6e61 6d65 3a20 4e61 6d65 206f  ram name: Name o
+00007a30: 6620 7468 6520 7461 736b 2077 6869 6368  f the task which
+00007a40: 2074 6865 2072 756e 7320 6265 6c6f 6e67   the runs belong
+00007a50: 2074 6f2e 0a20 2020 2020 2020 203a 7061   to..        :pa
+00007a60: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
+00007a70: 6a65 6374 2074 6f20 7768 6963 6820 7468  ject to which th
+00007a80: 6520 7275 6e73 2062 656c 6f6e 672e 0a20  e runs belong.. 
+00007a90: 2020 2020 2020 203a 7061 7261 6d20 6c61         :param la
+00007aa0: 6265 6c73 3a20 4669 6c74 6572 2072 756e  bels: Filter run
+00007ab0: 7320 7468 6174 2061 7265 206c 6162 656c  s that are label
+00007ac0: 6564 2075 7369 6e67 2074 6865 7365 2073  ed using these s
+00007ad0: 7065 6369 6669 6320 6c61 6265 6c20 7661  pecific label va
+00007ae0: 6c75 6573 2e0a 2020 2020 2020 2020 3a70  lues..        :p
+00007af0: 6172 616d 2073 7461 7465 3a20 4669 6c74  aram state: Filt
+00007b00: 6572 206f 6e6c 7920 7275 6e73 2077 6869  er only runs whi
+00007b10: 6368 2061 7265 2069 6e20 7468 6973 2073  ch are in this s
+00007b20: 7461 7465 2e0a 2020 2020 2020 2020 3a70  tate..        :p
+00007b30: 6172 616d 2064 6179 735f 6167 6f3a 2046  aram days_ago: F
+00007b40: 696c 7465 7220 7275 6e73 2077 686f 7365  ilter runs whose
+00007b50: 2073 7461 7274 2074 696d 6520 6973 206e   start time is n
+00007b60: 6577 6572 2074 6861 6e20 7468 6973 2070  ewer than this p
+00007b70: 6172 616d 6574 6572 2e0a 2020 2020 2020  arameter..      
+00007b80: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
+00007b90: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
+00007ba0: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
+00007bb0: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
+00007bc0: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
+00007bd0: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
+00007be0: 3a20 6e61 6d65 2c0a 2020 2020 2020 2020  : name,.        
+00007bf0: 2020 2020 2270 726f 6a65 6374 223a 2070      "project": p
+00007c00: 726f 6a65 6374 2c0a 2020 2020 2020 2020  roject,.        
+00007c10: 2020 2020 226c 6162 656c 223a 206c 6162      "label": lab
+00007c20: 656c 7320 6f72 205b 5d2c 0a20 2020 2020  els or [],.     
+00007c30: 2020 2020 2020 2022 7374 6174 6522 3a20         "state": 
+00007c40: 7374 6174 652c 0a20 2020 2020 2020 2020  state,.         
+00007c50: 2020 2022 6461 7973 5f61 676f 223a 2073     "days_ago": s
+00007c60: 7472 2864 6179 735f 6167 6f29 2c0a 2020  tr(days_ago),.  
+00007c70: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00007c80: 6572 726f 7220 3d20 2264 656c 2072 756e  error = "del run
+00007c90: 7322 0a20 2020 2020 2020 2073 656c 662e  s".        self.
+00007ca0: 6170 695f 6361 6c6c 2822 4445 4c45 5445  api_call("DELETE
+00007cb0: 222c 2022 7275 6e73 222c 2065 7272 6f72  ", "runs", error
+00007cc0: 2c20 7061 7261 6d73 3d70 6172 616d 7329  , params=params)
+00007cd0: 0a0a 2020 2020 6465 6620 7374 6f72 655f  ..    def store_
+00007ce0: 6172 7469 6661 6374 2873 656c 662c 206b  artifact(self, k
+00007cf0: 6579 2c20 6172 7469 6661 6374 2c20 7569  ey, artifact, ui
+00007d00: 642c 2069 7465 723d 4e6f 6e65 2c20 7461  d, iter=None, ta
+00007d10: 673d 4e6f 6e65 2c20 7072 6f6a 6563 743d  g=None, project=
+00007d20: 2222 293a 0a20 2020 2020 2020 2022 2222  ""):.        """
+00007d30: 5374 6f72 6520 616e 2061 7274 6966 6163  Store an artifac
+00007d40: 7420 696e 2074 6865 2044 422e 0a0a 2020  t in the DB...  
+00007d50: 2020 2020 2020 3a70 6172 616d 206b 6579        :param key
+00007d60: 3a20 4964 656e 7469 6679 696e 6720 6b65  : Identifying ke
+00007d70: 7920 6f66 2074 6865 2061 7274 6966 6163  y of the artifac
+00007d80: 742e 0a20 2020 2020 2020 203a 7061 7261  t..        :para
+00007d90: 6d20 6172 7469 6661 6374 3a20 5468 6520  m artifact: The 
+00007da0: 6163 7475 616c 2061 7274 6966 6163 7420  actual artifact 
+00007db0: 746f 2073 746f 7265 2e0a 2020 2020 2020  to store..      
+00007dc0: 2020 3a70 6172 616d 2075 6964 3a20 4120    :param uid: A 
+00007dd0: 756e 6971 7565 2049 4420 666f 7220 7468  unique ID for th
+00007de0: 6973 2073 7065 6369 6669 6320 7665 7273  is specific vers
+00007df0: 696f 6e20 6f66 2074 6865 2061 7274 6966  ion of the artif
+00007e00: 6163 742e 0a20 2020 2020 2020 203a 7061  act..        :pa
+00007e10: 7261 6d20 6974 6572 3a20 5468 6520 7461  ram iter: The ta
+00007e20: 736b 2069 7465 7261 7469 6f6e 2077 6869  sk iteration whi
+00007e30: 6368 2067 656e 6572 6174 6564 2074 6869  ch generated thi
+00007e40: 7320 6172 7469 6661 6374 2e20 4966 2060  s artifact. If `
+00007e50: 6069 7465 7260 6020 6973 206e 6f74 2060  `iter`` is not `
+00007e60: 604e 6f6e 6560 6020 7468 6520 6974 6572  `None`` the iter
+00007e70: 6174 696f 6e20 7769 6c6c 0a20 2020 2020  ation will.     
+00007e80: 2020 2020 2020 2062 6520 6164 6465 6420         be added 
+00007e90: 746f 2074 6865 206b 6579 2070 726f 7669  to the key provi
+00007ea0: 6465 6420 746f 2067 656e 6572 6174 6520  ded to generate 
+00007eb0: 6120 756e 6971 7565 206b 6579 2066 6f72  a unique key for
+00007ec0: 2074 6865 2061 7274 6966 6163 7420 6f66   the artifact of
+00007ed0: 2074 6865 2073 7065 6369 6669 6320 6974   the specific it
+00007ee0: 6572 6174 696f 6e2e 0a20 2020 2020 2020  eration..       
+00007ef0: 203a 7061 7261 6d20 7461 673a 2054 6167   :param tag: Tag
+00007f00: 206f 6620 7468 6520 6172 7469 6661 6374   of the artifact
+00007f10: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00007f20: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
+00007f30: 7420 7468 6174 2074 6865 2061 7274 6966  t that the artif
+00007f40: 6163 7420 6265 6c6f 6e67 7320 746f 2e0a  act belongs to..
+00007f50: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+00007f60: 2020 2020 2065 6e64 706f 696e 745f 7061       endpoint_pa
+00007f70: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+00007f80: 7b70 726f 6a65 6374 7d2f 6172 7469 6661  {project}/artifa
+00007f90: 6374 732f 7b75 6964 7d2f 7b6b 6579 7d22  cts/{uid}/{key}"
+00007fa0: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+00007fb0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00007fc0: 2274 6167 223a 2074 6167 2c0a 2020 2020  "tag": tag,.    
+00007fd0: 2020 2020 7d0a 2020 2020 2020 2020 6966      }.        if
+00007fe0: 2069 7465 723a 0a20 2020 2020 2020 2020   iter:.         
+00007ff0: 2020 2070 6172 616d 735b 2269 7465 7222     params["iter"
+00008000: 5d20 3d20 7374 7228 6974 6572 290a 0a20  ] = str(iter).. 
+00008010: 2020 2020 2020 2065 7272 6f72 203d 2066         error = f
+00008020: 2273 746f 7265 2061 7274 6966 6163 7420  "store artifact 
+00008030: 7b70 726f 6a65 6374 7d2f 7b75 6964 7d2f  {project}/{uid}/
+00008040: 7b6b 6579 7d22 0a0a 2020 2020 2020 2020  {key}"..        
+00008050: 626f 6479 203d 205f 6173 5f6a 736f 6e28  body = _as_json(
+00008060: 6172 7469 6661 6374 290a 2020 2020 2020  artifact).      
+00008070: 2020 7365 6c66 2e61 7069 5f63 616c 6c28    self.api_call(
+00008080: 2250 4f53 5422 2c20 656e 6470 6f69 6e74  "POST", endpoint
+00008090: 5f70 6174 682c 2065 7272 6f72 2c20 7061  _path, error, pa
+000080a0: 7261 6d73 3d70 6172 616d 732c 2062 6f64  rams=params, bod
+000080b0: 793d 626f 6479 290a 0a20 2020 2064 6566  y=body)..    def
+000080c0: 2072 6561 645f 6172 7469 6661 6374 2873   read_artifact(s
+000080d0: 656c 662c 206b 6579 2c20 7461 673d 4e6f  elf, key, tag=No
+000080e0: 6e65 2c20 6974 6572 3d4e 6f6e 652c 2070  ne, iter=None, p
+000080f0: 726f 6a65 6374 3d22 2229 3a0a 2020 2020  roject=""):.    
+00008100: 2020 2020 2222 2252 6561 6420 616e 2061      """Read an a
+00008110: 7274 6966 6163 742c 2069 6465 6e74 6966  rtifact, identif
+00008120: 6965 6420 6279 2069 7473 206b 6579 2c20  ied by its key, 
+00008130: 7461 6720 616e 6420 6974 6572 6174 696f  tag and iteratio
+00008140: 6e2e 2222 220a 0a20 2020 2020 2020 2070  n."""..        p
+00008150: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
+00008160: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
+00008170: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
+00008180: 2020 2074 6167 203d 2074 6167 206f 7220     tag = tag or 
+00008190: 226c 6174 6573 7422 0a20 2020 2020 2020  "latest".       
+000081a0: 2065 6e64 706f 696e 745f 7061 7468 203d   endpoint_path =
+000081b0: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
+000081c0: 6a65 6374 7d2f 6172 7469 6661 6374 732f  ject}/artifacts/
+000081d0: 7b6b 6579 7d3f 7461 673d 7b74 6167 7d22  {key}?tag={tag}"
+000081e0: 0a20 2020 2020 2020 2065 7272 6f72 203d  .        error =
+000081f0: 2066 2272 6561 6420 6172 7469 6661 6374   f"read artifact
+00008200: 207b 7072 6f6a 6563 747d 2f7b 6b65 797d   {project}/{key}
+00008210: 220a 2020 2020 2020 2020 2320 6578 706c  ".        # expl
+00008220: 6963 6974 6c79 2073 6574 2061 7274 6966  icitly set artif
+00008230: 6163 7473 2066 6f72 6d61 7420 746f 2027  acts format to '
+00008240: 6675 6c6c 2720 7369 6e63 6520 6f6c 6420  full' since old 
+00008250: 7365 7276 6572 7320 6d61 7920 6465 6661  servers may defa
+00008260: 756c 7420 746f 2027 6c65 6761 6379 270a  ult to 'legacy'.
+00008270: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+00008280: 207b 2266 6f72 6d61 7422 3a20 6d6c 7275   {"format": mlru
+00008290: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+000082a0: 2e41 7274 6966 6163 7473 466f 726d 6174  .ArtifactsFormat
+000082b0: 2e66 756c 6c2e 7661 6c75 657d 0a20 2020  .full.value}.   
+000082c0: 2020 2020 2069 6620 6974 6572 3a0a 2020       if iter:.  
+000082d0: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+000082e0: 5b22 6974 6572 225d 203d 2073 7472 2869  ["iter"] = str(i
+000082f0: 7465 7229 0a20 2020 2020 2020 2072 6573  ter).        res
+00008300: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
+00008310: 6c28 2247 4554 222c 2065 6e64 706f 696e  l("GET", endpoin
+00008320: 745f 7061 7468 2c20 6572 726f 722c 2070  t_path, error, p
+00008330: 6172 616d 733d 7061 7261 6d73 290a 2020  arams=params).  
+00008340: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+00008350: 702e 6a73 6f6e 2829 5b22 6461 7461 225d  p.json()["data"]
+00008360: 0a0a 2020 2020 6465 6620 6465 6c5f 6172  ..    def del_ar
+00008370: 7469 6661 6374 2873 656c 662c 206b 6579  tifact(self, key
+00008380: 2c20 7461 673d 4e6f 6e65 2c20 7072 6f6a  , tag=None, proj
+00008390: 6563 743d 2222 293a 0a20 2020 2020 2020  ect=""):.       
+000083a0: 2022 2222 4465 6c65 7465 2061 6e20 6172   """Delete an ar
+000083b0: 7469 6661 6374 2e22 2222 0a0a 2020 2020  tifact."""..    
+000083c0: 2020 2020 656e 6470 6f69 6e74 5f70 6174      endpoint_pat
+000083d0: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
+000083e0: 7072 6f6a 6563 747d 2f61 7274 6966 6163  project}/artifac
+000083f0: 7473 2f7b 6b65 797d 220a 2020 2020 2020  ts/{key}".      
+00008400: 2020 7061 7261 6d73 203d 207b 0a20 2020    params = {.   
+00008410: 2020 2020 2020 2020 2022 6b65 7922 3a20           "key": 
+00008420: 6b65 792c 0a20 2020 2020 2020 2020 2020  key,.           
+00008430: 2022 7461 6722 3a20 7461 672c 0a20 2020   "tag": tag,.   
+00008440: 2020 2020 207d 0a20 2020 2020 2020 2065       }.        e
+00008450: 7272 6f72 203d 2066 2264 656c 2061 7274  rror = f"del art
+00008460: 6966 6163 7420 7b70 726f 6a65 6374 7d2f  ifact {project}/
+00008470: 7b6b 6579 7d22 0a20 2020 2020 2020 2073  {key}".        s
+00008480: 656c 662e 6170 695f 6361 6c6c 2822 4445  elf.api_call("DE
+00008490: 4c45 5445 222c 2065 6e64 706f 696e 745f  LETE", endpoint_
+000084a0: 7061 7468 2c20 6572 726f 722c 2070 6172  path, error, par
+000084b0: 616d 733d 7061 7261 6d73 290a 0a20 2020  ams=params)..   
+000084c0: 2064 6566 206c 6973 745f 6172 7469 6661   def list_artifa
+000084d0: 6374 7328 0a20 2020 2020 2020 2073 656c  cts(.        sel
+000084e0: 662c 0a20 2020 2020 2020 206e 616d 653d  f,.        name=
+000084f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7072  None,.        pr
+00008500: 6f6a 6563 743d 4e6f 6e65 2c0a 2020 2020  oject=None,.    
+00008510: 2020 2020 7461 673d 4e6f 6e65 2c0a 2020      tag=None,.  
+00008520: 2020 2020 2020 6c61 6265 6c73 3a20 4f70        labels: Op
+00008530: 7469 6f6e 616c 5b55 6e69 6f6e 5b44 6963  tional[Union[Dic
+00008540: 745b 7374 722c 2073 7472 5d2c 204c 6973  t[str, str], Lis
+00008550: 745b 7374 725d 5d5d 203d 204e 6f6e 652c  t[str]]] = None,
+00008560: 0a20 2020 2020 2020 2073 696e 6365 3d4e  .        since=N
+00008570: 6f6e 652c 0a20 2020 2020 2020 2075 6e74  one,.        unt
+00008580: 696c 3d4e 6f6e 652c 0a20 2020 2020 2020  il=None,.       
+00008590: 2069 7465 723a 2069 6e74 203d 204e 6f6e   iter: int = Non
+000085a0: 652c 0a20 2020 2020 2020 2062 6573 745f  e,.        best_
+000085b0: 6974 6572 6174 696f 6e3a 2062 6f6f 6c20  iteration: bool 
+000085c0: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
+000085d0: 206b 696e 643a 2073 7472 203d 204e 6f6e   kind: str = Non
+000085e0: 652c 0a20 2020 2020 2020 2063 6174 6567  e,.        categ
+000085f0: 6f72 793a 2055 6e69 6f6e 5b73 7472 2c20  ory: Union[str, 
+00008600: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00008610: 656d 6173 2e41 7274 6966 6163 7443 6174  emas.ArtifactCat
+00008620: 6567 6f72 6965 735d 203d 204e 6f6e 652c  egories] = None,
+00008630: 0a20 2020 2029 202d 3e20 4172 7469 6661  .    ) -> Artifa
+00008640: 6374 4c69 7374 3a0a 2020 2020 2020 2020  ctList:.        
+00008650: 2222 224c 6973 7420 6172 7469 6661 6374  """List artifact
+00008660: 7320 6669 6c74 6572 6564 2062 7920 7661  s filtered by va
+00008670: 7269 6f75 7320 7061 7261 6d65 7465 7273  rious parameters
+00008680: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
+00008690: 6c65 733a 3a0a 0a20 2020 2020 2020 2020  les::..         
+000086a0: 2020 2023 2053 686f 7720 6c61 7465 7374     # Show latest
+000086b0: 2076 6572 7369 6f6e 206f 6620 616c 6c20   version of all 
+000086c0: 6172 7469 6661 6374 7320 696e 2070 726f  artifacts in pro
+000086d0: 6a65 6374 0a20 2020 2020 2020 2020 2020  ject.           
+000086e0: 206c 6174 6573 745f 6172 7469 6661 6374   latest_artifact
+000086f0: 7320 3d20 6462 2e6c 6973 745f 6172 7469  s = db.list_arti
+00008700: 6661 6374 7328 2727 2c20 7461 673d 276c  facts('', tag='l
+00008710: 6174 6573 7427 2c20 7072 6f6a 6563 743d  atest', project=
+00008720: 2769 7269 7327 290a 2020 2020 2020 2020  'iris').        
+00008730: 2020 2020 2320 6368 6563 6b20 6469 6666      # check diff
+00008740: 6572 656e 7420 6172 7469 6661 6374 2076  erent artifact v
+00008750: 6572 7369 6f6e 7320 666f 7220 6120 7370  ersions for a sp
+00008760: 6563 6966 6963 2061 7274 6966 6163 740a  ecific artifact.
+00008770: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00008780: 6c74 5f76 6572 7369 6f6e 7320 3d20 6462  lt_versions = db
+00008790: 2e6c 6973 745f 6172 7469 6661 6374 7328  .list_artifacts(
+000087a0: 2772 6573 756c 7473 272c 2074 6167 3d27  'results', tag='
+000087b0: 2a27 2c20 7072 6f6a 6563 743d 2769 7269  *', project='iri
+000087c0: 7327 290a 2020 2020 2020 2020 2020 2020  s').            
+000087d0: 2320 5368 6f77 2061 7274 6966 6163 7473  # Show artifacts
+000087e0: 2077 6974 6820 6c61 6265 6c20 6669 6c74   with label filt
+000087f0: 6572 7320 2d20 626f 7468 2075 706c 6f61  ers - both uploa
+00008800: 6465 6420 616e 6420 6f66 2062 696e 6172  ded and of binar
+00008810: 7920 7479 7065 0a20 2020 2020 2020 2020  y type.         
+00008820: 2020 2072 6573 756c 745f 6c61 6265 6c73     result_labels
+00008830: 203d 2064 622e 6c69 7374 5f61 7274 6966   = db.list_artif
+00008840: 6163 7473 2827 7265 7375 6c74 7327 2c20  acts('results', 
+00008850: 7461 673d 272a 272c 2070 726f 6a65 6374  tag='*', project
+00008860: 3d27 6972 6973 272c 206c 6162 656c 733d  ='iris', labels=
+00008870: 5b27 7570 6c6f 6164 6564 272c 2027 7479  ['uploaded', 'ty
+00008880: 7065 3d62 696e 6172 7927 5d29 0a0a 2020  pe=binary'])..  
+00008890: 2020 2020 2020 3a70 6172 616d 206e 616d        :param nam
+000088a0: 653a 204e 616d 6520 6f66 2061 7274 6966  e: Name of artif
+000088b0: 6163 7473 2074 6f20 7265 7472 6965 7665  acts to retrieve
+000088c0: 2e20 4e61 6d65 2077 6974 6820 277e 2720  . Name with '~' 
+000088d0: 7072 6566 6978 2069 7320 7573 6564 2061  prefix is used a
+000088e0: 7320 6120 6c69 6b65 2071 7565 7279 2c20  s a like query, 
+000088f0: 616e 6420 6973 206e 6f74 0a20 2020 2020  and is not.     
+00008900: 2020 2020 2020 2063 6173 652d 7365 6e73         case-sens
+00008910: 6974 6976 652e 2054 6869 7320 6d65 616e  itive. This mean
+00008920: 7320 7468 6174 2071 7565 7279 696e 6720  s that querying 
+00008930: 666f 7220 6060 7e6e 616d 6560 6020 6d61  for ``~name`` ma
+00008940: 7920 7265 7475 726e 2061 7274 6966 6163  y return artifac
+00008950: 7473 206e 616d 6564 0a20 2020 2020 2020  ts named.       
+00008960: 2020 2020 2060 606d 795f 4e61 6d65 5f31       ``my_Name_1
+00008970: 6060 206f 7220 6060 7375 726e 616d 6560  `` or ``surname`
+00008980: 602e 0a20 2020 2020 2020 203a 7061 7261  `..        :para
+00008990: 6d20 7072 6f6a 6563 743a 2050 726f 6a65  m project: Proje
+000089a0: 6374 206e 616d 652e 0a20 2020 2020 2020  ct name..       
+000089b0: 203a 7061 7261 6d20 7461 673a 2052 6574   :param tag: Ret
+000089c0: 7572 6e20 6172 7469 6661 6374 7320 6173  urn artifacts as
+000089d0: 7369 676e 6564 2074 6869 7320 7461 672e  signed this tag.
+000089e0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000089f0: 6c61 6265 6c73 3a20 5265 7475 726e 2061  labels: Return a
+00008a00: 7274 6966 6163 7473 2074 6861 7420 6861  rtifacts that ha
+00008a10: 7665 2074 6865 7365 206c 6162 656c 732e  ve these labels.
+00008a20: 204c 6162 656c 7320 6361 6e20 6569 7468   Labels can eith
+00008a30: 6572 2062 6520 6120 6469 6374 696f 6e61  er be a dictiona
+00008a40: 7279 207b 226c 6162 656c 223a 2022 7661  ry {"label": "va
+00008a50: 6c75 6522 7d20 6f72 0a20 2020 2020 2020  lue"} or.       
+00008a60: 2020 2020 2061 206c 6973 7420 6f66 2022       a list of "
+00008a70: 6c61 6265 6c3d 7661 6c75 6522 2028 6d61  label=value" (ma
+00008a80: 7463 6820 6c61 6265 6c20 6b65 7920 616e  tch label key an
+00008a90: 6420 7661 6c75 6529 206f 7220 226c 6162  d value) or "lab
+00008aa0: 656c 2220 286d 6174 6368 206a 7573 7420  el" (match just 
+00008ab0: 6c61 6265 6c20 6b65 7929 2073 7472 696e  label key) strin
+00008ac0: 6773 2e0a 2020 2020 2020 2020 3a70 6172  gs..        :par
+00008ad0: 616d 2073 696e 6365 3a20 4e6f 7420 696e  am since: Not in
+00008ae0: 2075 7365 2069 6e20 3a70 793a 636c 6173   use in :py:clas
+00008af0: 733a 6048 5454 5052 756e 4442 602e 0a20  s:`HTTPRunDB`.. 
+00008b00: 2020 2020 2020 203a 7061 7261 6d20 756e         :param un
+00008b10: 7469 6c3a 204e 6f74 2069 6e20 7573 6520  til: Not in use 
+00008b20: 696e 203a 7079 3a63 6c61 7373 3a60 4854  in :py:class:`HT
+00008b30: 5450 5275 6e44 4260 2e0a 2020 2020 2020  TPRunDB`..      
+00008b40: 2020 3a70 6172 616d 2069 7465 723a 2052    :param iter: R
+00008b50: 6574 7572 6e20 6172 7469 6661 6374 7320  eturn artifacts 
+00008b60: 6672 6f6d 2061 2073 7065 6369 6669 6320  from a specific 
+00008b70: 6974 6572 6174 696f 6e20 2877 6865 7265  iteration (where
+00008b80: 2060 6069 7465 723d 3060 6020 6d65 616e   ``iter=0`` mean
+00008b90: 7320 7468 6520 726f 6f74 2069 7465 7261  s the root itera
+00008ba0: 7469 6f6e 292e 2049 660a 2020 2020 2020  tion). If.      
+00008bb0: 2020 2020 2020 6060 4e6f 6e65 6060 2028        ``None`` (
+00008bc0: 6465 6661 756c 7429 2072 6574 7572 6e20  default) return 
+00008bd0: 6172 7469 6661 6374 7320 6672 6f6d 2061  artifacts from a
+00008be0: 6c6c 2069 7465 7261 7469 6f6e 732e 0a20  ll iterations.. 
+00008bf0: 2020 2020 2020 203a 7061 7261 6d20 6265         :param be
+00008c00: 7374 5f69 7465 7261 7469 6f6e 3a20 5265  st_iteration: Re
+00008c10: 7475 726e 7320 7468 6520 6172 7469 6661  turns the artifa
+00008c20: 6374 2077 6869 6368 2062 656c 6f6e 6773  ct which belongs
+00008c30: 2074 6f20 7468 6520 6265 7374 2069 7465   to the best ite
+00008c40: 7261 7469 6f6e 206f 6620 6120 6769 7665  ration of a give
+00008c50: 6e20 7275 6e2c 2069 6e20 7468 6520 6361  n run, in the ca
+00008c60: 7365 206f 660a 2020 2020 2020 2020 2020  se of.          
+00008c70: 2020 6172 7469 6661 6374 7320 6765 6e65    artifacts gene
+00008c80: 7261 7465 6420 6672 6f6d 2061 2068 7970  rated from a hyp
+00008c90: 6572 2d70 6172 616d 2072 756e 2e20 4966  er-param run. If
+00008ca0: 206f 6e6c 7920 6120 7369 6e67 6c65 2069   only a single i
+00008cb0: 7465 7261 7469 6f6e 2065 7869 7374 732c  teration exists,
+00008cc0: 2077 696c 6c20 7265 7475 726e 2074 6865   will return the
+00008cd0: 2061 7274 6966 6163 740a 2020 2020 2020   artifact.      
+00008ce0: 2020 2020 2020 6672 6f6d 2074 6861 7420        from that 
+00008cf0: 6974 6572 6174 696f 6e2e 2049 6620 7573  iteration. If us
+00008d00: 696e 6720 6060 6265 7374 5f69 7465 7260  ing ``best_iter`
+00008d10: 602c 2074 6865 2060 6069 7465 7260 6020  `, the ``iter`` 
+00008d20: 7061 7261 6d65 7465 7220 6d75 7374 206e  parameter must n
+00008d30: 6f74 2062 6520 7573 6564 2e0a 2020 2020  ot be used..    
+00008d40: 2020 2020 3a70 6172 616d 206b 696e 643a      :param kind:
+00008d50: 2052 6574 7572 6e20 6172 7469 6661 6374   Return artifact
+00008d60: 7320 6f66 2074 6865 2072 6571 7565 7374  s of the request
+00008d70: 6564 206b 696e 642e 0a20 2020 2020 2020  ed kind..       
+00008d80: 203a 7061 7261 6d20 6361 7465 676f 7279   :param category
+00008d90: 3a20 5265 7475 726e 2061 7274 6966 6163  : Return artifac
+00008da0: 7473 206f 6620 7468 6520 7265 7175 6573  ts of the reques
+00008db0: 7465 6420 6361 7465 676f 7279 2e0a 2020  ted category..  
+00008dc0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+00008dd0: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
+00008de0: 6a65 6374 206f 7220 636f 6e66 6967 2e64  ject or config.d
+00008df0: 6566 6175 6c74 5f70 726f 6a65 6374 0a0a  efault_project..
+00008e00: 2020 2020 2020 2020 6c61 6265 6c73 203d          labels =
+00008e10: 206c 6162 656c 7320 6f72 205b 5d0a 2020   labels or [].  
+00008e20: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00008e30: 6e63 6528 6c61 6265 6c73 2c20 6469 6374  nce(labels, dict
+00008e40: 293a 0a20 2020 2020 2020 2020 2020 206c  ):.            l
+00008e50: 6162 656c 7320 3d20 5b66 227b 6b65 797d  abels = [f"{key}
+00008e60: 3d7b 7661 6c75 657d 2220 666f 7220 6b65  ={value}" for ke
+00008e70: 792c 2076 616c 7565 2069 6e20 6c61 6265  y, value in labe
+00008e80: 6c73 2e69 7465 6d73 2829 5d0a 0a20 2020  ls.items()]..   
+00008e90: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
+00008ea0: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
+00008eb0: 6522 3a20 6e61 6d65 2c0a 2020 2020 2020  e": name,.      
+00008ec0: 2020 2020 2020 2274 6167 223a 2074 6167        "tag": tag
+00008ed0: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
+00008ee0: 6162 656c 223a 206c 6162 656c 732c 0a20  abel": labels,. 
+00008ef0: 2020 2020 2020 2020 2020 2022 6974 6572             "iter
+00008f00: 223a 2069 7465 722c 0a20 2020 2020 2020  ": iter,.       
+00008f10: 2020 2020 2022 6265 7374 2d69 7465 7261       "best-itera
+00008f20: 7469 6f6e 223a 2062 6573 745f 6974 6572  tion": best_iter
+00008f30: 6174 696f 6e2c 0a20 2020 2020 2020 2020  ation,.         
+00008f40: 2020 2022 6b69 6e64 223a 206b 696e 642c     "kind": kind,
+00008f50: 0a20 2020 2020 2020 2020 2020 2022 6361  .            "ca
+00008f60: 7465 676f 7279 223a 2063 6174 6567 6f72  tegory": categor
+00008f70: 792c 0a20 2020 2020 2020 2020 2020 2022  y,.            "
+00008f80: 666f 726d 6174 223a 206d 6c72 756e 2e63  format": mlrun.c
+00008f90: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4172  ommon.schemas.Ar
+00008fa0: 7469 6661 6374 7346 6f72 6d61 742e 6675  tifactsFormat.fu
+00008fb0: 6c6c 2e76 616c 7565 2c0a 2020 2020 2020  ll.value,.      
+00008fc0: 2020 7d0a 2020 2020 2020 2020 6572 726f    }.        erro
+00008fd0: 7220 3d20 226c 6973 7420 6172 7469 6661  r = "list artifa
+00008fe0: 6374 7322 0a20 2020 2020 2020 2065 6e64  cts".        end
+00008ff0: 706f 696e 745f 7061 7468 203d 2066 2270  point_path = f"p
+00009000: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
+00009010: 7d2f 6172 7469 6661 6374 7322 0a20 2020  }/artifacts".   
+00009020: 2020 2020 2072 6573 7020 3d20 7365 6c66       resp = self
+00009030: 2e61 7069 5f63 616c 6c28 2247 4554 222c  .api_call("GET",
+00009040: 2065 6e64 706f 696e 745f 7061 7468 2c20   endpoint_path, 
+00009050: 6572 726f 722c 2070 6172 616d 733d 7061  error, params=pa
+00009060: 7261 6d73 290a 2020 2020 2020 2020 7661  rams).        va
+00009070: 6c75 6573 203d 2041 7274 6966 6163 744c  lues = ArtifactL
+00009080: 6973 7428 7265 7370 2e6a 736f 6e28 295b  ist(resp.json()[
+00009090: 2261 7274 6966 6163 7473 225d 290a 2020  "artifacts"]).  
+000090a0: 2020 2020 2020 7661 6c75 6573 2e74 6167        values.tag
+000090b0: 203d 2074 6167 0a20 2020 2020 2020 2072   = tag.        r
+000090c0: 6574 7572 6e20 7661 6c75 6573 0a0a 2020  eturn values..  
+000090d0: 2020 6465 6620 6465 6c5f 6172 7469 6661    def del_artifa
+000090e0: 6374 7328 7365 6c66 2c20 6e61 6d65 3d4e  cts(self, name=N
+000090f0: 6f6e 652c 2070 726f 6a65 6374 3d4e 6f6e  one, project=Non
+00009100: 652c 2074 6167 3d4e 6f6e 652c 206c 6162  e, tag=None, lab
+00009110: 656c 733d 4e6f 6e65 2c20 6461 7973 5f61  els=None, days_a
+00009120: 676f 3d30 293a 0a20 2020 2020 2020 2022  go=0):.        "
+00009130: 2222 4465 6c65 7465 2061 7274 6966 6163  ""Delete artifac
+00009140: 7473 2072 6566 6572 656e 6365 6420 6279  ts referenced by
+00009150: 2074 6865 2070 6172 616d 6574 6572 732e   the parameters.
+00009160: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00009170: 206e 616d 653a 204e 616d 6520 6f66 2061   name: Name of a
+00009180: 7274 6966 6163 7473 2074 6f20 6465 6c65  rtifacts to dele
+00009190: 7465 2e20 4e6f 7465 2074 6861 7420 7468  te. Note that th
+000091a0: 6973 2069 7320 6120 6c69 6b65 2071 7565  is is a like que
+000091b0: 7279 2c20 616e 6420 6973 2063 6173 652d  ry, and is case-
+000091c0: 696e 7365 6e73 6974 6976 652e 2053 6565  insensitive. See
+000091d0: 0a20 2020 2020 2020 2020 2020 203a 7079  .            :py
+000091e0: 3a66 756e 633a 607e 6c69 7374 5f61 7274  :func:`~list_art
+000091f0: 6966 6163 7473 6020 666f 7220 6d6f 7265  ifacts` for more
+00009200: 2064 6574 6169 6c73 2e0a 2020 2020 2020   details..      
+00009210: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+00009220: 3a20 5072 6f6a 6563 7420 7468 6174 2061  : Project that a
+00009230: 7274 6966 6163 7473 2062 656c 6f6e 6720  rtifacts belong 
+00009240: 746f 2e0a 2020 2020 2020 2020 3a70 6172  to..        :par
+00009250: 616d 2074 6167 3a20 4368 6f6f 7365 2061  am tag: Choose a
+00009260: 7274 6966 6163 7473 2077 686f 2061 7265  rtifacts who are
+00009270: 2061 7373 6967 6e65 6420 7468 6973 2074   assigned this t
+00009280: 6167 2e0a 2020 2020 2020 2020 3a70 6172  ag..        :par
+00009290: 616d 206c 6162 656c 733a 2043 686f 6f73  am labels: Choos
+000092a0: 6520 6172 7469 6661 6374 7320 7768 6963  e artifacts whic
+000092b0: 6820 6172 6520 6c61 6265 6c65 642e 0a20  h are labeled.. 
+000092c0: 2020 2020 2020 203a 7061 7261 6d20 6461         :param da
+000092d0: 7973 5f61 676f 3a20 5468 6973 2070 6172  ys_ago: This par
+000092e0: 616d 6574 6572 2069 7320 6465 7072 6563  ameter is deprec
+000092f0: 6174 6564 2061 6e64 206e 6f74 2075 7365  ated and not use
+00009300: 642e 0a20 2020 2020 2020 2022 2222 0a20  d..        """. 
+00009310: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
+00009320: 2070 726f 6a65 6374 206f 7220 636f 6e66   project or conf
+00009330: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
+00009340: 6374 0a20 2020 2020 2020 2070 6172 616d  ct.        param
+00009350: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+00009360: 2020 226e 616d 6522 3a20 6e61 6d65 2c0a    "name": name,.
+00009370: 2020 2020 2020 2020 2020 2020 2274 6167              "tag
+00009380: 223a 2074 6167 2c0a 2020 2020 2020 2020  ": tag,.        
+00009390: 2020 2020 226c 6162 656c 223a 206c 6162      "label": lab
+000093a0: 656c 7320 6f72 205b 5d2c 0a20 2020 2020  els or [],.     
+000093b0: 2020 2020 2020 2022 6461 7973 5f61 676f         "days_ago
+000093c0: 223a 2073 7472 2864 6179 735f 6167 6f29  ": str(days_ago)
+000093d0: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+000093e0: 2020 2020 6572 726f 7220 3d20 2264 656c      error = "del
+000093f0: 2061 7274 6966 6163 7473 220a 2020 2020   artifacts".    
+00009400: 2020 2020 656e 6470 6f69 6e74 5f70 6174      endpoint_pat
+00009410: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
+00009420: 7072 6f6a 6563 747d 2f61 7274 6966 6163  project}/artifac
+00009430: 7473 220a 2020 2020 2020 2020 7365 6c66  ts".        self
+00009440: 2e61 7069 5f63 616c 6c28 2244 454c 4554  .api_call("DELET
+00009450: 4522 2c20 656e 6470 6f69 6e74 5f70 6174  E", endpoint_pat
+00009460: 682c 2065 7272 6f72 2c20 7061 7261 6d73  h, error, params
+00009470: 3d70 6172 616d 7329 0a0a 2020 2020 6465  =params)..    de
+00009480: 6620 6c69 7374 5f61 7274 6966 6163 745f  f list_artifact_
+00009490: 7461 6773 280a 2020 2020 2020 2020 7365  tags(.        se
+000094a0: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
+000094b0: 6563 743d 4e6f 6e65 2c0a 2020 2020 2020  ect=None,.      
+000094c0: 2020 6361 7465 676f 7279 3a20 556e 696f    category: Unio
+000094d0: 6e5b 7374 722c 206d 6c72 756e 2e63 6f6d  n[str, mlrun.com
+000094e0: 6d6f 6e2e 7363 6865 6d61 732e 4172 7469  mon.schemas.Arti
+000094f0: 6661 6374 4361 7465 676f 7269 6573 5d20  factCategories] 
+00009500: 3d20 4e6f 6e65 2c0a 2020 2020 2920 2d3e  = None,.    ) ->
+00009510: 204c 6973 745b 7374 725d 3a0a 2020 2020   List[str]:.    
+00009520: 2020 2020 2222 2252 6574 7572 6e20 6120      """Return a 
+00009530: 6c69 7374 206f 6620 616c 6c20 7468 6520  list of all the 
+00009540: 7461 6773 2061 7373 6967 6e65 6420 746f  tags assigned to
+00009550: 2061 7274 6966 6163 7473 2069 6e20 7468   artifacts in th
+00009560: 6520 7363 6f70 6520 6f66 2074 6865 2067  e scope of the g
+00009570: 6976 656e 2070 726f 6a65 6374 2e22 2222  iven project."""
+00009580: 0a0a 2020 2020 2020 2020 7072 6f6a 6563  ..        projec
+00009590: 7420 3d20 7072 6f6a 6563 7420 6f72 2063  t = project or c
+000095a0: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
+000095b0: 6f6a 6563 740a 2020 2020 2020 2020 6572  oject.        er
+000095c0: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
+000095d0: 4661 696c 6564 206c 6973 7469 6e67 2061  Failed listing a
+000095e0: 7274 6966 6163 7420 7461 6773 2e20 7072  rtifact tags. pr
+000095f0: 6f6a 6563 743d 7b70 726f 6a65 6374 7d22  oject={project}"
+00009600: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+00009610: 3d20 7b22 6361 7465 676f 7279 223a 2063  = {"category": c
+00009620: 6174 6567 6f72 797d 2069 6620 6361 7465  ategory} if cate
+00009630: 676f 7279 2065 6c73 6520 7b7d 0a0a 2020  gory else {}..  
+00009640: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
+00009650: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
+00009660: 2020 2020 2020 2020 2020 2020 2247 4554              "GET
+00009670: 222c 2066 2270 726f 6a65 6374 732f 7b70  ", f"projects/{p
+00009680: 726f 6a65 6374 7d2f 6172 7469 6661 6374  roject}/artifact
+00009690: 2d74 6167 7322 2c20 6572 726f 725f 6d65  -tags", error_me
+000096a0: 7373 6167 652c 2070 6172 616d 733d 7061  ssage, params=pa
+000096b0: 7261 6d73 0a20 2020 2020 2020 2029 0a20  rams.        ). 
+000096c0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+000096d0: 7370 6f6e 7365 2e6a 736f 6e28 295b 2274  sponse.json()["t
+000096e0: 6167 7322 5d0a 0a20 2020 2064 6566 2073  ags"]..    def s
+000096f0: 746f 7265 5f66 756e 6374 696f 6e28 0a20  tore_function(. 
+00009700: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00009710: 2020 2020 2066 756e 6374 696f 6e3a 2074       function: t
+00009720: 7970 696e 672e 556e 696f 6e5b 6d6c 7275  yping.Union[mlru
+00009730: 6e2e 7275 6e74 696d 6573 2e42 6173 6552  n.runtimes.BaseR
+00009740: 756e 7469 6d65 2c20 6469 6374 5d2c 0a20  untime, dict],. 
+00009750: 2020 2020 2020 206e 616d 652c 0a20 2020         name,.   
+00009760: 2020 2020 2070 726f 6a65 6374 3d22 222c       project="",
+00009770: 0a20 2020 2020 2020 2074 6167 3d4e 6f6e  .        tag=Non
+00009780: 652c 0a20 2020 2020 2020 2076 6572 7369  e,.        versi
+00009790: 6f6e 6564 3d46 616c 7365 2c0a 2020 2020  oned=False,.    
+000097a0: 293a 0a20 2020 2020 2020 2022 2222 5374  ):.        """St
+000097b0: 6f72 6520 6120 6675 6e63 7469 6f6e 206f  ore a function o
+000097c0: 626a 6563 742e 2046 756e 6374 696f 6e20  bject. Function 
+000097d0: 6973 2069 6465 6e74 6966 6965 6420 6279  is identified by
+000097e0: 2069 7473 206e 616d 6520 616e 6420 7461   its name and ta
+000097f0: 672c 2061 6e64 2063 616e 2062 6520 7665  g, and can be ve
+00009800: 7273 696f 6e65 642e 2222 220a 2020 2020  rsioned.""".    
+00009810: 2020 2020 6e61 6d65 203d 206d 6c72 756e      name = mlrun
+00009820: 2e75 7469 6c73 2e6e 6f72 6d61 6c69 7a65  .utils.normalize
+00009830: 5f6e 616d 6528 6e61 6d65 290a 2020 2020  _name(name).    
+00009840: 2020 2020 6966 2068 6173 6174 7472 2866      if hasattr(f
+00009850: 756e 6374 696f 6e2c 2022 746f 5f64 6963  unction, "to_dic
+00009860: 7422 293a 0a20 2020 2020 2020 2020 2020  t"):.           
+00009870: 2066 756e 6374 696f 6e20 3d20 6675 6e63   function = func
+00009880: 7469 6f6e 2e74 6f5f 6469 6374 2829 0a0a  tion.to_dict()..
+00009890: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+000098a0: 207b 2274 6167 223a 2074 6167 2c20 2276   {"tag": tag, "v
+000098b0: 6572 7369 6f6e 6564 223a 2076 6572 7369  ersioned": versi
+000098c0: 6f6e 6564 7d0a 2020 2020 2020 2020 7072  oned}.        pr
+000098d0: 6f6a 6563 7420 3d20 7072 6f6a 6563 7420  oject = project 
+000098e0: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
+000098f0: 745f 7072 6f6a 6563 740a 2020 2020 2020  t_project.      
+00009900: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
+00009910: 6374 732f 7b70 726f 6a65 6374 7d2f 6675  cts/{project}/fu
+00009920: 6e63 7469 6f6e 732f 7b6e 616d 657d 220a  nctions/{name}".
+00009930: 0a20 2020 2020 2020 2065 7272 6f72 203d  .        error =
+00009940: 2066 2273 746f 7265 2066 756e 6374 696f   f"store functio
+00009950: 6e20 7b70 726f 6a65 6374 7d2f 7b6e 616d  n {project}/{nam
+00009960: 657d 220a 2020 2020 2020 2020 7265 7370  e}".        resp
+00009970: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+00009980: 280a 2020 2020 2020 2020 2020 2020 2250  (.            "P
+00009990: 4f53 5422 2c20 7061 7468 2c20 6572 726f  OST", path, erro
+000099a0: 722c 2070 6172 616d 733d 7061 7261 6d73  r, params=params
+000099b0: 2c20 626f 6479 3d64 6963 745f 746f 5f6a  , body=dict_to_j
+000099c0: 736f 6e28 6675 6e63 7469 6f6e 290a 2020  son(function).  
+000099d0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000099e0: 2023 2068 6173 6820 6b65 7920 6f70 7469   # hash key opti
+000099f0: 6f6e 616c 2074 6f20 6265 2062 6163 6b77  onal to be backw
+00009a00: 6172 6473 2063 6f6d 7061 7469 626c 6520  ards compatible 
+00009a10: 746f 2041 5049 2076 3c30 2e34 2e31 3020  to API v<0.4.10 
+00009a20: 696e 2077 6869 6368 2069 7420 7761 736e  in which it wasn
+00009a30: 2774 2069 6e20 7468 6520 7265 7370 6f6e  't in the respon
+00009a40: 7365 0a20 2020 2020 2020 2072 6574 7572  se.        retur
+00009a50: 6e20 7265 7370 2e6a 736f 6e28 292e 6765  n resp.json().ge
+00009a60: 7428 2268 6173 685f 6b65 7922 290a 0a20  t("hash_key").. 
+00009a70: 2020 2064 6566 2067 6574 5f66 756e 6374     def get_funct
+00009a80: 696f 6e28 7365 6c66 2c20 6e61 6d65 2c20  ion(self, name, 
+00009a90: 7072 6f6a 6563 743d 2222 2c20 7461 673d  project="", tag=
+00009aa0: 4e6f 6e65 2c20 6861 7368 5f6b 6579 3d22  None, hash_key="
+00009ab0: 2229 3a0a 2020 2020 2020 2020 2222 2252  "):.        """R
+00009ac0: 6574 7269 6576 6520 6465 7461 696c 7320  etrieve details 
+00009ad0: 6f66 2061 2073 7065 6369 6669 6320 6675  of a specific fu
+00009ae0: 6e63 7469 6f6e 2c20 6964 656e 7469 6669  nction, identifi
+00009af0: 6564 2062 7920 6974 7320 6e61 6d65 2061  ed by its name a
+00009b00: 6e64 2070 6f74 656e 7469 616c 6c79 2061  nd potentially a
+00009b10: 2074 6167 206f 7220 6675 6e63 7469 6f6e   tag or function
+00009b20: 2068 6173 682e 2222 220a 0a20 2020 2020   hash."""..     
+00009b30: 2020 2070 6172 616d 7320 3d20 7b22 7461     params = {"ta
+00009b40: 6722 3a20 7461 672c 2022 6861 7368 5f6b  g": tag, "hash_k
+00009b50: 6579 223a 2068 6173 685f 6b65 797d 0a20  ey": hash_key}. 
+00009b60: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
+00009b70: 2070 726f 6a65 6374 206f 7220 636f 6e66   project or conf
+00009b80: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
+00009b90: 6374 0a20 2020 2020 2020 2070 6174 6820  ct.        path 
+00009ba0: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+00009bb0: 6f6a 6563 747d 2f66 756e 6374 696f 6e73  oject}/functions
+00009bc0: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
+00009bd0: 2065 7272 6f72 203d 2066 2267 6574 2066   error = f"get f
+00009be0: 756e 6374 696f 6e20 7b70 726f 6a65 6374  unction {project
+00009bf0: 7d2f 7b6e 616d 657d 220a 2020 2020 2020  }/{name}".      
+00009c00: 2020 7265 7370 203d 2073 656c 662e 6170    resp = self.ap
+00009c10: 695f 6361 6c6c 2822 4745 5422 2c20 7061  i_call("GET", pa
+00009c20: 7468 2c20 6572 726f 722c 2070 6172 616d  th, error, param
+00009c30: 733d 7061 7261 6d73 290a 2020 2020 2020  s=params).      
+00009c40: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
+00009c50: 6f6e 2829 5b22 6675 6e63 225d 0a0a 2020  on()["func"]..  
+00009c60: 2020 6465 6620 6465 6c65 7465 5f66 756e    def delete_fun
+00009c70: 6374 696f 6e28 7365 6c66 2c20 6e61 6d65  ction(self, name
+00009c80: 3a20 7374 722c 2070 726f 6a65 6374 3a20  : str, project: 
+00009c90: 7374 7220 3d20 2222 293a 0a20 2020 2020  str = ""):.     
+00009ca0: 2020 2022 2222 4465 6c65 7465 2061 2066     """Delete a f
+00009cb0: 756e 6374 696f 6e20 6265 6c6f 6e67 696e  unction belongin
+00009cc0: 6720 746f 2061 2073 7065 6369 6669 6320  g to a specific 
+00009cd0: 7072 6f6a 6563 742e 2222 220a 0a20 2020  project."""..   
+00009ce0: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
+00009cf0: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
+00009d00: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
+00009d10: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+00009d20: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+00009d30: 6563 747d 2f66 756e 6374 696f 6e73 2f7b  ect}/functions/{
+00009d40: 6e61 6d65 7d22 0a20 2020 2020 2020 2065  name}".        e
+00009d50: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
+00009d60: 2246 6169 6c65 6420 6465 6c65 7469 6e67  "Failed deleting
+00009d70: 2066 756e 6374 696f 6e20 7b70 726f 6a65   function {proje
+00009d80: 6374 7d2f 7b6e 616d 657d 220a 2020 2020  ct}/{name}".    
+00009d90: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
+00009da0: 6c28 2244 454c 4554 4522 2c20 7061 7468  l("DELETE", path
+00009db0: 2c20 6572 726f 725f 6d65 7373 6167 6529  , error_message)
+00009dc0: 0a0a 2020 2020 6465 6620 6c69 7374 5f66  ..    def list_f
+00009dd0: 756e 6374 696f 6e73 2873 656c 662c 206e  unctions(self, n
+00009de0: 616d 653d 4e6f 6e65 2c20 7072 6f6a 6563  ame=None, projec
+00009df0: 743d 4e6f 6e65 2c20 7461 673d 4e6f 6e65  t=None, tag=None
+00009e00: 2c20 6c61 6265 6c73 3d4e 6f6e 6529 3a0a  , labels=None):.
+00009e10: 2020 2020 2020 2020 2222 2252 6574 7269          """Retri
+00009e20: 6576 6520 6120 6c69 7374 206f 6620 6675  eve a list of fu
+00009e30: 6e63 7469 6f6e 732c 2066 696c 7465 7265  nctions, filtere
+00009e40: 6420 6279 2073 7065 6369 6669 6320 6372  d by specific cr
+00009e50: 6974 6572 6961 2e0a 0a20 2020 2020 2020  iteria...       
+00009e60: 203a 7061 7261 6d20 6e61 6d65 3a20 5265   :param name: Re
+00009e70: 7475 726e 206f 6e6c 7920 6675 6e63 7469  turn only functi
+00009e80: 6f6e 7320 7769 7468 2061 2073 7065 6369  ons with a speci
+00009e90: 6669 6320 6e61 6d65 2e0a 2020 2020 2020  fic name..      
+00009ea0: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+00009eb0: 3a20 5265 7475 726e 2066 756e 6374 696f  : Return functio
+00009ec0: 6e73 2062 656c 6f6e 6769 6e67 2074 6f20  ns belonging to 
+00009ed0: 7468 6973 2070 726f 6a65 6374 2e20 4966  this project. If
+00009ee0: 206e 6f74 2073 7065 6369 6669 6564 2c20   not specified, 
+00009ef0: 7468 6520 6465 6661 756c 7420 7072 6f6a  the default proj
+00009f00: 6563 7420 6973 2075 7365 642e 0a20 2020  ect is used..   
+00009f10: 2020 2020 203a 7061 7261 6d20 7461 673a       :param tag:
+00009f20: 2052 6574 7572 6e20 6675 6e63 7469 6f6e   Return function
+00009f30: 2076 6572 7369 6f6e 7320 7769 7468 2073   versions with s
+00009f40: 7065 6369 6669 6320 7461 6773 2e0a 2020  pecific tags..  
+00009f50: 2020 2020 2020 3a70 6172 616d 206c 6162        :param lab
+00009f60: 656c 733a 2052 6574 7572 6e20 6675 6e63  els: Return func
+00009f70: 7469 6f6e 7320 7468 6174 2068 6176 6520  tions that have 
+00009f80: 7370 6563 6966 6963 206c 6162 656c 7320  specific labels 
+00009f90: 6173 7369 676e 6564 2074 6f20 7468 656d  assigned to them
+00009fa0: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+00009fb0: 6e73 3a20 4c69 7374 206f 6620 6675 6e63  ns: List of func
+00009fc0: 7469 6f6e 206f 626a 6563 7473 2028 6173  tion objects (as
+00009fd0: 2064 6963 7469 6f6e 6172 7929 2e0a 2020   dictionary)..  
+00009fe0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00009ff0: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
+0000a000: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
+0000a010: 6661 756c 745f 7072 6f6a 6563 740a 2020  fault_project.  
+0000a020: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
+0000a030: 0a20 2020 2020 2020 2020 2020 2022 6e61  .            "na
+0000a040: 6d65 223a 206e 616d 652c 0a20 2020 2020  me": name,.     
+0000a050: 2020 2020 2020 2022 7461 6722 3a20 7461         "tag": ta
+0000a060: 672c 0a20 2020 2020 2020 2020 2020 2022  g,.            "
+0000a070: 6c61 6265 6c22 3a20 6c61 6265 6c73 206f  label": labels o
+0000a080: 7220 5b5d 2c0a 2020 2020 2020 2020 7d0a  r [],.        }.
+0000a090: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
+0000a0a0: 226c 6973 7420 6675 6e63 7469 6f6e 7322  "list functions"
+0000a0b0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+0000a0c0: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+0000a0d0: 6563 747d 2f66 756e 6374 696f 6e73 220a  ect}/functions".
+0000a0e0: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
+0000a0f0: 656c 662e 6170 695f 6361 6c6c 2822 4745  elf.api_call("GE
+0000a100: 5422 2c20 7061 7468 2c20 6572 726f 722c  T", path, error,
+0000a110: 2070 6172 616d 733d 7061 7261 6d73 290a   params=params).
+0000a120: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+0000a130: 6573 702e 6a73 6f6e 2829 5b22 6675 6e63  esp.json()["func
+0000a140: 7322 5d0a 0a20 2020 2064 6566 206c 6973  s"]..    def lis
+0000a150: 745f 7275 6e74 696d 655f 7265 736f 7572  t_runtime_resour
+0000a160: 6365 7328 0a20 2020 2020 2020 2073 656c  ces(.        sel
+0000a170: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
+0000a180: 6374 3a20 4f70 7469 6f6e 616c 5b73 7472  ct: Optional[str
+0000a190: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+0000a1a0: 2020 6c61 6265 6c5f 7365 6c65 6374 6f72    label_selector
+0000a1b0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+0000a1c0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0000a1d0: 6b69 6e64 3a20 4f70 7469 6f6e 616c 5b73  kind: Optional[s
+0000a1e0: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
+0000a1f0: 2020 2020 6f62 6a65 6374 5f69 643a 204f      object_id: O
+0000a200: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+0000a210: 6f6e 652c 0a20 2020 2020 2020 2067 726f  one,.        gro
+0000a220: 7570 5f62 793a 204f 7074 696f 6e61 6c5b  up_by: Optional[
+0000a230: 0a20 2020 2020 2020 2020 2020 206d 6c72  .            mlr
+0000a240: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0000a250: 732e 4c69 7374 5275 6e74 696d 6552 6573  s.ListRuntimeRes
+0000a260: 6f75 7263 6573 4772 6f75 7042 7946 6965  ourcesGroupByFie
+0000a270: 6c64 0a20 2020 2020 2020 205d 203d 204e  ld.        ] = N
+0000a280: 6f6e 652c 0a20 2020 2029 202d 3e20 556e  one,.    ) -> Un
+0000a290: 696f 6e5b 0a20 2020 2020 2020 206d 6c72  ion[.        mlr
+0000a2a0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0000a2b0: 732e 5275 6e74 696d 6552 6573 6f75 7263  s.RuntimeResourc
+0000a2c0: 6573 4f75 7470 7574 2c0a 2020 2020 2020  esOutput,.      
+0000a2d0: 2020 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73    mlrun.common.s
+0000a2e0: 6368 656d 6173 2e47 726f 7570 6564 4279  chemas.GroupedBy
+0000a2f0: 4a6f 6252 756e 7469 6d65 5265 736f 7572  JobRuntimeResour
+0000a300: 6365 734f 7574 7075 742c 0a20 2020 2020  cesOutput,.     
+0000a310: 2020 206d 6c72 756e 2e63 6f6d 6d6f 6e2e     mlrun.common.
+0000a320: 7363 6865 6d61 732e 4772 6f75 7065 6442  schemas.GroupedB
+0000a330: 7950 726f 6a65 6374 5275 6e74 696d 6552  yProjectRuntimeR
+0000a340: 6573 6f75 7263 6573 4f75 7470 7574 2c0a  esourcesOutput,.
+0000a350: 2020 2020 5d3a 0a20 2020 2020 2020 2022      ]:.        "
+0000a360: 2222 4c69 7374 2063 7572 7265 6e74 2072  ""List current r
+0000a370: 756e 7469 6d65 2072 6573 6f75 7263 6573  untime resources
+0000a380: 2c20 7768 6963 6820 6172 6520 7573 7561  , which are usua
+0000a390: 6c6c 7920 2862 7574 206e 6f74 206c 696d  lly (but not lim
+0000a3a0: 6974 6564 2074 6f29 204b 7562 6572 6e65  ited to) Kuberne
+0000a3b0: 7465 7320 706f 6473 206f 7220 4352 4473  tes pods or CRDs
+0000a3c0: 2e0a 2020 2020 2020 2020 4675 6e63 7469  ..        Functi
+0000a3d0: 6f6e 2061 7070 6c69 6573 2066 6f72 2072  on applies for r
+0000a3e0: 756e 7320 6f66 2074 7970 6520 605b 2764  uns of type `['d
+0000a3f0: 6173 6b27 2c20 276a 6f62 272c 2027 7370  ask', 'job', 'sp
+0000a400: 6172 6b27 2c20 2772 656d 6f74 652d 7370  ark', 'remote-sp
+0000a410: 6172 6b27 2c20 276d 7069 6a6f 6227 5d60  ark', 'mpijob']`
+0000a420: 2c20 616e 6420 7769 6c6c 2072 6574 7572  , and will retur
+0000a430: 6e20 7065 720a 2020 2020 2020 2020 7275  n per.        ru
+0000a440: 6e74 696d 6520 6b69 6e64 2061 206c 6973  ntime kind a lis
+0000a450: 7420 6f66 2074 6865 2072 756e 7469 6d65  t of the runtime
+0000a460: 2072 6573 6f75 7263 6573 2028 7768 6963   resources (whic
+0000a470: 6820 6d61 7920 6861 7665 2061 6c72 6561  h may have alrea
+0000a480: 6479 2063 6f6d 706c 6574 6564 2074 6865  dy completed the
+0000a490: 6972 2065 7865 6375 7469 6f6e 292e 0a0a  ir execution)...
+0000a4a0: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+0000a4b0: 726f 6a65 6374 3a20 4765 7420 6f6e 6c79  roject: Get only
+0000a4c0: 2072 756e 7469 6d65 2072 6573 6f75 7263   runtime resourc
+0000a4d0: 6573 206f 6620 6120 7370 6563 6966 6963  es of a specific
+0000a4e0: 2070 726f 6a65 6374 2c20 6279 2064 6566   project, by def
+0000a4f0: 6175 6c74 204e 6f6e 652c 2077 6869 6368  ault None, which
+0000a500: 2077 696c 6c20 7265 7475 726e 206f 6e6c   will return onl
+0000a510: 7920 7468 650a 2020 2020 2020 2020 2020  y the.          
+0000a520: 2020 7072 6f6a 6563 7473 2079 6f75 2772    projects you'r
+0000a530: 6520 6175 7468 6f72 697a 6564 2074 6f20  e authorized to 
+0000a540: 7365 652e 0a20 2020 2020 2020 203a 7061  see..        :pa
+0000a550: 7261 6d20 6c61 6265 6c5f 7365 6c65 6374  ram label_select
+0000a560: 6f72 3a20 4120 6c61 6265 6c20 6669 6c74  or: A label filt
+0000a570: 6572 2074 6861 7420 7769 6c6c 2062 6520  er that will be 
+0000a580: 7061 7373 6564 2074 6f20 4b75 6265 726e  passed to Kubern
+0000a590: 6574 6573 2066 6f72 2066 696c 7465 7269  etes for filteri
+0000a5a0: 6e67 2074 6865 2072 6573 756c 7473 2061  ng the results a
+0000a5b0: 6363 6f72 6469 6e67 0a20 2020 2020 2020  ccording.       
+0000a5c0: 2020 2020 2074 6f20 7468 6569 7220 6c61       to their la
+0000a5d0: 6265 6c73 2e0a 2020 2020 2020 2020 3a70  bels..        :p
+0000a5e0: 6172 616d 206b 696e 643a 2054 6865 206b  aram kind: The k
+0000a5f0: 696e 6420 6f66 2072 756e 7469 6d65 2074  ind of runtime t
+0000a600: 6f20 7175 6572 792e 204d 6179 2062 6520  o query. May be 
+0000a610: 6f6e 6520 6f66 2060 5b27 6461 736b 272c  one of `['dask',
+0000a620: 2027 6a6f 6227 2c20 2773 7061 726b 272c   'job', 'spark',
+0000a630: 2027 7265 6d6f 7465 2d73 7061 726b 272c   'remote-spark',
+0000a640: 2027 6d70 696a 6f62 275d 600a 2020 2020   'mpijob']`.    
+0000a650: 2020 2020 3a70 6172 616d 206f 626a 6563      :param objec
+0000a660: 745f 6964 3a20 5468 6520 6964 656e 7469  t_id: The identi
+0000a670: 6669 6572 206f 6620 7468 6520 6d6c 7275  fier of the mlru
+0000a680: 6e20 6f62 6a65 6374 2074 6f20 7175 6572  n object to quer
+0000a690: 7920 6974 7320 7275 6e74 696d 6520 7265  y its runtime re
+0000a6a0: 736f 7572 6365 732e 2066 6f72 206d 6f73  sources. for mos
+0000a6b0: 7420 6675 6e63 7469 6f6e 2072 756e 7469  t function runti
+0000a6c0: 6d65 732c 0a20 2020 2020 2020 2020 2020  mes,.           
+0000a6d0: 2072 756e 7469 6d65 2072 6573 6f75 7263   runtime resourc
+0000a6e0: 6573 2061 7265 2070 6572 2052 756e 2c20  es are per Run, 
+0000a6f0: 666f 7220 7768 6963 6820 7468 6520 6964  for which the id
+0000a700: 656e 7469 6669 6572 2069 7320 7468 6520  entifier is the 
+0000a710: 5275 6e27 7320 5549 442e 2046 6f72 2064  Run's UID. For d
+0000a720: 6173 6b20 7275 6e74 696d 652c 2074 6865  ask runtime, the
+0000a730: 2072 756e 7469 6d65 0a20 2020 2020 2020   runtime.       
+0000a740: 2020 2020 2072 6573 6f75 7263 6573 2061       resources a
+0000a750: 7265 2070 6572 2046 756e 6374 696f 6e2c  re per Function,
+0000a760: 2066 6f72 2077 6869 6368 2074 6865 2069   for which the i
+0000a770: 6465 6e74 6966 6965 7220 6973 2074 6865  dentifier is the
+0000a780: 2046 756e 6374 696f 6e27 7320 6e61 6d65   Function's name
+0000a790: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000a7a0: 2067 726f 7570 5f62 793a 204f 626a 6563   group_by: Objec
+0000a7b0: 7420 746f 2067 726f 7570 2072 6573 756c  t to group resul
+0000a7c0: 7473 2062 792e 2041 6c6c 6f77 6564 2076  ts by. Allowed v
+0000a7d0: 616c 7565 7320 6172 6520 606a 6f62 6020  alues are `job` 
+0000a7e0: 616e 6420 6070 726f 6a65 6374 602e 0a20  and `project`.. 
+0000a7f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000a800: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
+0000a810: 2020 2020 2020 2020 2020 226c 6162 656c            "label
+0000a820: 5f73 656c 6563 746f 7222 3a20 6c61 6265  _selector": labe
+0000a830: 6c5f 7365 6c65 6374 6f72 2c0a 2020 2020  l_selector,.    
+0000a840: 2020 2020 2020 2020 2267 726f 7570 2d62          "group-b
+0000a850: 7922 3a20 6772 6f75 705f 6279 2c0a 2020  y": group_by,.  
+0000a860: 2020 2020 2020 2020 2020 226b 696e 6422            "kind"
+0000a870: 3a20 6b69 6e64 2c0a 2020 2020 2020 2020  : kind,.        
+0000a880: 2020 2020 226f 626a 6563 742d 6964 223a      "object-id":
+0000a890: 206f 626a 6563 745f 6964 2c0a 2020 2020   object_id,.    
+0000a8a0: 2020 2020 7d0a 2020 2020 2020 2020 7072      }.        pr
+0000a8b0: 6f6a 6563 745f 7061 7468 203d 2070 726f  oject_path = pro
+0000a8c0: 6a65 6374 2069 6620 7072 6f6a 6563 7420  ject if project 
+0000a8d0: 656c 7365 2022 2a22 0a20 2020 2020 2020  else "*".       
+0000a8e0: 2065 7272 6f72 203d 2022 4661 696c 6564   error = "Failed
+0000a8f0: 206c 6973 7469 6e67 2072 756e 7469 6d65   listing runtime
+0000a900: 2072 6573 6f75 7263 6573 220a 2020 2020   resources".    
+0000a910: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
+0000a920: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+0000a930: 2020 2020 2020 2020 2020 2247 4554 222c            "GET",
+0000a940: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
+0000a950: 6a65 6374 5f70 6174 687d 2f72 756e 7469  ject_path}/runti
+0000a960: 6d65 2d72 6573 6f75 7263 6573 222c 2065  me-resources", e
+0000a970: 7272 6f72 2c20 7061 7261 6d73 3d70 6172  rror, params=par
+0000a980: 616d 730a 2020 2020 2020 2020 290a 2020  ams.        ).  
+0000a990: 2020 2020 2020 6966 2067 726f 7570 5f62        if group_b
+0000a9a0: 7920 6973 204e 6f6e 653a 0a20 2020 2020  y is None:.     
+0000a9b0: 2020 2020 2020 2073 7472 7563 7475 7265         structure
+0000a9c0: 645f 6c69 7374 203d 205b 0a20 2020 2020  d_list = [.     
+0000a9d0: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
+0000a9e0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+0000a9f0: 4b69 6e64 5275 6e74 696d 6552 6573 6f75  KindRuntimeResou
+0000aa00: 7263 6573 282a 2a6b 696e 645f 7275 6e74  rces(**kind_runt
+0000aa10: 696d 655f 7265 736f 7572 6365 7329 0a20  ime_resources). 
+0000aa20: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000aa30: 6f72 206b 696e 645f 7275 6e74 696d 655f  or kind_runtime_
+0000aa40: 7265 736f 7572 6365 7320 696e 2072 6573  resources in res
+0000aa50: 706f 6e73 652e 6a73 6f6e 2829 0a20 2020  ponse.json().   
+0000aa60: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+0000aa70: 2020 2020 2020 2072 6574 7572 6e20 7374         return st
+0000aa80: 7275 6374 7572 6564 5f6c 6973 740a 2020  ructured_list.  
+0000aa90: 2020 2020 2020 656c 6966 2067 726f 7570        elif group
+0000aaa0: 5f62 7920 3d3d 206d 6c72 756e 2e63 6f6d  _by == mlrun.com
+0000aab0: 6d6f 6e2e 7363 6865 6d61 732e 4c69 7374  mon.schemas.List
+0000aac0: 5275 6e74 696d 6552 6573 6f75 7263 6573  RuntimeResources
+0000aad0: 4772 6f75 7042 7946 6965 6c64 2e6a 6f62  GroupByField.job
+0000aae0: 3a0a 2020 2020 2020 2020 2020 2020 7374  :.            st
+0000aaf0: 7275 6374 7572 6564 5f64 6963 7420 3d20  ructured_dict = 
+0000ab00: 7b7d 0a20 2020 2020 2020 2020 2020 2066  {}.            f
+0000ab10: 6f72 2070 726f 6a65 6374 2c20 6a6f 625f  or project, job_
+0000ab20: 7275 6e74 696d 655f 7265 736f 7572 6365  runtime_resource
+0000ab30: 735f 6d61 7020 696e 2072 6573 706f 6e73  s_map in respons
+0000ab40: 652e 6a73 6f6e 2829 2e69 7465 6d73 2829  e.json().items()
+0000ab50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000ab60: 2020 666f 7220 6a6f 625f 6964 2c20 7275    for job_id, ru
+0000ab70: 6e74 696d 655f 7265 736f 7572 6365 7320  ntime_resources 
+0000ab80: 696e 206a 6f62 5f72 756e 7469 6d65 5f72  in job_runtime_r
+0000ab90: 6573 6f75 7263 6573 5f6d 6170 2e69 7465  esources_map.ite
+0000aba0: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
+0000abb0: 2020 2020 2020 2020 2020 7374 7275 6374            struct
+0000abc0: 7572 6564 5f64 6963 742e 7365 7464 6566  ured_dict.setdef
+0000abd0: 6175 6c74 2870 726f 6a65 6374 2c20 7b7d  ault(project, {}
+0000abe0: 295b 0a20 2020 2020 2020 2020 2020 2020  )[.             
+0000abf0: 2020 2020 2020 2020 2020 206a 6f62 5f69             job_i
+0000ac00: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+0000ac10: 2020 2020 2020 5d20 3d20 6d6c 7275 6e2e        ] = mlrun.
+0000ac20: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e52  common.schemas.R
+0000ac30: 756e 7469 6d65 5265 736f 7572 6365 7328  untimeResources(
+0000ac40: 2a2a 7275 6e74 696d 655f 7265 736f 7572  **runtime_resour
+0000ac50: 6365 7329 0a20 2020 2020 2020 2020 2020  ces).           
+0000ac60: 2072 6574 7572 6e20 7374 7275 6374 7572   return structur
+0000ac70: 6564 5f64 6963 740a 2020 2020 2020 2020  ed_dict.        
+0000ac80: 656c 6966 2067 726f 7570 5f62 7920 3d3d  elif group_by ==
+0000ac90: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+0000aca0: 6865 6d61 732e 4c69 7374 5275 6e74 696d  hemas.ListRuntim
+0000acb0: 6552 6573 6f75 7263 6573 4772 6f75 7042  eResourcesGroupB
+0000acc0: 7946 6965 6c64 2e70 726f 6a65 6374 3a0a  yField.project:.
+0000acd0: 2020 2020 2020 2020 2020 2020 7374 7275              stru
+0000ace0: 6374 7572 6564 5f64 6963 7420 3d20 7b7d  ctured_dict = {}
+0000acf0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0000ad00: 2070 726f 6a65 6374 2c20 6b69 6e64 5f72   project, kind_r
+0000ad10: 756e 7469 6d65 5f72 6573 6f75 7263 6573  untime_resources
+0000ad20: 5f6d 6170 2069 6e20 7265 7370 6f6e 7365  _map in response
+0000ad30: 2e6a 736f 6e28 292e 6974 656d 7328 293a  .json().items():
+0000ad40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ad50: 2066 6f72 206b 696e 642c 2072 756e 7469   for kind, runti
+0000ad60: 6d65 5f72 6573 6f75 7263 6573 2069 6e20  me_resources in 
+0000ad70: 6b69 6e64 5f72 756e 7469 6d65 5f72 6573  kind_runtime_res
+0000ad80: 6f75 7263 6573 5f6d 6170 2e69 7465 6d73  ources_map.items
+0000ad90: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+0000ada0: 2020 2020 2020 2020 7374 7275 6374 7572          structur
+0000adb0: 6564 5f64 6963 742e 7365 7464 6566 6175  ed_dict.setdefau
+0000adc0: 6c74 2870 726f 6a65 6374 2c20 7b7d 295b  lt(project, {})[
+0000add0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ade0: 2020 2020 2020 2020 206b 696e 640a 2020           kind.  
+0000adf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ae00: 2020 5d20 3d20 6d6c 7275 6e2e 636f 6d6d    ] = mlrun.comm
+0000ae10: 6f6e 2e73 6368 656d 6173 2e52 756e 7469  on.schemas.Runti
+0000ae20: 6d65 5265 736f 7572 6365 7328 2a2a 7275  meResources(**ru
+0000ae30: 6e74 696d 655f 7265 736f 7572 6365 7329  ntime_resources)
+0000ae40: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000ae50: 7572 6e20 7374 7275 6374 7572 6564 5f64  urn structured_d
+0000ae60: 6963 740a 2020 2020 2020 2020 656c 7365  ict.        else
+0000ae70: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000ae80: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+0000ae90: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
+0000aea0: 2020 2020 2020 2020 2066 2250 726f 7669           f"Provi
+0000aeb0: 6465 6420 6772 6f75 7020 6279 2066 6965  ded group by fie
+0000aec0: 6c64 2069 7320 6e6f 7420 7375 7070 6f72  ld is not suppor
+0000aed0: 7465 642e 2067 726f 7570 5f62 793d 7b67  ted. group_by={g
+0000aee0: 726f 7570 5f62 797d 220a 2020 2020 2020  roup_by}".      
+0000aef0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+0000af00: 2064 656c 6574 655f 7275 6e74 696d 655f   delete_runtime_
+0000af10: 7265 736f 7572 6365 7328 0a20 2020 2020  resources(.     
+0000af20: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0000af30: 2070 726f 6a65 6374 3a20 4f70 7469 6f6e   project: Option
+0000af40: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
+0000af50: 2020 2020 2020 2020 6c61 6265 6c5f 7365          label_se
+0000af60: 6c65 6374 6f72 3a20 4f70 7469 6f6e 616c  lector: Optional
+0000af70: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+0000af80: 2020 2020 2020 6b69 6e64 3a20 4f70 7469        kind: Opti
+0000af90: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+0000afa0: 2c0a 2020 2020 2020 2020 6f62 6a65 6374  ,.        object
+0000afb0: 5f69 643a 204f 7074 696f 6e61 6c5b 7374  _id: Optional[st
+0000afc0: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
+0000afd0: 2020 2066 6f72 6365 3a20 626f 6f6c 203d     force: bool =
+0000afe0: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+0000aff0: 6772 6163 655f 7065 7269 6f64 3a20 696e  grace_period: in
+0000b000: 7420 3d20 4e6f 6e65 2c0a 2020 2020 2920  t = None,.    ) 
+0000b010: 2d3e 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  -> mlrun.common.
+0000b020: 7363 6865 6d61 732e 4772 6f75 7065 6442  schemas.GroupedB
+0000b030: 7950 726f 6a65 6374 5275 6e74 696d 6552  yProjectRuntimeR
+0000b040: 6573 6f75 7263 6573 4f75 7470 7574 3a0a  esourcesOutput:.
+0000b050: 2020 2020 2020 2020 2222 2244 656c 6574          """Delet
+0000b060: 6520 616c 6c20 7275 6e74 696d 6520 7265  e all runtime re
+0000b070: 736f 7572 6365 7320 7768 6963 6820 6172  sources which ar
+0000b080: 6520 696e 2074 6572 6d69 6e61 6c20 7374  e in terminal st
+0000b090: 6174 652e 0a0a 2020 2020 2020 2020 3a70  ate...        :p
+0000b0a0: 6172 616d 2070 726f 6a65 6374 3a20 4465  aram project: De
+0000b0b0: 6c65 7465 206f 6e6c 7920 7275 6e74 696d  lete only runtim
+0000b0c0: 6520 7265 736f 7572 6365 7320 6f66 2061  e resources of a
+0000b0d0: 2073 7065 6369 6669 6320 7072 6f6a 6563   specific projec
+0000b0e0: 742c 2062 7920 6465 6661 756c 7420 4e6f  t, by default No
+0000b0f0: 6e65 2c20 7768 6963 6820 7769 6c6c 2064  ne, which will d
+0000b100: 656c 6574 6520 6f6e 6c79 0a20 2020 2020  elete only.     
+0000b110: 2020 2020 2020 2066 726f 6d20 7468 6520         from the 
+0000b120: 7072 6f6a 6563 7473 2079 6f75 2772 6520  projects you're 
+0000b130: 6175 7468 6f72 697a 6564 2074 6f20 6465  authorized to de
+0000b140: 6c65 7465 2066 726f 6d2e 0a20 2020 2020  lete from..     
+0000b150: 2020 203a 7061 7261 6d20 6c61 6265 6c5f     :param label_
+0000b160: 7365 6c65 6374 6f72 3a20 4465 6c65 7465  selector: Delete
+0000b170: 206f 6e6c 7920 7275 6e74 696d 6520 7265   only runtime re
+0000b180: 736f 7572 6365 7320 6d61 7463 6869 6e67  sources matching
+0000b190: 2074 6865 206c 6162 656c 2073 656c 6563   the label selec
+0000b1a0: 746f 722e 0a20 2020 2020 2020 203a 7061  tor..        :pa
+0000b1b0: 7261 6d20 6b69 6e64 3a20 5468 6520 6b69  ram kind: The ki
+0000b1c0: 6e64 206f 6620 7275 6e74 696d 6520 746f  nd of runtime to
+0000b1d0: 2064 656c 6574 652e 204d 6179 2062 6520   delete. May be 
+0000b1e0: 6f6e 6520 6f66 2060 5b27 6461 736b 272c  one of `['dask',
+0000b1f0: 2027 6a6f 6227 2c20 2773 7061 726b 272c   'job', 'spark',
+0000b200: 2027 7265 6d6f 7465 2d73 7061 726b 272c   'remote-spark',
+0000b210: 2027 6d70 696a 6f62 275d 600a 2020 2020   'mpijob']`.    
+0000b220: 2020 2020 3a70 6172 616d 206f 626a 6563      :param objec
+0000b230: 745f 6964 3a20 5468 6520 6964 656e 7469  t_id: The identi
+0000b240: 6669 6572 206f 6620 7468 6520 6d6c 7275  fier of the mlru
+0000b250: 6e20 6f62 6a65 6374 2074 6f20 6465 6c65  n object to dele
+0000b260: 7465 2069 7473 2072 756e 7469 6d65 2072  te its runtime r
+0000b270: 6573 6f75 7263 6573 2e20 666f 7220 6d6f  esources. for mo
+0000b280: 7374 2066 756e 6374 696f 6e0a 2020 2020  st function.    
+0000b290: 2020 2020 2020 2020 7275 6e74 696d 6573          runtimes
+0000b2a0: 2c20 7275 6e74 696d 6520 7265 736f 7572  , runtime resour
+0000b2b0: 6365 7320 6172 6520 7065 7220 5275 6e2c  ces are per Run,
+0000b2c0: 2066 6f72 2077 6869 6368 2074 6865 2069   for which the i
+0000b2d0: 6465 6e74 6966 6965 7220 6973 2074 6865  dentifier is the
+0000b2e0: 2052 756e 2773 2055 4944 2e20 466f 7220   Run's UID. For 
+0000b2f0: 6461 736b 2072 756e 7469 6d65 2c20 7468  dask runtime, th
+0000b300: 650a 2020 2020 2020 2020 2020 2020 7275  e.            ru
+0000b310: 6e74 696d 6520 7265 736f 7572 6365 7320  ntime resources 
+0000b320: 6172 6520 7065 7220 4675 6e63 7469 6f6e  are per Function
+0000b330: 2c20 666f 7220 7768 6963 6820 7468 6520  , for which the 
+0000b340: 6964 656e 7469 6669 6572 2069 7320 7468  identifier is th
+0000b350: 6520 4675 6e63 7469 6f6e 2773 206e 616d  e Function's nam
+0000b360: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+0000b370: 6d20 666f 7263 653a 2046 6f72 6365 2064  m force: Force d
+0000b380: 656c 6574 696f 6e20 2d20 6465 6c65 7465  eletion - delete
+0000b390: 2074 6865 2072 756e 7469 6d65 2072 6573   the runtime res
+0000b3a0: 6f75 7263 6520 6576 656e 2069 6620 6974  ource even if it
+0000b3b0: 2773 206e 6f74 2069 6e20 7465 726d 696e  's not in termin
+0000b3c0: 616c 2073 7461 7465 206f 7220 6966 2074  al state or if t
+0000b3d0: 6865 2067 7261 6365 0a20 2020 2020 2020  he grace.       
+0000b3e0: 2020 2020 2070 6572 696f 6420 6469 646e       period didn
+0000b3f0: 2774 2070 6173 732e 0a20 2020 2020 2020  't pass..       
+0000b400: 203a 7061 7261 6d20 6772 6163 655f 7065   :param grace_pe
+0000b410: 7269 6f64 3a20 4772 6163 6520 7065 7269  riod: Grace peri
+0000b420: 6f64 2067 6976 656e 2074 6f20 7468 6520  od given to the 
+0000b430: 7275 6e74 696d 6520 7265 736f 7572 6365  runtime resource
+0000b440: 2062 6566 6f72 6520 7468 6579 2061 7265   before they are
+0000b450: 2061 6374 7561 6c6c 7920 7265 6d6f 7665   actually remove
+0000b460: 642c 2063 6f75 6e74 6564 2066 726f 6d0a  d, counted from.
+0000b470: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+0000b480: 6d6f 6d65 6e74 2074 6865 7920 6d6f 7665  moment they move
+0000b490: 6420 746f 2074 6572 6d69 6e61 6c20 7374  d to terminal st
+0000b4a0: 6174 6520 2864 6566 6175 6c74 7320 746f  ate (defaults to
+0000b4b0: 206d 6c72 756e 2e6d 6c63 6f6e 662e 7275   mlrun.mlconf.ru
+0000b4c0: 6e74 696d 655f 7265 736f 7572 6365 735f  ntime_resources_
+0000b4d0: 6465 6c65 7469 6f6e 5f67 7261 6365 5f70  deletion_grace_p
+0000b4e0: 6572 696f 6429 2e0a 0a20 2020 2020 2020  eriod)...       
+0000b4f0: 203a 7265 7475 726e 733a 203a 7079 3a63   :returns: :py:c
+0000b500: 6c61 7373 3a60 7e6d 6c72 756e 2e63 6f6d  lass:`~mlrun.com
+0000b510: 6d6f 6e2e 7363 6865 6d61 732e 4772 6f75  mon.schemas.Grou
+0000b520: 7065 6442 7950 726f 6a65 6374 5275 6e74  pedByProjectRunt
+0000b530: 696d 6552 6573 6f75 7263 6573 4f75 7470  imeResourcesOutp
+0000b540: 7574 6020 6c69 7374 696e 6720 7468 6520  ut` listing the 
+0000b550: 7275 6e74 696d 6520 7265 736f 7572 6365  runtime resource
+0000b560: 730a 2020 2020 2020 2020 2020 2020 7468  s.            th
+0000b570: 6174 2077 6572 6520 7265 6d6f 7665 642e  at were removed.
+0000b580: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000b590: 2020 2020 2069 6620 6772 6163 655f 7065       if grace_pe
+0000b5a0: 7269 6f64 2069 7320 4e6f 6e65 3a0a 2020  riod is None:.  
+0000b5b0: 2020 2020 2020 2020 2020 6772 6163 655f            grace_
+0000b5c0: 7065 7269 6f64 203d 2063 6f6e 6669 672e  period = config.
+0000b5d0: 7275 6e74 696d 655f 7265 736f 7572 6365  runtime_resource
+0000b5e0: 735f 6465 6c65 7469 6f6e 5f67 7261 6365  s_deletion_grace
+0000b5f0: 5f70 6572 696f 640a 2020 2020 2020 2020  _period.        
+0000b600: 2020 2020 6c6f 6767 6572 2e69 6e66 6f28      logger.info(
+0000b610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b620: 2022 5573 696e 6720 6465 6661 756c 7420   "Using default 
+0000b630: 6772 6163 6520 7065 7269 6f64 2066 6f72  grace period for
+0000b640: 2072 756e 7469 6d65 2072 6573 6f75 7263   runtime resourc
+0000b650: 6573 2064 656c 6574 696f 6e22 2c0a 2020  es deletion",.  
+0000b660: 2020 2020 2020 2020 2020 2020 2020 6772                gr
+0000b670: 6163 655f 7065 7269 6f64 3d67 7261 6365  ace_period=grace
+0000b680: 5f70 6572 696f 642c 0a20 2020 2020 2020  _period,.       
+0000b690: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0000b6a0: 7061 7261 6d73 203d 207b 0a20 2020 2020  params = {.     
+0000b6b0: 2020 2020 2020 2022 6c61 6265 6c2d 7365         "label-se
+0000b6c0: 6c65 6374 6f72 223a 206c 6162 656c 5f73  lector": label_s
+0000b6d0: 656c 6563 746f 722c 0a20 2020 2020 2020  elector,.       
+0000b6e0: 2020 2020 2022 6b69 6e64 223a 206b 696e       "kind": kin
+0000b6f0: 642c 0a20 2020 2020 2020 2020 2020 2022  d,.            "
+0000b700: 6f62 6a65 6374 2d69 6422 3a20 6f62 6a65  object-id": obje
+0000b710: 6374 5f69 642c 0a20 2020 2020 2020 2020  ct_id,.         
+0000b720: 2020 2022 666f 7263 6522 3a20 666f 7263     "force": forc
+0000b730: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+0000b740: 6772 6163 652d 7065 7269 6f64 223a 2067  grace-period": g
+0000b750: 7261 6365 5f70 6572 696f 642c 0a20 2020  race_period,.   
+0000b760: 2020 2020 207d 0a20 2020 2020 2020 2065       }.        e
+0000b770: 7272 6f72 203d 2022 4661 696c 6564 2064  rror = "Failed d
+0000b780: 656c 6574 696e 6720 7275 6e74 696d 6520  eleting runtime 
+0000b790: 7265 736f 7572 6365 7322 0a20 2020 2020  resources".     
+0000b7a0: 2020 2070 726f 6a65 6374 5f70 6174 6820     project_path 
+0000b7b0: 3d20 7072 6f6a 6563 7420 6966 2070 726f  = project if pro
+0000b7c0: 6a65 6374 2065 6c73 6520 222a 220a 2020  ject else "*".  
+0000b7d0: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
+0000b7e0: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
+0000b7f0: 2020 2020 2020 2020 2020 2020 2244 454c              "DEL
+0000b800: 4554 4522 2c0a 2020 2020 2020 2020 2020  ETE",.          
+0000b810: 2020 6622 7072 6f6a 6563 7473 2f7b 7072    f"projects/{pr
+0000b820: 6f6a 6563 745f 7061 7468 7d2f 7275 6e74  oject_path}/runt
+0000b830: 696d 652d 7265 736f 7572 6365 7322 2c0a  ime-resources",.
+0000b840: 2020 2020 2020 2020 2020 2020 6572 726f              erro
+0000b850: 722c 0a20 2020 2020 2020 2020 2020 2070  r,.            p
+0000b860: 6172 616d 733d 7061 7261 6d73 2c0a 2020  arams=params,.  
+0000b870: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000b880: 7374 7275 6374 7572 6564 5f64 6963 7420  structured_dict 
+0000b890: 3d20 7b7d 0a20 2020 2020 2020 2066 6f72  = {}.        for
+0000b8a0: 2070 726f 6a65 6374 2c20 6b69 6e64 5f72   project, kind_r
+0000b8b0: 756e 7469 6d65 5f72 6573 6f75 7263 6573  untime_resources
+0000b8c0: 5f6d 6170 2069 6e20 7265 7370 6f6e 7365  _map in response
+0000b8d0: 2e6a 736f 6e28 292e 6974 656d 7328 293a  .json().items():
+0000b8e0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0000b8f0: 206b 696e 642c 2072 756e 7469 6d65 5f72   kind, runtime_r
+0000b900: 6573 6f75 7263 6573 2069 6e20 6b69 6e64  esources in kind
+0000b910: 5f72 756e 7469 6d65 5f72 6573 6f75 7263  _runtime_resourc
+0000b920: 6573 5f6d 6170 2e69 7465 6d73 2829 3a0a  es_map.items():.
+0000b930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b940: 7374 7275 6374 7572 6564 5f64 6963 742e  structured_dict.
+0000b950: 7365 7464 6566 6175 6c74 2870 726f 6a65  setdefault(proje
+0000b960: 6374 2c20 7b7d 295b 0a20 2020 2020 2020  ct, {})[.       
+0000b970: 2020 2020 2020 2020 2020 2020 206b 696e               kin
+0000b980: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+0000b990: 2020 5d20 3d20 6d6c 7275 6e2e 636f 6d6d    ] = mlrun.comm
+0000b9a0: 6f6e 2e73 6368 656d 6173 2e52 756e 7469  on.schemas.Runti
+0000b9b0: 6d65 5265 736f 7572 6365 7328 2a2a 7275  meResources(**ru
+0000b9c0: 6e74 696d 655f 7265 736f 7572 6365 7329  ntime_resources)
+0000b9d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000b9e0: 7374 7275 6374 7572 6564 5f64 6963 740a  structured_dict.
+0000b9f0: 0a20 2020 2064 6566 2063 7265 6174 655f  .    def create_
+0000ba00: 7363 6865 6475 6c65 280a 2020 2020 2020  schedule(.      
+0000ba10: 2020 7365 6c66 2c20 7072 6f6a 6563 743a    self, project:
+0000ba20: 2073 7472 2c20 7363 6865 6475 6c65 3a20   str, schedule: 
+0000ba30: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0000ba40: 656d 6173 2e53 6368 6564 756c 6549 6e70  emas.ScheduleInp
+0000ba50: 7574 0a20 2020 2029 3a0a 2020 2020 2020  ut.    ):.      
+0000ba60: 2020 2222 2243 7265 6174 6520 6120 6e65    """Create a ne
+0000ba70: 7720 7363 6865 6475 6c65 206f 6e20 7468  w schedule on th
+0000ba80: 6520 6769 7665 6e20 7072 6f6a 6563 742e  e given project.
+0000ba90: 2054 6865 2064 6574 6169 6c73 206f 6e20   The details on 
+0000baa0: 7468 6520 6163 7475 616c 206f 626a 6563  the actual objec
+0000bab0: 7420 746f 2073 6368 6564 756c 6520 6173  t to schedule as
+0000bac0: 2077 656c 6c20 6173 2074 6865 0a20 2020   well as the.   
+0000bad0: 2020 2020 2073 6368 6564 756c 6520 6974       schedule it
+0000bae0: 7365 6c66 2061 7265 2077 6974 6869 6e20  self are within 
+0000baf0: 7468 6520 7363 6865 6475 6c65 206f 626a  the schedule obj
+0000bb00: 6563 7420 7072 6f76 6964 6564 2e0a 2020  ect provided..  
+0000bb10: 2020 2020 2020 5468 6520 3a70 793a 636c        The :py:cl
+0000bb20: 6173 733a 607e 5363 6865 6475 6c65 4372  ass:`~ScheduleCr
+0000bb30: 6f6e 5472 6967 6765 7260 2066 6f6c 6c6f  onTrigger` follo
+0000bb40: 7773 2074 6865 2067 7569 6465 6c69 6e65  ws the guideline
+0000bb50: 7320 696e 0a20 2020 2020 2020 2068 7474  s in.        htt
+0000bb60: 7073 3a2f 2f61 7073 6368 6564 756c 6572  ps://apscheduler
+0000bb70: 2e72 6561 6474 6865 646f 6373 2e69 6f2f  .readthedocs.io/
+0000bb80: 656e 2f33 2e78 2f6d 6f64 756c 6573 2f74  en/3.x/modules/t
+0000bb90: 7269 6767 6572 732f 6372 6f6e 2e68 746d  riggers/cron.htm
+0000bba0: 6c2e 0a20 2020 2020 2020 2049 7420 616c  l..        It al
+0000bbb0: 736f 2073 7570 706f 7274 7320 6120 3a70  so supports a :p
+0000bbc0: 793a 6675 6e63 3a60 7e53 6368 6564 756c  y:func:`~Schedul
+0000bbd0: 6543 726f 6e54 7269 6767 6572 2e66 726f  eCronTrigger.fro
+0000bbe0: 6d5f 6372 6f6e 7461 6260 2066 756e 6374  m_crontab` funct
+0000bbf0: 696f 6e20 7468 6174 2061 6363 6570 7473  ion that accepts
+0000bc00: 2061 0a20 2020 2020 2020 2063 726f 6e74   a.        cront
+0000bc10: 6162 2d66 6f72 6d61 7474 6564 2073 7472  ab-formatted str
+0000bc20: 696e 6720 2873 6565 2068 7474 7073 3a2f  ing (see https:/
+0000bc30: 2f65 6e2e 7769 6b69 7065 6469 612e 6f72  /en.wikipedia.or
+0000bc40: 672f 7769 6b69 2f43 726f 6e20 666f 7220  g/wiki/Cron for 
+0000bc50: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
+0000bc60: 206f 6e20 7468 6520 666f 726d 6174 2061   on the format a
+0000bc70: 6e64 0a20 2020 2020 2020 206e 6f74 6520  nd.        note 
+0000bc80: 7468 6174 2074 6865 2030 2077 6565 6b64  that the 0 weekd
+0000bc90: 6179 2069 7320 616c 7761 7973 206d 6f6e  ay is always mon
+0000bca0: 6461 7929 2e0a 0a0a 2020 2020 2020 2020  day)....        
+0000bcb0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0000bcc0: 2020 2020 2020 2066 726f 6d20 6d6c 7275         from mlru
+0000bcd0: 6e2e 636f 6d6d 6f6e 2069 6d70 6f72 7420  n.common import 
+0000bce0: 7363 6865 6d61 730a 0a20 2020 2020 2020  schemas..       
+0000bcf0: 2020 2020 2023 2045 7865 6375 7465 2074       # Execute t
+0000bd00: 6865 2067 6574 5f64 6174 615f 6675 6e63  he get_data_func
+0000bd10: 2066 756e 6374 696f 6e20 6576 6572 7920   function every 
+0000bd20: 5475 6573 6461 7920 6174 2031 353a 3330  Tuesday at 15:30
+0000bd30: 0a20 2020 2020 2020 2020 2020 2073 6368  .            sch
+0000bd40: 6564 756c 6520 3d20 7363 6865 6d61 732e  edule = schemas.
+0000bd50: 5363 6865 6475 6c65 496e 7075 7428 0a20  ScheduleInput(. 
+0000bd60: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0000bd70: 616d 653d 2272 756e 5f66 756e 635f 6f6e  ame="run_func_on
+0000bd80: 5f74 7565 7364 6179 7322 2c0a 2020 2020  _tuesdays",.    
+0000bd90: 2020 2020 2020 2020 2020 2020 6b69 6e64              kind
+0000bda0: 3d22 6a6f 6222 2c0a 2020 2020 2020 2020  ="job",.        
+0000bdb0: 2020 2020 2020 2020 7363 6865 6475 6c65          schedule
+0000bdc0: 645f 6f62 6a65 6374 3d67 6574 5f64 6174  d_object=get_dat
+0000bdd0: 615f 6675 6e63 2c0a 2020 2020 2020 2020  a_func,.        
+0000bde0: 2020 2020 2020 2020 6372 6f6e 5f74 7269          cron_tri
+0000bdf0: 6767 6572 3d73 6368 656d 6173 2e53 6368  gger=schemas.Sch
+0000be00: 6564 756c 6543 726f 6e54 7269 6767 6572  eduleCronTrigger
+0000be10: 2864 6179 5f6f 665f 7765 656b 3d27 7475  (day_of_week='tu
+0000be20: 6527 2c20 686f 7572 3d31 352c 206d 696e  e', hour=15, min
+0000be30: 7574 653d 3330 292c 0a20 2020 2020 2020  ute=30),.       
+0000be40: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0000be50: 2020 2064 622e 6372 6561 7465 5f73 6368     db.create_sch
+0000be60: 6564 756c 6528 7072 6f6a 6563 745f 6e61  edule(project_na
+0000be70: 6d65 2c20 7363 6865 6475 6c65 290a 2020  me, schedule).  
+0000be80: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0000be90: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
+0000bea0: 6a65 6374 206f 7220 636f 6e66 6967 2e64  ject or config.d
+0000beb0: 6566 6175 6c74 5f70 726f 6a65 6374 0a20  efault_project. 
+0000bec0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+0000bed0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+0000bee0: 747d 2f73 6368 6564 756c 6573 220a 0a20  t}/schedules".. 
+0000bef0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+0000bf00: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+0000bf10: 6372 6561 7469 6e67 2073 6368 6564 756c  creating schedul
+0000bf20: 6520 7b70 726f 6a65 6374 7d2f 7b73 6368  e {project}/{sch
+0000bf30: 6564 756c 652e 6e61 6d65 7d22 0a20 2020  edule.name}".   
+0000bf40: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
+0000bf50: 6c6c 2822 504f 5354 222c 2070 6174 682c  ll("POST", path,
+0000bf60: 2065 7272 6f72 5f6d 6573 7361 6765 2c20   error_message, 
+0000bf70: 626f 6479 3d64 6963 745f 746f 5f6a 736f  body=dict_to_jso
+0000bf80: 6e28 7363 6865 6475 6c65 2e64 6963 7428  n(schedule.dict(
+0000bf90: 2929 290a 0a20 2020 2064 6566 2075 7064  )))..    def upd
+0000bfa0: 6174 655f 7363 6865 6475 6c65 280a 2020  ate_schedule(.  
+0000bfb0: 2020 2020 2020 7365 6c66 2c20 7072 6f6a        self, proj
+0000bfc0: 6563 743a 2073 7472 2c20 6e61 6d65 3a20  ect: str, name: 
+0000bfd0: 7374 722c 2073 6368 6564 756c 653a 206d  str, schedule: m
+0000bfe0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0000bff0: 6d61 732e 5363 6865 6475 6c65 5570 6461  mas.ScheduleUpda
+0000c000: 7465 0a20 2020 2029 3a0a 2020 2020 2020  te.    ):.      
+0000c010: 2020 2222 2255 7064 6174 6520 616e 2065    """Update an e
+0000c020: 7869 7374 696e 6720 7363 6865 6475 6c65  xisting schedule
+0000c030: 2c20 7265 706c 6163 6520 6974 2077 6974  , replace it wit
+0000c040: 6820 7468 6520 6465 7461 696c 7320 636f  h the details co
+0000c050: 6e74 6169 6e65 6420 696e 2074 6865 2073  ntained in the s
+0000c060: 6368 6564 756c 6520 6f62 6a65 6374 2e22  chedule object."
+0000c070: 2222 0a0a 2020 2020 2020 2020 7072 6f6a  ""..        proj
+0000c080: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
+0000c090: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
+0000c0a0: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
+0000c0b0: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+0000c0c0: 732f 7b70 726f 6a65 6374 7d2f 7363 6865  s/{project}/sche
+0000c0d0: 6475 6c65 732f 7b6e 616d 657d 220a 0a20  dules/{name}".. 
+0000c0e0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+0000c0f0: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+0000c100: 7570 6461 7469 6e67 2073 6368 6564 756c  updating schedul
+0000c110: 6520 7b70 726f 6a65 6374 7d2f 7b6e 616d  e {project}/{nam
+0000c120: 657d 220a 2020 2020 2020 2020 7365 6c66  e}".        self
+0000c130: 2e61 7069 5f63 616c 6c28 2250 5554 222c  .api_call("PUT",
+0000c140: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
+0000c150: 7361 6765 2c20 626f 6479 3d64 6963 745f  sage, body=dict_
+0000c160: 746f 5f6a 736f 6e28 7363 6865 6475 6c65  to_json(schedule
+0000c170: 2e64 6963 7428 2929 290a 0a20 2020 2064  .dict()))..    d
+0000c180: 6566 2067 6574 5f73 6368 6564 756c 6528  ef get_schedule(
+0000c190: 0a20 2020 2020 2020 2073 656c 662c 2070  .        self, p
+0000c1a0: 726f 6a65 6374 3a20 7374 722c 206e 616d  roject: str, nam
+0000c1b0: 653a 2073 7472 2c20 696e 636c 7564 655f  e: str, include_
+0000c1c0: 6c61 7374 5f72 756e 3a20 626f 6f6c 203d  last_run: bool =
+0000c1d0: 2046 616c 7365 0a20 2020 2029 202d 3e20   False.    ) -> 
+0000c1e0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0000c1f0: 656d 6173 2e53 6368 6564 756c 654f 7574  emas.ScheduleOut
+0000c200: 7075 743a 0a20 2020 2020 2020 2022 2222  put:.        """
+0000c210: 5265 7472 6965 7665 2064 6574 6169 6c73  Retrieve details
+0000c220: 206f 6620 7468 6520 7363 6865 6475 6c65   of the schedule
+0000c230: 2069 6e20 7175 6573 7469 6f6e 2e20 4265   in question. Be
+0000c240: 7369 6465 7320 7265 7475 726e 696e 6720  sides returning 
+0000c250: 7468 6520 6465 7461 696c 7320 6f66 2074  the details of t
+0000c260: 6865 2073 6368 6564 756c 6520 6f62 6a65  he schedule obje
+0000c270: 6374 2069 7473 656c 662c 0a20 2020 2020  ct itself,.     
+0000c280: 2020 2074 6869 7320 6675 6e63 7469 6f6e     this function
+0000c290: 2061 6c73 6f20 7265 7475 726e 7320 7468   also returns th
+0000c2a0: 6520 6e65 7874 2073 6368 6564 756c 6564  e next scheduled
+0000c2b0: 2072 756e 2066 6f72 2074 6869 7320 7370   run for this sp
+0000c2c0: 6563 6966 6963 2073 6368 6564 756c 652c  ecific schedule,
+0000c2d0: 2061 7320 7765 6c6c 2061 7320 706f 7465   as well as pote
+0000c2e0: 6e74 6961 6c6c 7920 7468 650a 2020 2020  ntially the.    
+0000c2f0: 2020 2020 7265 7375 6c74 7320 6f66 2074      results of t
+0000c300: 6865 206c 6173 7420 7275 6e20 6578 6563  he last run exec
+0000c310: 7574 6564 2074 6872 6f75 6768 2074 6869  uted through thi
+0000c320: 7320 7363 6865 6475 6c65 2e0a 0a20 2020  s schedule...   
+0000c330: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+0000c340: 6563 743a 2050 726f 6a65 6374 206e 616d  ect: Project nam
+0000c350: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+0000c360: 6d20 6e61 6d65 3a20 4e61 6d65 206f 6620  m name: Name of 
+0000c370: 7468 6520 7363 6865 6475 6c65 206f 626a  the schedule obj
+0000c380: 6563 7420 746f 2071 7565 7279 2e0a 2020  ect to query..  
+0000c390: 2020 2020 2020 3a70 6172 616d 2069 6e63        :param inc
+0000c3a0: 6c75 6465 5f6c 6173 745f 7275 6e3a 2057  lude_last_run: W
+0000c3b0: 6865 7468 6572 2074 6f20 696e 636c 7564  hether to includ
+0000c3c0: 6520 7468 6520 7265 7375 6c74 7320 6f66  e the results of
+0000c3d0: 2074 6865 2073 6368 6564 756c 6527 7320   the schedule's 
+0000c3e0: 6c61 7374 2072 756e 2069 6e20 7468 6520  last run in the 
+0000c3f0: 7265 7370 6f6e 7365 2e0a 2020 2020 2020  response..      
+0000c400: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
+0000c410: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
+0000c420: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
+0000c430: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
+0000c440: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
+0000c450: 6563 7473 2f7b 7072 6f6a 6563 747d 2f73  ects/{project}/s
+0000c460: 6368 6564 756c 6573 2f7b 6e61 6d65 7d22  chedules/{name}"
+0000c470: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
+0000c480: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
+0000c490: 6420 6765 7474 696e 6720 7363 6865 6475  d getting schedu
+0000c4a0: 6c65 2066 6f72 207b 7072 6f6a 6563 747d  le for {project}
+0000c4b0: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
+0000c4c0: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
+0000c4d0: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+0000c4e0: 2020 2022 4745 5422 2c20 7061 7468 2c20     "GET", path, 
+0000c4f0: 6572 726f 725f 6d65 7373 6167 652c 2070  error_message, p
+0000c500: 6172 616d 733d 7b22 696e 636c 7564 655f  arams={"include_
+0000c510: 6c61 7374 5f72 756e 223a 2069 6e63 6c75  last_run": inclu
+0000c520: 6465 5f6c 6173 745f 7275 6e7d 0a20 2020  de_last_run}.   
+0000c530: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+0000c540: 6574 7572 6e20 6d6c 7275 6e2e 636f 6d6d  eturn mlrun.comm
+0000c550: 6f6e 2e73 6368 656d 6173 2e53 6368 6564  on.schemas.Sched
+0000c560: 756c 654f 7574 7075 7428 2a2a 7265 7370  uleOutput(**resp
+0000c570: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
+0000c580: 6620 6c69 7374 5f73 6368 6564 756c 6573  f list_schedules
+0000c590: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0000c5a0: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
+0000c5b0: 2073 7472 2c0a 2020 2020 2020 2020 6e61   str,.        na
+0000c5c0: 6d65 3a20 7374 7220 3d20 4e6f 6e65 2c0a  me: str = None,.
+0000c5d0: 2020 2020 2020 2020 6b69 6e64 3a20 6d6c          kind: ml
+0000c5e0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+0000c5f0: 6173 2e53 6368 6564 756c 654b 696e 6473  as.ScheduleKinds
+0000c600: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000c610: 2069 6e63 6c75 6465 5f6c 6173 745f 7275   include_last_ru
+0000c620: 6e3a 2062 6f6f 6c20 3d20 4661 6c73 652c  n: bool = False,
+0000c630: 0a20 2020 2029 202d 3e20 6d6c 7275 6e2e  .    ) -> mlrun.
+0000c640: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
+0000c650: 6368 6564 756c 6573 4f75 7470 7574 3a0a  chedulesOutput:.
+0000c660: 2020 2020 2020 2020 2222 2252 6574 7269          """Retri
+0000c670: 6576 6520 6c69 7374 206f 6620 7363 6865  eve list of sche
+0000c680: 6475 6c65 7320 6f66 2073 7065 6369 6669  dules of specifi
+0000c690: 6320 6e61 6d65 206f 7220 6b69 6e64 2e0a  c name or kind..
+0000c6a0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000c6b0: 7072 6f6a 6563 743a 2050 726f 6a65 6374  project: Project
+0000c6c0: 206e 616d 652e 0a20 2020 2020 2020 203a   name..        :
+0000c6d0: 7061 7261 6d20 6e61 6d65 3a20 4e61 6d65  param name: Name
+0000c6e0: 206f 6620 7363 6865 6475 6c65 2074 6f20   of schedule to 
+0000c6f0: 7265 7472 6965 7665 2e20 4361 6e20 6265  retrieve. Can be
+0000c700: 206f 6d69 7474 6564 2074 6f20 6c69 7374   omitted to list
+0000c710: 2061 6c6c 2073 6368 6564 756c 6573 2e0a   all schedules..
+0000c720: 2020 2020 2020 2020 3a70 6172 616d 206b          :param k
+0000c730: 696e 643a 204b 696e 6420 6f66 2073 6368  ind: Kind of sch
+0000c740: 6564 756c 6520 6f62 6a65 6374 7320 746f  edule objects to
+0000c750: 2072 6574 7269 6576 652c 2063 616e 2062   retrieve, can b
+0000c760: 6520 6569 7468 6572 2060 606a 6f62 6060  e either ``job``
+0000c770: 206f 7220 6060 7069 7065 6c69 6e65 6060   or ``pipeline``
+0000c780: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000c790: 2069 6e63 6c75 6465 5f6c 6173 745f 7275   include_last_ru
+0000c7a0: 6e3a 2057 6865 7468 6572 2074 6f20 7265  n: Whether to re
+0000c7b0: 7475 726e 2066 6f72 2065 6163 6820 7363  turn for each sc
+0000c7c0: 6865 6475 6c65 2072 6574 7572 6e65 6420  hedule returned 
+0000c7d0: 616c 736f 2074 6865 2072 6573 756c 7473  also the results
+0000c7e0: 206f 6620 7468 6520 6c61 7374 2072 756e   of the last run
+0000c7f0: 206f 660a 2020 2020 2020 2020 2020 2020   of.            
+0000c800: 7468 6174 2073 6368 6564 756c 652e 0a20  that schedule.. 
+0000c810: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0000c820: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+0000c830: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+0000c840: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+0000c850: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+0000c860: 207b 226b 696e 6422 3a20 6b69 6e64 2c20   {"kind": kind, 
+0000c870: 226e 616d 6522 3a20 6e61 6d65 2c20 2269  "name": name, "i
+0000c880: 6e63 6c75 6465 5f6c 6173 745f 7275 6e22  nclude_last_run"
+0000c890: 3a20 696e 636c 7564 655f 6c61 7374 5f72  : include_last_r
+0000c8a0: 756e 7d0a 2020 2020 2020 2020 7061 7468  un}.        path
+0000c8b0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+0000c8c0: 726f 6a65 6374 7d2f 7363 6865 6475 6c65  roject}/schedule
+0000c8d0: 7322 0a20 2020 2020 2020 2065 7272 6f72  s".        error
+0000c8e0: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
+0000c8f0: 6c65 6420 6c69 7374 696e 6720 7363 6865  led listing sche
+0000c900: 6475 6c65 7320 666f 7220 7b70 726f 6a65  dules for {proje
+0000c910: 6374 7d20 3f20 7b6b 696e 647d 207b 6e61  ct} ? {kind} {na
+0000c920: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
+0000c930: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
+0000c940: 6c28 2247 4554 222c 2070 6174 682c 2065  l("GET", path, e
+0000c950: 7272 6f72 5f6d 6573 7361 6765 2c20 7061  rror_message, pa
+0000c960: 7261 6d73 3d70 6172 616d 7329 0a20 2020  rams=params).   
+0000c970: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
+0000c980: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0000c990: 2e53 6368 6564 756c 6573 4f75 7470 7574  .SchedulesOutput
+0000c9a0: 282a 2a72 6573 702e 6a73 6f6e 2829 290a  (**resp.json()).
+0000c9b0: 0a20 2020 2064 6566 2064 656c 6574 655f  .    def delete_
+0000c9c0: 7363 6865 6475 6c65 2873 656c 662c 2070  schedule(self, p
+0000c9d0: 726f 6a65 6374 3a20 7374 722c 206e 616d  roject: str, nam
+0000c9e0: 653a 2073 7472 293a 0a20 2020 2020 2020  e: str):.       
+0000c9f0: 2022 2222 4465 6c65 7465 2061 2073 7065   """Delete a spe
+0000ca00: 6369 6669 6320 7363 6865 6475 6c65 2062  cific schedule b
+0000ca10: 7920 6e61 6d65 2e22 2222 0a0a 2020 2020  y name."""..    
+0000ca20: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+0000ca30: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+0000ca40: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+0000ca50: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+0000ca60: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
+0000ca70: 6374 7d2f 7363 6865 6475 6c65 732f 7b6e  ct}/schedules/{n
+0000ca80: 616d 657d 220a 2020 2020 2020 2020 6572  ame}".        er
+0000ca90: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
+0000caa0: 4661 696c 6564 2064 656c 6574 696e 6720  Failed deleting 
+0000cab0: 7363 6865 6475 6c65 207b 7072 6f6a 6563  schedule {projec
+0000cac0: 747d 2f7b 6e61 6d65 7d22 0a20 2020 2020  t}/{name}".     
+0000cad0: 2020 2073 656c 662e 6170 695f 6361 6c6c     self.api_call
+0000cae0: 2822 4445 4c45 5445 222c 2070 6174 682c  ("DELETE", path,
+0000caf0: 2065 7272 6f72 5f6d 6573 7361 6765 290a   error_message).
+0000cb00: 0a20 2020 2064 6566 2069 6e76 6f6b 655f  .    def invoke_
+0000cb10: 7363 6865 6475 6c65 2873 656c 662c 2070  schedule(self, p
+0000cb20: 726f 6a65 6374 3a20 7374 722c 206e 616d  roject: str, nam
+0000cb30: 653a 2073 7472 293a 0a20 2020 2020 2020  e: str):.       
+0000cb40: 2022 2222 4578 6563 7574 6520 7468 6520   """Execute the 
+0000cb50: 6f62 6a65 6374 2072 6566 6572 656e 6365  object reference
+0000cb60: 6420 6279 2074 6865 2073 6368 6564 756c  d by the schedul
+0000cb70: 6520 696d 6d65 6469 6174 656c 792e 2222  e immediately.""
+0000cb80: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
+0000cb90: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
+0000cba0: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
+0000cbb0: 726f 6a65 6374 0a20 2020 2020 2020 2070  roject.        p
+0000cbc0: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
+0000cbd0: 2f7b 7072 6f6a 6563 747d 2f73 6368 6564  /{project}/sched
+0000cbe0: 756c 6573 2f7b 6e61 6d65 7d2f 696e 766f  ules/{name}/invo
+0000cbf0: 6b65 220a 2020 2020 2020 2020 6572 726f  ke".        erro
+0000cc00: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+0000cc10: 696c 6564 2069 6e76 6f6b 696e 6720 7363  iled invoking sc
+0000cc20: 6865 6475 6c65 207b 7072 6f6a 6563 747d  hedule {project}
+0000cc30: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
+0000cc40: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
+0000cc50: 504f 5354 222c 2070 6174 682c 2065 7272  POST", path, err
+0000cc60: 6f72 5f6d 6573 7361 6765 290a 0a20 2020  or_message)..   
+0000cc70: 2064 6566 2072 656d 6f74 655f 6275 696c   def remote_buil
+0000cc80: 6465 7228 0a20 2020 2020 2020 2073 656c  der(.        sel
+0000cc90: 662c 0a20 2020 2020 2020 2066 756e 632c  f,.        func,
+0000cca0: 0a20 2020 2020 2020 2077 6974 685f 6d6c  .        with_ml
+0000ccb0: 7275 6e2c 0a20 2020 2020 2020 206d 6c72  run,.        mlr
+0000ccc0: 756e 5f76 6572 7369 6f6e 5f73 7065 6369  un_version_speci
+0000ccd0: 6669 6572 3d4e 6f6e 652c 0a20 2020 2020  fier=None,.     
+0000cce0: 2020 2073 6b69 705f 6465 706c 6f79 6564     skip_deployed
+0000ccf0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+0000cd00: 6275 696c 6465 725f 656e 763d 4e6f 6e65  builder_env=None
+0000cd10: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0000cd20: 2022 2222 4275 696c 6420 7468 6520 706f   """Build the po
+0000cd30: 6420 696d 6167 6520 666f 7220 6120 6675  d image for a fu
+0000cd40: 6e63 7469 6f6e 2c20 666f 7220 6578 6563  nction, for exec
+0000cd50: 7574 696f 6e20 6f6e 2061 2072 656d 6f74  ution on a remot
+0000cd60: 6520 636c 7573 7465 722e 2054 6869 7320  e cluster. This 
+0000cd70: 6973 2065 7865 6375 7465 6420 6279 2074  is executed by t
+0000cd80: 6865 204d 4c52 756e 0a20 2020 2020 2020  he MLRun.       
+0000cd90: 2041 5049 2073 6572 7665 722c 2061 6e64   API server, and
+0000cda0: 2063 7265 6174 6573 2061 2044 6f63 6b65   creates a Docke
+0000cdb0: 7220 696d 6167 6520 6f75 7420 6f66 2074  r image out of t
+0000cdc0: 6865 2066 756e 6374 696f 6e20 7072 6f76  he function prov
+0000cdd0: 6964 6564 2061 6e64 2061 6e79 2073 7065  ided and any spe
+0000cde0: 6369 6669 6320 6275 696c 640a 2020 2020  cific build.    
+0000cdf0: 2020 2020 696e 7374 7275 6374 696f 6e73      instructions
+0000ce00: 2070 726f 7669 6465 6420 7769 7468 696e   provided within
+0000ce10: 2e20 5468 6973 2069 7320 6120 7072 652d  . This is a pre-
+0000ce20: 7265 7175 6973 6974 6520 666f 7220 7265  requisite for re
+0000ce30: 6d6f 7465 6c79 2065 7865 6375 7469 6e67  motely executing
+0000ce40: 2061 2066 756e 6374 696f 6e2c 2075 6e6c   a function, unl
+0000ce50: 6573 7320 7573 696e 670a 2020 2020 2020  ess using.      
+0000ce60: 2020 6120 7072 652d 6465 706c 6f79 6564    a pre-deployed
+0000ce70: 2069 6d61 6765 2e0a 0a20 2020 2020 2020   image...       
+0000ce80: 203a 7061 7261 6d20 6675 6e63 3a20 4675   :param func: Fu
+0000ce90: 6e63 7469 6f6e 2074 6f20 6275 696c 642e  nction to build.
+0000cea0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000ceb0: 7769 7468 5f6d 6c72 756e 3a20 5768 6574  with_mlrun: Whet
+0000cec0: 6865 7220 746f 2061 6464 204d 4c52 756e  her to add MLRun
+0000ced0: 2070 6163 6b61 6765 2074 6f20 7468 6520   package to the 
+0000cee0: 6275 696c 7420 7061 636b 6167 652e 2054  built package. T
+0000cef0: 6869 7320 6973 206e 6f74 2072 6571 7569  his is not requi
+0000cf00: 7265 6420 6966 2075 7369 6e67 2061 2062  red if using a b
+0000cf10: 6173 650a 2020 2020 2020 2020 2020 2020  ase.            
+0000cf20: 696d 6167 6520 7468 6174 2061 6c72 6561  image that alrea
+0000cf30: 6479 2068 6173 204d 4c52 756e 2069 6e20  dy has MLRun in 
+0000cf40: 6974 2e0a 2020 2020 2020 2020 3a70 6172  it..        :par
+0000cf50: 616d 206d 6c72 756e 5f76 6572 7369 6f6e  am mlrun_version
+0000cf60: 5f73 7065 6369 6669 6572 3a20 5665 7273  _specifier: Vers
+0000cf70: 696f 6e20 6f66 204d 4c52 756e 2074 6f20  ion of MLRun to 
+0000cf80: 696e 636c 7564 6520 696e 2074 6865 2062  include in the b
+0000cf90: 7569 6c74 2069 6d61 6765 2e0a 2020 2020  uilt image..    
+0000cfa0: 2020 2020 3a70 6172 616d 2073 6b69 705f      :param skip_
+0000cfb0: 6465 706c 6f79 6564 3a20 536b 6970 2074  deployed: Skip t
+0000cfc0: 6865 2062 7569 6c64 2069 6620 7765 2061  he build if we a
+0000cfd0: 6c72 6561 6479 2068 6176 6520 616e 2069  lready have an i
+0000cfe0: 6d61 6765 2066 6f72 2074 6865 2066 756e  mage for the fun
+0000cff0: 6374 696f 6e2e 0a20 2020 2020 2020 203a  ction..        :
+0000d000: 7061 7261 6d20 6275 696c 6465 725f 656e  param builder_en
+0000d010: 763a 2020 204b 616e 696b 6f20 6275 696c  v:   Kaniko buil
+0000d020: 6465 7220 706f 6420 656e 7620 7661 7273  der pod env vars
+0000d030: 2064 6963 7420 2866 6f72 2063 6f6e 6669   dict (for confi
+0000d040: 672f 6372 6564 656e 7469 616c 7329 0a20  g/credentials). 
+0000d050: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0000d060: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0000d070: 2020 2020 2072 6571 203d 207b 0a20 2020       req = {.   
+0000d080: 2020 2020 2020 2020 2020 2020 2022 6675               "fu
+0000d090: 6e63 7469 6f6e 223a 2066 756e 632e 746f  nction": func.to
+0000d0a0: 5f64 6963 7428 292c 0a20 2020 2020 2020  _dict(),.       
+0000d0b0: 2020 2020 2020 2020 2022 7769 7468 5f6d           "with_m
+0000d0c0: 6c72 756e 223a 2062 6f6f 6c32 7374 7228  lrun": bool2str(
+0000d0d0: 7769 7468 5f6d 6c72 756e 292c 0a20 2020  with_mlrun),.   
+0000d0e0: 2020 2020 2020 2020 2020 2020 2022 736b               "sk
+0000d0f0: 6970 5f64 6570 6c6f 7965 6422 3a20 736b  ip_deployed": sk
+0000d100: 6970 5f64 6570 6c6f 7965 642c 0a20 2020  ip_deployed,.   
+0000d110: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+0000d120: 2020 2020 2020 2069 6620 6d6c 7275 6e5f         if mlrun_
+0000d130: 7665 7273 696f 6e5f 7370 6563 6966 6965  version_specifie
+0000d140: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
+0000d150: 2020 2072 6571 5b22 6d6c 7275 6e5f 7665     req["mlrun_ve
+0000d160: 7273 696f 6e5f 7370 6563 6966 6965 7222  rsion_specifier"
+0000d170: 5d20 3d20 6d6c 7275 6e5f 7665 7273 696f  ] = mlrun_versio
+0000d180: 6e5f 7370 6563 6966 6965 720a 2020 2020  n_specifier.    
+0000d190: 2020 2020 2020 2020 6966 2062 7569 6c64          if build
+0000d1a0: 6572 5f65 6e76 3a0a 2020 2020 2020 2020  er_env:.        
+0000d1b0: 2020 2020 2020 2020 7265 715b 2262 7569          req["bui
+0000d1c0: 6c64 6572 5f65 6e76 225d 203d 2062 7569  lder_env"] = bui
+0000d1d0: 6c64 6572 5f65 6e76 0a20 2020 2020 2020  lder_env.       
+0000d1e0: 2020 2020 2072 6573 7020 3d20 7365 6c66       resp = self
+0000d1f0: 2e61 7069 5f63 616c 6c28 2250 4f53 5422  .api_call("POST"
+0000d200: 2c20 2262 7569 6c64 2f66 756e 6374 696f  , "build/functio
+0000d210: 6e22 2c20 6a73 6f6e 3d72 6571 290a 2020  n", json=req).  
+0000d220: 2020 2020 2020 6578 6365 7074 204f 5345        except OSE
+0000d230: 7272 6f72 2061 7320 6572 723a 0a20 2020  rror as err:.   
+0000d240: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
+0000d250: 6572 726f 7228 6622 6572 726f 7220 7375  error(f"error su
+0000d260: 626d 6974 7469 6e67 2062 7569 6c64 2074  bmitting build t
+0000d270: 6173 6b3a 207b 6572 725f 746f 5f73 7472  ask: {err_to_str
+0000d280: 2865 7272 297d 2229 0a20 2020 2020 2020  (err)}").       
+0000d290: 2020 2020 2072 6169 7365 204f 5345 7272       raise OSErr
+0000d2a0: 6f72 2866 2265 7272 6f72 3a20 6361 6e6e  or(f"error: cann
+0000d2b0: 6f74 2073 7562 6d69 7420 6275 696c 642c  ot submit build,
+0000d2c0: 207b 6572 725f 746f 5f73 7472 2865 7272   {err_to_str(err
+0000d2d0: 297d 2229 0a0a 2020 2020 2020 2020 6966  )}")..        if
+0000d2e0: 206e 6f74 2072 6573 702e 6f6b 3a0a 2020   not resp.ok:.  
+0000d2f0: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
+0000d300: 2e65 7272 6f72 2866 2262 6164 2072 6573  .error(f"bad res
+0000d310: 7021 215c 6e7b 7265 7370 2e74 6578 747d  p!!\n{resp.text}
+0000d320: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+0000d330: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0000d340: 2262 6164 2066 756e 6374 696f 6e20 7275  "bad function ru
+0000d350: 6e20 7265 7370 6f6e 7365 2229 0a0a 2020  n response")..  
+0000d360: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+0000d370: 702e 6a73 6f6e 2829 0a0a 2020 2020 6465  p.json()..    de
+0000d380: 6620 6765 745f 6275 696c 6465 725f 7374  f get_builder_st
+0000d390: 6174 7573 280a 2020 2020 2020 2020 7365  atus(.        se
+0000d3a0: 6c66 2c0a 2020 2020 2020 2020 6675 6e63  lf,.        func
+0000d3b0: 3a20 4261 7365 5275 6e74 696d 652c 0a20  : BaseRuntime,. 
+0000d3c0: 2020 2020 2020 206f 6666 7365 743a 2069         offset: i
+0000d3d0: 6e74 203d 2030 2c0a 2020 2020 2020 2020  nt = 0,.        
+0000d3e0: 6c6f 6773 3a20 626f 6f6c 203d 2054 7275  logs: bool = Tru
+0000d3f0: 652c 0a20 2020 2020 2020 206c 6173 745f  e,.        last_
+0000d400: 6c6f 675f 7469 6d65 7374 616d 703a 2066  log_timestamp: f
+0000d410: 6c6f 6174 203d 2030 2e30 2c0a 2020 2020  loat = 0.0,.    
+0000d420: 2020 2020 7665 7262 6f73 653a 2062 6f6f      verbose: boo
+0000d430: 6c20 3d20 4661 6c73 652c 0a20 2020 2029  l = False,.    )
+0000d440: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+0000d450: 7269 6576 6520 7468 6520 7374 6174 7573  rieve the status
+0000d460: 206f 6620 6120 6275 696c 6420 6f70 6572   of a build oper
+0000d470: 6174 696f 6e20 6375 7272 656e 746c 7920  ation currently 
+0000d480: 696e 2070 726f 6772 6573 732e 0a0a 2020  in progress...  
+0000d490: 2020 2020 2020 3a70 6172 616d 2066 756e        :param fun
+0000d4a0: 633a 2020 2020 2020 2020 2020 2020 2020  c:              
+0000d4b0: 2020 4675 6e63 7469 6f6e 206f 626a 6563    Function objec
+0000d4c0: 7420 7468 6174 2069 7320 6265 696e 6720  t that is being 
+0000d4d0: 6275 696c 742e 0a20 2020 2020 2020 203a  built..        :
+0000d4e0: 7061 7261 6d20 6f66 6673 6574 3a20 2020  param offset:   
+0000d4f0: 2020 2020 2020 2020 2020 204f 6666 7365             Offse
+0000d500: 7420 696e 746f 2074 6865 2062 7569 6c64  t into the build
+0000d510: 206c 6f67 7320 746f 2072 6574 7269 6576   logs to retriev
+0000d520: 6520 6c6f 6773 2066 726f 6d2e 0a20 2020  e logs from..   
+0000d530: 2020 2020 203a 7061 7261 6d20 6c6f 6773       :param logs
+0000d540: 3a20 2020 2020 2020 2020 2020 2020 2020  :               
+0000d550: 2053 686f 756c 6420 6275 696c 6420 6c6f   Should build lo
+0000d560: 6773 2062 6520 7265 7472 6965 7665 642e  gs be retrieved.
+0000d570: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000d580: 6c61 7374 5f6c 6f67 5f74 696d 6573 7461  last_log_timesta
+0000d590: 6d70 3a20 204c 6173 7420 7469 6d65 7374  mp:  Last timest
+0000d5a0: 616d 7020 6f66 206c 6f67 7320 7468 6174  amp of logs that
+0000d5b0: 2077 6572 6520 616c 7265 6164 7920 7265   were already re
+0000d5c0: 7472 6965 7665 642e 2046 756e 6374 696f  trieved. Functio
+0000d5d0: 6e20 7769 6c6c 2072 6574 7572 6e20 6f6e  n will return on
+0000d5e0: 6c79 206c 6f67 730a 2020 2020 2020 2020  ly logs.        
+0000d5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d600: 2020 2020 2020 2020 2020 2020 6c61 7465              late
+0000d610: 7220 7468 616e 2074 6869 7320 7061 7261  r than this para
+0000d620: 6d65 7465 722e 0a20 2020 2020 2020 203a  meter..        :
+0000d630: 7061 7261 6d20 7665 7262 6f73 653a 2020  param verbose:  
+0000d640: 2020 2020 2020 2020 2020 2041 6464 2076             Add v
+0000d650: 6572 626f 7365 206c 6f67 7320 696e 746f  erbose logs into
+0000d660: 2074 6865 206f 7574 7075 742e 0a0a 2020   the output...  
+0000d670: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
+0000d680: 5468 6520 666f 6c6c 6f77 696e 6720 7061  The following pa
+0000d690: 7261 6d65 7465 7273 3a0a 0a20 2020 2020  rameters:..     
+0000d6a0: 2020 2020 2020 202d 2054 6578 7420 6f66         - Text of
+0000d6b0: 2062 7569 6c64 6572 206c 6f67 732e 0a20   builder logs.. 
+0000d6c0: 2020 2020 2020 2020 2020 202d 2054 696d             - Tim
+0000d6d0: 6573 7461 6d70 206f 6620 6c61 7374 206c  estamp of last l
+0000d6e0: 6f67 2072 6574 7269 6576 6564 2c20 746f  og retrieved, to
+0000d6f0: 2062 6520 7573 6564 2069 6e20 7375 6273   be used in subs
+0000d700: 6571 7565 6e74 2063 616c 6c73 2074 6f20  equent calls to 
+0000d710: 7468 6973 2066 756e 6374 696f 6e2e 0a0a  this function...
+0000d720: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+0000d730: 6675 6e63 7469 6f6e 2061 6c73 6f20 7570  function also up
+0000d740: 6461 7465 7320 696e 7465 726e 616c 206d  dates internal m
+0000d750: 656d 6265 7273 206f 6620 7468 6520 6060  embers of the ``
+0000d760: 6675 6e63 6060 206f 626a 6563 7420 746f  func`` object to
+0000d770: 2072 6566 6c65 6374 2062 7569 6c64 2070   reflect build p
+0000d780: 726f 6365 7373 2069 6e66 6f2e 0a20 2020  rocess info..   
+0000d790: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+0000d7a0: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+0000d7b0: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
+0000d7c0: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+0000d7d0: 616d 6522 3a20 6e6f 726d 616c 697a 655f  ame": normalize_
+0000d7e0: 6e61 6d65 2866 756e 632e 6d65 7461 6461  name(func.metada
+0000d7f0: 7461 2e6e 616d 6529 2c0a 2020 2020 2020  ta.name),.      
+0000d800: 2020 2020 2020 2020 2020 2270 726f 6a65            "proje
+0000d810: 6374 223a 2066 756e 632e 6d65 7461 6461  ct": func.metada
+0000d820: 7461 2e70 726f 6a65 6374 2c0a 2020 2020  ta.project,.    
+0000d830: 2020 2020 2020 2020 2020 2020 2274 6167              "tag
+0000d840: 223a 2066 756e 632e 6d65 7461 6461 7461  ": func.metadata
+0000d850: 2e74 6167 2c0a 2020 2020 2020 2020 2020  .tag,.          
+0000d860: 2020 2020 2020 226c 6f67 7322 3a20 626f        "logs": bo
+0000d870: 6f6c 3273 7472 286c 6f67 7329 2c0a 2020  ol2str(logs),.  
+0000d880: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+0000d890: 6666 7365 7422 3a20 7374 7228 6f66 6673  ffset": str(offs
+0000d8a0: 6574 292c 0a20 2020 2020 2020 2020 2020  et),.           
+0000d8b0: 2020 2020 2022 6c61 7374 5f6c 6f67 5f74       "last_log_t
+0000d8c0: 696d 6573 7461 6d70 223a 2073 7472 286c  imestamp": str(l
+0000d8d0: 6173 745f 6c6f 675f 7469 6d65 7374 616d  ast_log_timestam
+0000d8e0: 7029 2c0a 2020 2020 2020 2020 2020 2020  p),.            
+0000d8f0: 2020 2020 2276 6572 626f 7365 223a 2062      "verbose": b
+0000d900: 6f6f 6c32 7374 7228 7665 7262 6f73 6529  ool2str(verbose)
+0000d910: 2c0a 2020 2020 2020 2020 2020 2020 7d0a  ,.            }.
+0000d920: 2020 2020 2020 2020 2020 2020 7265 7370              resp
+0000d930: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+0000d940: 2822 4745 5422 2c20 2262 7569 6c64 2f73  ("GET", "build/s
+0000d950: 7461 7475 7322 2c20 7061 7261 6d73 3d70  tatus", params=p
+0000d960: 6172 616d 7329 0a20 2020 2020 2020 2065  arams).        e
+0000d970: 7863 6570 7420 4f53 4572 726f 7220 6173  xcept OSError as
+0000d980: 2065 7272 3a0a 2020 2020 2020 2020 2020   err:.          
+0000d990: 2020 6c6f 6767 6572 2e65 7272 6f72 2866    logger.error(f
+0000d9a0: 2265 7272 6f72 2067 6574 7469 6e67 2062  "error getting b
+0000d9b0: 7569 6c64 2073 7461 7475 733a 207b 6572  uild status: {er
+0000d9c0: 725f 746f 5f73 7472 2865 7272 297d 2229  r_to_str(err)}")
+0000d9d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000d9e0: 7365 204f 5345 7272 6f72 2866 2265 7272  se OSError(f"err
+0000d9f0: 6f72 3a20 6361 6e6e 6f74 2067 6574 2062  or: cannot get b
+0000da00: 7569 6c64 2073 7461 7475 732c 207b 6572  uild status, {er
+0000da10: 725f 746f 5f73 7472 2865 7272 297d 2229  r_to_str(err)}")
+0000da20: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+0000da30: 2072 6573 702e 6f6b 3a0a 2020 2020 2020   resp.ok:.      
+0000da40: 2020 2020 2020 6c6f 6767 6572 2e77 6172        logger.war
+0000da50: 6e69 6e67 2866 2266 6169 6c65 6420 7265  ning(f"failed re
+0000da60: 7370 2c20 7b72 6573 702e 7465 7874 7d22  sp, {resp.text}"
+0000da70: 290a 2020 2020 2020 2020 2020 2020 7261  ).            ra
+0000da80: 6973 6520 5275 6e44 4245 7272 6f72 2822  ise RunDBError("
+0000da90: 6261 6420 6675 6e63 7469 6f6e 2062 7569  bad function bui
+0000daa0: 6c64 2072 6573 706f 6e73 6522 290a 0a20  ld response").. 
+0000dab0: 2020 2020 2020 2069 6620 7265 7370 2e68         if resp.h
+0000dac0: 6561 6465 7273 3a0a 2020 2020 2020 2020  eaders:.        
+0000dad0: 2020 2020 6675 6e63 2e73 7461 7475 732e      func.status.
+0000dae0: 7374 6174 6520 3d20 7265 7370 2e68 6561  state = resp.hea
+0000daf0: 6465 7273 2e67 6574 2822 782d 6d6c 7275  ders.get("x-mlru
+0000db00: 6e2d 6675 6e63 7469 6f6e 2d73 7461 7475  n-function-statu
+0000db10: 7322 2c20 2222 290a 2020 2020 2020 2020  s", "").        
+0000db20: 2020 2020 6c61 7374 5f6c 6f67 5f74 696d      last_log_tim
+0000db30: 6573 7461 6d70 203d 2066 6c6f 6174 280a  estamp = float(.
 0000db40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000db50: 6675 6e63 2e73 7461 7475 732e 696e 7465  func.status.inte
-0000db60: 726e 616c 5f69 6e76 6f63 6174 696f 6e5f  rnal_invocation_
-0000db70: 7572 6c73 203d 2072 6573 702e 6865 6164  urls = resp.head
-0000db80: 6572 732e 6765 7428 0a20 2020 2020 2020  ers.get(.       
-0000db90: 2020 2020 2020 2020 2020 2020 2022 782d               "x-
-0000dba0: 6d6c 7275 6e2d 696e 7465 726e 616c 2d69  mlrun-internal-i
-0000dbb0: 6e76 6f63 6174 696f 6e2d 7572 6c73 222c  nvocation-urls",
-0000dbc0: 2022 220a 2020 2020 2020 2020 2020 2020   "".            
-0000dbd0: 2020 2020 292e 7370 6c69 7428 222c 2229      ).split(",")
-0000dbe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000dbf0: 2066 756e 632e 7374 6174 7573 2e65 7874   func.status.ext
-0000dc00: 6572 6e61 6c5f 696e 766f 6361 7469 6f6e  ernal_invocation
-0000dc10: 5f75 726c 7320 3d20 7265 7370 2e68 6561  _urls = resp.hea
-0000dc20: 6465 7273 2e67 6574 280a 2020 2020 2020  ders.get(.      
-0000dc30: 2020 2020 2020 2020 2020 2020 2020 2278                "x
-0000dc40: 2d6d 6c72 756e 2d65 7874 6572 6e61 6c2d  -mlrun-external-
-0000dc50: 696e 766f 6361 7469 6f6e 2d75 726c 7322  invocation-urls"
-0000dc60: 2c20 2222 0a20 2020 2020 2020 2020 2020  , "".           
-0000dc70: 2020 2020 2029 2e73 706c 6974 2822 2c22       ).split(","
-0000dc80: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000dc90: 2020 6675 6e63 2e73 7461 7475 732e 636f    func.status.co
-0000dca0: 6e74 6169 6e65 725f 696d 6167 6520 3d20  ntainer_image = 
-0000dcb0: 7265 7370 2e68 6561 6465 7273 2e67 6574  resp.headers.get
-0000dcc0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000dcd0: 2020 2020 2020 2278 2d6d 6c72 756e 2d63        "x-mlrun-c
-0000dce0: 6f6e 7461 696e 6572 2d69 6d61 6765 222c  ontainer-image",
-0000dcf0: 2022 220a 2020 2020 2020 2020 2020 2020   "".            
-0000dd00: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0000dd10: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000dd20: 2020 2020 2020 2020 6675 6e63 2e73 7461          func.sta
-0000dd30: 7475 732e 6275 696c 645f 706f 6420 3d20  tus.build_pod = 
-0000dd40: 7265 7370 2e68 6561 6465 7273 2e67 6574  resp.headers.get
-0000dd50: 2822 6275 696c 6465 725f 706f 6422 2c20  ("builder_pod", 
-0000dd60: 2222 290a 2020 2020 2020 2020 2020 2020  "").            
-0000dd70: 2020 2020 6675 6e63 2e73 7065 632e 696d      func.spec.im
-0000dd80: 6167 6520 3d20 7265 7370 2e68 6561 6465  age = resp.heade
-0000dd90: 7273 2e67 6574 2822 6675 6e63 7469 6f6e  rs.get("function
-0000dda0: 5f69 6d61 6765 222c 2022 2229 0a0a 2020  _image", "")..  
-0000ddb0: 2020 2020 2020 7465 7874 203d 2022 220a        text = "".
-0000ddc0: 2020 2020 2020 2020 6966 2072 6573 702e          if resp.
-0000ddd0: 636f 6e74 656e 743a 0a20 2020 2020 2020  content:.       
-0000dde0: 2020 2020 2074 6578 7420 3d20 7265 7370       text = resp
-0000ddf0: 2e63 6f6e 7465 6e74 2e64 6563 6f64 6528  .content.decode(
-0000de00: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0000de10: 2074 6578 742c 206c 6173 745f 6c6f 675f   text, last_log_
-0000de20: 7469 6d65 7374 616d 700a 0a20 2020 2064  timestamp..    d
-0000de30: 6566 2072 656d 6f74 655f 7374 6172 7428  ef remote_start(
-0000de40: 7365 6c66 2c20 6675 6e63 5f75 726c 2920  self, func_url) 
-0000de50: 2d3e 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  -> mlrun.common.
-0000de60: 7363 6865 6d61 732e 4261 636b 6772 6f75  schemas.Backgrou
-0000de70: 6e64 5461 736b 3a0a 2020 2020 2020 2020  ndTask:.        
-0000de80: 2222 2245 7865 6375 7465 2061 2066 756e  """Execute a fun
-0000de90: 6374 696f 6e20 7265 6d6f 7465 6c79 2c20  ction remotely, 
-0000dea0: 5573 6564 2066 6f72 2060 6064 6173 6b60  Used for ``dask`
-0000deb0: 6020 6675 6e63 7469 6f6e 732e 0a0a 2020  ` functions...  
-0000dec0: 2020 2020 2020 3a70 6172 616d 2066 756e        :param fun
-0000ded0: 635f 7572 6c3a 2055 524c 2074 6f20 7468  c_url: URL to th
-0000dee0: 6520 6675 6e63 7469 6f6e 2074 6f20 6265  e function to be
-0000def0: 2065 7865 6375 7465 642e 0a20 2020 2020   executed..     
-0000df00: 2020 203a 7265 7475 726e 733a 2041 2042     :returns: A B
-0000df10: 6163 6b67 726f 756e 6454 6173 6b20 6f62  ackgroundTask ob
-0000df20: 6a65 6374 2c20 7769 7468 2064 6574 6169  ject, with detai
-0000df30: 6c73 206f 6e20 6578 6563 7574 696f 6e20  ls on execution 
-0000df40: 7072 6f63 6573 7320 616e 6420 6974 7320  process and its 
-0000df50: 7374 6174 7573 2e0a 2020 2020 2020 2020  status..        
-0000df60: 2222 220a 0a20 2020 2020 2020 2074 7279  """..        try
-0000df70: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0000df80: 7120 3d20 7b22 6675 6e63 7469 6f6e 5572  q = {"functionUr
-0000df90: 6c22 3a20 6675 6e63 5f75 726c 7d0a 2020  l": func_url}.  
-0000dfa0: 2020 2020 2020 2020 2020 7265 7370 203d            resp =
-0000dfb0: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
-0000dfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dfd0: 2250 4f53 5422 2c0a 2020 2020 2020 2020  "POST",.        
-0000dfe0: 2020 2020 2020 2020 2273 7461 7274 2f66          "start/f
-0000dff0: 756e 6374 696f 6e22 2c0a 2020 2020 2020  unction",.      
-0000e000: 2020 2020 2020 2020 2020 6a73 6f6e 3d72            json=r
-0000e010: 6571 2c0a 2020 2020 2020 2020 2020 2020  eq,.            
-0000e020: 2020 2020 7469 6d65 6f75 743d 696e 7428      timeout=int(
-0000e030: 636f 6e66 6967 2e73 7562 6d69 745f 7469  config.submit_ti
-0000e040: 6d65 6f75 7429 206f 7220 3630 2c0a 2020  meout) or 60,.  
-0000e050: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000e060: 2020 2020 6578 6365 7074 204f 5345 7272      except OSErr
-0000e070: 6f72 2061 7320 6572 723a 0a20 2020 2020  or as err:.     
-0000e080: 2020 2020 2020 206c 6f67 6765 722e 6572         logger.er
-0000e090: 726f 7228 6622 6572 726f 7220 7374 6172  ror(f"error star
-0000e0a0: 7469 6e67 2066 756e 6374 696f 6e3a 207b  ting function: {
-0000e0b0: 6572 725f 746f 5f73 7472 2865 7272 297d  err_to_str(err)}
-0000e0c0: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
-0000e0d0: 6169 7365 204f 5345 7272 6f72 2866 2265  aise OSError(f"e
-0000e0e0: 7272 6f72 3a20 6361 6e6e 6f74 2073 7461  rror: cannot sta
-0000e0f0: 7274 2066 756e 6374 696f 6e2c 207b 6572  rt function, {er
-0000e100: 725f 746f 5f73 7472 2865 7272 297d 2229  r_to_str(err)}")
-0000e110: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0000e120: 2072 6573 702e 6f6b 3a0a 2020 2020 2020   resp.ok:.      
-0000e130: 2020 2020 2020 6c6f 6767 6572 2e65 7272        logger.err
-0000e140: 6f72 2866 2262 6164 2072 6573 7021 215c  or(f"bad resp!!\
-0000e150: 6e7b 7265 7370 2e74 6578 747d 2229 0a20  n{resp.text}"). 
-0000e160: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000e170: 2056 616c 7565 4572 726f 7228 2262 6164   ValueError("bad
-0000e180: 2066 756e 6374 696f 6e20 7374 6172 7420   function start 
-0000e190: 7265 7370 6f6e 7365 2229 0a0a 2020 2020  response")..    
-0000e1a0: 2020 2020 7265 7475 726e 206d 6c72 756e      return mlrun
-0000e1b0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-0000e1c0: 4261 636b 6772 6f75 6e64 5461 736b 282a  BackgroundTask(*
-0000e1d0: 2a72 6573 702e 6a73 6f6e 2829 290a 0a20  *resp.json()).. 
-0000e1e0: 2020 2064 6566 2067 6574 5f70 726f 6a65     def get_proje
-0000e1f0: 6374 5f62 6163 6b67 726f 756e 645f 7461  ct_background_ta
-0000e200: 736b 280a 2020 2020 2020 2020 7365 6c66  sk(.        self
-0000e210: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
-0000e220: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
-0000e230: 6e61 6d65 3a20 7374 722c 0a20 2020 2029  name: str,.    )
-0000e240: 202d 3e20 6d6c 7275 6e2e 636f 6d6d 6f6e   -> mlrun.common
-0000e250: 2e73 6368 656d 6173 2e42 6163 6b67 726f  .schemas.Backgro
-0000e260: 756e 6454 6173 6b3a 0a20 2020 2020 2020  undTask:.       
-0000e270: 2022 2222 5265 7472 6965 7665 2075 7064   """Retrieve upd
-0000e280: 6174 6564 2069 6e66 6f72 6d61 7469 6f6e  ated information
-0000e290: 206f 6e20 6120 7072 6f6a 6563 7420 6261   on a project ba
-0000e2a0: 636b 6772 6f75 6e64 2074 6173 6b20 6265  ckground task be
-0000e2b0: 696e 6720 6578 6563 7574 6564 2e22 2222  ing executed."""
-0000e2c0: 0a0a 2020 2020 2020 2020 7072 6f6a 6563  ..        projec
-0000e2d0: 7420 3d20 7072 6f6a 6563 7420 6f72 2063  t = project or c
-0000e2e0: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
-0000e2f0: 6f6a 6563 740a 2020 2020 2020 2020 7061  oject.        pa
-0000e300: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-0000e310: 7b70 726f 6a65 6374 7d2f 6261 636b 6772  {project}/backgr
-0000e320: 6f75 6e64 2d74 6173 6b73 2f7b 6e61 6d65  ound-tasks/{name
-0000e330: 7d22 0a20 2020 2020 2020 2065 7272 6f72  }".        error
-0000e340: 5f6d 6573 7361 6765 203d 2028 0a20 2020  _message = (.   
-0000e350: 2020 2020 2020 2020 2066 2246 6169 6c65           f"Faile
-0000e360: 6420 6765 7474 696e 6720 7072 6f6a 6563  d getting projec
-0000e370: 7420 6261 636b 6772 6f75 6e64 2074 6173  t background tas
-0000e380: 6b2e 2070 726f 6a65 6374 3d7b 7072 6f6a  k. project={proj
-0000e390: 6563 747d 2c20 6e61 6d65 3d7b 6e61 6d65  ect}, name={name
-0000e3a0: 7d22 0a20 2020 2020 2020 2029 0a20 2020  }".        ).   
-0000e3b0: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
-0000e3c0: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
-0000e3d0: 4554 222c 2070 6174 682c 2065 7272 6f72  ET", path, error
-0000e3e0: 5f6d 6573 7361 6765 290a 2020 2020 2020  _message).      
-0000e3f0: 2020 7265 7475 726e 206d 6c72 756e 2e63    return mlrun.c
-0000e400: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4261  ommon.schemas.Ba
-0000e410: 636b 6772 6f75 6e64 5461 736b 282a 2a72  ckgroundTask(**r
-0000e420: 6573 706f 6e73 652e 6a73 6f6e 2829 290a  esponse.json()).
-0000e430: 0a20 2020 2064 6566 2067 6574 5f62 6163  .    def get_bac
-0000e440: 6b67 726f 756e 645f 7461 736b 2873 656c  kground_task(sel
-0000e450: 662c 206e 616d 653a 2073 7472 2920 2d3e  f, name: str) ->
-0000e460: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-0000e470: 6865 6d61 732e 4261 636b 6772 6f75 6e64  hemas.Background
-0000e480: 5461 736b 3a0a 2020 2020 2020 2020 2222  Task:.        ""
-0000e490: 2252 6574 7269 6576 6520 7570 6461 7465  "Retrieve update
-0000e4a0: 6420 696e 666f 726d 6174 696f 6e20 6f6e  d information on
-0000e4b0: 2061 2062 6163 6b67 726f 756e 6420 7461   a background ta
-0000e4c0: 736b 2062 6569 6e67 2065 7865 6375 7465  sk being execute
-0000e4d0: 642e 2222 220a 0a20 2020 2020 2020 2070  d."""..        p
-0000e4e0: 6174 6820 3d20 6622 6261 636b 6772 6f75  ath = f"backgrou
-0000e4f0: 6e64 2d74 6173 6b73 2f7b 6e61 6d65 7d22  nd-tasks/{name}"
-0000e500: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-0000e510: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
-0000e520: 6420 6765 7474 696e 6720 6261 636b 6772  d getting backgr
-0000e530: 6f75 6e64 2074 6173 6b2e 206e 616d 653d  ound task. name=
-0000e540: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
-0000e550: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
-0000e560: 6170 695f 6361 6c6c 2822 4745 5422 2c20  api_call("GET", 
-0000e570: 7061 7468 2c20 6572 726f 725f 6d65 7373  path, error_mess
-0000e580: 6167 6529 0a20 2020 2020 2020 2072 6574  age).        ret
-0000e590: 7572 6e20 6d6c 7275 6e2e 636f 6d6d 6f6e  urn mlrun.common
-0000e5a0: 2e73 6368 656d 6173 2e42 6163 6b67 726f  .schemas.Backgro
-0000e5b0: 756e 6454 6173 6b28 2a2a 7265 7370 6f6e  undTask(**respon
-0000e5c0: 7365 2e6a 736f 6e28 2929 0a0a 2020 2020  se.json())..    
-0000e5d0: 6465 6620 7265 6d6f 7465 5f73 7461 7475  def remote_statu
-0000e5e0: 7328 7365 6c66 2c20 7072 6f6a 6563 742c  s(self, project,
-0000e5f0: 206e 616d 652c 206b 696e 642c 2073 656c   name, kind, sel
-0000e600: 6563 746f 7229 3a0a 2020 2020 2020 2020  ector):.        
-0000e610: 2222 2252 6574 7269 6576 6520 7374 6174  """Retrieve stat
-0000e620: 7573 206f 6620 6120 6675 6e63 7469 6f6e  us of a function
-0000e630: 2062 6569 6e67 2065 7865 6375 7465 6420   being executed 
-0000e640: 7265 6d6f 7465 6c79 2028 7265 6c65 7661  remotely (releva
-0000e650: 6e74 2074 6f20 6060 6461 736b 6060 2066  nt to ``dask`` f
-0000e660: 756e 6374 696f 6e73 292e 0a0a 2020 2020  unctions)...    
-0000e670: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
-0000e680: 6374 3a20 5468 6520 7072 6f6a 6563 7420  ct: The project 
-0000e690: 6f66 2074 6865 2066 756e 6374 696f 6e0a  of the function.
-0000e6a0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-0000e6b0: 616d 653a 2054 6865 206e 616d 6520 6f66  ame: The name of
-0000e6c0: 2074 6865 2066 756e 6374 696f 6e0a 2020   the function.  
-0000e6d0: 2020 2020 2020 3a70 6172 616d 206b 696e        :param kin
-0000e6e0: 643a 2054 6865 206b 696e 6420 6f66 2074  d: The kind of t
-0000e6f0: 6865 2066 756e 6374 696f 6e2c 2063 7572  he function, cur
-0000e700: 7265 6e74 6c79 2060 6064 6173 6b60 6020  rently ``dask`` 
-0000e710: 6973 2073 7570 706f 7274 6564 2e0a 2020  is supported..  
-0000e720: 2020 2020 2020 3a70 6172 616d 2073 656c        :param sel
-0000e730: 6563 746f 723a 2053 656c 6563 746f 7220  ector: Selector 
-0000e740: 636c 6175 7365 2074 6f20 6265 2061 7070  clause to be app
-0000e750: 6c69 6564 2074 6f20 7468 6520 4b75 6265  lied to the Kube
-0000e760: 726e 6574 6573 2073 7461 7475 7320 7175  rnetes status qu
-0000e770: 6572 7920 746f 2066 696c 7465 7220 7468  ery to filter th
-0000e780: 6520 7265 7375 6c74 732e 0a20 2020 2020  e results..     
-0000e790: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-0000e7a0: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-0000e7b0: 2072 6571 203d 207b 226b 696e 6422 3a20   req = {"kind": 
-0000e7c0: 6b69 6e64 2c20 2273 656c 6563 746f 7222  kind, "selector"
-0000e7d0: 3a20 7365 6c65 6374 6f72 2c20 2270 726f  : selector, "pro
-0000e7e0: 6a65 6374 223a 2070 726f 6a65 6374 2c20  ject": project, 
-0000e7f0: 226e 616d 6522 3a20 6e61 6d65 7d0a 2020  "name": name}.  
-0000e800: 2020 2020 2020 2020 2020 7265 7370 203d            resp =
-0000e810: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
-0000e820: 504f 5354 222c 2022 7374 6174 7573 2f66  POST", "status/f
-0000e830: 756e 6374 696f 6e22 2c20 6a73 6f6e 3d72  unction", json=r
-0000e840: 6571 290a 2020 2020 2020 2020 6578 6365  eq).        exce
-0000e850: 7074 204f 5345 7272 6f72 2061 7320 6572  pt OSError as er
-0000e860: 723a 0a20 2020 2020 2020 2020 2020 206c  r:.            l
-0000e870: 6f67 6765 722e 6572 726f 7228 6622 6572  ogger.error(f"er
-0000e880: 726f 7220 7374 6172 7469 6e67 2066 756e  ror starting fun
-0000e890: 6374 696f 6e3a 207b 6572 725f 746f 5f73  ction: {err_to_s
-0000e8a0: 7472 2865 7272 297d 2229 0a20 2020 2020  tr(err)}").     
-0000e8b0: 2020 2020 2020 2072 6169 7365 204f 5345         raise OSE
-0000e8c0: 7272 6f72 2866 2265 7272 6f72 3a20 6361  rror(f"error: ca
-0000e8d0: 6e6e 6f74 2073 7461 7274 2066 756e 6374  nnot start funct
-0000e8e0: 696f 6e2c 207b 6572 725f 746f 5f73 7472  ion, {err_to_str
-0000e8f0: 2865 7272 297d 2229 0a0a 2020 2020 2020  (err)}")..      
-0000e900: 2020 6966 206e 6f74 2072 6573 702e 6f6b    if not resp.ok
-0000e910: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
-0000e920: 6767 6572 2e65 7272 6f72 2866 2262 6164  gger.error(f"bad
-0000e930: 2072 6573 7021 215c 6e7b 7265 7370 2e74   resp!!\n{resp.t
-0000e940: 6578 747d 2229 0a20 2020 2020 2020 2020  ext}").         
-0000e950: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0000e960: 726f 7228 2262 6164 2066 756e 6374 696f  ror("bad functio
-0000e970: 6e20 7374 6174 7573 2072 6573 706f 6e73  n status respons
-0000e980: 6522 290a 0a20 2020 2020 2020 2072 6574  e")..        ret
-0000e990: 7572 6e20 7265 7370 2e6a 736f 6e28 295b  urn resp.json()[
-0000e9a0: 2264 6174 6122 5d0a 0a20 2020 2064 6566  "data"]..    def
-0000e9b0: 2073 7562 6d69 745f 6a6f 6228 0a20 2020   submit_job(.   
-0000e9c0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000e9d0: 2020 2072 756e 7370 6563 2c0a 2020 2020     runspec,.    
-0000e9e0: 2020 2020 7363 6865 6475 6c65 3a20 556e      schedule: Un
-0000e9f0: 696f 6e5b 7374 722c 206d 6c72 756e 2e63  ion[str, mlrun.c
-0000ea00: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5363  ommon.schemas.Sc
-0000ea10: 6865 6475 6c65 4372 6f6e 5472 6967 6765  heduleCronTrigge
-0000ea20: 725d 203d 204e 6f6e 652c 0a20 2020 2029  r] = None,.    )
-0000ea30: 3a0a 2020 2020 2020 2020 2222 2253 7562  :.        """Sub
-0000ea40: 6d69 7420 6120 6a6f 6220 666f 7220 7265  mit a job for re
-0000ea50: 6d6f 7465 2065 7865 6375 7469 6f6e 2e0a  mote execution..
-0000ea60: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000ea70: 7275 6e73 7065 633a 2054 6865 2072 756e  runspec: The run
-0000ea80: 7469 6d65 206f 626a 6563 7420 7370 6563  time object spec
-0000ea90: 2028 5461 736b 2920 746f 2065 7865 6375   (Task) to execu
-0000eaa0: 7465 2e0a 2020 2020 2020 2020 3a70 6172  te..        :par
-0000eab0: 616d 2073 6368 6564 756c 653a 2057 6865  am schedule: Whe
-0000eac0: 7468 6572 2074 6f20 7363 6865 6475 6c65  ther to schedule
-0000ead0: 2074 6869 7320 6a6f 6220 7573 696e 6720   this job using 
-0000eae0: 6120 4372 6f6e 2074 7269 6767 6572 2e20  a Cron trigger. 
-0000eaf0: 4966 206e 6f74 2073 7065 6369 6669 6564  If not specified
-0000eb00: 2c20 7468 6520 6a6f 6220 7769 6c6c 2062  , the job will b
-0000eb10: 6520 7375 626d 6974 7465 640a 2020 2020  e submitted.    
-0000eb20: 2020 2020 2020 2020 696d 6d65 6469 6174          immediat
-0000eb30: 656c 792e 0a20 2020 2020 2020 2022 2222  ely..        """
-0000eb40: 0a0a 2020 2020 2020 2020 7472 793a 0a20  ..        try:. 
-0000eb50: 2020 2020 2020 2020 2020 2072 6571 203d             req =
-0000eb60: 207b 2274 6173 6b22 3a20 7275 6e73 7065   {"task": runspe
-0000eb70: 632e 746f 5f64 6963 7428 297d 0a20 2020  c.to_dict()}.   
-0000eb80: 2020 2020 2020 2020 2069 6620 7363 6865           if sche
-0000eb90: 6475 6c65 3a0a 2020 2020 2020 2020 2020  dule:.          
-0000eba0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0000ebb0: 6e63 6528 7363 6865 6475 6c65 2c20 6d6c  nce(schedule, ml
-0000ebc0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0000ebd0: 6173 2e53 6368 6564 756c 6543 726f 6e54  as.ScheduleCronT
-0000ebe0: 7269 6767 6572 293a 0a20 2020 2020 2020  rigger):.       
-0000ebf0: 2020 2020 2020 2020 2020 2020 2073 6368               sch
-0000ec00: 6564 756c 6520 3d20 7363 6865 6475 6c65  edule = schedule
-0000ec10: 2e64 6963 7428 290a 2020 2020 2020 2020  .dict().        
-0000ec20: 2020 2020 2020 2020 7265 715b 2273 6368          req["sch
-0000ec30: 6564 756c 6522 5d20 3d20 7363 6865 6475  edule"] = schedu
-0000ec40: 6c65 0a20 2020 2020 2020 2020 2020 2074  le.            t
-0000ec50: 696d 656f 7574 203d 2028 696e 7428 636f  imeout = (int(co
-0000ec60: 6e66 6967 2e73 7562 6d69 745f 7469 6d65  nfig.submit_time
-0000ec70: 6f75 7429 206f 7220 3132 3029 202b 2032  out) or 120) + 2
-0000ec80: 300a 2020 2020 2020 2020 2020 2020 7265  0.            re
-0000ec90: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
-0000eca0: 6c6c 2822 504f 5354 222c 2022 7375 626d  ll("POST", "subm
-0000ecb0: 6974 5f6a 6f62 222c 206a 736f 6e3d 7265  it_job", json=re
-0000ecc0: 712c 2074 696d 656f 7574 3d74 696d 656f  q, timeout=timeo
-0000ecd0: 7574 290a 0a20 2020 2020 2020 2065 7863  ut)..        exc
-0000ece0: 6570 7420 7265 7175 6573 7473 2e48 5454  ept requests.HTT
-0000ecf0: 5045 7272 6f72 2061 7320 6572 723a 0a20  PError as err:. 
-0000ed00: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
-0000ed10: 722e 6572 726f 7228 6622 6572 726f 7220  r.error(f"error 
-0000ed20: 7375 626d 6974 7469 6e67 2074 6173 6b3a  submitting task:
-0000ed30: 207b 6572 725f 746f 5f73 7472 2865 7272   {err_to_str(err
-0000ed40: 297d 2229 0a20 2020 2020 2020 2020 2020  )}").           
-0000ed50: 2023 206e 6f74 2063 7265 6174 696e 6720   # not creating 
-0000ed60: 6120 6e65 7720 6578 6365 7074 696f 6e20  a new exception 
-0000ed70: 6865 7265 2c20 696e 206f 7264 6572 2074  here, in order t
-0000ed80: 6f20 6b65 6570 2074 6865 2072 6573 706f  o keep the respo
-0000ed90: 6e73 6520 616e 6420 7374 6174 7573 2063  nse and status c
-0000eda0: 6f64 6520 696e 2074 6865 2065 7863 6570  ode in the excep
-0000edb0: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
-0000edc0: 2072 6169 7365 0a0a 2020 2020 2020 2020   raise..        
-0000edd0: 6578 6365 7074 204f 5345 7272 6f72 2061  except OSError a
-0000ede0: 7320 6572 723a 0a20 2020 2020 2020 2020  s err:.         
-0000edf0: 2020 206c 6f67 6765 722e 6572 726f 7228     logger.error(
-0000ee00: 6622 6572 726f 7220 7375 626d 6974 7469  f"error submitti
-0000ee10: 6e67 2074 6173 6b3a 207b 6572 725f 746f  ng task: {err_to
-0000ee20: 5f73 7472 2865 7272 297d 2229 0a20 2020  _str(err)}").   
-0000ee30: 2020 2020 2020 2020 2072 6169 7365 204f           raise O
-0000ee40: 5345 7272 6f72 2822 6572 726f 723a 2063  SError("error: c
-0000ee50: 616e 6e6f 7420 7375 626d 6974 2074 6173  annot submit tas
-0000ee60: 6b22 2920 6672 6f6d 2065 7272 0a0a 2020  k") from err..  
-0000ee70: 2020 2020 2020 6966 206e 6f74 2072 6573        if not res
-0000ee80: 702e 6f6b 3a0a 2020 2020 2020 2020 2020  p.ok:.          
-0000ee90: 2020 6c6f 6767 6572 2e65 7272 6f72 2866    logger.error(f
-0000eea0: 2262 6164 2072 6573 7021 215c 6e7b 7265  "bad resp!!\n{re
-0000eeb0: 7370 2e74 6578 747d 2229 0a20 2020 2020  sp.text}").     
-0000eec0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0000eed0: 7565 4572 726f 7228 6622 6261 6420 6675  ueError(f"bad fu
-0000eee0: 6e63 7469 6f6e 2072 756e 2072 6573 706f  nction run respo
-0000eef0: 6e73 652c 207b 7265 7370 2e74 6578 747d  nse, {resp.text}
-0000ef00: 2229 0a0a 2020 2020 2020 2020 7265 7370  ")..        resp
-0000ef10: 203d 2072 6573 702e 6a73 6f6e 2829 0a20   = resp.json(). 
-0000ef20: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-0000ef30: 7370 5b22 6461 7461 225d 0a0a 2020 2020  sp["data"]..    
-0000ef40: 6465 6620 7375 626d 6974 5f70 6970 656c  def submit_pipel
-0000ef50: 696e 6528 0a20 2020 2020 2020 2073 656c  ine(.        sel
-0000ef60: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
-0000ef70: 6374 2c0a 2020 2020 2020 2020 7069 7065  ct,.        pipe
-0000ef80: 6c69 6e65 2c0a 2020 2020 2020 2020 6172  line,.        ar
-0000ef90: 6775 6d65 6e74 733d 4e6f 6e65 2c0a 2020  guments=None,.  
-0000efa0: 2020 2020 2020 6578 7065 7269 6d65 6e74        experiment
-0000efb0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2072  =None,.        r
-0000efc0: 756e 3d4e 6f6e 652c 0a20 2020 2020 2020  un=None,.       
-0000efd0: 206e 616d 6573 7061 6365 3d4e 6f6e 652c   namespace=None,
-0000efe0: 0a20 2020 2020 2020 2061 7274 6966 6163  .        artifac
-0000eff0: 745f 7061 7468 3d4e 6f6e 652c 0a20 2020  t_path=None,.   
-0000f000: 2020 2020 206f 7073 3d4e 6f6e 652c 0a20       ops=None,. 
-0000f010: 2020 2020 2020 2063 6c65 616e 7570 5f74         cleanup_t
-0000f020: 746c 3d4e 6f6e 652c 0a20 2020 2029 3a0a  tl=None,.    ):.
-0000f030: 2020 2020 2020 2020 2222 2253 7562 6d69          """Submi
-0000f040: 7420 6120 4b46 5020 7069 7065 6c69 6e65  t a KFP pipeline
-0000f050: 2066 6f72 2065 7865 6375 7469 6f6e 2e0a   for execution..
-0000f060: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000f070: 7072 6f6a 6563 743a 2054 6865 2070 726f  project: The pro
-0000f080: 6a65 6374 206f 6620 7468 6520 7069 7065  ject of the pipe
-0000f090: 6c69 6e65 0a20 2020 2020 2020 203a 7061  line.        :pa
-0000f0a0: 7261 6d20 7069 7065 6c69 6e65 3a20 5069  ram pipeline: Pi
-0000f0b0: 7065 6c69 6e65 2066 756e 6374 696f 6e20  peline function 
-0000f0c0: 6f72 2070 6174 6820 746f 202e 7961 6d6c  or path to .yaml
-0000f0d0: 2f2e 7a69 7020 7069 7065 6c69 6e65 2066  /.zip pipeline f
-0000f0e0: 696c 652e 0a20 2020 2020 2020 203a 7061  ile..        :pa
-0000f0f0: 7261 6d20 6172 6775 6d65 6e74 733a 2041  ram arguments: A
-0000f100: 2064 6963 7469 6f6e 6172 7920 6f66 2061   dictionary of a
-0000f110: 7267 756d 656e 7473 2074 6f20 7061 7373  rguments to pass
-0000f120: 2074 6f20 7468 6520 7069 7065 6c69 6e65   to the pipeline
-0000f130: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000f140: 2065 7870 6572 696d 656e 743a 2041 206e   experiment: A n
-0000f150: 616d 6520 746f 2061 7373 6967 6e20 666f  ame to assign fo
-0000f160: 7220 7468 6520 7370 6563 6966 6963 2065  r the specific e
-0000f170: 7870 6572 696d 656e 742e 0a20 2020 2020  xperiment..     
-0000f180: 2020 203a 7061 7261 6d20 7275 6e3a 2041     :param run: A
-0000f190: 206e 616d 6520 666f 7220 7468 6973 2073   name for this s
-0000f1a0: 7065 6369 6669 6320 7275 6e2e 0a20 2020  pecific run..   
-0000f1b0: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
-0000f1c0: 7370 6163 653a 204b 7562 6572 6e65 7465  space: Kubernete
-0000f1d0: 7320 6e61 6d65 7370 6163 6520 746f 2065  s namespace to e
-0000f1e0: 7865 6375 7465 2074 6865 2070 6970 656c  xecute the pipel
-0000f1f0: 696e 6520 696e 2e0a 2020 2020 2020 2020  ine in..        
-0000f200: 3a70 6172 616d 2061 7274 6966 6163 745f  :param artifact_
-0000f210: 7061 7468 3a20 4120 7061 7468 2074 6f20  path: A path to 
-0000f220: 6172 7469 6661 6374 7320 7573 6564 2062  artifacts used b
-0000f230: 7920 7468 6973 2070 6970 656c 696e 652e  y this pipeline.
-0000f240: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000f250: 6f70 733a 2054 7261 6e73 666f 726d 6572  ops: Transformer
-0000f260: 7320 746f 2061 7070 6c79 206f 6e20 616c  s to apply on al
-0000f270: 6c20 6f70 7320 696e 2074 6865 2070 6970  l ops in the pip
-0000f280: 656c 696e 652e 0a20 2020 2020 2020 203a  eline..        :
-0000f290: 7061 7261 6d20 636c 6561 6e75 705f 7474  param cleanup_tt
-0000f2a0: 6c3a 2070 6970 656c 696e 6520 636c 6561  l: pipeline clea
-0000f2b0: 6e75 7020 7474 6c20 696e 2073 6563 7320  nup ttl in secs 
-0000f2c0: 2874 696d 6520 746f 2077 6169 7420 6166  (time to wait af
-0000f2d0: 7465 7220 776f 726b 666c 6f77 2063 6f6d  ter workflow com
-0000f2e0: 706c 6574 696f 6e2c 2061 7420 7768 6963  pletion, at whic
-0000f2f0: 6820 706f 696e 7420 7468 650a 2020 2020  h point the.    
-0000f300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f310: 2020 2020 2020 2020 776f 726b 666c 6f77          workflow
-0000f320: 2061 6e64 2061 6c6c 2069 7473 2072 6573   and all its res
-0000f330: 6f75 7263 6573 2061 7265 2064 656c 6574  ources are delet
-0000f340: 6564 290a 2020 2020 2020 2020 2222 220a  ed).        """.
-0000f350: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0000f360: 7374 616e 6365 2870 6970 656c 696e 652c  stance(pipeline,
-0000f370: 2073 7472 293a 0a20 2020 2020 2020 2020   str):.         
-0000f380: 2020 2070 6970 655f 6669 6c65 203d 2070     pipe_file = p
-0000f390: 6970 656c 696e 650a 2020 2020 2020 2020  ipeline.        
-0000f3a0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000f3b0: 2020 7069 7065 5f66 696c 6520 3d20 7465    pipe_file = te
-0000f3c0: 6d70 6669 6c65 2e4e 616d 6564 5465 6d70  mpfile.NamedTemp
-0000f3d0: 6f72 6172 7946 696c 6528 7375 6666 6978  oraryFile(suffix
-0000f3e0: 3d22 2e79 616d 6c22 2c20 6465 6c65 7465  =".yaml", delete
-0000f3f0: 3d46 616c 7365 292e 6e61 6d65 0a20 2020  =False).name.   
-0000f400: 2020 2020 2020 2020 2063 6f6e 6620 3d20           conf = 
-0000f410: 6e65 775f 7069 7065 5f6d 6574 6164 6174  new_pipe_metadat
-0000f420: 6128 0a20 2020 2020 2020 2020 2020 2020  a(.             
-0000f430: 2020 2061 7274 6966 6163 745f 7061 7468     artifact_path
-0000f440: 3d61 7274 6966 6163 745f 7061 7468 2c0a  =artifact_path,.
-0000f450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f460: 636c 6561 6e75 705f 7474 6c3d 636c 6561  cleanup_ttl=clea
-0000f470: 6e75 705f 7474 6c2c 0a20 2020 2020 2020  nup_ttl,.       
-0000f480: 2020 2020 2020 2020 206f 705f 7472 616e           op_tran
-0000f490: 7366 6f72 6d65 7273 3d6f 7073 2c0a 2020  sformers=ops,.  
-0000f4a0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000f4b0: 2020 2020 2020 2020 6b66 702e 636f 6d70          kfp.comp
-0000f4c0: 696c 6572 2e43 6f6d 7069 6c65 7228 292e  iler.Compiler().
-0000f4d0: 636f 6d70 696c 6528 0a20 2020 2020 2020  compile(.       
-0000f4e0: 2020 2020 2020 2020 2070 6970 656c 696e           pipelin
-0000f4f0: 652c 2070 6970 655f 6669 6c65 2c20 7479  e, pipe_file, ty
-0000f500: 7065 5f63 6865 636b 3d46 616c 7365 2c20  pe_check=False, 
-0000f510: 7069 7065 6c69 6e65 5f63 6f6e 663d 636f  pipeline_conf=co
-0000f520: 6e66 0a20 2020 2020 2020 2020 2020 2029  nf.            )
-0000f530: 0a0a 2020 2020 2020 2020 6966 2070 6970  ..        if pip
-0000f540: 655f 6669 6c65 2e65 6e64 7377 6974 6828  e_file.endswith(
-0000f550: 222e 7961 6d6c 2229 3a0a 2020 2020 2020  ".yaml"):.      
-0000f560: 2020 2020 2020 6865 6164 6572 7320 3d20        headers = 
-0000f570: 7b22 636f 6e74 656e 742d 7479 7065 223a  {"content-type":
-0000f580: 2022 6170 706c 6963 6174 696f 6e2f 7961   "application/ya
-0000f590: 6d6c 227d 0a20 2020 2020 2020 2065 6c69  ml"}.        eli
-0000f5a0: 6620 7069 7065 5f66 696c 652e 656e 6473  f pipe_file.ends
-0000f5b0: 7769 7468 2822 2e7a 6970 2229 3a0a 2020  with(".zip"):.  
-0000f5c0: 2020 2020 2020 2020 2020 6865 6164 6572            header
-0000f5d0: 7320 3d20 7b22 636f 6e74 656e 742d 7479  s = {"content-ty
-0000f5e0: 7065 223a 2022 6170 706c 6963 6174 696f  pe": "applicatio
-0000f5f0: 6e2f 7a69 7022 7d0a 2020 2020 2020 2020  n/zip"}.        
-0000f600: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000f610: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0000f620: 6f72 2822 7069 7065 6c69 6e65 2066 696c  or("pipeline fil
-0000f630: 6520 6d75 7374 2062 6520 2e79 616d 6c20  e must be .yaml 
-0000f640: 6f72 202e 7a69 7022 290a 2020 2020 2020  or .zip").      
-0000f650: 2020 6966 2061 7267 756d 656e 7473 3a0a    if arguments:.
-0000f660: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0000f670: 6f74 2069 7369 6e73 7461 6e63 6528 6172  ot isinstance(ar
-0000f680: 6775 6d65 6e74 732c 2064 6963 7429 3a0a  guments, dict):.
-0000f690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f6a0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0000f6b0: 2822 6172 6775 6d65 6e74 7320 6d75 7374  ("arguments must
-0000f6c0: 2062 6520 6469 6374 2074 7970 6522 290a   be dict type").
-0000f6d0: 2020 2020 2020 2020 2020 2020 6865 6164              head
-0000f6e0: 6572 735b 6d6c 7275 6e2e 636f 6d6d 6f6e  ers[mlrun.common
-0000f6f0: 2e73 6368 656d 6173 2e48 6561 6465 724e  .schemas.HeaderN
-0000f700: 616d 6573 2e70 6970 656c 696e 655f 6172  ames.pipeline_ar
-0000f710: 6775 6d65 6e74 735d 203d 2073 7472 280a  guments] = str(.
-0000f720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f730: 6172 6775 6d65 6e74 730a 2020 2020 2020  arguments.      
-0000f740: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0000f750: 2069 6620 6e6f 7420 7061 7468 2e69 7366   if not path.isf
-0000f760: 696c 6528 7069 7065 5f66 696c 6529 3a0a  ile(pipe_file):.
-0000f770: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000f780: 6520 4f53 4572 726f 7228 6622 6669 6c65  e OSError(f"file
-0000f790: 207b 7069 7065 5f66 696c 657d 2064 6f65   {pipe_file} doe
-0000f7a0: 736e 7420 6578 6973 7422 290a 2020 2020  snt exist").    
-0000f7b0: 2020 2020 7769 7468 206f 7065 6e28 7069      with open(pi
-0000f7c0: 7065 5f66 696c 652c 2022 7262 2229 2061  pe_file, "rb") a
-0000f7d0: 7320 6670 3a0a 2020 2020 2020 2020 2020  s fp:.          
-0000f7e0: 2020 6461 7461 203d 2066 702e 7265 6164    data = fp.read
-0000f7f0: 2829 0a20 2020 2020 2020 2069 6620 6e6f  ().        if no
-0000f800: 7420 6973 696e 7374 616e 6365 2870 6970  t isinstance(pip
-0000f810: 656c 696e 652c 2073 7472 293a 0a20 2020  eline, str):.   
-0000f820: 2020 2020 2020 2020 2072 656d 6f76 6528           remove(
-0000f830: 7069 7065 5f66 696c 6529 0a0a 2020 2020  pipe_file)..    
-0000f840: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-0000f850: 2020 2020 2070 6172 616d 7320 3d20 7b22       params = {"
-0000f860: 6e61 6d65 7370 6163 6522 3a20 6e61 6d65  namespace": name
-0000f870: 7370 6163 652c 2022 6578 7065 7269 6d65  space, "experime
-0000f880: 6e74 223a 2065 7870 6572 696d 656e 742c  nt": experiment,
-0000f890: 2022 7275 6e22 3a20 7275 6e7d 0a20 2020   "run": run}.   
-0000f8a0: 2020 2020 2020 2020 2072 6573 7020 3d20           resp = 
-0000f8b0: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
-0000f8c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000f8d0: 504f 5354 222c 0a20 2020 2020 2020 2020  POST",.         
-0000f8e0: 2020 2020 2020 2066 2270 726f 6a65 6374         f"project
-0000f8f0: 732f 7b70 726f 6a65 6374 7d2f 7069 7065  s/{project}/pipe
-0000f900: 6c69 6e65 7322 2c0a 2020 2020 2020 2020  lines",.        
-0000f910: 2020 2020 2020 2020 7061 7261 6d73 3d70          params=p
-0000f920: 6172 616d 732c 0a20 2020 2020 2020 2020  arams,.         
-0000f930: 2020 2020 2020 2074 696d 656f 7574 3d32         timeout=2
-0000f940: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
-0000f950: 2020 2062 6f64 793d 6461 7461 2c0a 2020     body=data,.  
-0000f960: 2020 2020 2020 2020 2020 2020 2020 6865                he
-0000f970: 6164 6572 733d 6865 6164 6572 732c 0a20  aders=headers,. 
-0000f980: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0000f990: 2020 2020 2065 7863 6570 7420 4f53 4572       except OSEr
-0000f9a0: 726f 7220 6173 2065 7272 3a0a 2020 2020  ror as err:.    
-0000f9b0: 2020 2020 2020 2020 6c6f 6767 6572 2e65          logger.e
-0000f9c0: 7272 6f72 2866 2265 7272 6f72 2063 616e  rror(f"error can
-0000f9d0: 6e6f 7420 7375 626d 6974 2070 6970 656c  not submit pipel
-0000f9e0: 696e 653a 207b 6572 725f 746f 5f73 7472  ine: {err_to_str
-0000f9f0: 2865 7272 297d 2229 0a20 2020 2020 2020  (err)}").       
-0000fa00: 2020 2020 2072 6169 7365 204f 5345 7272       raise OSErr
-0000fa10: 6f72 2866 2265 7272 6f72 3a20 6361 6e6e  or(f"error: cann
-0000fa20: 6f74 2063 616e 6e6f 7420 7375 626d 6974  ot cannot submit
-0000fa30: 2070 6970 656c 696e 652c 207b 6572 725f   pipeline, {err_
-0000fa40: 746f 5f73 7472 2865 7272 297d 2229 0a0a  to_str(err)}")..
-0000fa50: 2020 2020 2020 2020 6966 206e 6f74 2072          if not r
-0000fa60: 6573 702e 6f6b 3a0a 2020 2020 2020 2020  esp.ok:.        
-0000fa70: 2020 2020 6c6f 6767 6572 2e65 7272 6f72      logger.error
-0000fa80: 2866 2262 6164 2072 6573 7021 215c 6e7b  (f"bad resp!!\n{
-0000fa90: 7265 7370 2e74 6578 747d 2229 0a20 2020  resp.text}").   
-0000faa0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0000fab0: 616c 7565 4572 726f 7228 6622 6261 6420  alueError(f"bad 
-0000fac0: 7375 626d 6974 2070 6970 656c 696e 6520  submit pipeline 
-0000fad0: 7265 7370 6f6e 7365 2c20 7b72 6573 702e  response, {resp.
-0000fae0: 7465 7874 7d22 290a 0a20 2020 2020 2020  text}")..       
-0000faf0: 2072 6573 7020 3d20 7265 7370 2e6a 736f   resp = resp.jso
-0000fb00: 6e28 290a 2020 2020 2020 2020 6c6f 6767  n().        logg
-0000fb10: 6572 2e69 6e66 6f28 6622 7375 626d 6974  er.info(f"submit
-0000fb20: 7465 6420 7069 7065 6c69 6e65 207b 7265  ted pipeline {re
-0000fb30: 7370 5b27 6e61 6d65 275d 7d20 6964 3d7b  sp['name']} id={
-0000fb40: 7265 7370 5b27 6964 275d 7d22 290a 2020  resp['id']}").  
-0000fb50: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-0000fb60: 705b 2269 6422 5d0a 0a20 2020 2064 6566  p["id"]..    def
-0000fb70: 206c 6973 745f 7069 7065 6c69 6e65 7328   list_pipelines(
-0000fb80: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0000fb90: 2020 2020 2020 2070 726f 6a65 6374 3a20         project: 
-0000fba0: 7374 722c 0a20 2020 2020 2020 206e 616d  str,.        nam
-0000fbb0: 6573 7061 6365 3a20 7374 7220 3d20 4e6f  espace: str = No
-0000fbc0: 6e65 2c0a 2020 2020 2020 2020 736f 7274  ne,.        sort
-0000fbd0: 5f62 793a 2073 7472 203d 2022 222c 0a20  _by: str = "",. 
-0000fbe0: 2020 2020 2020 2070 6167 655f 746f 6b65         page_toke
-0000fbf0: 6e3a 2073 7472 203d 2022 222c 0a20 2020  n: str = "",.   
-0000fc00: 2020 2020 2066 696c 7465 725f 3a20 7374       filter_: st
-0000fc10: 7220 3d20 2222 2c0a 2020 2020 2020 2020  r = "",.        
-0000fc20: 666f 726d 6174 5f3a 2055 6e69 6f6e 5b0a  format_: Union[.
-0000fc30: 2020 2020 2020 2020 2020 2020 7374 722c              str,
-0000fc40: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-0000fc50: 6865 6d61 732e 5069 7065 6c69 6e65 7346  hemas.PipelinesF
-0000fc60: 6f72 6d61 740a 2020 2020 2020 2020 5d20  ormat.        ] 
-0000fc70: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
-0000fc80: 6368 656d 6173 2e50 6970 656c 696e 6573  chemas.Pipelines
-0000fc90: 466f 726d 6174 2e6d 6574 6164 6174 615f  Format.metadata_
-0000fca0: 6f6e 6c79 2c0a 2020 2020 2020 2020 7061  only,.        pa
-0000fcb0: 6765 5f73 697a 653a 2069 6e74 203d 204e  ge_size: int = N
-0000fcc0: 6f6e 652c 0a20 2020 2029 202d 3e20 6d6c  one,.    ) -> ml
-0000fcd0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0000fce0: 6173 2e50 6970 656c 696e 6573 4f75 7470  as.PipelinesOutp
-0000fcf0: 7574 3a0a 2020 2020 2020 2020 2222 2252  ut:.        """R
-0000fd00: 6574 7269 6576 6520 6120 6c69 7374 206f  etrieve a list o
-0000fd10: 6620 4b46 5020 7069 7065 6c69 6e65 732e  f KFP pipelines.
-0000fd20: 2054 6869 7320 6675 6e63 7469 6f6e 2063   This function c
-0000fd30: 616e 2062 6520 696e 766f 6b65 6420 746f  an be invoked to
-0000fd40: 2067 6574 2061 6c6c 2070 6970 656c 696e   get all pipelin
-0000fd50: 6573 2066 726f 6d20 616c 6c20 7072 6f6a  es from all proj
-0000fd60: 6563 7473 2c0a 2020 2020 2020 2020 6279  ects,.        by
-0000fd70: 2073 7065 6369 6679 696e 6720 6060 7072   specifying ``pr
-0000fd80: 6f6a 6563 743d 2a60 602c 2069 6e20 7768  oject=*``, in wh
-0000fd90: 6963 6820 6361 7365 2070 6167 696e 6174  ich case paginat
-0000fda0: 696f 6e20 6361 6e20 6265 2075 7365 6420  ion can be used 
-0000fdb0: 616e 6420 7468 6520 7661 7269 6f75 7320  and the various 
-0000fdc0: 736f 7274 696e 6720 616e 6420 7061 6769  sorting and pagi
-0000fdd0: 6e61 7469 6f6e 0a20 2020 2020 2020 2070  nation.        p
-0000fde0: 726f 7065 7274 6965 7320 6361 6e20 6265  roperties can be
-0000fdf0: 2061 7070 6c69 6564 2e20 4966 2061 2073   applied. If a s
-0000fe00: 7065 6369 6669 6320 7072 6f6a 6563 7420  pecific project 
-0000fe10: 6973 2072 6571 7565 7374 6564 2c20 7468  is requested, th
-0000fe20: 656e 2074 6865 2070 6167 696e 6174 696f  en the paginatio
-0000fe30: 6e20 6f70 7469 6f6e 7320 6361 6e6e 6f74  n options cannot
-0000fe40: 2062 650a 2020 2020 2020 2020 7573 6564   be.        used
-0000fe50: 2061 6e64 2070 6167 696e 6174 696f 6e20   and pagination 
-0000fe60: 6973 206e 6f74 2061 7070 6c69 6564 2e0a  is not applied..
-0000fe70: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000fe80: 7072 6f6a 6563 743a 2050 726f 6a65 6374  project: Project
-0000fe90: 206e 616d 652e 2043 616e 2062 6520 6060   name. Can be ``
-0000fea0: 2a60 6020 666f 7220 7175 6572 7920 6163  *`` for query ac
-0000feb0: 726f 7373 2061 6c6c 2070 726f 6a65 6374  ross all project
-0000fec0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-0000fed0: 6d20 6e61 6d65 7370 6163 653a 204b 7562  m namespace: Kub
-0000fee0: 6572 6e65 7465 7320 6e61 6d65 7370 6163  ernetes namespac
-0000fef0: 6520 696e 2077 6869 6368 2074 6865 2070  e in which the p
-0000ff00: 6970 656c 696e 6573 2061 7265 2065 7865  ipelines are exe
-0000ff10: 6375 7469 6e67 2e0a 2020 2020 2020 2020  cuting..        
-0000ff20: 3a70 6172 616d 2073 6f72 745f 6279 3a20  :param sort_by: 
-0000ff30: 4669 656c 6420 746f 2073 6f72 7420 7468  Field to sort th
-0000ff40: 6520 7265 7375 6c74 7320 6279 2e0a 2020  e results by..  
-0000ff50: 2020 2020 2020 3a70 6172 616d 2070 6167        :param pag
-0000ff60: 655f 746f 6b65 6e3a 2055 7365 2066 6f72  e_token: Use for
-0000ff70: 2070 6167 696e 6174 696f 6e2c 2074 6f20   pagination, to 
-0000ff80: 7265 7472 6965 7665 206e 6578 7420 7061  retrieve next pa
-0000ff90: 6765 2e0a 2020 2020 2020 2020 3a70 6172  ge..        :par
-0000ffa0: 616d 2066 696c 7465 725f 3a20 4b75 6265  am filter_: Kube
-0000ffb0: 726e 6574 6573 2066 696c 7465 7220 746f  rnetes filter to
-0000ffc0: 2061 7070 6c79 2074 6f20 7468 6520 7175   apply to the qu
-0000ffd0: 6572 792c 2063 616e 2062 6520 7573 6564  ery, can be used
-0000ffe0: 2074 6f20 6669 6c74 6572 206f 6e20 7370   to filter on sp
-0000fff0: 6563 6966 6963 206f 626a 6563 7420 6669  ecific object fi
-00010000: 656c 6473 2e0a 2020 2020 2020 2020 3a70  elds..        :p
-00010010: 6172 616d 2066 6f72 6d61 745f 3a20 5265  aram format_: Re
-00010020: 7375 6c74 2066 6f72 6d61 742e 2043 616e  sult format. Can
-00010030: 2062 6520 6f6e 6520 6f66 3a0a 0a20 2020   be one of:..   
-00010040: 2020 2020 2020 2020 202d 2060 6066 756c           - ``ful
-00010050: 6c60 6020 2d20 7265 7475 726e 2074 6865  l`` - return the
-00010060: 2066 756c 6c20 6f62 6a65 6374 732e 0a20   full objects.. 
-00010070: 2020 2020 2020 2020 2020 202d 2060 606d             - ``m
-00010080: 6574 6164 6174 615f 6f6e 6c79 6060 2028  etadata_only`` (
-00010090: 6465 6661 756c 7429 202d 2072 6574 7572  default) - retur
-000100a0: 6e20 6a75 7374 206d 6574 6164 6174 6120  n just metadata 
-000100b0: 6f66 2074 6865 2070 6970 656c 696e 6573  of the pipelines
-000100c0: 206f 626a 6563 7473 2e0a 2020 2020 2020   objects..      
-000100d0: 2020 2020 2020 2d20 6060 6e61 6d65 5f6f        - ``name_o
-000100e0: 6e6c 7960 6020 2d20 7265 7475 726e 206a  nly`` - return j
-000100f0: 7573 7420 7468 6520 6e61 6d65 7320 6f66  ust the names of
-00010100: 2074 6865 2070 6970 656c 696e 6520 6f62   the pipeline ob
-00010110: 6a65 6374 732e 0a20 2020 2020 2020 203a  jects..        :
-00010120: 7061 7261 6d20 7061 6765 5f73 697a 653a  param page_size:
-00010130: 2053 697a 6520 6f66 2061 2073 696e 676c   Size of a singl
-00010140: 6520 7061 6765 2077 6865 6e20 6170 706c  e page when appl
-00010150: 7969 6e67 2070 6167 696e 6174 696f 6e2e  ying pagination.
-00010160: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00010170: 2020 2020 2020 6966 2070 726f 6a65 6374        if project
-00010180: 2021 3d20 222a 2220 616e 6420 2870 6167   != "*" and (pag
-00010190: 655f 746f 6b65 6e20 6f72 2070 6167 655f  e_token or page_
-000101a0: 7369 7a65 293a 0a20 2020 2020 2020 2020  size):.         
-000101b0: 2020 2072 6169 7365 206d 6c72 756e 2e65     raise mlrun.e
-000101c0: 7272 6f72 732e 4d4c 5275 6e49 6e76 616c  rrors.MLRunInval
-000101d0: 6964 4172 6775 6d65 6e74 4572 726f 7228  idArgumentError(
-000101e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000101f0: 2022 4669 6c74 6572 696e 6720 6279 2070   "Filtering by p
-00010200: 726f 6a65 6374 2063 616e 206e 6f74 2062  roject can not b
-00010210: 6520 7573 6564 2074 6f67 6574 6865 7220  e used together 
-00010220: 7769 7468 2070 6167 696e 6174 696f 6e22  with pagination"
-00010230: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00010240: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
-00010250: 7b0a 2020 2020 2020 2020 2020 2020 226e  {.            "n
-00010260: 616d 6573 7061 6365 223a 206e 616d 6573  amespace": names
-00010270: 7061 6365 2c0a 2020 2020 2020 2020 2020  pace,.          
-00010280: 2020 2273 6f72 745f 6279 223a 2073 6f72    "sort_by": sor
-00010290: 745f 6279 2c0a 2020 2020 2020 2020 2020  t_by,.          
-000102a0: 2020 2270 6167 655f 746f 6b65 6e22 3a20    "page_token": 
-000102b0: 7061 6765 5f74 6f6b 656e 2c0a 2020 2020  page_token,.    
-000102c0: 2020 2020 2020 2020 2266 696c 7465 7222          "filter"
-000102d0: 3a20 6669 6c74 6572 5f2c 0a20 2020 2020  : filter_,.     
-000102e0: 2020 2020 2020 2022 666f 726d 6174 223a         "format":
-000102f0: 2066 6f72 6d61 745f 2c0a 2020 2020 2020   format_,.      
-00010300: 2020 2020 2020 2270 6167 655f 7369 7a65        "page_size
-00010310: 223a 2070 6167 655f 7369 7a65 2c0a 2020  ": page_size,.  
-00010320: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
-00010330: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-00010340: 2066 2246 6169 6c65 6420 6c69 7374 696e   f"Failed listin
-00010350: 6720 7069 7065 6c69 6e65 732c 2071 7565  g pipelines, que
-00010360: 7279 3a20 7b70 6172 616d 737d 220a 2020  ry: {params}".  
-00010370: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
-00010380: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
-00010390: 2020 2020 2020 2020 2020 2020 2247 4554              "GET
-000103a0: 222c 2066 2270 726f 6a65 6374 732f 7b70  ", f"projects/{p
-000103b0: 726f 6a65 6374 7d2f 7069 7065 6c69 6e65  roject}/pipeline
-000103c0: 7322 2c20 6572 726f 725f 6d65 7373 6167  s", error_messag
-000103d0: 652c 2070 6172 616d 733d 7061 7261 6d73  e, params=params
-000103e0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-000103f0: 2020 2072 6574 7572 6e20 6d6c 7275 6e2e     return mlrun.
-00010400: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e50  common.schemas.P
-00010410: 6970 656c 696e 6573 4f75 7470 7574 282a  ipelinesOutput(*
-00010420: 2a72 6573 706f 6e73 652e 6a73 6f6e 2829  *response.json()
-00010430: 290a 0a20 2020 2064 6566 2067 6574 5f70  )..    def get_p
-00010440: 6970 656c 696e 6528 0a20 2020 2020 2020  ipeline(.       
-00010450: 2073 656c 662c 0a20 2020 2020 2020 2072   self,.        r
-00010460: 756e 5f69 643a 2073 7472 2c0a 2020 2020  un_id: str,.    
-00010470: 2020 2020 6e61 6d65 7370 6163 653a 2073      namespace: s
-00010480: 7472 203d 204e 6f6e 652c 0a20 2020 2020  tr = None,.     
-00010490: 2020 2074 696d 656f 7574 3a20 696e 7420     timeout: int 
-000104a0: 3d20 3130 2c0a 2020 2020 2020 2020 666f  = 10,.        fo
-000104b0: 726d 6174 5f3a 2055 6e69 6f6e 5b0a 2020  rmat_: Union[.  
-000104c0: 2020 2020 2020 2020 2020 7374 722c 206d            str, m
-000104d0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-000104e0: 6d61 732e 5069 7065 6c69 6e65 7346 6f72  mas.PipelinesFor
-000104f0: 6d61 740a 2020 2020 2020 2020 5d20 3d20  mat.        ] = 
-00010500: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00010510: 656d 6173 2e50 6970 656c 696e 6573 466f  emas.PipelinesFo
-00010520: 726d 6174 2e73 756d 6d61 7279 2c0a 2020  rmat.summary,.  
-00010530: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
-00010540: 7472 203d 204e 6f6e 652c 0a20 2020 2029  tr = None,.    )
-00010550: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-00010560: 7269 6576 6520 6465 7461 696c 7320 6f66  rieve details of
-00010570: 2061 2073 7065 6369 6669 6320 7069 7065   a specific pipe
-00010580: 6c69 6e65 2075 7369 6e67 2069 7473 2072  line using its r
-00010590: 756e 2049 4420 2861 7320 7072 6f76 6964  un ID (as provid
-000105a0: 6564 2077 6865 6e20 7468 6520 7069 7065  ed when the pipe
-000105b0: 6c69 6e65 2077 6173 2065 7865 6375 7465  line was execute
-000105c0: 6429 2e22 2222 0a0a 2020 2020 2020 2020  d)."""..        
-000105d0: 7061 7261 6d73 203d 207b 7d0a 2020 2020  params = {}.    
-000105e0: 2020 2020 6966 206e 616d 6573 7061 6365      if namespace
-000105f0: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
-00010600: 7261 6d73 5b22 6e61 6d65 7370 6163 6522  rams["namespace"
-00010610: 5d20 3d20 6e61 6d65 7370 6163 650a 2020  ] = namespace.  
-00010620: 2020 2020 2020 7061 7261 6d73 5b22 666f        params["fo
-00010630: 726d 6174 225d 203d 2066 6f72 6d61 745f  rmat"] = format_
-00010640: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-00010650: 5f70 6174 6820 3d20 7072 6f6a 6563 7420  _path = project 
-00010660: 6966 2070 726f 6a65 6374 2065 6c73 6520  if project else 
-00010670: 222a 220a 2020 2020 2020 2020 7265 7370  "*".        resp
-00010680: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-00010690: 280a 2020 2020 2020 2020 2020 2020 2247  (.            "G
-000106a0: 4554 222c 0a20 2020 2020 2020 2020 2020  ET",.           
-000106b0: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-000106c0: 6a65 6374 5f70 6174 687d 2f70 6970 656c  ject_path}/pipel
-000106d0: 696e 6573 2f7b 7275 6e5f 6964 7d22 2c0a  ines/{run_id}",.
-000106e0: 2020 2020 2020 2020 2020 2020 7061 7261              para
-000106f0: 6d73 3d70 6172 616d 732c 0a20 2020 2020  ms=params,.     
-00010700: 2020 2020 2020 2074 696d 656f 7574 3d74         timeout=t
-00010710: 696d 656f 7574 2c0a 2020 2020 2020 2020  imeout,.        
-00010720: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
-00010730: 7420 7265 7370 2e6f 6b3a 0a20 2020 2020  t resp.ok:.     
-00010740: 2020 2020 2020 206c 6f67 6765 722e 6572         logger.er
-00010750: 726f 7228 6622 6261 6420 7265 7370 2121  ror(f"bad resp!!
-00010760: 5c6e 7b72 6573 702e 7465 7874 7d22 290a  \n{resp.text}").
-00010770: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00010780: 6520 5661 6c75 6545 7272 6f72 2866 2262  e ValueError(f"b
-00010790: 6164 2067 6574 2070 6970 656c 696e 6520  ad get pipeline 
-000107a0: 7265 7370 6f6e 7365 2c20 7b72 6573 702e  response, {resp.
-000107b0: 7465 7874 7d22 290a 0a20 2020 2020 2020  text}")..       
-000107c0: 2072 6574 7572 6e20 7265 7370 2e6a 736f   return resp.jso
-000107d0: 6e28 290a 0a20 2020 2040 7374 6174 6963  n()..    @static
-000107e0: 6d65 7468 6f64 0a20 2020 2064 6566 205f  method.    def _
-000107f0: 7265 736f 6c76 655f 7265 6665 7265 6e63  resolve_referenc
-00010800: 6528 7461 672c 2075 6964 293a 0a20 2020  e(tag, uid):.   
-00010810: 2020 2020 2069 6620 7569 6420 616e 6420       if uid and 
-00010820: 7461 673a 0a20 2020 2020 2020 2020 2020  tag:.           
-00010830: 2072 6169 7365 204d 4c52 756e 496e 7661   raise MLRunInva
-00010840: 6c69 6441 7267 756d 656e 7445 7272 6f72  lidArgumentError
-00010850: 2822 626f 7468 2075 6964 2061 6e64 2074  ("both uid and t
-00010860: 6167 2077 6572 6520 7072 6f76 6964 6564  ag were provided
-00010870: 2229 0a20 2020 2020 2020 2072 6574 7572  ").        retur
-00010880: 6e20 7569 6420 6f72 2074 6167 206f 7220  n uid or tag or 
-00010890: 226c 6174 6573 7422 0a0a 2020 2020 6465  "latest"..    de
-000108a0: 6620 6372 6561 7465 5f66 6561 7475 7265  f create_feature
-000108b0: 5f73 6574 280a 2020 2020 2020 2020 7365  _set(.        se
-000108c0: 6c66 2c0a 2020 2020 2020 2020 6665 6174  lf,.        feat
-000108d0: 7572 655f 7365 743a 2055 6e69 6f6e 5b64  ure_set: Union[d
-000108e0: 6963 742c 206d 6c72 756e 2e63 6f6d 6d6f  ict, mlrun.commo
-000108f0: 6e2e 7363 6865 6d61 732e 4665 6174 7572  n.schemas.Featur
-00010900: 6553 6574 2c20 4665 6174 7572 6553 6574  eSet, FeatureSet
-00010910: 5d2c 0a20 2020 2020 2020 2070 726f 6a65  ],.        proje
-00010920: 6374 3d22 222c 0a20 2020 2020 2020 2076  ct="",.        v
-00010930: 6572 7369 6f6e 6564 3d54 7275 652c 0a20  ersioned=True,. 
-00010940: 2020 2029 202d 3e20 6469 6374 3a0a 2020     ) -> dict:.  
-00010950: 2020 2020 2020 2222 2243 7265 6174 6520        """Create 
-00010960: 6120 6e65 7720 3a70 793a 636c 6173 733a  a new :py:class:
-00010970: 607e 6d6c 7275 6e2e 6665 6174 7572 655f  `~mlrun.feature_
-00010980: 7374 6f72 652e 4665 6174 7572 6553 6574  store.FeatureSet
-00010990: 6020 616e 6420 7361 7665 2069 6e20 7468  ` and save in th
-000109a0: 6520 3a70 793a 6d6f 643a 606d 6c72 756e  e :py:mod:`mlrun
-000109b0: 6020 4442 2e20 5468 650a 2020 2020 2020  ` DB. The.      
-000109c0: 2020 6665 6174 7572 652d 7365 7420 6d75    feature-set mu
-000109d0: 7374 206e 6f74 2070 7265 7669 6f75 736c  st not previousl
-000109e0: 7920 6578 6973 7420 696e 2074 6865 2044  y exist in the D
-000109f0: 422e 0a0a 2020 2020 2020 2020 3a70 6172  B...        :par
-00010a00: 616d 2066 6561 7475 7265 5f73 6574 3a20  am feature_set: 
-00010a10: 5468 6520 6e65 7720 3a70 793a 636c 6173  The new :py:clas
-00010a20: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
-00010a30: 655f 7374 6f72 652e 4665 6174 7572 6553  e_store.FeatureS
-00010a40: 6574 6020 746f 2063 7265 6174 652e 0a20  et` to create.. 
-00010a50: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00010a60: 6f6a 6563 743a 204e 616d 6520 6f66 2070  oject: Name of p
-00010a70: 726f 6a65 6374 2074 6869 7320 6665 6174  roject this feat
-00010a80: 7572 652d 7365 7420 6265 6c6f 6e67 7320  ure-set belongs 
-00010a90: 746f 2e0a 2020 2020 2020 2020 3a70 6172  to..        :par
-00010aa0: 616d 2076 6572 7369 6f6e 6564 3a20 5768  am versioned: Wh
-00010ab0: 6574 6865 7220 746f 206d 6169 6e74 6169  ether to maintai
-00010ac0: 6e20 7665 7273 696f 6e73 2066 6f72 2074  n versions for t
-00010ad0: 6869 7320 6665 6174 7572 652d 7365 742e  his feature-set.
-00010ae0: 2041 6c6c 2076 6572 7369 6f6e 7320 6f66   All versions of
-00010af0: 2061 2076 6572 7369 6f6e 6564 206f 626a   a versioned obj
-00010b00: 6563 740a 2020 2020 2020 2020 2020 2020  ect.            
-00010b10: 7769 6c6c 2062 6520 6b65 7074 2069 6e20  will be kept in 
-00010b20: 7468 6520 4442 2061 6e64 2063 616e 2062  the DB and can b
-00010b30: 6520 7265 7472 6965 7665 6420 756e 7469  e retrieved unti
-00010b40: 6c20 6578 706c 6963 6974 6c79 2064 656c  l explicitly del
-00010b50: 6574 6564 2e0a 2020 2020 2020 2020 3a72  eted..        :r
-00010b60: 6574 7572 6e73 3a20 5468 6520 3a70 793a  eturns: The :py:
-00010b70: 636c 6173 733a 607e 6d6c 7275 6e2e 6665  class:`~mlrun.fe
-00010b80: 6174 7572 655f 7374 6f72 652e 4665 6174  ature_store.Feat
-00010b90: 7572 6553 6574 6020 6f62 6a65 6374 2028  ureSet` object (
-00010ba0: 6173 2064 6963 7429 2e0a 2020 2020 2020  as dict)..      
-00010bb0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-00010bc0: 2069 7369 6e73 7461 6e63 6528 6665 6174   isinstance(feat
-00010bd0: 7572 655f 7365 742c 206d 6c72 756e 2e63  ure_set, mlrun.c
-00010be0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4665  ommon.schemas.Fe
-00010bf0: 6174 7572 6553 6574 293a 0a20 2020 2020  atureSet):.     
-00010c00: 2020 2020 2020 2066 6561 7475 7265 5f73         feature_s
-00010c10: 6574 203d 2066 6561 7475 7265 5f73 6574  et = feature_set
-00010c20: 2e64 6963 7428 290a 2020 2020 2020 2020  .dict().        
-00010c30: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
-00010c40: 6665 6174 7572 655f 7365 742c 2046 6561  feature_set, Fea
-00010c50: 7475 7265 5365 7429 3a0a 2020 2020 2020  tureSet):.      
-00010c60: 2020 2020 2020 6665 6174 7572 655f 7365        feature_se
-00010c70: 7420 3d20 6665 6174 7572 655f 7365 742e  t = feature_set.
-00010c80: 746f 5f64 6963 7428 290a 0a20 2020 2020  to_dict()..     
-00010c90: 2020 2070 726f 6a65 6374 203d 2028 0a20     project = (. 
-00010ca0: 2020 2020 2020 2020 2020 2070 726f 6a65             proje
-00010cb0: 6374 0a20 2020 2020 2020 2020 2020 206f  ct.            o
-00010cc0: 7220 6665 6174 7572 655f 7365 745b 226d  r feature_set["m
-00010cd0: 6574 6164 6174 6122 5d2e 6765 7428 2270  etadata"].get("p
-00010ce0: 726f 6a65 6374 222c 204e 6f6e 6529 0a20  roject", None). 
-00010cf0: 2020 2020 2020 2020 2020 206f 7220 636f             or co
-00010d00: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
-00010d10: 6a65 6374 0a20 2020 2020 2020 2029 0a20  ject.        ). 
-00010d20: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-00010d30: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-00010d40: 747d 2f66 6561 7475 7265 2d73 6574 7322  t}/feature-sets"
-00010d50: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
-00010d60: 3d20 7b22 7665 7273 696f 6e65 6422 3a20  = {"versioned": 
-00010d70: 7665 7273 696f 6e65 647d 0a0a 2020 2020  versioned}..    
-00010d80: 2020 2020 6e61 6d65 203d 2066 6561 7475      name = featu
-00010d90: 7265 5f73 6574 5b22 6d65 7461 6461 7461  re_set["metadata
-00010da0: 225d 5b22 6e61 6d65 225d 0a20 2020 2020  "]["name"].     
-00010db0: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-00010dc0: 203d 2066 2246 6169 6c65 6420 6372 6561   = f"Failed crea
-00010dd0: 7469 6e67 2066 6561 7475 7265 2d73 6574  ting feature-set
-00010de0: 207b 7072 6f6a 6563 747d 2f7b 6e61 6d65   {project}/{name
-00010df0: 7d22 0a20 2020 2020 2020 2072 6573 7020  }".        resp 
-00010e00: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-00010e10: 0a20 2020 2020 2020 2020 2020 2022 504f  .            "PO
-00010e20: 5354 222c 0a20 2020 2020 2020 2020 2020  ST",.           
-00010e30: 2070 6174 682c 0a20 2020 2020 2020 2020   path,.         
-00010e40: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-00010e50: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-00010e60: 7261 6d73 3d70 6172 616d 732c 0a20 2020  rams=params,.   
-00010e70: 2020 2020 2020 2020 2062 6f64 793d 6469           body=di
-00010e80: 6374 5f74 6f5f 6a73 6f6e 2866 6561 7475  ct_to_json(featu
-00010e90: 7265 5f73 6574 292c 0a20 2020 2020 2020  re_set),.       
-00010ea0: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
-00010eb0: 6e20 7265 7370 2e6a 736f 6e28 290a 0a20  n resp.json().. 
-00010ec0: 2020 2064 6566 2067 6574 5f66 6561 7475     def get_featu
-00010ed0: 7265 5f73 6574 280a 2020 2020 2020 2020  re_set(.        
-00010ee0: 7365 6c66 2c20 6e61 6d65 3a20 7374 722c  self, name: str,
-00010ef0: 2070 726f 6a65 6374 3a20 7374 7220 3d20   project: str = 
-00010f00: 2222 2c20 7461 673a 2073 7472 203d 204e  "", tag: str = N
-00010f10: 6f6e 652c 2075 6964 3a20 7374 7220 3d20  one, uid: str = 
-00010f20: 4e6f 6e65 0a20 2020 2029 202d 3e20 4665  None.    ) -> Fe
-00010f30: 6174 7572 6553 6574 3a0a 2020 2020 2020  atureSet:.      
-00010f40: 2020 2222 2252 6574 7269 6576 6520 6120    """Retrieve a 
-00010f50: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
-00010f60: 746f 7265 2e46 6561 7475 7265 5365 7460  tore.FeatureSet`
-00010f70: 206f 626a 6563 742e 2049 6620 626f 7468   object. If both
-00010f80: 2060 6074 6167 6060 2061 6e64 2060 6075   ``tag`` and ``u
-00010f90: 6964 6060 2061 7265 206e 6f74 2073 7065  id`` are not spe
-00010fa0: 6369 6669 6564 2c20 7468 656e 0a20 2020  cified, then.   
-00010fb0: 2020 2020 2074 6865 206f 626a 6563 7420       the object 
-00010fc0: 7461 6767 6564 2060 606c 6174 6573 7460  tagged ``latest`
-00010fd0: 6020 7769 6c6c 2062 6520 7265 7472 6965  ` will be retrie
-00010fe0: 7665 642e 0a0a 2020 2020 2020 2020 3a70  ved...        :p
-00010ff0: 6172 616d 206e 616d 653a 204e 616d 6520  aram name: Name 
-00011000: 6f66 206f 626a 6563 7420 746f 2072 6574  of object to ret
-00011010: 7269 6576 652e 0a20 2020 2020 2020 203a  rieve..        :
-00011020: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
-00011030: 726f 6a65 6374 2074 6865 2046 6561 7475  roject the Featu
-00011040: 7265 5365 7420 6265 6c6f 6e67 7320 746f  reSet belongs to
-00011050: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00011060: 2074 6167 3a20 5461 6720 6f66 2074 6865   tag: Tag of the
-00011070: 2073 7065 6369 6669 6320 6f62 6a65 6374   specific object
-00011080: 2076 6572 7369 6f6e 2074 6f20 7265 7472   version to retr
-00011090: 6965 7665 2e0a 2020 2020 2020 2020 3a70  ieve..        :p
-000110a0: 6172 616d 2075 6964 3a20 7569 6420 6f66  aram uid: uid of
-000110b0: 2074 6865 206f 626a 6563 7420 746f 2072   the object to r
-000110c0: 6574 7269 6576 6520 2863 616e 206f 6e6c  etrieve (can onl
-000110d0: 7920 6265 2075 7365 6420 666f 7220 7665  y be used for ve
-000110e0: 7273 696f 6e65 6420 6f62 6a65 6374 7329  rsioned objects)
-000110f0: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-00011100: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
-00011110: 2070 726f 6a65 6374 206f 7220 636f 6e66   project or conf
-00011120: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
-00011130: 6374 0a20 2020 2020 2020 2072 6566 6572  ct.        refer
-00011140: 656e 6365 203d 2073 656c 662e 5f72 6573  ence = self._res
-00011150: 6f6c 7665 5f72 6566 6572 656e 6365 2874  olve_reference(t
-00011160: 6167 2c20 7569 6429 0a20 2020 2020 2020  ag, uid).       
-00011170: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-00011180: 7473 2f7b 7072 6f6a 6563 747d 2f66 6561  ts/{project}/fea
-00011190: 7475 7265 2d73 6574 732f 7b6e 616d 657d  ture-sets/{name}
-000111a0: 2f72 6566 6572 656e 6365 732f 7b72 6566  /references/{ref
-000111b0: 6572 656e 6365 7d22 0a20 2020 2020 2020  erence}".       
-000111c0: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-000111d0: 2066 2246 6169 6c65 6420 7265 7472 6965   f"Failed retrie
-000111e0: 7669 6e67 2066 6561 7475 7265 2d73 6574  ving feature-set
-000111f0: 207b 7072 6f6a 6563 747d 2f7b 6e61 6d65   {project}/{name
-00011200: 7d22 0a20 2020 2020 2020 2072 6573 7020  }".        resp 
-00011210: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-00011220: 2247 4554 222c 2070 6174 682c 2065 7272  "GET", path, err
-00011230: 6f72 5f6d 6573 7361 6765 290a 2020 2020  or_message).    
-00011240: 2020 2020 7265 7475 726e 2046 6561 7475      return Featu
-00011250: 7265 5365 742e 6672 6f6d 5f64 6963 7428  reSet.from_dict(
-00011260: 7265 7370 2e6a 736f 6e28 2929 0a0a 2020  resp.json())..  
-00011270: 2020 6465 6620 6c69 7374 5f66 6561 7475    def list_featu
-00011280: 7265 7328 0a20 2020 2020 2020 2073 656c  res(.        sel
-00011290: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
-000112a0: 6374 3a20 7374 722c 0a20 2020 2020 2020  ct: str,.       
-000112b0: 206e 616d 653a 2073 7472 203d 204e 6f6e   name: str = Non
-000112c0: 652c 0a20 2020 2020 2020 2074 6167 3a20  e,.        tag: 
-000112d0: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
-000112e0: 2020 2020 656e 7469 7469 6573 3a20 4c69      entities: Li
-000112f0: 7374 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  st[str] = None,.
-00011300: 2020 2020 2020 2020 6c61 6265 6c73 3a20          labels: 
-00011310: 4c69 7374 5b73 7472 5d20 3d20 4e6f 6e65  List[str] = None
-00011320: 2c0a 2020 2020 2920 2d3e 204c 6973 745b  ,.    ) -> List[
-00011330: 6469 6374 5d3a 0a20 2020 2020 2020 2022  dict]:.        "
-00011340: 2222 4c69 7374 2066 6561 7475 7265 2d73  ""List feature-s
-00011350: 6574 7320 7768 6963 6820 636f 6e74 6169  ets which contai
-00011360: 6e20 7370 6563 6966 6963 2066 6561 7475  n specific featu
-00011370: 7265 732e 2054 6869 7320 6675 6e63 7469  res. This functi
-00011380: 6f6e 206d 6179 2072 6574 7572 6e20 6d75  on may return mu
-00011390: 6c74 6970 6c65 2076 6572 7369 6f6e 7320  ltiple versions 
-000113a0: 6f66 2074 6865 2073 616d 650a 2020 2020  of the same.    
-000113b0: 2020 2020 6665 6174 7572 652d 7365 7420      feature-set 
-000113c0: 6966 2061 2073 7065 6369 6669 6320 7461  if a specific ta
-000113d0: 6720 6973 206e 6f74 2072 6571 7565 7374  g is not request
-000113e0: 6564 2e20 4e6f 7465 2074 6861 7420 7468  ed. Note that th
-000113f0: 6520 7661 7269 6f75 7320 6669 6c74 6572  e various filter
-00011400: 7320 6f66 2074 6869 7320 6675 6e63 7469  s of this functi
-00011410: 6f6e 2061 6374 7561 6c6c 790a 2020 2020  on actually.    
-00011420: 2020 2020 7265 6665 7220 746f 2074 6865      refer to the
-00011430: 2066 6561 7475 7265 2d73 6574 206f 626a   feature-set obj
-00011440: 6563 7420 636f 6e74 6169 6e69 6e67 2074  ect containing t
-00011450: 6865 2066 6561 7475 7265 732c 206e 6f74  he features, not
-00011460: 2074 6f20 7468 6520 6665 6174 7572 6573   to the features
-00011470: 2074 6865 6d73 656c 7665 732e 0a0a 2020   themselves...  
-00011480: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
-00011490: 6a65 6374 3a20 5072 6f6a 6563 7420 7768  ject: Project wh
-000114a0: 6963 6820 636f 6e74 6169 6e73 2074 6865  ich contains the
-000114b0: 7365 2066 6561 7475 7265 732e 0a20 2020  se features..   
-000114c0: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
-000114d0: 3a20 4e61 6d65 206f 6620 7468 6520 6665  : Name of the fe
-000114e0: 6174 7572 6520 746f 206c 6f6f 6b20 666f  ature to look fo
-000114f0: 722e 2054 6865 206e 616d 6520 6973 2075  r. The name is u
-00011500: 7365 6420 696e 2061 206c 696b 6520 7175  sed in a like qu
-00011510: 6572 792c 2061 6e64 2069 7320 6e6f 7420  ery, and is not 
-00011520: 6361 7365 2d73 656e 7369 7469 7665 2e20  case-sensitive. 
-00011530: 466f 720a 2020 2020 2020 2020 2020 2020  For.            
-00011540: 6578 616d 706c 652c 206c 6f6f 6b69 6e67  example, looking
-00011550: 2066 6f72 2060 6066 6561 7460 6020 7769   for ``feat`` wi
-00011560: 6c6c 2072 6574 7572 6e20 6665 6174 7572  ll return featur
-00011570: 6573 2077 6869 6368 2061 7265 206e 616d  es which are nam
-00011580: 6564 2060 604d 7946 6561 7475 7265 6060  ed ``MyFeature``
-00011590: 2061 7320 7765 6c6c 2061 7320 6060 6465   as well as ``de
-000115a0: 6665 6174 6060 2e0a 2020 2020 2020 2020  feat``..        
-000115b0: 3a70 6172 616d 2074 6167 3a20 5265 7475  :param tag: Retu
-000115c0: 726e 2066 6561 7475 7265 2d73 6574 7320  rn feature-sets 
-000115d0: 7768 6963 6820 636f 6e74 6169 6e20 7468  which contain th
-000115e0: 6520 6665 6174 7572 6573 206c 6f6f 6b65  e features looke
-000115f0: 6420 666f 722c 2061 6e64 2061 7265 2074  d for, and are t
-00011600: 6167 6765 6420 7769 7468 2074 6865 2073  agged with the s
-00011610: 7065 6369 6669 6320 7461 672e 0a20 2020  pecific tag..   
-00011620: 2020 2020 203a 7061 7261 6d20 656e 7469       :param enti
-00011630: 7469 6573 3a20 5265 7475 726e 206f 6e6c  ties: Return onl
-00011640: 7920 6665 6174 7572 652d 7365 7473 2077  y feature-sets w
-00011650: 6869 6368 2063 6f6e 7461 696e 2061 6e20  hich contain an 
-00011660: 656e 7469 7479 2077 686f 7365 206e 616d  entity whose nam
-00011670: 6520 6973 2063 6f6e 7461 696e 6564 2069  e is contained i
-00011680: 6e20 7468 6973 206c 6973 742e 0a20 2020  n this list..   
-00011690: 2020 2020 203a 7061 7261 6d20 6c61 6265       :param labe
-000116a0: 6c73 3a20 5265 7475 726e 206f 6e6c 7920  ls: Return only 
-000116b0: 6665 6174 7572 652d 7365 7473 2077 6869  feature-sets whi
-000116c0: 6368 2061 7265 206c 6162 656c 6564 2061  ch are labeled a
-000116d0: 7320 7265 7175 6573 7465 642e 0a20 2020  s requested..   
-000116e0: 2020 2020 203a 7265 7475 726e 733a 2041       :returns: A
-000116f0: 206c 6973 7420 6f66 206d 6170 7069 6e67   list of mapping
-00011700: 2066 726f 6d20 6665 6174 7572 6520 746f   from feature to
-00011710: 2061 2064 6967 6573 7420 6f66 2074 6865   a digest of the
-00011720: 2066 6561 7475 7265 2d73 6574 2c20 7768   feature-set, wh
-00011730: 6963 6820 636f 6e74 6169 6e73 2074 6865  ich contains the
-00011740: 2066 6561 7475 7265 2d73 6574 0a20 2020   feature-set.   
-00011750: 2020 2020 2020 2020 206d 6574 612d 6461           meta-da
-00011760: 7461 2e20 4d75 6c74 6970 6c65 2065 6e74  ta. Multiple ent
-00011770: 7269 6573 206d 6179 2062 6520 7265 7475  ries may be retu
-00011780: 726e 6564 2066 6f72 2061 6e79 2073 7065  rned for any spe
-00011790: 6369 6669 6320 6665 6174 7572 6520 6475  cific feature du
-000117a0: 6520 746f 206d 756c 7469 706c 6520 7461  e to multiple ta
-000117b0: 6773 206f 7220 7665 7273 696f 6e73 0a20  gs or versions. 
-000117c0: 2020 2020 2020 2020 2020 206f 6620 7468             of th
-000117d0: 6520 6665 6174 7572 652d 7365 742e 0a20  e feature-set.. 
-000117e0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-000117f0: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
-00011800: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
-00011810: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
-00011820: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
-00011830: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-00011840: 6e61 6d65 223a 206e 616d 652c 0a20 2020  name": name,.   
-00011850: 2020 2020 2020 2020 2022 7461 6722 3a20           "tag": 
-00011860: 7461 672c 0a20 2020 2020 2020 2020 2020  tag,.           
-00011870: 2022 656e 7469 7479 223a 2065 6e74 6974   "entity": entit
-00011880: 6965 7320 6f72 205b 5d2c 0a20 2020 2020  ies or [],.     
-00011890: 2020 2020 2020 2022 6c61 6265 6c22 3a20         "label": 
-000118a0: 6c61 6265 6c73 206f 7220 5b5d 2c0a 2020  labels or [],.  
-000118b0: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
-000118c0: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-000118d0: 7473 2f7b 7072 6f6a 6563 747d 2f66 6561  ts/{project}/fea
-000118e0: 7475 7265 7322 0a0a 2020 2020 2020 2020  tures"..        
-000118f0: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-00011900: 6622 4661 696c 6564 206c 6973 7469 6e67  f"Failed listing
-00011910: 2066 6561 7475 7265 732c 2070 726f 6a65   features, proje
-00011920: 6374 3a20 7b70 726f 6a65 6374 7d2c 2071  ct: {project}, q
-00011930: 7565 7279 3a20 7b70 6172 616d 737d 220a  uery: {params}".
-00011940: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
-00011950: 656c 662e 6170 695f 6361 6c6c 2822 4745  elf.api_call("GE
-00011960: 5422 2c20 7061 7468 2c20 6572 726f 725f  T", path, error_
-00011970: 6d65 7373 6167 652c 2070 6172 616d 733d  message, params=
-00011980: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
-00011990: 7265 7475 726e 2072 6573 702e 6a73 6f6e  return resp.json
-000119a0: 2829 5b22 6665 6174 7572 6573 225d 0a0a  ()["features"]..
-000119b0: 2020 2020 6465 6620 6c69 7374 5f65 6e74      def list_ent
-000119c0: 6974 6965 7328 0a20 2020 2020 2020 2073  ities(.        s
-000119d0: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
-000119e0: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
-000119f0: 2020 206e 616d 653a 2073 7472 203d 204e     name: str = N
-00011a00: 6f6e 652c 0a20 2020 2020 2020 2074 6167  one,.        tag
-00011a10: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
-00011a20: 2020 2020 2020 6c61 6265 6c73 3a20 4c69        labels: Li
-00011a30: 7374 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  st[str] = None,.
-00011a40: 2020 2020 2920 2d3e 204c 6973 745b 6469      ) -> List[di
-00011a50: 6374 5d3a 0a20 2020 2020 2020 2022 2222  ct]:.        """
-00011a60: 5265 7472 6965 7665 2061 206c 6973 7420  Retrieve a list 
-00011a70: 6f66 2065 6e74 6974 6965 7320 616e 6420  of entities and 
-00011a80: 7468 6569 7220 6d61 7070 696e 6720 746f  their mapping to
-00011a90: 2074 6865 2063 6f6e 7461 696e 696e 6720   the containing 
-00011aa0: 6665 6174 7572 652d 7365 7473 2e20 5468  feature-sets. Th
-00011ab0: 6973 2066 756e 6374 696f 6e20 6973 2073  is function is s
-00011ac0: 696d 696c 6172 0a20 2020 2020 2020 2074  imilar.        t
-00011ad0: 6f20 7468 6520 3a70 793a 6675 6e63 3a60  o the :py:func:`
-00011ae0: 7e6c 6973 745f 6665 6174 7572 6573 6020  ~list_features` 
-00011af0: 6675 6e63 7469 6f6e 2c20 616e 6420 7573  function, and us
-00011b00: 6573 2074 6865 2073 616d 6520 6c6f 6769  es the same logi
-00011b10: 632e 2048 6f77 6576 6572 2c20 7468 6520  c. However, the 
-00011b20: 656e 7469 7469 6573 2061 7265 206d 6174  entities are mat
-00011b30: 6368 6564 0a20 2020 2020 2020 2061 6761  ched.        aga
-00011b40: 696e 7374 2074 6865 206e 616d 6520 7261  inst the name ra
-00011b50: 7468 6572 2074 6861 6e20 7468 6520 6665  ther than the fe
-00011b60: 6174 7572 6573 2e0a 2020 2020 2020 2020  atures..        
-00011b70: 2222 220a 0a20 2020 2020 2020 2070 726f  """..        pro
-00011b80: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
-00011b90: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
-00011ba0: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
-00011bb0: 2070 6172 616d 7320 3d20 7b0a 2020 2020   params = {.    
-00011bc0: 2020 2020 2020 2020 226e 616d 6522 3a20          "name": 
-00011bd0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-00011be0: 2020 2274 6167 223a 2074 6167 2c0a 2020    "tag": tag,.  
-00011bf0: 2020 2020 2020 2020 2020 226c 6162 656c            "label
-00011c00: 223a 206c 6162 656c 7320 6f72 205b 5d2c  ": labels or [],
-00011c10: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
-00011c20: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
-00011c30: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
-00011c40: 656e 7469 7469 6573 220a 0a20 2020 2020  entities"..     
-00011c50: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-00011c60: 203d 2066 2246 6169 6c65 6420 6c69 7374   = f"Failed list
-00011c70: 696e 6720 656e 7469 7469 6573 2c20 7072  ing entities, pr
-00011c80: 6f6a 6563 743a 207b 7072 6f6a 6563 747d  oject: {project}
-00011c90: 2c20 7175 6572 793a 207b 7061 7261 6d73  , query: {params
-00011ca0: 7d22 0a20 2020 2020 2020 2072 6573 7020  }".        resp 
-00011cb0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-00011cc0: 2247 4554 222c 2070 6174 682c 2065 7272  "GET", path, err
-00011cd0: 6f72 5f6d 6573 7361 6765 2c20 7061 7261  or_message, para
-00011ce0: 6d73 3d70 6172 616d 7329 0a20 2020 2020  ms=params).     
-00011cf0: 2020 2072 6574 7572 6e20 7265 7370 2e6a     return resp.j
-00011d00: 736f 6e28 295b 2265 6e74 6974 6965 7322  son()["entities"
-00011d10: 5d0a 0a20 2020 2040 7374 6174 6963 6d65  ]..    @staticme
-00011d20: 7468 6f64 0a20 2020 2064 6566 205f 6765  thod.    def _ge
-00011d30: 6e65 7261 7465 5f70 6172 7469 7469 6f6e  nerate_partition
-00011d40: 5f62 795f 7061 7261 6d73 280a 2020 2020  _by_params(.    
-00011d50: 2020 2020 7061 7274 6974 696f 6e5f 6279      partition_by
-00011d60: 5f63 6c73 2c0a 2020 2020 2020 2020 7061  _cls,.        pa
-00011d70: 7274 6974 696f 6e5f 6279 2c0a 2020 2020  rtition_by,.    
-00011d80: 2020 2020 726f 7773 5f70 6572 5f70 6172      rows_per_par
-00011d90: 7469 7469 6f6e 2c0a 2020 2020 2020 2020  tition,.        
-00011da0: 736f 7274 5f62 792c 0a20 2020 2020 2020  sort_by,.       
-00011db0: 206f 7264 6572 2c0a 2020 2020 2020 2020   order,.        
-00011dc0: 6d61 785f 7061 7274 6974 696f 6e73 3d4e  max_partitions=N
-00011dd0: 6f6e 652c 0a20 2020 2029 3a0a 0a20 2020  one,.    ):..   
-00011de0: 2020 2020 2070 6172 7469 7469 6f6e 5f70       partition_p
-00011df0: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
-00011e00: 2020 2020 2020 2270 6172 7469 7469 6f6e        "partition
-00011e10: 2d62 7922 3a20 7061 7274 6974 696f 6e5f  -by": partition_
-00011e20: 6279 2c0a 2020 2020 2020 2020 2020 2020  by,.            
-00011e30: 2272 6f77 732d 7065 722d 7061 7274 6974  "rows-per-partit
-00011e40: 696f 6e22 3a20 726f 7773 5f70 6572 5f70  ion": rows_per_p
-00011e50: 6172 7469 7469 6f6e 2c0a 2020 2020 2020  artition,.      
-00011e60: 2020 2020 2020 2270 6172 7469 7469 6f6e        "partition
-00011e70: 2d73 6f72 742d 6279 223a 2073 6f72 745f  -sort-by": sort_
-00011e80: 6279 2c0a 2020 2020 2020 2020 2020 2020  by,.            
-00011e90: 2270 6172 7469 7469 6f6e 2d6f 7264 6572  "partition-order
-00011ea0: 223a 206f 7264 6572 2c0a 2020 2020 2020  ": order,.      
-00011eb0: 2020 7d0a 2020 2020 2020 2020 6966 206d    }.        if m
-00011ec0: 6178 5f70 6172 7469 7469 6f6e 7320 6973  ax_partitions is
-00011ed0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00011ee0: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00011ef0: 5f70 6172 616d 735b 226d 6178 2d70 6172  _params["max-par
-00011f00: 7469 7469 6f6e 7322 5d20 3d20 6d61 785f  titions"] = max_
-00011f10: 7061 7274 6974 696f 6e73 0a20 2020 2020  partitions.     
-00011f20: 2020 2072 6574 7572 6e20 7061 7274 6974     return partit
-00011f30: 696f 6e5f 7061 7261 6d73 0a0a 2020 2020  ion_params..    
-00011f40: 6465 6620 6c69 7374 5f66 6561 7475 7265  def list_feature
-00011f50: 5f73 6574 7328 0a20 2020 2020 2020 2073  _sets(.        s
-00011f60: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
-00011f70: 6a65 6374 3a20 7374 7220 3d20 2222 2c0a  ject: str = "",.
-00011f80: 2020 2020 2020 2020 6e61 6d65 3a20 7374          name: st
-00011f90: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
-00011fa0: 2020 7461 673a 2073 7472 203d 204e 6f6e    tag: str = Non
-00011fb0: 652c 0a20 2020 2020 2020 2073 7461 7465  e,.        state
-00011fc0: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
-00011fd0: 2020 2020 2020 656e 7469 7469 6573 3a20        entities: 
-00011fe0: 4c69 7374 5b73 7472 5d20 3d20 4e6f 6e65  List[str] = None
-00011ff0: 2c0a 2020 2020 2020 2020 6665 6174 7572  ,.        featur
-00012000: 6573 3a20 4c69 7374 5b73 7472 5d20 3d20  es: List[str] = 
-00012010: 4e6f 6e65 2c0a 2020 2020 2020 2020 6c61  None,.        la
-00012020: 6265 6c73 3a20 4c69 7374 5b73 7472 5d20  bels: List[str] 
-00012030: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00012040: 7061 7274 6974 696f 6e5f 6279 3a20 556e  partition_by: Un
-00012050: 696f 6e5b 0a20 2020 2020 2020 2020 2020  ion[.           
-00012060: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-00012070: 6865 6d61 732e 4665 6174 7572 6553 746f  hemas.FeatureSto
-00012080: 7265 5061 7274 6974 696f 6e42 7946 6965  rePartitionByFie
-00012090: 6c64 2c20 7374 720a 2020 2020 2020 2020  ld, str.        
-000120a0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-000120b0: 2020 726f 7773 5f70 6572 5f70 6172 7469    rows_per_parti
-000120c0: 7469 6f6e 3a20 696e 7420 3d20 312c 0a20  tion: int = 1,. 
-000120d0: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-000120e0: 5f73 6f72 745f 6279 3a20 556e 696f 6e5b  _sort_by: Union[
-000120f0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00012100: 656d 6173 2e53 6f72 7446 6965 6c64 2c20  emas.SortField, 
-00012110: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-00012120: 2020 2020 2070 6172 7469 7469 6f6e 5f6f       partition_o
-00012130: 7264 6572 3a20 556e 696f 6e5b 0a20 2020  rder: Union[.   
-00012140: 2020 2020 2020 2020 206d 6c72 756e 2e63           mlrun.c
-00012150: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4f72  ommon.schemas.Or
-00012160: 6465 7254 7970 652c 2073 7472 0a20 2020  derType, str.   
-00012170: 2020 2020 205d 203d 206d 6c72 756e 2e63       ] = mlrun.c
-00012180: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4f72  ommon.schemas.Or
-00012190: 6465 7254 7970 652e 6465 7363 2c0a 2020  derType.desc,.  
-000121a0: 2020 2920 2d3e 204c 6973 745b 4665 6174    ) -> List[Feat
-000121b0: 7572 6553 6574 5d3a 0a20 2020 2020 2020  ureSet]:.       
-000121c0: 2022 2222 5265 7472 6965 7665 2061 206c   """Retrieve a l
-000121d0: 6973 7420 6f66 2066 6561 7475 7265 2d73  ist of feature-s
-000121e0: 6574 7320 6d61 7463 6869 6e67 2074 6865  ets matching the
-000121f0: 2063 7269 7465 7269 6120 7072 6f76 6964   criteria provid
-00012200: 6564 2e0a 0a20 2020 2020 2020 203a 7061  ed...        :pa
-00012210: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
-00012220: 6a65 6374 206e 616d 652e 0a20 2020 2020  ject name..     
-00012230: 2020 203a 7061 7261 6d20 6e61 6d65 3a20     :param name: 
-00012240: 4e61 6d65 206f 6620 6665 6174 7572 652d  Name of feature-
-00012250: 7365 7420 746f 206d 6174 6368 2e20 5468  set to match. Th
-00012260: 6973 2069 7320 6120 6c69 6b65 2071 7565  is is a like que
-00012270: 7279 2c20 616e 6420 6973 2063 6173 652d  ry, and is case-
-00012280: 696e 7365 6e73 6974 6976 652e 0a20 2020  insensitive..   
-00012290: 2020 2020 203a 7061 7261 6d20 7461 673a       :param tag:
-000122a0: 204d 6174 6368 2066 6561 7475 7265 2d73   Match feature-s
-000122b0: 6574 7320 7769 7468 2073 7065 6369 6669  ets with specifi
-000122c0: 6320 7461 672e 0a20 2020 2020 2020 203a  c tag..        :
-000122d0: 7061 7261 6d20 7374 6174 653a 204d 6174  param state: Mat
-000122e0: 6368 2066 6561 7475 7265 2d73 6574 7320  ch feature-sets 
-000122f0: 7769 7468 2061 2073 7065 6369 6669 6320  with a specific 
-00012300: 7374 6174 652e 0a20 2020 2020 2020 203a  state..        :
-00012310: 7061 7261 6d20 656e 7469 7469 6573 3a20  param entities: 
-00012320: 4d61 7463 6820 6665 6174 7572 652d 7365  Match feature-se
-00012330: 7473 2077 6869 6368 2063 6f6e 7461 696e  ts which contain
-00012340: 2065 6e74 6974 6965 7320 7768 6f73 6520   entities whose 
-00012350: 6e61 6d65 2069 7320 696e 2074 6869 7320  name is in this 
-00012360: 6c69 7374 2e0a 2020 2020 2020 2020 3a70  list..        :p
-00012370: 6172 616d 2066 6561 7475 7265 733a 204d  aram features: M
-00012380: 6174 6368 2066 6561 7475 7265 2d73 6574  atch feature-set
-00012390: 7320 7768 6963 6820 636f 6e74 6169 6e20  s which contain 
-000123a0: 6665 6174 7572 6573 2077 686f 7365 206e  features whose n
-000123b0: 616d 6520 6973 2069 6e20 7468 6973 206c  ame is in this l
-000123c0: 6973 742e 0a20 2020 2020 2020 203a 7061  ist..        :pa
-000123d0: 7261 6d20 6c61 6265 6c73 3a20 4d61 7463  ram labels: Matc
-000123e0: 6820 6665 6174 7572 652d 7365 7473 2077  h feature-sets w
-000123f0: 6869 6368 2068 6176 6520 7468 6573 6520  hich have these 
-00012400: 6c61 6265 6c73 2e0a 2020 2020 2020 2020  labels..        
-00012410: 3a70 6172 616d 2070 6172 7469 7469 6f6e  :param partition
-00012420: 5f62 793a 2046 6965 6c64 2074 6f20 6772  _by: Field to gr
-00012430: 6f75 7020 7265 7375 6c74 7320 6279 2e20  oup results by. 
-00012440: 4f6e 6c79 2061 6c6c 6f77 6564 2076 616c  Only allowed val
-00012450: 7565 2069 7320 606e 616d 6560 2e20 5768  ue is `name`. Wh
-00012460: 656e 2060 7061 7274 6974 696f 6e5f 6279  en `partition_by
-00012470: 6020 6973 2073 7065 6369 6669 6564 2c0a  ` is specified,.
-00012480: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-00012490: 6070 6172 7469 7469 6f6e 5f73 6f72 745f  `partition_sort_
-000124a0: 6279 6020 7061 7261 6d65 7465 7220 6d75  by` parameter mu
-000124b0: 7374 2062 6520 7072 6f76 6964 6564 2061  st be provided a
-000124c0: 7320 7765 6c6c 2e0a 2020 2020 2020 2020  s well..        
-000124d0: 3a70 6172 616d 2072 6f77 735f 7065 725f  :param rows_per_
-000124e0: 7061 7274 6974 696f 6e3a 2048 6f77 206d  partition: How m
-000124f0: 616e 7920 746f 7020 726f 7773 2028 7065  any top rows (pe
-00012500: 7220 736f 7274 696e 6720 6465 6669 6e65  r sorting define
-00012510: 6420 6279 2060 7061 7274 6974 696f 6e5f  d by `partition_
-00012520: 736f 7274 5f62 7960 2061 6e64 2060 7061  sort_by` and `pa
-00012530: 7274 6974 696f 6e5f 6f72 6465 7260 290a  rtition_order`).
-00012540: 2020 2020 2020 2020 2020 2020 746f 2072              to r
-00012550: 6574 7572 6e20 7065 7220 6772 6f75 702e  eturn per group.
-00012560: 2044 6566 6175 6c74 2076 616c 7565 2069   Default value i
-00012570: 7320 312e 0a20 2020 2020 2020 203a 7061  s 1..        :pa
-00012580: 7261 6d20 7061 7274 6974 696f 6e5f 736f  ram partition_so
-00012590: 7274 5f62 793a 2057 6861 7420 6669 656c  rt_by: What fiel
-000125a0: 6420 746f 2073 6f72 7420 7468 6520 7265  d to sort the re
-000125b0: 7375 6c74 7320 6279 2c20 7769 7468 696e  sults by, within
-000125c0: 2065 6163 6820 7061 7274 6974 696f 6e20   each partition 
-000125d0: 6465 6669 6e65 6420 6279 2060 7061 7274  defined by `part
-000125e0: 6974 696f 6e5f 6279 602e 0a20 2020 2020  ition_by`..     
-000125f0: 2020 2020 2020 2043 7572 7265 6e74 6c79         Currently
-00012600: 2074 6865 206f 6e6c 7920 616c 6c6f 7765   the only allowe
-00012610: 6420 7661 6c75 6520 6172 6520 6063 7265  d value are `cre
-00012620: 6174 6564 6020 616e 6420 6075 7064 6174  ated` and `updat
-00012630: 6564 602e 0a20 2020 2020 2020 203a 7061  ed`..        :pa
-00012640: 7261 6d20 7061 7274 6974 696f 6e5f 6f72  ram partition_or
-00012650: 6465 723a 204f 7264 6572 206f 6620 736f  der: Order of so
-00012660: 7274 696e 6720 7769 7468 696e 2070 6172  rting within par
-00012670: 7469 7469 6f6e 7320 2d20 6061 7363 6020  titions - `asc` 
-00012680: 6f72 2060 6465 7363 602e 2044 6566 6175  or `desc`. Defau
-00012690: 6c74 2069 7320 6064 6573 6360 2e0a 2020  lt is `desc`..  
-000126a0: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
-000126b0: 4c69 7374 206f 6620 6d61 7463 6869 6e67  List of matching
-000126c0: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
-000126d0: 756e 2e66 6561 7475 7265 5f73 746f 7265  un.feature_store
-000126e0: 2e46 6561 7475 7265 5365 7460 206f 626a  .FeatureSet` obj
-000126f0: 6563 7473 2e0a 2020 2020 2020 2020 2222  ects..        ""
-00012700: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
-00012710: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
-00012720: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
-00012730: 726f 6a65 6374 0a0a 2020 2020 2020 2020  roject..        
-00012740: 7061 7261 6d73 203d 207b 0a20 2020 2020  params = {.     
-00012750: 2020 2020 2020 2022 6e61 6d65 223a 206e         "name": n
-00012760: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00012770: 2022 7374 6174 6522 3a20 7374 6174 652c   "state": state,
-00012780: 0a20 2020 2020 2020 2020 2020 2022 7461  .            "ta
-00012790: 6722 3a20 7461 672c 0a20 2020 2020 2020  g": tag,.       
-000127a0: 2020 2020 2022 656e 7469 7479 223a 2065       "entity": e
-000127b0: 6e74 6974 6965 7320 6f72 205b 5d2c 0a20  ntities or [],. 
-000127c0: 2020 2020 2020 2020 2020 2022 6665 6174             "feat
-000127d0: 7572 6522 3a20 6665 6174 7572 6573 206f  ure": features o
-000127e0: 7220 5b5d 2c0a 2020 2020 2020 2020 2020  r [],.          
-000127f0: 2020 226c 6162 656c 223a 206c 6162 656c    "label": label
-00012800: 7320 6f72 205b 5d2c 0a20 2020 2020 2020  s or [],.       
-00012810: 207d 0a20 2020 2020 2020 2069 6620 7061   }.        if pa
-00012820: 7274 6974 696f 6e5f 6279 3a0a 2020 2020  rtition_by:.    
-00012830: 2020 2020 2020 2020 7061 7261 6d73 2e75          params.u
-00012840: 7064 6174 6528 0a20 2020 2020 2020 2020  pdate(.         
-00012850: 2020 2020 2020 2073 656c 662e 5f67 656e         self._gen
-00012860: 6572 6174 655f 7061 7274 6974 696f 6e5f  erate_partition_
-00012870: 6279 5f70 6172 616d 7328 0a20 2020 2020  by_params(.     
-00012880: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00012890: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-000128a0: 6d61 732e 4665 6174 7572 6553 746f 7265  mas.FeatureStore
-000128b0: 5061 7274 6974 696f 6e42 7946 6965 6c64  PartitionByField
-000128c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000128d0: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
-000128e0: 6279 2c0a 2020 2020 2020 2020 2020 2020  by,.            
-000128f0: 2020 2020 2020 2020 726f 7773 5f70 6572          rows_per
-00012900: 5f70 6172 7469 7469 6f6e 2c0a 2020 2020  _partition,.    
-00012910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012920: 7061 7274 6974 696f 6e5f 736f 7274 5f62  partition_sort_b
-00012930: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-00012940: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00012950: 5f6f 7264 6572 2c0a 2020 2020 2020 2020  _order,.        
-00012960: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00012970: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00012980: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-00012990: 7473 2f7b 7072 6f6a 6563 747d 2f66 6561  ts/{project}/fea
-000129a0: 7475 7265 2d73 6574 7322 0a0a 2020 2020  ture-sets"..    
-000129b0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-000129c0: 6520 3d20 280a 2020 2020 2020 2020 2020  e = (.          
-000129d0: 2020 6622 4661 696c 6564 206c 6973 7469    f"Failed listi
-000129e0: 6e67 2066 6561 7475 7265 2d73 6574 732c  ng feature-sets,
-000129f0: 2070 726f 6a65 6374 3a20 7b70 726f 6a65   project: {proje
-00012a00: 6374 7d2c 2071 7565 7279 3a20 7b70 6172  ct}, query: {par
-00012a10: 616d 737d 220a 2020 2020 2020 2020 290a  ams}".        ).
-00012a20: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
-00012a30: 656c 662e 6170 695f 6361 6c6c 2822 4745  elf.api_call("GE
-00012a40: 5422 2c20 7061 7468 2c20 6572 726f 725f  T", path, error_
-00012a50: 6d65 7373 6167 652c 2070 6172 616d 733d  message, params=
-00012a60: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
-00012a70: 6665 6174 7572 655f 7365 7473 203d 2072  feature_sets = r
-00012a80: 6573 702e 6a73 6f6e 2829 5b22 6665 6174  esp.json()["feat
-00012a90: 7572 655f 7365 7473 225d 0a20 2020 2020  ure_sets"].     
-00012aa0: 2020 2069 6620 6665 6174 7572 655f 7365     if feature_se
-00012ab0: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-00012ac0: 7265 7475 726e 205b 4665 6174 7572 6553  return [FeatureS
-00012ad0: 6574 2e66 726f 6d5f 6469 6374 286f 626a  et.from_dict(obj
-00012ae0: 2920 666f 7220 6f62 6a20 696e 2066 6561  ) for obj in fea
-00012af0: 7475 7265 5f73 6574 735d 0a0a 2020 2020  ture_sets]..    
-00012b00: 6465 6620 7374 6f72 655f 6665 6174 7572  def store_featur
-00012b10: 655f 7365 7428 0a20 2020 2020 2020 2073  e_set(.        s
-00012b20: 656c 662c 0a20 2020 2020 2020 2066 6561  elf,.        fea
-00012b30: 7475 7265 5f73 6574 3a20 556e 696f 6e5b  ture_set: Union[
-00012b40: 6469 6374 2c20 6d6c 7275 6e2e 636f 6d6d  dict, mlrun.comm
-00012b50: 6f6e 2e73 6368 656d 6173 2e46 6561 7475  on.schemas.Featu
-00012b60: 7265 5365 742c 2046 6561 7475 7265 5365  reSet, FeatureSe
-00012b70: 745d 2c0a 2020 2020 2020 2020 6e61 6d65  t],.        name
-00012b80: 3d4e 6f6e 652c 0a20 2020 2020 2020 2070  =None,.        p
-00012b90: 726f 6a65 6374 3d22 222c 0a20 2020 2020  roject="",.     
-00012ba0: 2020 2074 6167 3d4e 6f6e 652c 0a20 2020     tag=None,.   
-00012bb0: 2020 2020 2075 6964 3d4e 6f6e 652c 0a20       uid=None,. 
-00012bc0: 2020 2020 2020 2076 6572 7369 6f6e 6564         versioned
-00012bd0: 3d54 7275 652c 0a20 2020 2029 202d 3e20  =True,.    ) -> 
-00012be0: 6469 6374 3a0a 2020 2020 2020 2020 2222  dict:.        ""
-00012bf0: 2253 6176 6520 6120 3a70 793a 636c 6173  "Save a :py:clas
-00012c00: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
-00012c10: 655f 7374 6f72 652e 4665 6174 7572 6553  e_store.FeatureS
-00012c20: 6574 6020 6f62 6a65 6374 2069 6e20 7468  et` object in th
-00012c30: 6520 3a70 793a 6d6f 643a 606d 6c72 756e  e :py:mod:`mlrun
-00012c40: 6020 4442 2e20 5468 650a 2020 2020 2020  ` DB. The.      
-00012c50: 2020 6665 6174 7572 652d 7365 7420 6361    feature-set ca
-00012c60: 6e20 6265 2065 6974 6865 7220 6120 6e65  n be either a ne
-00012c70: 7720 6f62 6a65 6374 206f 7220 6120 6d6f  w object or a mo
-00012c80: 6469 6669 6361 7469 6f6e 2074 6f20 6578  dification to ex
-00012c90: 6973 7469 6e67 206f 626a 6563 7420 7265  isting object re
-00012ca0: 6665 7265 6e63 6564 2062 7920 7468 6520  ferenced by the 
-00012cb0: 7061 7261 6d73 206f 660a 2020 2020 2020  params of.      
-00012cc0: 2020 7468 6520 6675 6e63 7469 6f6e 2e0a    the function..
-00012cd0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00012ce0: 6665 6174 7572 655f 7365 743a 2054 6865  feature_set: The
-00012cf0: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
-00012d00: 756e 2e66 6561 7475 7265 5f73 746f 7265  un.feature_store
-00012d10: 2e46 6561 7475 7265 5365 7460 2074 6f20  .FeatureSet` to 
-00012d20: 7374 6f72 652e 0a20 2020 2020 2020 203a  store..        :
-00012d30: 7061 7261 6d20 6e61 6d65 3a20 2020 204e  param name:    N
-00012d40: 616d 6520 6f66 2066 6561 7475 7265 2073  ame of feature s
-00012d50: 6574 2e0a 2020 2020 2020 2020 3a70 6172  et..        :par
-00012d60: 616d 2070 726f 6a65 6374 3a20 4e61 6d65  am project: Name
-00012d70: 206f 6620 7072 6f6a 6563 7420 7468 6973   of project this
-00012d80: 2066 6561 7475 7265 2d73 6574 2062 656c   feature-set bel
-00012d90: 6f6e 6773 2074 6f2e 0a20 2020 2020 2020  ongs to..       
-00012da0: 203a 7061 7261 6d20 7461 673a 2054 6865   :param tag: The
-00012db0: 2060 6074 6167 6060 206f 6620 7468 6520   ``tag`` of the 
-00012dc0: 6f62 6a65 6374 2074 6f20 7265 706c 6163  object to replac
-00012dd0: 6520 696e 2074 6865 2044 422c 2066 6f72  e in the DB, for
-00012de0: 2065 7861 6d70 6c65 2060 606c 6174 6573   example ``lates
-00012df0: 7460 602e 0a20 2020 2020 2020 203a 7061  t``..        :pa
-00012e00: 7261 6d20 7569 643a 2054 6865 2060 6075  ram uid: The ``u
-00012e10: 6964 6060 206f 6620 7468 6520 6f62 6a65  id`` of the obje
-00012e20: 6374 2074 6f20 7265 706c 6163 6520 696e  ct to replace in
-00012e30: 2074 6865 2044 422e 2049 6620 7573 696e   the DB. If usin
-00012e40: 6720 7468 6973 2070 6172 616d 6574 6572  g this parameter
-00012e50: 2c20 7468 6520 6d6f 6469 6669 6564 206f  , the modified o
-00012e60: 626a 6563 740a 2020 2020 2020 2020 2020  bject.          
-00012e70: 2020 6d75 7374 2068 6176 6520 7468 6520    must have the 
-00012e80: 7361 6d65 2060 6075 6964 6060 206f 6620  same ``uid`` of 
-00012e90: 7468 6520 7072 6576 696f 7573 6c79 2d65  the previously-e
-00012ea0: 7869 7374 696e 6720 6f62 6a65 6374 2e20  xisting object. 
-00012eb0: 5468 6973 2063 616e 6e6f 7420 6265 2075  This cannot be u
-00012ec0: 7365 6420 666f 7220 6e6f 6e2d 7665 7273  sed for non-vers
-00012ed0: 696f 6e65 6420 6f62 6a65 6374 732e 0a20  ioned objects.. 
-00012ee0: 2020 2020 2020 203a 7061 7261 6d20 7665         :param ve
-00012ef0: 7273 696f 6e65 643a 2057 6865 7468 6572  rsioned: Whether
-00012f00: 2074 6f20 6d61 696e 7461 696e 2076 6572   to maintain ver
-00012f10: 7369 6f6e 7320 666f 7220 7468 6973 2066  sions for this f
-00012f20: 6561 7475 7265 2d73 6574 2e20 416c 6c20  eature-set. All 
-00012f30: 7665 7273 696f 6e73 206f 6620 6120 7665  versions of a ve
-00012f40: 7273 696f 6e65 6420 6f62 6a65 6374 0a20  rsioned object. 
-00012f50: 2020 2020 2020 2020 2020 2077 696c 6c20             will 
-00012f60: 6265 206b 6570 7420 696e 2074 6865 2044  be kept in the D
-00012f70: 4220 616e 6420 6361 6e20 6265 2072 6574  B and can be ret
-00012f80: 7269 6576 6564 2075 6e74 696c 2065 7870  rieved until exp
-00012f90: 6c69 6369 746c 7920 6465 6c65 7465 642e  licitly deleted.
-00012fa0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00012fb0: 733a 2054 6865 203a 7079 3a63 6c61 7373  s: The :py:class
-00012fc0: 3a60 7e6d 6c72 756e 2e66 6561 7475 7265  :`~mlrun.feature
-00012fd0: 5f73 746f 7265 2e46 6561 7475 7265 5365  _store.FeatureSe
-00012fe0: 7460 206f 626a 6563 7420 2861 7320 6469  t` object (as di
-00012ff0: 6374 292e 0a20 2020 2020 2020 2022 2222  ct)..        """
-00013000: 0a0a 2020 2020 2020 2020 7265 6665 7265  ..        refere
-00013010: 6e63 6520 3d20 7365 6c66 2e5f 7265 736f  nce = self._reso
-00013020: 6c76 655f 7265 6665 7265 6e63 6528 7461  lve_reference(ta
-00013030: 672c 2075 6964 290a 2020 2020 2020 2020  g, uid).        
-00013040: 7061 7261 6d73 203d 207b 2276 6572 7369  params = {"versi
-00013050: 6f6e 6564 223a 2076 6572 7369 6f6e 6564  oned": versioned
-00013060: 7d0a 0a20 2020 2020 2020 2069 6620 6973  }..        if is
-00013070: 696e 7374 616e 6365 2866 6561 7475 7265  instance(feature
-00013080: 5f73 6574 2c20 6d6c 7275 6e2e 636f 6d6d  _set, mlrun.comm
-00013090: 6f6e 2e73 6368 656d 6173 2e46 6561 7475  on.schemas.Featu
-000130a0: 7265 5365 7429 3a0a 2020 2020 2020 2020  reSet):.        
-000130b0: 2020 2020 6665 6174 7572 655f 7365 7420      feature_set 
-000130c0: 3d20 6665 6174 7572 655f 7365 742e 6469  = feature_set.di
-000130d0: 6374 2829 0a20 2020 2020 2020 2065 6c69  ct().        eli
-000130e0: 6620 6973 696e 7374 616e 6365 2866 6561  f isinstance(fea
-000130f0: 7475 7265 5f73 6574 2c20 4665 6174 7572  ture_set, Featur
-00013100: 6553 6574 293a 0a20 2020 2020 2020 2020  eSet):.         
-00013110: 2020 2066 6561 7475 7265 5f73 6574 203d     feature_set =
-00013120: 2066 6561 7475 7265 5f73 6574 2e74 6f5f   feature_set.to_
-00013130: 6469 6374 2829 0a0a 2020 2020 2020 2020  dict()..        
-00013140: 6e61 6d65 203d 206e 616d 6520 6f72 2066  name = name or f
-00013150: 6561 7475 7265 5f73 6574 5b22 6d65 7461  eature_set["meta
-00013160: 6461 7461 225d 5b22 6e61 6d65 225d 0a20  data"]["name"]. 
-00013170: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
-00013180: 2028 0a20 2020 2020 2020 2020 2020 2070   (.            p
-00013190: 726f 6a65 6374 206f 7220 6665 6174 7572  roject or featur
-000131a0: 655f 7365 745b 226d 6574 6164 6174 6122  e_set["metadata"
-000131b0: 5d2e 6765 7428 2270 726f 6a65 6374 2229  ].get("project")
-000131c0: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
-000131d0: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
-000131e0: 2020 2029 0a20 2020 2020 2020 2070 6174     ).        pat
-000131f0: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
-00013200: 7072 6f6a 6563 747d 2f66 6561 7475 7265  project}/feature
-00013210: 2d73 6574 732f 7b6e 616d 657d 2f72 6566  -sets/{name}/ref
-00013220: 6572 656e 6365 732f 7b72 6566 6572 656e  erences/{referen
-00013230: 6365 7d22 0a20 2020 2020 2020 2065 7272  ce}".        err
-00013240: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
-00013250: 6169 6c65 6420 7374 6f72 696e 6720 6665  ailed storing fe
-00013260: 6174 7572 652d 7365 7420 7b70 726f 6a65  ature-set {proje
-00013270: 6374 7d2f 7b6e 616d 657d 220a 2020 2020  ct}/{name}".    
-00013280: 2020 2020 7265 7370 203d 2073 656c 662e      resp = self.
-00013290: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
-000132a0: 2020 2020 2020 2250 5554 222c 2070 6174        "PUT", pat
-000132b0: 682c 2065 7272 6f72 5f6d 6573 7361 6765  h, error_message
-000132c0: 2c20 7061 7261 6d73 3d70 6172 616d 732c  , params=params,
-000132d0: 2062 6f64 793d 6469 6374 5f74 6f5f 6a73   body=dict_to_js
-000132e0: 6f6e 2866 6561 7475 7265 5f73 6574 290a  on(feature_set).
-000132f0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00013300: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
-00013310: 6f6e 2829 0a0a 2020 2020 6465 6620 7061  on()..    def pa
-00013320: 7463 685f 6665 6174 7572 655f 7365 7428  tch_feature_set(
-00013330: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00013340: 2020 2020 2020 206e 616d 652c 0a20 2020         name,.   
-00013350: 2020 2020 2066 6561 7475 7265 5f73 6574       feature_set
-00013360: 5f75 7064 6174 653a 2064 6963 742c 0a20  _update: dict,. 
-00013370: 2020 2020 2020 2070 726f 6a65 6374 3d22         project="
-00013380: 222c 0a20 2020 2020 2020 2074 6167 3d4e  ",.        tag=N
-00013390: 6f6e 652c 0a20 2020 2020 2020 2075 6964  one,.        uid
-000133a0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2070  =None,.        p
-000133b0: 6174 6368 5f6d 6f64 653a 2055 6e69 6f6e  atch_mode: Union
-000133c0: 5b0a 2020 2020 2020 2020 2020 2020 7374  [.            st
-000133d0: 722c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  r, mlrun.common.
-000133e0: 7363 6865 6d61 732e 5061 7463 684d 6f64  schemas.PatchMod
-000133f0: 650a 2020 2020 2020 2020 5d20 3d20 6d6c  e.        ] = ml
-00013400: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00013410: 6173 2e50 6174 6368 4d6f 6465 2e72 6570  as.PatchMode.rep
-00013420: 6c61 6365 2c0a 2020 2020 293a 0a20 2020  lace,.    ):.   
-00013430: 2020 2020 2022 2222 4d6f 6469 6679 2028       """Modify (
-00013440: 7061 7463 6829 2061 6e20 6578 6973 7469  patch) an existi
-00013450: 6e67 203a 7079 3a63 6c61 7373 3a60 7e6d  ng :py:class:`~m
-00013460: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
-00013470: 7265 2e46 6561 7475 7265 5365 7460 206f  re.FeatureSet` o
-00013480: 626a 6563 742e 0a20 2020 2020 2020 2054  bject..        T
-00013490: 6865 206f 626a 6563 7420 6973 2069 6465  he object is ide
-000134a0: 6e74 6966 6965 6420 6279 2069 7473 206e  ntified by its n
-000134b0: 616d 6520 2861 6e64 2070 726f 6a65 6374  ame (and project
-000134c0: 2069 7420 6265 6c6f 6e67 7320 746f 292c   it belongs to),
-000134d0: 2061 7320 7765 6c6c 2061 7320 6f70 7469   as well as opti
-000134e0: 6f6e 616c 6c79 2061 2060 6074 6167 6060  onally a ``tag``
-000134f0: 206f 7220 6974 730a 2020 2020 2020 2020   or its.        
-00013500: 6060 7569 6460 6020 2866 6f72 2076 6572  ``uid`` (for ver
-00013510: 7369 6f6e 6564 206f 626a 6563 7429 2e20  sioned object). 
-00013520: 4966 2062 6f74 6820 6060 7461 6760 6020  If both ``tag`` 
-00013530: 616e 6420 6060 7569 6460 6020 6172 6520  and ``uid`` are 
-00013540: 6f6d 6974 7465 6420 7468 656e 2074 6865  omitted then the
-00013550: 206f 626a 6563 7420 7769 7468 2074 6167   object with tag
-00013560: 2060 606c 6174 6573 7460 600a 2020 2020   ``latest``.    
-00013570: 2020 2020 6973 206d 6f64 6966 6965 642e      is modified.
-00013580: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00013590: 206e 616d 653a 204e 616d 6520 6f66 2074   name: Name of t
-000135a0: 6865 206f 626a 6563 7420 746f 2070 6174  he object to pat
-000135b0: 6368 2e0a 2020 2020 2020 2020 3a70 6172  ch..        :par
-000135c0: 616d 2066 6561 7475 7265 5f73 6574 5f75  am feature_set_u
-000135d0: 7064 6174 653a 2054 6865 206d 6f64 6966  pdate: The modif
-000135e0: 6963 6174 696f 6e73 206e 6565 6465 6420  ications needed 
-000135f0: 696e 2074 6865 206f 626a 6563 742e 2054  in the object. T
-00013600: 6869 7320 7061 7261 6d65 7465 7220 6f6e  his parameter on
-00013610: 6c79 2068 6173 2074 6865 2063 6861 6e67  ly has the chang
-00013620: 6573 2069 6e20 6974 2c0a 2020 2020 2020  es in it,.      
-00013630: 2020 2020 2020 6e6f 7420 6120 6675 6c6c        not a full
-00013640: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
-00013650: 2020 2020 2045 7861 6d70 6c65 3a3a 0a0a       Example::..
-00013660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013670: 6665 6174 7572 655f 7365 745f 7570 6461  feature_set_upda
-00013680: 7465 203d 207b 2273 7461 7475 7322 3a20  te = {"status": 
-00013690: 7b22 7072 6f63 6573 7365 6422 203a 2054  {"processed" : T
-000136a0: 7275 657d 7d0a 0a20 2020 2020 2020 2020  rue}}..         
-000136b0: 2020 2057 696c 6c20 6170 706c 7920 7468     Will apply th
-000136c0: 6520 6669 656c 6420 6060 7374 6174 7573  e field ``status
-000136d0: 2e70 726f 6365 7373 6564 6060 2074 6f20  .processed`` to 
-000136e0: 7468 6520 6578 6973 7469 6e67 206f 626a  the existing obj
-000136f0: 6563 742e 0a20 2020 2020 2020 203a 7061  ect..        :pa
-00013700: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
-00013710: 6a65 6374 2077 6869 6368 2063 6f6e 7461  ject which conta
-00013720: 696e 7320 7468 6520 6d6f 6469 6669 6564  ins the modified
-00013730: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
-00013740: 203a 7061 7261 6d20 7461 673a 2054 6865   :param tag: The
-00013750: 2074 6167 206f 6620 7468 6520 6f62 6a65   tag of the obje
-00013760: 6374 2074 6f20 6d6f 6469 6679 2e0a 2020  ct to modify..  
-00013770: 2020 2020 2020 3a70 6172 616d 2075 6964        :param uid
-00013780: 3a20 7569 6420 6f66 2074 6865 206f 626a  : uid of the obj
-00013790: 6563 7420 746f 206d 6f64 6966 792e 0a20  ect to modify.. 
-000137a0: 2020 2020 2020 203a 7061 7261 6d20 7061         :param pa
-000137b0: 7463 685f 6d6f 6465 3a20 5468 6520 7374  tch_mode: The st
-000137c0: 7261 7465 6779 2066 6f72 206d 6572 6769  rategy for mergi
-000137d0: 6e67 2074 6865 2063 6861 6e67 6573 2077  ng the changes w
-000137e0: 6974 6820 7468 6520 6578 6973 7469 6e67  ith the existing
-000137f0: 206f 626a 6563 742e 2043 616e 2062 6520   object. Can be 
-00013800: 6569 7468 6572 2060 6072 6570 6c61 6365  either ``replace
-00013810: 6060 0a20 2020 2020 2020 2020 2020 206f  ``.            o
-00013820: 7220 6060 6164 6469 7469 7665 6060 2e0a  r ``additive``..
-00013830: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00013840: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
-00013850: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
-00013860: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
-00013870: 2020 2020 2020 2020 7265 6665 7265 6e63          referenc
-00013880: 6520 3d20 7365 6c66 2e5f 7265 736f 6c76  e = self._resolv
-00013890: 655f 7265 6665 7265 6e63 6528 7461 672c  e_reference(tag,
-000138a0: 2075 6964 290a 2020 2020 2020 2020 6865   uid).        he
-000138b0: 6164 6572 7320 3d20 7b6d 6c72 756e 2e63  aders = {mlrun.c
-000138c0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4865  ommon.schemas.He
-000138d0: 6164 6572 4e61 6d65 732e 7061 7463 685f  aderNames.patch_
-000138e0: 6d6f 6465 3a20 7061 7463 685f 6d6f 6465  mode: patch_mode
-000138f0: 7d0a 2020 2020 2020 2020 7061 7468 203d  }.        path =
-00013900: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-00013910: 6a65 6374 7d2f 6665 6174 7572 652d 7365  ject}/feature-se
-00013920: 7473 2f7b 6e61 6d65 7d2f 7265 6665 7265  ts/{name}/refere
-00013930: 6e63 6573 2f7b 7265 6665 7265 6e63 657d  nces/{reference}
-00013940: 220a 2020 2020 2020 2020 6572 726f 725f  ".        error_
-00013950: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
-00013960: 6564 2075 7064 6174 696e 6720 6665 6174  ed updating feat
-00013970: 7572 652d 7365 7420 7b70 726f 6a65 6374  ure-set {project
-00013980: 7d2f 7b6e 616d 657d 220a 2020 2020 2020  }/{name}".      
-00013990: 2020 7365 6c66 2e61 7069 5f63 616c 6c28    self.api_call(
-000139a0: 0a20 2020 2020 2020 2020 2020 2022 5041  .            "PA
-000139b0: 5443 4822 2c0a 2020 2020 2020 2020 2020  TCH",.          
-000139c0: 2020 7061 7468 2c0a 2020 2020 2020 2020    path,.        
-000139d0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-000139e0: 652c 0a20 2020 2020 2020 2020 2020 2062  e,.            b
-000139f0: 6f64 793d 6469 6374 5f74 6f5f 6a73 6f6e  ody=dict_to_json
-00013a00: 2866 6561 7475 7265 5f73 6574 5f75 7064  (feature_set_upd
-00013a10: 6174 6529 2c0a 2020 2020 2020 2020 2020  ate),.          
-00013a20: 2020 6865 6164 6572 733d 6865 6164 6572    headers=header
-00013a30: 732c 0a20 2020 2020 2020 2029 0a0a 2020  s,.        )..  
-00013a40: 2020 6465 6620 6465 6c65 7465 5f66 6561    def delete_fea
-00013a50: 7475 7265 5f73 6574 2873 656c 662c 206e  ture_set(self, n
-00013a60: 616d 652c 2070 726f 6a65 6374 3d22 222c  ame, project="",
-00013a70: 2074 6167 3d4e 6f6e 652c 2075 6964 3d4e   tag=None, uid=N
-00013a80: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
-00013a90: 2244 656c 6574 6520 6120 3a70 793a 636c  "Delete a :py:cl
-00013aa0: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
-00013ab0: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
-00013ac0: 6553 6574 6020 6f62 6a65 6374 2066 726f  eSet` object fro
-00013ad0: 6d20 7468 6520 4442 2e0a 2020 2020 2020  m the DB..      
-00013ae0: 2020 4966 2060 6074 6167 6060 206f 7220    If ``tag`` or 
-00013af0: 6060 7569 6460 6020 6172 6520 7370 6563  ``uid`` are spec
-00013b00: 6966 6965 642c 2074 6865 6e20 6a75 7374  ified, then just
-00013b10: 2074 6865 2076 6572 7369 6f6e 2072 6566   the version ref
-00013b20: 6572 656e 6365 6420 6279 2074 6865 6d20  erenced by them 
-00013b30: 7769 6c6c 2062 6520 6465 6c65 7465 642e  will be deleted.
-00013b40: 2055 7369 6e67 2062 6f74 680a 2020 2020   Using both.    
-00013b50: 2020 2020 6973 206e 6f74 2061 6c6c 6f77      is not allow
-00013b60: 6564 2e0a 2020 2020 2020 2020 4966 206e  ed..        If n
-00013b70: 6f6e 6520 6172 6520 7370 6563 6966 6965  one are specifie
-00013b80: 642c 2074 6865 6e20 616c 6c20 696e 7374  d, then all inst
-00013b90: 616e 6365 7320 6f66 2074 6865 206f 626a  ances of the obj
-00013ba0: 6563 7420 7768 6f73 6520 6e61 6d65 2069  ect whose name i
-00013bb0: 7320 6060 6e61 6d65 6060 2077 696c 6c20  s ``name`` will 
-00013bc0: 6265 2064 656c 6574 6564 2e0a 2020 2020  be deleted..    
-00013bd0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00013be0: 7072 6f6a 6563 7420 3d20 7072 6f6a 6563  project = projec
-00013bf0: 7420 6f72 2063 6f6e 6669 672e 6465 6661  t or config.defa
-00013c00: 756c 745f 7072 6f6a 6563 740a 2020 2020  ult_project.    
-00013c10: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
-00013c20: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
-00013c30: 6665 6174 7572 652d 7365 7473 2f7b 6e61  feature-sets/{na
-00013c40: 6d65 7d22 0a0a 2020 2020 2020 2020 6966  me}"..        if
-00013c50: 2074 6167 206f 7220 7569 643a 0a20 2020   tag or uid:.   
-00013c60: 2020 2020 2020 2020 2072 6566 6572 656e           referen
-00013c70: 6365 203d 2073 656c 662e 5f72 6573 6f6c  ce = self._resol
-00013c80: 7665 5f72 6566 6572 656e 6365 2874 6167  ve_reference(tag
-00013c90: 2c20 7569 6429 0a20 2020 2020 2020 2020  , uid).         
-00013ca0: 2020 2070 6174 6820 3d20 7061 7468 202b     path = path +
-00013cb0: 2066 222f 7265 6665 7265 6e63 6573 2f7b   f"/references/{
-00013cc0: 7265 6665 7265 6e63 657d 220a 0a20 2020  reference}"..   
-00013cd0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-00013ce0: 6765 203d 2066 2246 6169 6c65 6420 6465  ge = f"Failed de
-00013cf0: 6c65 7469 6e67 2066 6561 7475 7265 2d73  leting feature-s
-00013d00: 6574 207b 6e61 6d65 7d22 0a20 2020 2020  et {name}".     
-00013d10: 2020 2073 656c 662e 6170 695f 6361 6c6c     self.api_call
-00013d20: 2822 4445 4c45 5445 222c 2070 6174 682c  ("DELETE", path,
-00013d30: 2065 7272 6f72 5f6d 6573 7361 6765 290a   error_message).
-00013d40: 0a20 2020 2064 6566 2063 7265 6174 655f  .    def create_
-00013d50: 6665 6174 7572 655f 7665 6374 6f72 280a  feature_vector(.
-00013d60: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00013d70: 2020 2020 2020 6665 6174 7572 655f 7665        feature_ve
-00013d80: 6374 6f72 3a20 556e 696f 6e5b 6469 6374  ctor: Union[dict
-00013d90: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
-00013da0: 6368 656d 6173 2e46 6561 7475 7265 5665  chemas.FeatureVe
-00013db0: 6374 6f72 2c20 4665 6174 7572 6556 6563  ctor, FeatureVec
-00013dc0: 746f 725d 2c0a 2020 2020 2020 2020 7072  tor],.        pr
-00013dd0: 6f6a 6563 743d 2222 2c0a 2020 2020 2020  oject="",.      
-00013de0: 2020 7665 7273 696f 6e65 643d 5472 7565    versioned=True
-00013df0: 2c0a 2020 2020 2920 2d3e 2064 6963 743a  ,.    ) -> dict:
-00013e00: 0a20 2020 2020 2020 2022 2222 4372 6561  .        """Crea
-00013e10: 7465 2061 206e 6577 203a 7079 3a63 6c61  te a new :py:cla
-00013e20: 7373 3a60 7e6d 6c72 756e 2e66 6561 7475  ss:`~mlrun.featu
-00013e30: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
-00013e40: 5665 6374 6f72 6020 616e 6420 7361 7665  Vector` and save
-00013e50: 2069 6e20 7468 6520 3a70 793a 6d6f 643a   in the :py:mod:
-00013e60: 606d 6c72 756e 6020 4442 2e0a 0a20 2020  `mlrun` DB...   
-00013e70: 2020 2020 203a 7061 7261 6d20 6665 6174       :param feat
-00013e80: 7572 655f 7665 6374 6f72 3a20 5468 6520  ure_vector: The 
-00013e90: 6e65 7720 3a70 793a 636c 6173 733a 607e  new :py:class:`~
-00013ea0: 6d6c 7275 6e2e 6665 6174 7572 655f 7374  mlrun.feature_st
-00013eb0: 6f72 652e 4665 6174 7572 6556 6563 746f  ore.FeatureVecto
-00013ec0: 7260 2074 6f20 6372 6561 7465 2e0a 2020  r` to create..  
-00013ed0: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
-00013ee0: 6a65 6374 3a20 4e61 6d65 206f 6620 7072  ject: Name of pr
-00013ef0: 6f6a 6563 7420 7468 6973 2066 6561 7475  oject this featu
-00013f00: 7265 2d76 6563 746f 7220 6265 6c6f 6e67  re-vector belong
-00013f10: 7320 746f 2e0a 2020 2020 2020 2020 3a70  s to..        :p
-00013f20: 6172 616d 2076 6572 7369 6f6e 6564 3a20  aram versioned: 
-00013f30: 5768 6574 6865 7220 746f 206d 6169 6e74  Whether to maint
-00013f40: 6169 6e20 7665 7273 696f 6e73 2066 6f72  ain versions for
-00013f50: 2074 6869 7320 6665 6174 7572 652d 7665   this feature-ve
-00013f60: 6374 6f72 2e20 416c 6c20 7665 7273 696f  ctor. All versio
-00013f70: 6e73 206f 6620 6120 7665 7273 696f 6e65  ns of a versione
-00013f80: 6420 6f62 6a65 6374 0a20 2020 2020 2020  d object.       
-00013f90: 2020 2020 2077 696c 6c20 6265 206b 6570       will be kep
-00013fa0: 7420 696e 2074 6865 2044 4220 616e 6420  t in the DB and 
-00013fb0: 6361 6e20 6265 2072 6574 7269 6576 6564  can be retrieved
-00013fc0: 2075 6e74 696c 2065 7870 6c69 6369 746c   until explicitl
-00013fd0: 7920 6465 6c65 7465 642e 0a20 2020 2020  y deleted..     
-00013fe0: 2020 203a 7265 7475 726e 733a 2054 6865     :returns: The
-00013ff0: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
-00014000: 756e 2e66 6561 7475 7265 5f73 746f 7265  un.feature_store
-00014010: 2e46 6561 7475 7265 5665 6374 6f72 6020  .FeatureVector` 
-00014020: 6f62 6a65 6374 2028 6173 2064 6963 7429  object (as dict)
-00014030: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00014040: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00014050: 6e63 6528 6665 6174 7572 655f 7665 6374  nce(feature_vect
-00014060: 6f72 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  or, mlrun.common
-00014070: 2e73 6368 656d 6173 2e46 6561 7475 7265  .schemas.Feature
-00014080: 5665 6374 6f72 293a 0a20 2020 2020 2020  Vector):.       
-00014090: 2020 2020 2066 6561 7475 7265 5f76 6563       feature_vec
-000140a0: 746f 7220 3d20 6665 6174 7572 655f 7665  tor = feature_ve
-000140b0: 6374 6f72 2e64 6963 7428 290a 2020 2020  ctor.dict().    
-000140c0: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-000140d0: 6e63 6528 6665 6174 7572 655f 7665 6374  nce(feature_vect
-000140e0: 6f72 2c20 4665 6174 7572 6556 6563 746f  or, FeatureVecto
-000140f0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-00014100: 6665 6174 7572 655f 7665 6374 6f72 203d  feature_vector =
-00014110: 2066 6561 7475 7265 5f76 6563 746f 722e   feature_vector.
-00014120: 746f 5f64 6963 7428 290a 0a20 2020 2020  to_dict()..     
-00014130: 2020 2070 726f 6a65 6374 203d 2028 0a20     project = (. 
-00014140: 2020 2020 2020 2020 2020 2070 726f 6a65             proje
-00014150: 6374 0a20 2020 2020 2020 2020 2020 206f  ct.            o
-00014160: 7220 6665 6174 7572 655f 7665 6374 6f72  r feature_vector
-00014170: 5b22 6d65 7461 6461 7461 225d 2e67 6574  ["metadata"].get
-00014180: 2822 7072 6f6a 6563 7422 2c20 4e6f 6e65  ("project", None
-00014190: 290a 2020 2020 2020 2020 2020 2020 6f72  ).            or
-000141a0: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
-000141b0: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
-000141c0: 290a 2020 2020 2020 2020 7061 7468 203d  ).        path =
-000141d0: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-000141e0: 6a65 6374 7d2f 6665 6174 7572 652d 7665  ject}/feature-ve
-000141f0: 6374 6f72 7322 0a20 2020 2020 2020 2070  ctors".        p
-00014200: 6172 616d 7320 3d20 7b22 7665 7273 696f  arams = {"versio
-00014210: 6e65 6422 3a20 7665 7273 696f 6e65 647d  ned": versioned}
-00014220: 0a0a 2020 2020 2020 2020 6e61 6d65 203d  ..        name =
-00014230: 2066 6561 7475 7265 5f76 6563 746f 725b   feature_vector[
-00014240: 226d 6574 6164 6174 6122 5d5b 226e 616d  "metadata"]["nam
-00014250: 6522 5d0a 2020 2020 2020 2020 6572 726f  e"].        erro
-00014260: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
-00014270: 696c 6564 2063 7265 6174 696e 6720 6665  iled creating fe
-00014280: 6174 7572 652d 7665 6374 6f72 207b 7072  ature-vector {pr
-00014290: 6f6a 6563 747d 2f7b 6e61 6d65 7d22 0a20  oject}/{name}". 
-000142a0: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
-000142b0: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
-000142c0: 2020 2020 2020 2020 2022 504f 5354 222c           "POST",
-000142d0: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
-000142e0: 682c 0a20 2020 2020 2020 2020 2020 2065  h,.            e
-000142f0: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
-00014300: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-00014310: 3d70 6172 616d 732c 0a20 2020 2020 2020  =params,.       
-00014320: 2020 2020 2062 6f64 793d 6469 6374 5f74       body=dict_t
-00014330: 6f5f 6a73 6f6e 2866 6561 7475 7265 5f76  o_json(feature_v
-00014340: 6563 746f 7229 2c0a 2020 2020 2020 2020  ector),.        
-00014350: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00014360: 2072 6573 702e 6a73 6f6e 2829 0a0a 2020   resp.json()..  
-00014370: 2020 6465 6620 6765 745f 6665 6174 7572    def get_featur
-00014380: 655f 7665 6374 6f72 280a 2020 2020 2020  e_vector(.      
-00014390: 2020 7365 6c66 2c20 6e61 6d65 3a20 7374    self, name: st
-000143a0: 722c 2070 726f 6a65 6374 3a20 7374 7220  r, project: str 
-000143b0: 3d20 2222 2c20 7461 673a 2073 7472 203d  = "", tag: str =
-000143c0: 204e 6f6e 652c 2075 6964 3a20 7374 7220   None, uid: str 
-000143d0: 3d20 4e6f 6e65 0a20 2020 2029 202d 3e20  = None.    ) -> 
-000143e0: 4665 6174 7572 6556 6563 746f 723a 0a20  FeatureVector:. 
-000143f0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-00014400: 2061 2073 7065 6369 6669 6320 6665 6174   a specific feat
-00014410: 7572 652d 7665 6374 6f72 2072 6566 6572  ure-vector refer
-00014420: 656e 6365 6420 6279 2069 7473 2074 6167  enced by its tag
-00014430: 206f 7220 7569 642e 2049 6620 6e6f 6e65   or uid. If none
-00014440: 2061 7265 2070 726f 7669 6465 642c 2060   are provided, `
-00014450: 606c 6174 6573 7460 6020 7461 6720 7769  `latest`` tag wi
-00014460: 6c6c 0a20 2020 2020 2020 2062 6520 7573  ll.        be us
-00014470: 6564 2e22 2222 0a0a 2020 2020 2020 2020  ed."""..        
-00014480: 7072 6f6a 6563 7420 3d20 7072 6f6a 6563  project = projec
-00014490: 7420 6f72 2063 6f6e 6669 672e 6465 6661  t or config.defa
-000144a0: 756c 745f 7072 6f6a 6563 740a 2020 2020  ult_project.    
-000144b0: 2020 2020 7265 6665 7265 6e63 6520 3d20      reference = 
-000144c0: 7365 6c66 2e5f 7265 736f 6c76 655f 7265  self._resolve_re
-000144d0: 6665 7265 6e63 6528 7461 672c 2075 6964  ference(tag, uid
-000144e0: 290a 2020 2020 2020 2020 7061 7468 203d  ).        path =
-000144f0: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-00014500: 6a65 6374 7d2f 6665 6174 7572 652d 7665  ject}/feature-ve
-00014510: 6374 6f72 732f 7b6e 616d 657d 2f72 6566  ctors/{name}/ref
-00014520: 6572 656e 6365 732f 7b72 6566 6572 656e  erences/{referen
-00014530: 6365 7d22 0a20 2020 2020 2020 2065 7272  ce}".        err
-00014540: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
-00014550: 6169 6c65 6420 7265 7472 6965 7669 6e67  ailed retrieving
-00014560: 2066 6561 7475 7265 2d76 6563 746f 7220   feature-vector 
-00014570: 7b70 726f 6a65 6374 7d2f 7b6e 616d 657d  {project}/{name}
-00014580: 220a 2020 2020 2020 2020 7265 7370 203d  ".        resp =
-00014590: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
-000145a0: 4745 5422 2c20 7061 7468 2c20 6572 726f  GET", path, erro
-000145b0: 725f 6d65 7373 6167 6529 0a20 2020 2020  r_message).     
-000145c0: 2020 2072 6574 7572 6e20 4665 6174 7572     return Featur
-000145d0: 6556 6563 746f 722e 6672 6f6d 5f64 6963  eVector.from_dic
-000145e0: 7428 7265 7370 2e6a 736f 6e28 2929 0a0a  t(resp.json())..
-000145f0: 2020 2020 6465 6620 6c69 7374 5f66 6561      def list_fea
-00014600: 7475 7265 5f76 6563 746f 7273 280a 2020  ture_vectors(.  
-00014610: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00014620: 2020 2020 7072 6f6a 6563 743a 2073 7472      project: str
-00014630: 203d 2022 222c 0a20 2020 2020 2020 206e   = "",.        n
-00014640: 616d 653a 2073 7472 203d 204e 6f6e 652c  ame: str = None,
-00014650: 0a20 2020 2020 2020 2074 6167 3a20 7374  .        tag: st
-00014660: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
-00014670: 2020 7374 6174 653a 2073 7472 203d 204e    state: str = N
-00014680: 6f6e 652c 0a20 2020 2020 2020 206c 6162  one,.        lab
-00014690: 656c 733a 204c 6973 745b 7374 725d 203d  els: List[str] =
-000146a0: 204e 6f6e 652c 0a20 2020 2020 2020 2070   None,.        p
-000146b0: 6172 7469 7469 6f6e 5f62 793a 2055 6e69  artition_by: Uni
-000146c0: 6f6e 5b0a 2020 2020 2020 2020 2020 2020  on[.            
-000146d0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-000146e0: 656d 6173 2e46 6561 7475 7265 5374 6f72  emas.FeatureStor
-000146f0: 6550 6172 7469 7469 6f6e 4279 4669 656c  ePartitionByFiel
-00014700: 642c 2073 7472 0a20 2020 2020 2020 205d  d, str.        ]
-00014710: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00014720: 2072 6f77 735f 7065 725f 7061 7274 6974   rows_per_partit
-00014730: 696f 6e3a 2069 6e74 203d 2031 2c0a 2020  ion: int = 1,.  
-00014740: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
-00014750: 736f 7274 5f62 793a 2055 6e69 6f6e 5b6d  sort_by: Union[m
-00014760: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00014770: 6d61 732e 536f 7274 4669 656c 642c 2073  mas.SortField, s
-00014780: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-00014790: 2020 2020 7061 7274 6974 696f 6e5f 6f72      partition_or
-000147a0: 6465 723a 2055 6e69 6f6e 5b0a 2020 2020  der: Union[.    
-000147b0: 2020 2020 2020 2020 6d6c 7275 6e2e 636f          mlrun.co
-000147c0: 6d6d 6f6e 2e73 6368 656d 6173 2e4f 7264  mmon.schemas.Ord
-000147d0: 6572 5479 7065 2c20 7374 720a 2020 2020  erType, str.    
-000147e0: 2020 2020 5d20 3d20 6d6c 7275 6e2e 636f      ] = mlrun.co
-000147f0: 6d6d 6f6e 2e73 6368 656d 6173 2e4f 7264  mmon.schemas.Ord
-00014800: 6572 5479 7065 2e64 6573 632c 0a20 2020  erType.desc,.   
-00014810: 2029 202d 3e20 4c69 7374 5b46 6561 7475   ) -> List[Featu
-00014820: 7265 5665 6374 6f72 5d3a 0a20 2020 2020  reVector]:.     
-00014830: 2020 2022 2222 5265 7472 6965 7665 2061     """Retrieve a
-00014840: 206c 6973 7420 6f66 2066 6561 7475 7265   list of feature
-00014850: 2d76 6563 746f 7273 206d 6174 6368 696e  -vectors matchin
-00014860: 6720 7468 6520 6372 6974 6572 6961 2070  g the criteria p
-00014870: 726f 7669 6465 642e 0a0a 2020 2020 2020  rovided...      
-00014880: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
-00014890: 3a20 5072 6f6a 6563 7420 6e61 6d65 2e0a  : Project name..
-000148a0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-000148b0: 616d 653a 204e 616d 6520 6f66 2066 6561  ame: Name of fea
-000148c0: 7475 7265 2d76 6563 746f 7220 746f 206d  ture-vector to m
-000148d0: 6174 6368 2e20 5468 6973 2069 7320 6120  atch. This is a 
-000148e0: 6c69 6b65 2071 7565 7279 2c20 616e 6420  like query, and 
-000148f0: 6973 2063 6173 652d 696e 7365 6e73 6974  is case-insensit
-00014900: 6976 652e 0a20 2020 2020 2020 203a 7061  ive..        :pa
-00014910: 7261 6d20 7461 673a 204d 6174 6368 2066  ram tag: Match f
-00014920: 6561 7475 7265 2d76 6563 746f 7273 2077  eature-vectors w
-00014930: 6974 6820 7370 6563 6966 6963 2074 6167  ith specific tag
-00014940: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00014950: 2073 7461 7465 3a20 4d61 7463 6820 6665   state: Match fe
-00014960: 6174 7572 652d 7665 6374 6f72 7320 7769  ature-vectors wi
-00014970: 7468 2061 2073 7065 6369 6669 6320 7374  th a specific st
-00014980: 6174 652e 0a20 2020 2020 2020 203a 7061  ate..        :pa
-00014990: 7261 6d20 6c61 6265 6c73 3a20 4d61 7463  ram labels: Matc
-000149a0: 6820 6665 6174 7572 652d 7665 6374 6f72  h feature-vector
-000149b0: 7320 7768 6963 6820 6861 7665 2074 6865  s which have the
-000149c0: 7365 206c 6162 656c 732e 0a20 2020 2020  se labels..     
-000149d0: 2020 203a 7061 7261 6d20 7061 7274 6974     :param partit
-000149e0: 696f 6e5f 6279 3a20 4669 656c 6420 746f  ion_by: Field to
-000149f0: 2067 726f 7570 2072 6573 756c 7473 2062   group results b
-00014a00: 792e 204f 6e6c 7920 616c 6c6f 7765 6420  y. Only allowed 
-00014a10: 7661 6c75 6520 6973 2060 6e61 6d65 602e  value is `name`.
-00014a20: 2057 6865 6e20 6070 6172 7469 7469 6f6e   When `partition
-00014a30: 5f62 7960 2069 7320 7370 6563 6966 6965  _by` is specifie
-00014a40: 642c 0a20 2020 2020 2020 2020 2020 2074  d,.            t
-00014a50: 6865 2060 7061 7274 6974 696f 6e5f 736f  he `partition_so
-00014a60: 7274 5f62 7960 2070 6172 616d 6574 6572  rt_by` parameter
-00014a70: 206d 7573 7420 6265 2070 726f 7669 6465   must be provide
-00014a80: 6420 6173 2077 656c 6c2e 0a20 2020 2020  d as well..     
-00014a90: 2020 203a 7061 7261 6d20 726f 7773 5f70     :param rows_p
-00014aa0: 6572 5f70 6172 7469 7469 6f6e 3a20 486f  er_partition: Ho
-00014ab0: 7720 6d61 6e79 2074 6f70 2072 6f77 7320  w many top rows 
-00014ac0: 2870 6572 2073 6f72 7469 6e67 2064 6566  (per sorting def
-00014ad0: 696e 6564 2062 7920 6070 6172 7469 7469  ined by `partiti
-00014ae0: 6f6e 5f73 6f72 745f 6279 6020 616e 6420  on_sort_by` and 
-00014af0: 6070 6172 7469 7469 6f6e 5f6f 7264 6572  `partition_order
-00014b00: 6029 0a20 2020 2020 2020 2020 2020 2074  `).            t
-00014b10: 6f20 7265 7475 726e 2070 6572 2067 726f  o return per gro
-00014b20: 7570 2e20 4465 6661 756c 7420 7661 6c75  up. Default valu
-00014b30: 6520 6973 2031 2e0a 2020 2020 2020 2020  e is 1..        
-00014b40: 3a70 6172 616d 2070 6172 7469 7469 6f6e  :param partition
-00014b50: 5f73 6f72 745f 6279 3a20 5768 6174 2066  _sort_by: What f
-00014b60: 6965 6c64 2074 6f20 736f 7274 2074 6865  ield to sort the
-00014b70: 2072 6573 756c 7473 2062 792c 2077 6974   results by, wit
-00014b80: 6869 6e20 6561 6368 2070 6172 7469 7469  hin each partiti
-00014b90: 6f6e 2064 6566 696e 6564 2062 7920 6070  on defined by `p
-00014ba0: 6172 7469 7469 6f6e 5f62 7960 2e0a 2020  artition_by`..  
-00014bb0: 2020 2020 2020 2020 2020 4375 7272 656e            Curren
-00014bc0: 746c 7920 7468 6520 6f6e 6c79 2061 6c6c  tly the only all
-00014bd0: 6f77 6564 2076 616c 7565 7320 6172 6520  owed values are 
-00014be0: 6063 7265 6174 6564 6020 616e 6420 6075  `created` and `u
-00014bf0: 7064 6174 6564 602e 0a20 2020 2020 2020  pdated`..       
-00014c00: 203a 7061 7261 6d20 7061 7274 6974 696f   :param partitio
-00014c10: 6e5f 6f72 6465 723a 204f 7264 6572 206f  n_order: Order o
-00014c20: 6620 736f 7274 696e 6720 7769 7468 696e  f sorting within
-00014c30: 2070 6172 7469 7469 6f6e 7320 2d20 6061   partitions - `a
-00014c40: 7363 6020 6f72 2060 6465 7363 602e 2044  sc` or `desc`. D
-00014c50: 6566 6175 6c74 2069 7320 6064 6573 6360  efault is `desc`
-00014c60: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-00014c70: 6e73 3a20 4c69 7374 206f 6620 6d61 7463  ns: List of matc
-00014c80: 6869 6e67 203a 7079 3a63 6c61 7373 3a60  hing :py:class:`
-00014c90: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
-00014ca0: 746f 7265 2e46 6561 7475 7265 5665 6374  tore.FeatureVect
-00014cb0: 6f72 6020 6f62 6a65 6374 732e 0a20 2020  or` objects..   
-00014cc0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00014cd0: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
-00014ce0: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
-00014cf0: 6661 756c 745f 7072 6f6a 6563 740a 0a20  fault_project.. 
-00014d00: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
-00014d10: 7b0a 2020 2020 2020 2020 2020 2020 226e  {.            "n
-00014d20: 616d 6522 3a20 6e61 6d65 2c0a 2020 2020  ame": name,.    
-00014d30: 2020 2020 2020 2020 2273 7461 7465 223a          "state":
-00014d40: 2073 7461 7465 2c0a 2020 2020 2020 2020   state,.        
-00014d50: 2020 2020 2274 6167 223a 2074 6167 2c0a      "tag": tag,.
-00014d60: 2020 2020 2020 2020 2020 2020 226c 6162              "lab
-00014d70: 656c 223a 206c 6162 656c 7320 6f72 205b  el": labels or [
-00014d80: 5d2c 0a20 2020 2020 2020 207d 0a20 2020  ],.        }.   
-00014d90: 2020 2020 2069 6620 7061 7274 6974 696f       if partitio
-00014da0: 6e5f 6279 3a0a 2020 2020 2020 2020 2020  n_by:.          
-00014db0: 2020 7061 7261 6d73 2e75 7064 6174 6528    params.update(
-00014dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014dd0: 2073 656c 662e 5f67 656e 6572 6174 655f   self._generate_
-00014de0: 7061 7274 6974 696f 6e5f 6279 5f70 6172  partition_by_par
-00014df0: 616d 7328 0a20 2020 2020 2020 2020 2020  ams(.           
-00014e00: 2020 2020 2020 2020 206d 6c72 756e 2e63           mlrun.c
-00014e10: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4665  ommon.schemas.Fe
-00014e20: 6174 7572 6553 746f 7265 5061 7274 6974  atureStorePartit
-00014e30: 696f 6e42 7946 6965 6c64 2c0a 2020 2020  ionByField,.    
-00014e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e50: 7061 7274 6974 696f 6e5f 6279 2c0a 2020  partition_by,.  
-00014e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e70: 2020 726f 7773 5f70 6572 5f70 6172 7469    rows_per_parti
-00014e80: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-00014e90: 2020 2020 2020 2020 2020 7061 7274 6974            partit
-00014ea0: 696f 6e5f 736f 7274 5f62 792c 0a20 2020  ion_sort_by,.   
-00014eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ec0: 2070 6172 7469 7469 6f6e 5f6f 7264 6572   partition_order
-00014ed0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00014ee0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00014ef0: 290a 0a20 2020 2020 2020 2070 6174 6820  )..        path 
-00014f00: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
-00014f10: 6f6a 6563 747d 2f66 6561 7475 7265 2d76  oject}/feature-v
-00014f20: 6563 746f 7273 220a 0a20 2020 2020 2020  ectors"..       
-00014f30: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-00014f40: 2028 0a20 2020 2020 2020 2020 2020 2066   (.            f
-00014f50: 2246 6169 6c65 6420 6c69 7374 696e 6720  "Failed listing 
-00014f60: 6665 6174 7572 652d 7665 6374 6f72 732c  feature-vectors,
-00014f70: 2070 726f 6a65 6374 3a20 7b70 726f 6a65   project: {proje
-00014f80: 6374 7d2c 2071 7565 7279 3a20 7b70 6172  ct}, query: {par
-00014f90: 616d 737d 220a 2020 2020 2020 2020 290a  ams}".        ).
-00014fa0: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
-00014fb0: 656c 662e 6170 695f 6361 6c6c 2822 4745  elf.api_call("GE
-00014fc0: 5422 2c20 7061 7468 2c20 6572 726f 725f  T", path, error_
-00014fd0: 6d65 7373 6167 652c 2070 6172 616d 733d  message, params=
-00014fe0: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
-00014ff0: 6665 6174 7572 655f 7665 6374 6f72 7320  feature_vectors 
-00015000: 3d20 7265 7370 2e6a 736f 6e28 295b 2266  = resp.json()["f
-00015010: 6561 7475 7265 5f76 6563 746f 7273 225d  eature_vectors"]
-00015020: 0a20 2020 2020 2020 2069 6620 6665 6174  .        if feat
-00015030: 7572 655f 7665 6374 6f72 733a 0a20 2020  ure_vectors:.   
-00015040: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00015050: 5b46 6561 7475 7265 5665 6374 6f72 2e66  [FeatureVector.f
-00015060: 726f 6d5f 6469 6374 286f 626a 2920 666f  rom_dict(obj) fo
-00015070: 7220 6f62 6a20 696e 2066 6561 7475 7265  r obj in feature
-00015080: 5f76 6563 746f 7273 5d0a 0a20 2020 2064  _vectors]..    d
-00015090: 6566 2073 746f 7265 5f66 6561 7475 7265  ef store_feature
-000150a0: 5f76 6563 746f 7228 0a20 2020 2020 2020  _vector(.       
-000150b0: 2073 656c 662c 0a20 2020 2020 2020 2066   self,.        f
-000150c0: 6561 7475 7265 5f76 6563 746f 723a 2055  eature_vector: U
-000150d0: 6e69 6f6e 5b64 6963 742c 206d 6c72 756e  nion[dict, mlrun
-000150e0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-000150f0: 4665 6174 7572 6556 6563 746f 722c 2046  FeatureVector, F
-00015100: 6561 7475 7265 5665 6374 6f72 5d2c 0a20  eatureVector],. 
-00015110: 2020 2020 2020 206e 616d 653d 4e6f 6e65         name=None
-00015120: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
-00015130: 743d 2222 2c0a 2020 2020 2020 2020 7461  t="",.        ta
-00015140: 673d 4e6f 6e65 2c0a 2020 2020 2020 2020  g=None,.        
-00015150: 7569 643d 4e6f 6e65 2c0a 2020 2020 2020  uid=None,.      
-00015160: 2020 7665 7273 696f 6e65 643d 5472 7565    versioned=True
-00015170: 2c0a 2020 2020 2920 2d3e 2064 6963 743a  ,.    ) -> dict:
-00015180: 0a20 2020 2020 2020 2022 2222 5374 6f72  .        """Stor
-00015190: 6520 6120 3a70 793a 636c 6173 733a 607e  e a :py:class:`~
-000151a0: 6d6c 7275 6e2e 6665 6174 7572 655f 7374  mlrun.feature_st
-000151b0: 6f72 652e 4665 6174 7572 6556 6563 746f  ore.FeatureVecto
-000151c0: 7260 206f 626a 6563 7420 696e 2074 6865  r` object in the
-000151d0: 203a 7079 3a6d 6f64 3a60 6d6c 7275 6e60   :py:mod:`mlrun`
-000151e0: 2044 422e 2054 6865 0a20 2020 2020 2020   DB. The.       
-000151f0: 2066 6561 7475 7265 2d76 6563 746f 7220   feature-vector 
-00015200: 6361 6e20 6265 2065 6974 6865 7220 6120  can be either a 
-00015210: 6e65 7720 6f62 6a65 6374 206f 7220 6120  new object or a 
-00015220: 6d6f 6469 6669 6361 7469 6f6e 2074 6f20  modification to 
-00015230: 6578 6973 7469 6e67 206f 626a 6563 7420  existing object 
-00015240: 7265 6665 7265 6e63 6564 2062 7920 7468  referenced by th
-00015250: 6520 7061 7261 6d73 0a20 2020 2020 2020  e params.       
-00015260: 206f 6620 7468 6520 6675 6e63 7469 6f6e   of the function
-00015270: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00015280: 6d20 6665 6174 7572 655f 7665 6374 6f72  m feature_vector
-00015290: 3a20 5468 6520 3a70 793a 636c 6173 733a  : The :py:class:
-000152a0: 607e 6d6c 7275 6e2e 6665 6174 7572 655f  `~mlrun.feature_
-000152b0: 7374 6f72 652e 4665 6174 7572 6556 6563  store.FeatureVec
-000152c0: 746f 7260 2074 6f20 7374 6f72 652e 0a20  tor` to store.. 
-000152d0: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
-000152e0: 6d65 3a20 2020 204e 616d 6520 6f66 2066  me:    Name of f
-000152f0: 6561 7475 7265 2076 6563 746f 722e 0a20  eature vector.. 
-00015300: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00015310: 6f6a 6563 743a 204e 616d 6520 6f66 2070  oject: Name of p
-00015320: 726f 6a65 6374 2074 6869 7320 6665 6174  roject this feat
-00015330: 7572 652d 7665 6374 6f72 2062 656c 6f6e  ure-vector belon
-00015340: 6773 2074 6f2e 0a20 2020 2020 2020 203a  gs to..        :
-00015350: 7061 7261 6d20 7461 673a 2054 6865 2060  param tag: The `
-00015360: 6074 6167 6060 206f 6620 7468 6520 6f62  `tag`` of the ob
-00015370: 6a65 6374 2074 6f20 7265 706c 6163 6520  ject to replace 
-00015380: 696e 2074 6865 2044 422c 2066 6f72 2065  in the DB, for e
-00015390: 7861 6d70 6c65 2060 606c 6174 6573 7460  xample ``latest`
-000153a0: 602e 0a20 2020 2020 2020 203a 7061 7261  `..        :para
-000153b0: 6d20 7569 643a 2054 6865 2060 6075 6964  m uid: The ``uid
-000153c0: 6060 206f 6620 7468 6520 6f62 6a65 6374  `` of the object
-000153d0: 2074 6f20 7265 706c 6163 6520 696e 2074   to replace in t
-000153e0: 6865 2044 422e 2049 6620 7573 696e 6720  he DB. If using 
-000153f0: 7468 6973 2070 6172 616d 6574 6572 2c20  this parameter, 
-00015400: 7468 6520 6d6f 6469 6669 6564 206f 626a  the modified obj
-00015410: 6563 740a 2020 2020 2020 2020 2020 2020  ect.            
-00015420: 6d75 7374 2068 6176 6520 7468 6520 7361  must have the sa
-00015430: 6d65 2060 6075 6964 6060 206f 6620 7468  me ``uid`` of th
-00015440: 6520 7072 6576 696f 7573 6c79 2d65 7869  e previously-exi
-00015450: 7374 696e 6720 6f62 6a65 6374 2e20 5468  sting object. Th
-00015460: 6973 2063 616e 6e6f 7420 6265 2075 7365  is cannot be use
-00015470: 6420 666f 7220 6e6f 6e2d 7665 7273 696f  d for non-versio
-00015480: 6e65 6420 6f62 6a65 6374 732e 0a20 2020  ned objects..   
-00015490: 2020 2020 203a 7061 7261 6d20 7665 7273       :param vers
-000154a0: 696f 6e65 643a 2057 6865 7468 6572 2074  ioned: Whether t
-000154b0: 6f20 6d61 696e 7461 696e 2076 6572 7369  o maintain versi
-000154c0: 6f6e 7320 666f 7220 7468 6973 2066 6561  ons for this fea
-000154d0: 7475 7265 2d76 6563 746f 722e 2041 6c6c  ture-vector. All
-000154e0: 2076 6572 7369 6f6e 7320 6f66 2061 2076   versions of a v
-000154f0: 6572 7369 6f6e 6564 206f 626a 6563 740a  ersioned object.
-00015500: 2020 2020 2020 2020 2020 2020 7769 6c6c              will
-00015510: 2062 6520 6b65 7074 2069 6e20 7468 6520   be kept in the 
-00015520: 4442 2061 6e64 2063 616e 2062 6520 7265  DB and can be re
-00015530: 7472 6965 7665 6420 756e 7469 6c20 6578  trieved until ex
-00015540: 706c 6963 6974 6c79 2064 656c 6574 6564  plicitly deleted
-00015550: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-00015560: 6e73 3a20 5468 6520 3a70 793a 636c 6173  ns: The :py:clas
-00015570: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
-00015580: 655f 7374 6f72 652e 4665 6174 7572 6556  e_store.FeatureV
-00015590: 6563 746f 7260 206f 626a 6563 7420 2861  ector` object (a
-000155a0: 7320 6469 6374 292e 0a20 2020 2020 2020  s dict)..       
-000155b0: 2022 2222 0a0a 2020 2020 2020 2020 7265   """..        re
-000155c0: 6665 7265 6e63 6520 3d20 7365 6c66 2e5f  ference = self._
-000155d0: 7265 736f 6c76 655f 7265 6665 7265 6e63  resolve_referenc
-000155e0: 6528 7461 672c 2075 6964 290a 2020 2020  e(tag, uid).    
-000155f0: 2020 2020 7061 7261 6d73 203d 207b 2276      params = {"v
-00015600: 6572 7369 6f6e 6564 223a 2076 6572 7369  ersioned": versi
-00015610: 6f6e 6564 7d0a 0a20 2020 2020 2020 2069  oned}..        i
-00015620: 6620 6973 696e 7374 616e 6365 2866 6561  f isinstance(fea
-00015630: 7475 7265 5f76 6563 746f 722c 206d 6c72  ture_vector, mlr
-00015640: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00015650: 732e 4665 6174 7572 6556 6563 746f 7229  s.FeatureVector)
-00015660: 3a0a 2020 2020 2020 2020 2020 2020 6665  :.            fe
-00015670: 6174 7572 655f 7665 6374 6f72 203d 2066  ature_vector = f
-00015680: 6561 7475 7265 5f76 6563 746f 722e 6469  eature_vector.di
-00015690: 6374 2829 0a20 2020 2020 2020 2065 6c69  ct().        eli
-000156a0: 6620 6973 696e 7374 616e 6365 2866 6561  f isinstance(fea
-000156b0: 7475 7265 5f76 6563 746f 722c 2046 6561  ture_vector, Fea
-000156c0: 7475 7265 5665 6374 6f72 293a 0a20 2020  tureVector):.   
-000156d0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-000156e0: 5f76 6563 746f 7220 3d20 6665 6174 7572  _vector = featur
-000156f0: 655f 7665 6374 6f72 2e74 6f5f 6469 6374  e_vector.to_dict
-00015700: 2829 0a0a 2020 2020 2020 2020 6e61 6d65  ()..        name
-00015710: 203d 206e 616d 6520 6f72 2066 6561 7475   = name or featu
-00015720: 7265 5f76 6563 746f 725b 226d 6574 6164  re_vector["metad
-00015730: 6174 6122 5d5b 226e 616d 6522 5d0a 2020  ata"]["name"].  
-00015740: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
-00015750: 280a 2020 2020 2020 2020 2020 2020 7072  (.            pr
-00015760: 6f6a 6563 740a 2020 2020 2020 2020 2020  oject.          
-00015770: 2020 6f72 2066 6561 7475 7265 5f76 6563    or feature_vec
-00015780: 746f 725b 226d 6574 6164 6174 6122 5d2e  tor["metadata"].
-00015790: 6765 7428 2270 726f 6a65 6374 2229 0a20  get("project"). 
-000157a0: 2020 2020 2020 2020 2020 206f 7220 636f             or co
-000157b0: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
-000157c0: 6a65 6374 0a20 2020 2020 2020 2029 0a20  ject.        ). 
-000157d0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-000157e0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-000157f0: 747d 2f66 6561 7475 7265 2d76 6563 746f  t}/feature-vecto
-00015800: 7273 2f7b 6e61 6d65 7d2f 7265 6665 7265  rs/{name}/refere
-00015810: 6e63 6573 2f7b 7265 6665 7265 6e63 657d  nces/{reference}
-00015820: 220a 2020 2020 2020 2020 6572 726f 725f  ".        error_
-00015830: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
-00015840: 6564 2073 746f 7269 6e67 2066 6561 7475  ed storing featu
-00015850: 7265 2d76 6563 746f 7220 7b70 726f 6a65  re-vector {proje
-00015860: 6374 7d2f 7b6e 616d 657d 220a 2020 2020  ct}/{name}".    
-00015870: 2020 2020 7265 7370 203d 2073 656c 662e      resp = self.
-00015880: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
-00015890: 2020 2020 2020 2250 5554 222c 2070 6174        "PUT", pat
-000158a0: 682c 2065 7272 6f72 5f6d 6573 7361 6765  h, error_message
-000158b0: 2c20 7061 7261 6d73 3d70 6172 616d 732c  , params=params,
-000158c0: 2062 6f64 793d 6469 6374 5f74 6f5f 6a73   body=dict_to_js
-000158d0: 6f6e 2866 6561 7475 7265 5f76 6563 746f  on(feature_vecto
-000158e0: 7229 0a20 2020 2020 2020 2029 0a20 2020  r).        ).   
-000158f0: 2020 2020 2072 6574 7572 6e20 7265 7370       return resp
-00015900: 2e6a 736f 6e28 290a 0a20 2020 2064 6566  .json()..    def
-00015910: 2070 6174 6368 5f66 6561 7475 7265 5f76   patch_feature_v
-00015920: 6563 746f 7228 0a20 2020 2020 2020 2073  ector(.        s
-00015930: 656c 662c 0a20 2020 2020 2020 206e 616d  elf,.        nam
-00015940: 652c 0a20 2020 2020 2020 2066 6561 7475  e,.        featu
-00015950: 7265 5f76 6563 746f 725f 7570 6461 7465  re_vector_update
-00015960: 3a20 6469 6374 2c0a 2020 2020 2020 2020  : dict,.        
-00015970: 7072 6f6a 6563 743d 2222 2c0a 2020 2020  project="",.    
-00015980: 2020 2020 7461 673d 4e6f 6e65 2c0a 2020      tag=None,.  
-00015990: 2020 2020 2020 7569 643d 4e6f 6e65 2c0a        uid=None,.
-000159a0: 2020 2020 2020 2020 7061 7463 685f 6d6f          patch_mo
-000159b0: 6465 3a20 556e 696f 6e5b 0a20 2020 2020  de: Union[.     
-000159c0: 2020 2020 2020 2073 7472 2c20 6d6c 7275         str, mlru
-000159d0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-000159e0: 2e50 6174 6368 4d6f 6465 0a20 2020 2020  .PatchMode.     
-000159f0: 2020 205d 203d 206d 6c72 756e 2e63 6f6d     ] = mlrun.com
-00015a00: 6d6f 6e2e 7363 6865 6d61 732e 5061 7463  mon.schemas.Patc
-00015a10: 684d 6f64 652e 7265 706c 6163 652c 0a20  hMode.replace,. 
-00015a20: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-00015a30: 224d 6f64 6966 7920 2870 6174 6368 2920  "Modify (patch) 
-00015a40: 616e 2065 7869 7374 696e 6720 3a70 793a  an existing :py:
-00015a50: 636c 6173 733a 607e 6d6c 7275 6e2e 6665  class:`~mlrun.fe
-00015a60: 6174 7572 655f 7374 6f72 652e 4665 6174  ature_store.Feat
-00015a70: 7572 6556 6563 746f 7260 206f 626a 6563  ureVector` objec
-00015a80: 742e 0a20 2020 2020 2020 2054 6865 206f  t..        The o
-00015a90: 626a 6563 7420 6973 2069 6465 6e74 6966  bject is identif
-00015aa0: 6965 6420 6279 2069 7473 206e 616d 6520  ied by its name 
-00015ab0: 2861 6e64 2070 726f 6a65 6374 2069 7420  (and project it 
-00015ac0: 6265 6c6f 6e67 7320 746f 292c 2061 7320  belongs to), as 
-00015ad0: 7765 6c6c 2061 7320 6f70 7469 6f6e 616c  well as optional
-00015ae0: 6c79 2061 2060 6074 6167 6060 206f 7220  ly a ``tag`` or 
-00015af0: 6974 730a 2020 2020 2020 2020 6060 7569  its.        ``ui
-00015b00: 6460 6020 2866 6f72 2076 6572 7369 6f6e  d`` (for version
-00015b10: 6564 206f 626a 6563 7429 2e20 4966 2062  ed object). If b
-00015b20: 6f74 6820 6060 7461 6760 6020 616e 6420  oth ``tag`` and 
-00015b30: 6060 7569 6460 6020 6172 6520 6f6d 6974  ``uid`` are omit
-00015b40: 7465 6420 7468 656e 2074 6865 206f 626a  ted then the obj
-00015b50: 6563 7420 7769 7468 2074 6167 2060 606c  ect with tag ``l
-00015b60: 6174 6573 7460 600a 2020 2020 2020 2020  atest``.        
-00015b70: 6973 206d 6f64 6966 6965 642e 0a0a 2020  is modified...  
-00015b80: 2020 2020 2020 3a70 6172 616d 206e 616d        :param nam
-00015b90: 653a 204e 616d 6520 6f66 2074 6865 206f  e: Name of the o
-00015ba0: 626a 6563 7420 746f 2070 6174 6368 2e0a  bject to patch..
-00015bb0: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
-00015bc0: 6561 7475 7265 5f76 6563 746f 725f 7570  eature_vector_up
-00015bd0: 6461 7465 3a20 5468 6520 6d6f 6469 6669  date: The modifi
-00015be0: 6361 7469 6f6e 7320 6e65 6564 6564 2069  cations needed i
-00015bf0: 6e20 7468 6520 6f62 6a65 6374 2e20 5468  n the object. Th
-00015c00: 6973 2070 6172 616d 6574 6572 206f 6e6c  is parameter onl
-00015c10: 7920 6861 7320 7468 6520 6368 616e 6765  y has the change
-00015c20: 7320 696e 2069 742c 0a20 2020 2020 2020  s in it,.       
-00015c30: 2020 2020 206e 6f74 2061 2066 756c 6c20       not a full 
-00015c40: 6f62 6a65 6374 2e0a 2020 2020 2020 2020  object..        
-00015c50: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
-00015c60: 5072 6f6a 6563 7420 7768 6963 6820 636f  Project which co
-00015c70: 6e74 6169 6e73 2074 6865 206d 6f64 6966  ntains the modif
-00015c80: 6965 6420 6f62 6a65 6374 2e0a 2020 2020  ied object..    
-00015c90: 2020 2020 3a70 6172 616d 2074 6167 3a20      :param tag: 
-00015ca0: 5468 6520 7461 6720 6f66 2074 6865 206f  The tag of the o
-00015cb0: 626a 6563 7420 746f 206d 6f64 6966 792e  bject to modify.
-00015cc0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00015cd0: 7569 643a 2075 6964 206f 6620 7468 6520  uid: uid of the 
-00015ce0: 6f62 6a65 6374 2074 6f20 6d6f 6469 6679  object to modify
-00015cf0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00015d00: 2070 6174 6368 5f6d 6f64 653a 2054 6865   patch_mode: The
-00015d10: 2073 7472 6174 6567 7920 666f 7220 6d65   strategy for me
-00015d20: 7267 696e 6720 7468 6520 6368 616e 6765  rging the change
-00015d30: 7320 7769 7468 2074 6865 2065 7869 7374  s with the exist
-00015d40: 696e 6720 6f62 6a65 6374 2e20 4361 6e20  ing object. Can 
-00015d50: 6265 2065 6974 6865 7220 6060 7265 706c  be either ``repl
-00015d60: 6163 6560 600a 2020 2020 2020 2020 2020  ace``.          
-00015d70: 2020 6f72 2060 6061 6464 6974 6976 6560    or ``additive`
-00015d80: 602e 0a20 2020 2020 2020 2022 2222 0a20  `..        """. 
-00015d90: 2020 2020 2020 2072 6566 6572 656e 6365         reference
-00015da0: 203d 2073 656c 662e 5f72 6573 6f6c 7665   = self._resolve
-00015db0: 5f72 6566 6572 656e 6365 2874 6167 2c20  _reference(tag, 
-00015dc0: 7569 6429 0a20 2020 2020 2020 2070 726f  uid).        pro
-00015dd0: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
-00015de0: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
-00015df0: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
-00015e00: 2068 6561 6465 7273 203d 207b 6d6c 7275   headers = {mlru
-00015e10: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00015e20: 2e48 6561 6465 724e 616d 6573 2e70 6174  .HeaderNames.pat
-00015e30: 6368 5f6d 6f64 653a 2070 6174 6368 5f6d  ch_mode: patch_m
-00015e40: 6f64 657d 0a20 2020 2020 2020 2070 6174  ode}.        pat
-00015e50: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
-00015e60: 7072 6f6a 6563 747d 2f66 6561 7475 7265  project}/feature
-00015e70: 2d76 6563 746f 7273 2f7b 6e61 6d65 7d2f  -vectors/{name}/
-00015e80: 7265 6665 7265 6e63 6573 2f7b 7265 6665  references/{refe
-00015e90: 7265 6e63 657d 220a 2020 2020 2020 2020  rence}".        
-00015ea0: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-00015eb0: 6622 4661 696c 6564 2075 7064 6174 696e  f"Failed updatin
-00015ec0: 6720 6665 6174 7572 652d 7665 6374 6f72  g feature-vector
-00015ed0: 207b 7072 6f6a 6563 747d 2f7b 6e61 6d65   {project}/{name
-00015ee0: 7d22 0a20 2020 2020 2020 2073 656c 662e  }".        self.
-00015ef0: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
-00015f00: 2020 2020 2020 2250 4154 4348 222c 0a20        "PATCH",. 
-00015f10: 2020 2020 2020 2020 2020 2070 6174 682c             path,
-00015f20: 0a20 2020 2020 2020 2020 2020 2065 7272  .            err
-00015f30: 6f72 5f6d 6573 7361 6765 2c0a 2020 2020  or_message,.    
-00015f40: 2020 2020 2020 2020 626f 6479 3d64 6963          body=dic
-00015f50: 745f 746f 5f6a 736f 6e28 6665 6174 7572  t_to_json(featur
-00015f60: 655f 7665 6374 6f72 5f75 7064 6174 6529  e_vector_update)
-00015f70: 2c0a 2020 2020 2020 2020 2020 2020 6865  ,.            he
-00015f80: 6164 6572 733d 6865 6164 6572 732c 0a20  aders=headers,. 
-00015f90: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00015fa0: 6620 6465 6c65 7465 5f66 6561 7475 7265  f delete_feature
-00015fb0: 5f76 6563 746f 7228 7365 6c66 2c20 6e61  _vector(self, na
-00015fc0: 6d65 2c20 7072 6f6a 6563 743d 2222 2c20  me, project="", 
-00015fd0: 7461 673d 4e6f 6e65 2c20 7569 643d 4e6f  tag=None, uid=No
-00015fe0: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
-00015ff0: 4465 6c65 7465 2061 203a 7079 3a63 6c61  Delete a :py:cla
-00016000: 7373 3a60 7e6d 6c72 756e 2e66 6561 7475  ss:`~mlrun.featu
-00016010: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
-00016020: 5665 6374 6f72 6020 6f62 6a65 6374 2066  Vector` object f
-00016030: 726f 6d20 7468 6520 4442 2e0a 2020 2020  rom the DB..    
-00016040: 2020 2020 4966 2060 6074 6167 6060 206f      If ``tag`` o
-00016050: 7220 6060 7569 6460 6020 6172 6520 7370  r ``uid`` are sp
-00016060: 6563 6966 6965 642c 2074 6865 6e20 6a75  ecified, then ju
-00016070: 7374 2074 6865 2076 6572 7369 6f6e 2072  st the version r
-00016080: 6566 6572 656e 6365 6420 6279 2074 6865  eferenced by the
-00016090: 6d20 7769 6c6c 2062 6520 6465 6c65 7465  m will be delete
-000160a0: 642e 2055 7369 6e67 2062 6f74 680a 2020  d. Using both.  
-000160b0: 2020 2020 2020 6973 206e 6f74 2061 6c6c        is not all
-000160c0: 6f77 6564 2e0a 2020 2020 2020 2020 4966  owed..        If
-000160d0: 206e 6f6e 6520 6172 6520 7370 6563 6966   none are specif
-000160e0: 6965 642c 2074 6865 6e20 616c 6c20 696e  ied, then all in
-000160f0: 7374 616e 6365 7320 6f66 2074 6865 206f  stances of the o
-00016100: 626a 6563 7420 7768 6f73 6520 6e61 6d65  bject whose name
-00016110: 2069 7320 6060 6e61 6d65 6060 2077 696c   is ``name`` wil
-00016120: 6c20 6265 2064 656c 6574 6564 2e0a 2020  l be deleted..  
-00016130: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00016140: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
-00016150: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
-00016160: 6661 756c 745f 7072 6f6a 6563 740a 2020  fault_project.  
-00016170: 2020 2020 2020 7061 7468 203d 2066 2270        path = f"p
-00016180: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
-00016190: 7d2f 6665 6174 7572 652d 7665 6374 6f72  }/feature-vector
-000161a0: 732f 7b6e 616d 657d 220a 2020 2020 2020  s/{name}".      
-000161b0: 2020 6966 2074 6167 206f 7220 7569 643a    if tag or uid:
-000161c0: 0a20 2020 2020 2020 2020 2020 2072 6566  .            ref
-000161d0: 6572 656e 6365 203d 2073 656c 662e 5f72  erence = self._r
-000161e0: 6573 6f6c 7665 5f72 6566 6572 656e 6365  esolve_reference
-000161f0: 2874 6167 2c20 7569 6429 0a20 2020 2020  (tag, uid).     
-00016200: 2020 2020 2020 2070 6174 6820 3d20 7061         path = pa
-00016210: 7468 202b 2066 222f 7265 6665 7265 6e63  th + f"/referenc
-00016220: 6573 2f7b 7265 6665 7265 6e63 657d 220a  es/{reference}".
-00016230: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-00016240: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
-00016250: 6420 6465 6c65 7469 6e67 2066 6561 7475  d deleting featu
-00016260: 7265 2d76 6563 746f 7220 7b6e 616d 657d  re-vector {name}
-00016270: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
-00016280: 7069 5f63 616c 6c28 2244 454c 4554 4522  pi_call("DELETE"
-00016290: 2c20 7061 7468 2c20 6572 726f 725f 6d65  , path, error_me
-000162a0: 7373 6167 6529 0a0a 2020 2020 6465 6620  ssage)..    def 
-000162b0: 7461 675f 6f62 6a65 6374 7328 0a20 2020  tag_objects(.   
-000162c0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-000162d0: 2020 2070 726f 6a65 6374 3a20 7374 722c     project: str,
-000162e0: 0a20 2020 2020 2020 2074 6167 5f6e 616d  .        tag_nam
-000162f0: 653a 2073 7472 2c0a 2020 2020 2020 2020  e: str,.        
-00016300: 6f62 6a65 6374 733a 2055 6e69 6f6e 5b6d  objects: Union[m
-00016310: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00016320: 6d61 732e 5461 674f 626a 6563 7473 2c20  mas.TagObjects, 
-00016330: 6469 6374 5d2c 0a20 2020 2020 2020 2072  dict],.        r
-00016340: 6570 6c61 6365 3a20 626f 6f6c 203d 2046  eplace: bool = F
-00016350: 616c 7365 2c0a 2020 2020 293a 0a20 2020  alse,.    ):.   
-00016360: 2020 2020 2022 2222 5461 6720 6120 6c69       """Tag a li
-00016370: 7374 206f 6620 6f62 6a65 6374 732e 0a0a  st of objects...
-00016380: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-00016390: 726f 6a65 6374 3a20 5072 6f6a 6563 7420  roject: Project 
-000163a0: 7768 6963 6820 636f 6e74 6169 6e73 2074  which contains t
-000163b0: 6865 206f 626a 6563 7473 2e0a 2020 2020  he objects..    
-000163c0: 2020 2020 3a70 6172 616d 2074 6167 5f6e      :param tag_n
-000163d0: 616d 653a 2054 6865 2074 6167 2074 6f20  ame: The tag to 
-000163e0: 7365 7420 6f6e 2074 6865 206f 626a 6563  set on the objec
-000163f0: 7473 2e0a 2020 2020 2020 2020 3a70 6172  ts..        :par
-00016400: 616d 206f 626a 6563 7473 3a20 5468 6520  am objects: The 
-00016410: 6f62 6a65 6374 7320 746f 2074 6167 2e0a  objects to tag..
-00016420: 2020 2020 2020 2020 3a70 6172 616d 2072          :param r
-00016430: 6570 6c61 6365 3a20 5768 6574 6865 7220  eplace: Whether 
-00016440: 746f 2072 6570 6c61 6365 2074 6865 2065  to replace the e
-00016450: 7869 7374 696e 6720 7461 6773 206f 6620  xisting tags of 
-00016460: 7468 6520 6f62 6a65 6374 7320 6f72 2074  the objects or t
-00016470: 6f20 6164 6420 7468 6520 6e65 7720 7461  o add the new ta
-00016480: 6720 746f 2074 6865 6d2e 0a20 2020 2020  g to them..     
-00016490: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-000164a0: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
-000164b0: 732f 7b70 726f 6a65 6374 7d2f 7461 6773  s/{project}/tags
-000164c0: 2f7b 7461 675f 6e61 6d65 7d22 0a20 2020  /{tag_name}".   
-000164d0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-000164e0: 6765 203d 2066 2246 6169 6c65 6420 746f  ge = f"Failed to
-000164f0: 2074 6167 207b 7461 675f 6e61 6d65 7d20   tag {tag_name} 
-00016500: 6f6e 206f 626a 6563 7473 207b 6f62 6a65  on objects {obje
-00016510: 6374 737d 220a 2020 2020 2020 2020 6d65  cts}".        me
-00016520: 7468 6f64 203d 2022 504f 5354 2220 6966  thod = "POST" if
-00016530: 2072 6570 6c61 6365 2065 6c73 6520 2250   replace else "P
-00016540: 5554 220a 2020 2020 2020 2020 7365 6c66  UT".        self
-00016550: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
-00016560: 2020 2020 2020 206d 6574 686f 642c 0a20         method,. 
-00016570: 2020 2020 2020 2020 2020 2070 6174 682c             path,
-00016580: 0a20 2020 2020 2020 2020 2020 2065 7272  .            err
-00016590: 6f72 5f6d 6573 7361 6765 2c0a 2020 2020  or_message,.    
-000165a0: 2020 2020 2020 2020 626f 6479 3d64 6963          body=dic
-000165b0: 745f 746f 5f6a 736f 6e28 0a20 2020 2020  t_to_json(.     
-000165c0: 2020 2020 2020 2020 2020 206f 626a 6563             objec
-000165d0: 7473 2e64 6963 7428 290a 2020 2020 2020  ts.dict().      
-000165e0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-000165f0: 6e73 7461 6e63 6528 6f62 6a65 6374 732c  nstance(objects,
-00016600: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-00016610: 6865 6d61 732e 5461 674f 626a 6563 7473  hemas.TagObjects
-00016620: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00016630: 2020 656c 7365 206f 626a 6563 7473 0a20    else objects. 
-00016640: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
-00016650: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00016660: 2064 656c 6574 655f 6f62 6a65 6374 735f   delete_objects_
-00016670: 7461 6728 0a20 2020 2020 2020 2073 656c  tag(.        sel
-00016680: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
-00016690: 6374 3a20 7374 722c 0a20 2020 2020 2020  ct: str,.       
-000166a0: 2074 6167 5f6e 616d 653a 2073 7472 2c0a   tag_name: str,.
-000166b0: 2020 2020 2020 2020 7461 675f 6f62 6a65          tag_obje
-000166c0: 6374 733a 2055 6e69 6f6e 5b6d 6c72 756e  cts: Union[mlrun
-000166d0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-000166e0: 5461 674f 626a 6563 7473 2c20 6469 6374  TagObjects, dict
-000166f0: 5d2c 0a20 2020 2029 3a0a 2020 2020 2020  ],.    ):.      
-00016700: 2020 2222 2244 656c 6574 6520 6120 7461    """Delete a ta
-00016710: 6720 6672 6f6d 2061 206c 6973 7420 6f66  g from a list of
-00016720: 206f 626a 6563 7473 2e0a 0a20 2020 2020   objects...     
-00016730: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-00016740: 743a 2050 726f 6a65 6374 2077 6869 6368  t: Project which
-00016750: 2063 6f6e 7461 696e 7320 7468 6520 6f62   contains the ob
-00016760: 6a65 6374 732e 0a20 2020 2020 2020 203a  jects..        :
-00016770: 7061 7261 6d20 7461 675f 6e61 6d65 3a20  param tag_name: 
-00016780: 5468 6520 7461 6720 746f 2064 656c 6574  The tag to delet
-00016790: 6520 6672 6f6d 2074 6865 206f 626a 6563  e from the objec
-000167a0: 7473 2e0a 2020 2020 2020 2020 3a70 6172  ts..        :par
-000167b0: 616d 2074 6167 5f6f 626a 6563 7473 3a20  am tag_objects: 
-000167c0: 5468 6520 6f62 6a65 6374 7320 746f 2064  The objects to d
-000167d0: 656c 6574 6520 7468 6520 7461 6720 6672  elete the tag fr
-000167e0: 6f6d 2e0a 0a20 2020 2020 2020 2022 2222  om...        """
-000167f0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-00016800: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
-00016810: 6563 747d 2f74 6167 732f 7b74 6167 5f6e  ect}/tags/{tag_n
-00016820: 616d 657d 220a 2020 2020 2020 2020 6572  ame}".        er
-00016830: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-00016840: 4661 696c 6564 2064 656c 6574 696e 6720  Failed deleting 
-00016850: 7461 6720 6672 6f6d 207b 7461 675f 6e61  tag from {tag_na
-00016860: 6d65 7d22 0a20 2020 2020 2020 2073 656c  me}".        sel
-00016870: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
-00016880: 2020 2020 2020 2020 2244 454c 4554 4522          "DELETE"
-00016890: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-000168a0: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
-000168b0: 6572 726f 725f 6d65 7373 6167 652c 0a20  error_message,. 
-000168c0: 2020 2020 2020 2020 2020 2062 6f64 793d             body=
-000168d0: 6469 6374 5f74 6f5f 6a73 6f6e 280a 2020  dict_to_json(.  
-000168e0: 2020 2020 2020 2020 2020 2020 2020 7461                ta
-000168f0: 675f 6f62 6a65 6374 732e 6469 6374 2829  g_objects.dict()
-00016900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016910: 2069 6620 6973 696e 7374 616e 6365 2874   if isinstance(t
-00016920: 6167 5f6f 626a 6563 7473 2c20 6d6c 7275  ag_objects, mlru
-00016930: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00016940: 2e54 6167 4f62 6a65 6374 7329 0a20 2020  .TagObjects).   
-00016950: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00016960: 6520 7461 675f 6f62 6a65 6374 730a 2020  e tag_objects.  
-00016970: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
-00016980: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-00016990: 7461 675f 6172 7469 6661 6374 7328 0a20  tag_artifacts(. 
-000169a0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-000169b0: 2020 2020 2061 7274 6966 6163 7473 3a20       artifacts: 
-000169c0: 556e 696f 6e5b 4c69 7374 5b41 7274 6966  Union[List[Artif
-000169d0: 6163 745d 2c20 4c69 7374 5b64 6963 745d  act], List[dict]
-000169e0: 2c20 4172 7469 6661 6374 2c20 6469 6374  , Artifact, dict
-000169f0: 5d2c 0a20 2020 2020 2020 2070 726f 6a65  ],.        proje
-00016a00: 6374 3a20 7374 722c 0a20 2020 2020 2020  ct: str,.       
-00016a10: 2074 6167 5f6e 616d 653a 2073 7472 2c0a   tag_name: str,.
-00016a20: 2020 2020 2020 2020 7265 706c 6163 653a          replace:
-00016a30: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
-00016a40: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-00016a50: 2254 6167 2061 206c 6973 7420 6f66 2061  "Tag a list of a
-00016a60: 7274 6966 6163 7473 2e0a 0a20 2020 2020  rtifacts...     
-00016a70: 2020 203a 7061 7261 6d20 6172 7469 6661     :param artifa
-00016a80: 6374 733a 2054 6865 2061 7274 6966 6163  cts: The artifac
-00016a90: 7473 2074 6f20 7461 672e 2043 616e 2062  ts to tag. Can b
-00016aa0: 6520 6120 6c69 7374 206f 6620 3a70 793a  e a list of :py:
-00016ab0: 636c 6173 733a 607e 6d6c 7275 6e2e 6172  class:`~mlrun.ar
-00016ac0: 7469 6661 6374 732e 4172 7469 6661 6374  tifacts.Artifact
-00016ad0: 6020 6f62 6a65 6374 7320 6f72 0a20 2020  ` objects or.   
-00016ae0: 2020 2020 2020 2020 2064 6963 7469 6f6e           diction
-00016af0: 6172 6965 732c 206f 7220 6120 7369 6e67  aries, or a sing
-00016b00: 6c65 206f 626a 6563 742e 0a20 2020 2020  le object..     
-00016b10: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-00016b20: 743a 2050 726f 6a65 6374 2077 6869 6368  t: Project which
-00016b30: 2063 6f6e 7461 696e 7320 7468 6520 6172   contains the ar
-00016b40: 7469 6661 6374 732e 0a20 2020 2020 2020  tifacts..       
-00016b50: 203a 7061 7261 6d20 7461 675f 6e61 6d65   :param tag_name
-00016b60: 3a20 5468 6520 7461 6720 746f 2073 6574  : The tag to set
-00016b70: 206f 6e20 7468 6520 6172 7469 6661 6374   on the artifact
-00016b80: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-00016b90: 6d20 7265 706c 6163 653a 2049 6620 5472  m replace: If Tr
-00016ba0: 7565 2c20 7265 706c 6163 6520 6578 6973  ue, replace exis
-00016bb0: 7469 6e67 2074 6167 732c 206f 7468 6572  ting tags, other
-00016bc0: 7769 7365 2061 7070 656e 6420 746f 2065  wise append to e
-00016bd0: 7869 7374 696e 6720 7461 6773 2e0a 2020  xisting tags..  
-00016be0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00016bf0: 2020 7461 675f 6f62 6a65 6374 7320 3d20    tag_objects = 
-00016c00: 7365 6c66 2e5f 7265 736f 6c76 655f 6172  self._resolve_ar
-00016c10: 7469 6661 6374 735f 746f 5f74 6167 5f6f  tifacts_to_tag_o
-00016c20: 626a 6563 7473 2861 7274 6966 6163 7473  bjects(artifacts
-00016c30: 290a 2020 2020 2020 2020 7365 6c66 2e74  ).        self.t
-00016c40: 6167 5f6f 626a 6563 7473 2870 726f 6a65  ag_objects(proje
-00016c50: 6374 2c20 7461 675f 6e61 6d65 2c20 6f62  ct, tag_name, ob
-00016c60: 6a65 6374 733d 7461 675f 6f62 6a65 6374  jects=tag_object
-00016c70: 732c 2072 6570 6c61 6365 3d72 6570 6c61  s, replace=repla
-00016c80: 6365 290a 0a20 2020 2064 6566 2064 656c  ce)..    def del
-00016c90: 6574 655f 6172 7469 6661 6374 735f 7461  ete_artifacts_ta
-00016ca0: 6773 280a 2020 2020 2020 2020 7365 6c66  gs(.        self
-00016cb0: 2c0a 2020 2020 2020 2020 6172 7469 6661  ,.        artifa
-00016cc0: 6374 732c 0a20 2020 2020 2020 2070 726f  cts,.        pro
-00016cd0: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
-00016ce0: 2020 2074 6167 5f6e 616d 653a 2073 7472     tag_name: str
-00016cf0: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00016d00: 2022 2222 4465 6c65 7465 2074 6167 2066   """Delete tag f
-00016d10: 726f 6d20 6120 6c69 7374 206f 6620 6172  rom a list of ar
-00016d20: 7469 6661 6374 732e 0a0a 2020 2020 2020  tifacts...      
-00016d30: 2020 3a70 6172 616d 2061 7274 6966 6163    :param artifac
-00016d40: 7473 3a20 5468 6520 6172 7469 6661 6374  ts: The artifact
-00016d50: 7320 746f 2064 656c 6574 6520 7468 6520  s to delete the 
-00016d60: 7461 6720 6672 6f6d 2e20 4361 6e20 6265  tag from. Can be
-00016d70: 2061 206c 6973 7420 6f66 203a 7079 3a63   a list of :py:c
-00016d80: 6c61 7373 3a60 7e6d 6c72 756e 2e61 7274  lass:`~mlrun.art
-00016d90: 6966 6163 7473 2e41 7274 6966 6163 7460  ifacts.Artifact`
-00016da0: 0a20 2020 2020 2020 2020 2020 206f 626a  .            obj
-00016db0: 6563 7473 206f 7220 6469 6374 696f 6e61  ects or dictiona
-00016dc0: 7269 6573 2c20 6f72 2061 2073 696e 676c  ries, or a singl
-00016dd0: 6520 6f62 6a65 6374 2e0a 2020 2020 2020  e object..      
-00016de0: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
-00016df0: 3a20 5072 6f6a 6563 7420 7768 6963 6820  : Project which 
-00016e00: 636f 6e74 6169 6e73 2074 6865 2061 7274  contains the art
-00016e10: 6966 6163 7473 2e0a 2020 2020 2020 2020  ifacts..        
-00016e20: 3a70 6172 616d 2074 6167 5f6e 616d 653a  :param tag_name:
-00016e30: 2054 6865 2074 6167 2074 6f20 7365 7420   The tag to set 
-00016e40: 6f6e 2074 6865 2061 7274 6966 6163 7473  on the artifacts
-00016e50: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00016e60: 2020 2020 2020 7461 675f 6f62 6a65 6374        tag_object
-00016e70: 7320 3d20 7365 6c66 2e5f 7265 736f 6c76  s = self._resolv
-00016e80: 655f 6172 7469 6661 6374 735f 746f 5f74  e_artifacts_to_t
-00016e90: 6167 5f6f 626a 6563 7473 2861 7274 6966  ag_objects(artif
-00016ea0: 6163 7473 290a 2020 2020 2020 2020 7365  acts).        se
-00016eb0: 6c66 2e64 656c 6574 655f 6f62 6a65 6374  lf.delete_object
-00016ec0: 735f 7461 6728 7072 6f6a 6563 742c 2074  s_tag(project, t
-00016ed0: 6167 5f6e 616d 652c 2074 6167 5f6f 626a  ag_name, tag_obj
-00016ee0: 6563 7473 290a 0a20 2020 2064 6566 206c  ects)..    def l
-00016ef0: 6973 745f 7072 6f6a 6563 7473 280a 2020  ist_projects(.  
-00016f00: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00016f10: 2020 2020 6f77 6e65 723a 2073 7472 203d      owner: str =
-00016f20: 204e 6f6e 652c 0a20 2020 2020 2020 2066   None,.        f
-00016f30: 6f72 6d61 745f 3a20 556e 696f 6e5b 0a20  ormat_: Union[. 
-00016f40: 2020 2020 2020 2020 2020 2073 7472 2c20             str, 
-00016f50: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00016f60: 656d 6173 2e50 726f 6a65 6374 7346 6f72  emas.ProjectsFor
-00016f70: 6d61 740a 2020 2020 2020 2020 5d20 3d20  mat.        ] = 
-00016f80: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00016f90: 656d 6173 2e50 726f 6a65 6374 7346 6f72  emas.ProjectsFor
-00016fa0: 6d61 742e 6675 6c6c 2c0a 2020 2020 2020  mat.full,.      
-00016fb0: 2020 6c61 6265 6c73 3a20 4c69 7374 5b73    labels: List[s
-00016fc0: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-00016fd0: 2020 2020 7374 6174 653a 2055 6e69 6f6e      state: Union
-00016fe0: 5b73 7472 2c20 6d6c 7275 6e2e 636f 6d6d  [str, mlrun.comm
-00016ff0: 6f6e 2e73 6368 656d 6173 2e50 726f 6a65  on.schemas.Proje
-00017000: 6374 5374 6174 655d 203d 204e 6f6e 652c  ctState] = None,
-00017010: 0a20 2020 2029 202d 3e20 4c69 7374 5b55  .    ) -> List[U
-00017020: 6e69 6f6e 5b6d 6c72 756e 2e70 726f 6a65  nion[mlrun.proje
-00017030: 6374 732e 4d6c 7275 6e50 726f 6a65 6374  cts.MlrunProject
-00017040: 2c20 7374 725d 5d3a 0a20 2020 2020 2020  , str]]:.       
-00017050: 2022 2222 5265 7475 726e 2061 206c 6973   """Return a lis
-00017060: 7420 6f66 2074 6865 2065 7869 7374 696e  t of the existin
-00017070: 6720 7072 6f6a 6563 7473 2c20 706f 7465  g projects, pote
-00017080: 6e74 6961 6c6c 7920 6669 6c74 6572 6564  ntially filtered
-00017090: 2062 7920 7370 6563 6966 6963 2063 7269   by specific cri
-000170a0: 7465 7269 612e 0a0a 2020 2020 2020 2020  teria...        
-000170b0: 3a70 6172 616d 206f 776e 6572 3a20 4c69  :param owner: Li
-000170c0: 7374 206f 6e6c 7920 7072 6f6a 6563 7473  st only projects
-000170d0: 2062 656c 6f6e 6769 6e67 2074 6f20 7468   belonging to th
-000170e0: 6973 2073 7065 6369 6669 6320 6f77 6e65  is specific owne
-000170f0: 722e 0a20 2020 2020 2020 203a 7061 7261  r..        :para
-00017100: 6d20 666f 726d 6174 5f3a 2046 6f72 6d61  m format_: Forma
-00017110: 7420 6f66 2074 6865 2072 6573 756c 7473  t of the results
-00017120: 2e20 506f 7373 6962 6c65 2076 616c 7565  . Possible value
-00017130: 7320 6172 653a 0a0a 2020 2020 2020 2020  s are:..        
-00017140: 2020 2020 2d20 6060 6675 6c6c 6060 2028      - ``full`` (
-00017150: 6465 6661 756c 7420 7661 6c75 6529 202d  default value) -
-00017160: 2052 6574 7572 6e20 6675 6c6c 2070 726f   Return full pro
-00017170: 6a65 6374 206f 626a 6563 7473 2e0a 2020  ject objects..  
-00017180: 2020 2020 2020 2020 2020 2d20 6060 6d69            - ``mi
-00017190: 6e69 6d61 6c60 6020 2d20 5265 7475 726e  nimal`` - Return
-000171a0: 206d 696e 696d 616c 2070 726f 6a65 6374   minimal project
-000171b0: 206f 626a 6563 7473 2028 6d69 6e69 6d69   objects (minimi
-000171c0: 7a61 7469 6f6e 2068 6170 7065 6e73 2069  zation happens i
-000171d0: 6e20 7468 6520 4245 292e 0a20 2020 2020  n the BE)..     
-000171e0: 2020 2020 2020 202d 2060 606e 616d 655f         - ``name_
-000171f0: 6f6e 6c79 6060 202d 2052 6574 7572 6e20  only`` - Return 
-00017200: 6a75 7374 2074 6865 206e 616d 6573 206f  just the names o
-00017210: 6620 7468 6520 7072 6f6a 6563 7473 2e0a  f the projects..
-00017220: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00017230: 6c61 6265 6c73 3a20 4669 6c74 6572 2062  labels: Filter b
-00017240: 7920 6c61 6265 6c73 2061 7474 6163 6865  y labels attache
-00017250: 6420 746f 2074 6865 2070 726f 6a65 6374  d to the project
-00017260: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00017270: 2073 7461 7465 3a20 4669 6c74 6572 2062   state: Filter b
-00017280: 7920 7072 6f6a 6563 7427 7320 7374 6174  y project's stat
-00017290: 652e 2043 616e 2062 6520 6569 7468 6572  e. Can be either
-000172a0: 2060 606f 6e6c 696e 6560 6020 6f72 2060   ``online`` or `
-000172b0: 6061 7263 6869 7665 6460 602e 0a20 2020  `archived``..   
-000172c0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-000172d0: 2020 7061 7261 6d73 203d 207b 0a20 2020    params = {.   
-000172e0: 2020 2020 2020 2020 2022 6f77 6e65 7222           "owner"
-000172f0: 3a20 6f77 6e65 722c 0a20 2020 2020 2020  : owner,.       
-00017300: 2020 2020 2022 7374 6174 6522 3a20 7374       "state": st
-00017310: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
-00017320: 2022 666f 726d 6174 223a 2066 6f72 6d61   "format": forma
-00017330: 745f 2c0a 2020 2020 2020 2020 2020 2020  t_,.            
-00017340: 226c 6162 656c 223a 206c 6162 656c 7320  "label": labels 
-00017350: 6f72 205b 5d2c 0a20 2020 2020 2020 207d  or [],.        }
-00017360: 0a0a 2020 2020 2020 2020 6572 726f 725f  ..        error_
-00017370: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
-00017380: 6564 206c 6973 7469 6e67 2070 726f 6a65  ed listing proje
-00017390: 6374 732c 2071 7565 7279 3a20 7b70 6172  cts, query: {par
-000173a0: 616d 737d 220a 2020 2020 2020 2020 7265  ams}".        re
-000173b0: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
-000173c0: 695f 6361 6c6c 2822 4745 5422 2c20 2270  i_call("GET", "p
-000173d0: 726f 6a65 6374 7322 2c20 6572 726f 725f  rojects", error_
-000173e0: 6d65 7373 6167 652c 2070 6172 616d 733d  message, params=
-000173f0: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
-00017400: 6966 2066 6f72 6d61 745f 203d 3d20 6d6c  if format_ == ml
-00017410: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00017420: 6173 2e50 726f 6a65 6374 7346 6f72 6d61  as.ProjectsForma
-00017430: 742e 6e61 6d65 5f6f 6e6c 793a 0a0a 2020  t.name_only:..  
-00017440: 2020 2020 2020 2020 2020 2320 7072 6f6a            # proj
-00017450: 6563 7473 2069 7320 6a75 7374 2061 206c  ects is just a l
-00017460: 6973 7420 6f66 2073 7472 696e 6773 0a20  ist of strings. 
-00017470: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00017480: 6e20 7265 7370 6f6e 7365 2e6a 736f 6e28  n response.json(
-00017490: 295b 2270 726f 6a65 6374 7322 5d0a 0a20  )["projects"].. 
-000174a0: 2020 2020 2020 2023 2066 6f72 7761 7264         # forward
-000174b0: 7320 636f 6d70 6174 6962 696c 6974 7920  s compatibility 
-000174c0: 2d20 7765 2077 616e 7420 746f 2062 6520  - we want to be 
-000174d0: 6162 6c65 2074 6f20 6861 6e64 6c65 206e  able to handle n
-000174e0: 6577 2066 6f72 6d61 7473 2074 6861 7420  ew formats that 
-000174f0: 6d69 6768 7420 6265 2061 6464 6564 2069  might be added i
-00017500: 6e20 7468 6520 6675 7475 7265 0a20 2020  n the future.   
-00017510: 2020 2020 2023 2069 6620 666f 726d 6174       # if format
-00017520: 2069 7320 6e6f 7420 6b6e 6f77 6e20 746f   is not known to
-00017530: 2074 6865 2061 7069 2c20 6974 2069 7320   the api, it is 
-00017540: 7570 2074 6f20 7468 6520 7365 7276 6572  up to the server
-00017550: 2074 6f20 7265 7475 726e 2065 6974 6865   to return eithe
-00017560: 7220 616e 2065 7272 6f72 206f 7220 6120  r an error or a 
-00017570: 6465 6661 756c 7420 666f 726d 6174 0a20  default format. 
-00017580: 2020 2020 2020 2072 6574 7572 6e20 5b0a         return [.
-00017590: 2020 2020 2020 2020 2020 2020 6d6c 7275              mlru
-000175a0: 6e2e 7072 6f6a 6563 7473 2e4d 6c72 756e  n.projects.Mlrun
-000175b0: 5072 6f6a 6563 742e 6672 6f6d 5f64 6963  Project.from_dic
-000175c0: 7428 7072 6f6a 6563 745f 6469 6374 290a  t(project_dict).
-000175d0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000175e0: 7072 6f6a 6563 745f 6469 6374 2069 6e20  project_dict in 
-000175f0: 7265 7370 6f6e 7365 2e6a 736f 6e28 295b  response.json()[
-00017600: 2270 726f 6a65 6374 7322 5d0a 2020 2020  "projects"].    
-00017610: 2020 2020 5d0a 0a20 2020 2064 6566 2067      ]..    def g
-00017620: 6574 5f70 726f 6a65 6374 2873 656c 662c  et_project(self,
-00017630: 206e 616d 653a 2073 7472 2920 2d3e 206d   name: str) -> m
-00017640: 6c72 756e 2e70 726f 6a65 6374 732e 4d6c  lrun.projects.Ml
-00017650: 7275 6e50 726f 6a65 6374 3a0a 2020 2020  runProject:.    
-00017660: 2020 2020 2222 2247 6574 2064 6574 6169      """Get detai
-00017670: 6c73 2066 6f72 2061 2073 7065 6369 6669  ls for a specifi
-00017680: 6320 7072 6f6a 6563 742e 2222 220a 0a20  c project.""".. 
-00017690: 2020 2020 2020 2069 6620 6e6f 7420 6e61         if not na
-000176a0: 6d65 3a0a 2020 2020 2020 2020 2020 2020  me:.            
-000176b0: 7261 6973 6520 4d4c 5275 6e49 6e76 616c  raise MLRunInval
-000176c0: 6964 4172 6775 6d65 6e74 4572 726f 7228  idArgumentError(
-000176d0: 224e 616d 6520 6d75 7374 2062 6520 7072  "Name must be pr
-000176e0: 6f76 6964 6564 2229 0a0a 2020 2020 2020  ovided")..      
-000176f0: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-00017700: 6374 732f 7b6e 616d 657d 220a 2020 2020  cts/{name}".    
-00017710: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00017720: 6520 3d20 6622 4661 696c 6564 2072 6574  e = f"Failed ret
-00017730: 7269 6576 696e 6720 7072 6f6a 6563 7420  rieving project 
-00017740: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
-00017750: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
-00017760: 6170 695f 6361 6c6c 2822 4745 5422 2c20  api_call("GET", 
-00017770: 7061 7468 2c20 6572 726f 725f 6d65 7373  path, error_mess
-00017780: 6167 6529 0a20 2020 2020 2020 2072 6574  age).        ret
-00017790: 7572 6e20 6d6c 7275 6e2e 7072 6f6a 6563  urn mlrun.projec
-000177a0: 7473 2e4d 6c72 756e 5072 6f6a 6563 742e  ts.MlrunProject.
-000177b0: 6672 6f6d 5f64 6963 7428 7265 7370 6f6e  from_dict(respon
-000177c0: 7365 2e6a 736f 6e28 2929 0a0a 2020 2020  se.json())..    
-000177d0: 6465 6620 6465 6c65 7465 5f70 726f 6a65  def delete_proje
-000177e0: 6374 280a 2020 2020 2020 2020 7365 6c66  ct(.        self
-000177f0: 2c0a 2020 2020 2020 2020 6e61 6d65 3a20  ,.        name: 
-00017800: 7374 722c 0a20 2020 2020 2020 2064 656c  str,.        del
-00017810: 6574 696f 6e5f 7374 7261 7465 6779 3a20  etion_strategy: 
-00017820: 556e 696f 6e5b 0a20 2020 2020 2020 2020  Union[.         
-00017830: 2020 2073 7472 2c20 6d6c 7275 6e2e 636f     str, mlrun.co
-00017840: 6d6d 6f6e 2e73 6368 656d 6173 2e44 656c  mmon.schemas.Del
-00017850: 6574 696f 6e53 7472 6174 6567 790a 2020  etionStrategy.  
-00017860: 2020 2020 2020 5d20 3d20 6d6c 7275 6e2e        ] = mlrun.
-00017870: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e44  common.schemas.D
-00017880: 656c 6574 696f 6e53 7472 6174 6567 792e  eletionStrategy.
-00017890: 6465 6661 756c 7428 292c 0a20 2020 2029  default(),.    )
-000178a0: 3a0a 2020 2020 2020 2020 2222 2244 656c  :.        """Del
-000178b0: 6574 6520 6120 7072 6f6a 6563 742e 0a0a  ete a project...
-000178c0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-000178d0: 616d 653a 204e 616d 6520 6f66 2074 6865  ame: Name of the
-000178e0: 2070 726f 6a65 6374 2074 6f20 6465 6c65   project to dele
-000178f0: 7465 2e0a 2020 2020 2020 2020 3a70 6172  te..        :par
-00017900: 616d 2064 656c 6574 696f 6e5f 7374 7261  am deletion_stra
-00017910: 7465 6779 3a20 486f 7720 746f 2074 7265  tegy: How to tre
-00017920: 6174 2063 6869 6c64 206f 626a 6563 7473  at child objects
-00017930: 206f 6620 7468 6520 7072 6f6a 6563 742e   of the project.
-00017940: 2050 6f73 7369 626c 6520 7661 6c75 6573   Possible values
-00017950: 2061 7265 3a0a 0a20 2020 2020 2020 2020   are:..         
-00017960: 2020 202d 2060 6072 6573 7472 6963 7460     - ``restrict`
-00017970: 6020 2864 6566 6175 6c74 2920 2d20 5072  ` (default) - Pr
-00017980: 6f6a 6563 7420 6d75 7374 206e 6f74 2068  oject must not h
-00017990: 6176 6520 616e 7920 6368 696c 6420 6f62  ave any child ob
-000179a0: 6a65 6374 7320 7768 656e 2064 656c 6574  jects when delet
-000179b0: 6564 2e20 4966 2075 7369 6e67 2074 6869  ed. If using thi
-000179c0: 7320 6d6f 6465 2077 6869 6c65 0a20 2020  s mode while.   
-000179d0: 2020 2020 2020 2020 2020 2063 6869 6c64             child
-000179e0: 206f 626a 6563 7473 2065 7869 7374 2c20   objects exist, 
-000179f0: 7468 6520 6f70 6572 6174 696f 6e20 7769  the operation wi
-00017a00: 6c6c 2066 6169 6c2e 0a20 2020 2020 2020  ll fail..       
-00017a10: 2020 2020 202d 2060 6063 6173 6361 6465       - ``cascade
-00017a20: 6060 202d 2041 7574 6f6d 6174 6963 616c  `` - Automatical
-00017a30: 6c79 2064 656c 6574 6520 616c 6c20 6368  ly delete all ch
-00017a40: 696c 6420 6f62 6a65 6374 7320 7768 656e  ild objects when
-00017a50: 2064 656c 6574 696e 6720 7468 6520 7072   deleting the pr
-00017a60: 6f6a 6563 742e 0a20 2020 2020 2020 2022  oject..        "
-00017a70: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
-00017a80: 203d 2066 2270 726f 6a65 6374 732f 7b6e   = f"projects/{n
-00017a90: 616d 657d 220a 2020 2020 2020 2020 6865  ame}".        he
-00017aa0: 6164 6572 7320 3d20 7b0a 2020 2020 2020  aders = {.      
-00017ab0: 2020 2020 2020 6d6c 7275 6e2e 636f 6d6d        mlrun.comm
-00017ac0: 6f6e 2e73 6368 656d 6173 2e48 6561 6465  on.schemas.Heade
-00017ad0: 724e 616d 6573 2e64 656c 6574 696f 6e5f  rNames.deletion_
-00017ae0: 7374 7261 7465 6779 3a20 6465 6c65 7469  strategy: deleti
-00017af0: 6f6e 5f73 7472 6174 6567 790a 2020 2020  on_strategy.    
-00017b00: 2020 2020 7d0a 2020 2020 2020 2020 6572      }.        er
-00017b10: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-00017b20: 4661 696c 6564 2064 656c 6574 696e 6720  Failed deleting 
-00017b30: 7072 6f6a 6563 7420 7b6e 616d 657d 220a  project {name}".
-00017b40: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
-00017b50: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-00017b60: 2822 4445 4c45 5445 222c 2070 6174 682c  ("DELETE", path,
-00017b70: 2065 7272 6f72 5f6d 6573 7361 6765 2c20   error_message, 
-00017b80: 6865 6164 6572 733d 6865 6164 6572 7329  headers=headers)
-00017b90: 0a20 2020 2020 2020 2069 6620 7265 7370  .        if resp
-00017ba0: 6f6e 7365 2e73 7461 7475 735f 636f 6465  onse.status_code
-00017bb0: 203d 3d20 6874 7470 2e48 5454 5053 7461   == http.HTTPSta
-00017bc0: 7475 732e 4143 4345 5054 4544 3a0a 2020  tus.ACCEPTED:.  
-00017bd0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00017be0: 2073 656c 662e 5f77 6169 745f 666f 725f   self._wait_for_
-00017bf0: 7072 6f6a 6563 745f 746f 5f62 655f 6465  project_to_be_de
-00017c00: 6c65 7465 6428 6e61 6d65 290a 0a20 2020  leted(name)..   
-00017c10: 2064 6566 2073 746f 7265 5f70 726f 6a65   def store_proje
-00017c20: 6374 280a 2020 2020 2020 2020 7365 6c66  ct(.        self
-00017c30: 2c0a 2020 2020 2020 2020 6e61 6d65 3a20  ,.        name: 
-00017c40: 7374 722c 0a20 2020 2020 2020 2070 726f  str,.        pro
-00017c50: 6a65 6374 3a20 556e 696f 6e5b 6469 6374  ject: Union[dict
-00017c60: 2c20 6d6c 7275 6e2e 7072 6f6a 6563 7473  , mlrun.projects
-00017c70: 2e4d 6c72 756e 5072 6f6a 6563 742c 206d  .MlrunProject, m
-00017c80: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00017c90: 6d61 732e 5072 6f6a 6563 745d 2c0a 2020  mas.Project],.  
-00017ca0: 2020 2920 2d3e 206d 6c72 756e 2e70 726f    ) -> mlrun.pro
-00017cb0: 6a65 6374 732e 4d6c 7275 6e50 726f 6a65  jects.MlrunProje
-00017cc0: 6374 3a0a 2020 2020 2020 2020 2222 2253  ct:.        """S
-00017cd0: 746f 7265 2061 2070 726f 6a65 6374 2069  tore a project i
-00017ce0: 6e20 7468 6520 4442 2e20 5468 6973 206f  n the DB. This o
-00017cf0: 7065 7261 7469 6f6e 2077 696c 6c20 6f76  peration will ov
-00017d00: 6572 7772 6974 6520 6578 6973 7469 6e67  erwrite existing
-00017d10: 2070 726f 6a65 6374 206f 6620 7468 6520   project of the 
-00017d20: 7361 6d65 206e 616d 6520 6966 2065 7869  same name if exi
-00017d30: 7374 732e 2222 220a 0a20 2020 2020 2020  sts."""..       
-00017d40: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-00017d50: 7473 2f7b 6e61 6d65 7d22 0a20 2020 2020  ts/{name}".     
-00017d60: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-00017d70: 203d 2066 2246 6169 6c65 6420 7374 6f72   = f"Failed stor
-00017d80: 696e 6720 7072 6f6a 6563 7420 7b6e 616d  ing project {nam
-00017d90: 657d 220a 2020 2020 2020 2020 6966 2069  e}".        if i
-00017da0: 7369 6e73 7461 6e63 6528 7072 6f6a 6563  sinstance(projec
-00017db0: 742c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  t, mlrun.common.
-00017dc0: 7363 6865 6d61 732e 5072 6f6a 6563 7429  schemas.Project)
-00017dd0: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
-00017de0: 6f6a 6563 7420 3d20 7072 6f6a 6563 742e  oject = project.
-00017df0: 6469 6374 2829 0a20 2020 2020 2020 2065  dict().        e
-00017e00: 6c69 6620 6973 696e 7374 616e 6365 2870  lif isinstance(p
-00017e10: 726f 6a65 6374 2c20 6d6c 7275 6e2e 7072  roject, mlrun.pr
-00017e20: 6f6a 6563 7473 2e4d 6c72 756e 5072 6f6a  ojects.MlrunProj
-00017e30: 6563 7429 3a0a 2020 2020 2020 2020 2020  ect):.          
-00017e40: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
-00017e50: 6563 742e 746f 5f64 6963 7428 290a 2020  ect.to_dict().  
-00017e60: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
-00017e70: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
-00017e80: 2020 2020 2020 2020 2020 2020 2250 5554              "PUT
-00017e90: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
-00017ea0: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
-00017eb0: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
-00017ec0: 2020 2020 2020 2020 2020 2020 626f 6479              body
-00017ed0: 3d64 6963 745f 746f 5f6a 736f 6e28 7072  =dict_to_json(pr
-00017ee0: 6f6a 6563 7429 2c0a 2020 2020 2020 2020  oject),.        
-00017ef0: 290a 2020 2020 2020 2020 6966 2072 6573  ).        if res
-00017f00: 706f 6e73 652e 7374 6174 7573 5f63 6f64  ponse.status_cod
-00017f10: 6520 3d3d 2068 7474 702e 4854 5450 5374  e == http.HTTPSt
-00017f20: 6174 7573 2e41 4343 4550 5445 443a 0a20  atus.ACCEPTED:. 
-00017f30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00017f40: 6e20 7365 6c66 2e5f 7761 6974 5f66 6f72  n self._wait_for
-00017f50: 5f70 726f 6a65 6374 5f74 6f5f 7265 6163  _project_to_reac
-00017f60: 685f 7465 726d 696e 616c 5f73 7461 7465  h_terminal_state
-00017f70: 286e 616d 6529 0a20 2020 2020 2020 2072  (name).        r
-00017f80: 6574 7572 6e20 6d6c 7275 6e2e 7072 6f6a  eturn mlrun.proj
-00017f90: 6563 7473 2e4d 6c72 756e 5072 6f6a 6563  ects.MlrunProjec
-00017fa0: 742e 6672 6f6d 5f64 6963 7428 7265 7370  t.from_dict(resp
-00017fb0: 6f6e 7365 2e6a 736f 6e28 2929 0a0a 2020  onse.json())..  
-00017fc0: 2020 6465 6620 7061 7463 685f 7072 6f6a    def patch_proj
-00017fd0: 6563 7428 0a20 2020 2020 2020 2073 656c  ect(.        sel
-00017fe0: 662c 0a20 2020 2020 2020 206e 616d 653a  f,.        name:
-00017ff0: 2073 7472 2c0a 2020 2020 2020 2020 7072   str,.        pr
-00018000: 6f6a 6563 743a 2064 6963 742c 0a20 2020  oject: dict,.   
-00018010: 2020 2020 2070 6174 6368 5f6d 6f64 653a       patch_mode:
-00018020: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
-00018030: 2020 2020 7374 722c 206d 6c72 756e 2e63      str, mlrun.c
-00018040: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5061  ommon.schemas.Pa
-00018050: 7463 684d 6f64 650a 2020 2020 2020 2020  tchMode.        
-00018060: 5d20 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e  ] = mlrun.common
-00018070: 2e73 6368 656d 6173 2e50 6174 6368 4d6f  .schemas.PatchMo
-00018080: 6465 2e72 6570 6c61 6365 2c0a 2020 2020  de.replace,.    
-00018090: 2920 2d3e 206d 6c72 756e 2e70 726f 6a65  ) -> mlrun.proje
-000180a0: 6374 732e 4d6c 7275 6e50 726f 6a65 6374  cts.MlrunProject
-000180b0: 3a0a 2020 2020 2020 2020 2222 2250 6174  :.        """Pat
-000180c0: 6368 2061 6e20 6578 6973 7469 6e67 2070  ch an existing p
-000180d0: 726f 6a65 6374 206f 626a 6563 742e 0a0a  roject object...
-000180e0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-000180f0: 616d 653a 204e 616d 6520 6f66 2070 726f  ame: Name of pro
-00018100: 6a65 6374 2074 6f20 7061 7463 682e 0a20  ject to patch.. 
-00018110: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00018120: 6f6a 6563 743a 2054 6865 2061 6374 7561  oject: The actua
-00018130: 6c20 6368 616e 6765 7320 746f 2074 6865  l changes to the
-00018140: 2070 726f 6a65 6374 206f 626a 6563 742e   project object.
-00018150: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00018160: 7061 7463 685f 6d6f 6465 3a20 5468 6520  patch_mode: The 
-00018170: 7374 7261 7465 6779 2066 6f72 206d 6572  strategy for mer
-00018180: 6769 6e67 2074 6865 2063 6861 6e67 6573  ging the changes
-00018190: 2077 6974 6820 7468 6520 6578 6973 7469   with the existi
-000181a0: 6e67 206f 626a 6563 742e 2043 616e 2062  ng object. Can b
-000181b0: 6520 6569 7468 6572 2060 6072 6570 6c61  e either ``repla
-000181c0: 6365 6060 0a20 2020 2020 2020 2020 2020  ce``.           
-000181d0: 206f 7220 6060 6164 6469 7469 7665 6060   or ``additive``
-000181e0: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-000181f0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-00018200: 7072 6f6a 6563 7473 2f7b 6e61 6d65 7d22  projects/{name}"
-00018210: 0a20 2020 2020 2020 2068 6561 6465 7273  .        headers
-00018220: 203d 207b 6d6c 7275 6e2e 636f 6d6d 6f6e   = {mlrun.common
-00018230: 2e73 6368 656d 6173 2e48 6561 6465 724e  .schemas.HeaderN
-00018240: 616d 6573 2e70 6174 6368 5f6d 6f64 653a  ames.patch_mode:
-00018250: 2070 6174 6368 5f6d 6f64 657d 0a20 2020   patch_mode}.   
-00018260: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-00018270: 6765 203d 2066 2246 6169 6c65 6420 7061  ge = f"Failed pa
-00018280: 7463 6869 6e67 2070 726f 6a65 6374 207b  tching project {
-00018290: 6e61 6d65 7d22 0a20 2020 2020 2020 2072  name}".        r
-000182a0: 6573 706f 6e73 6520 3d20 7365 6c66 2e61  esponse = self.a
-000182b0: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
-000182c0: 2020 2020 2022 5041 5443 4822 2c20 7061       "PATCH", pa
-000182d0: 7468 2c20 6572 726f 725f 6d65 7373 6167  th, error_messag
-000182e0: 652c 2062 6f64 793d 6469 6374 5f74 6f5f  e, body=dict_to_
-000182f0: 6a73 6f6e 2870 726f 6a65 6374 292c 2068  json(project), h
-00018300: 6561 6465 7273 3d68 6561 6465 7273 0a20  eaders=headers. 
-00018310: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00018320: 2072 6574 7572 6e20 6d6c 7275 6e2e 7072   return mlrun.pr
-00018330: 6f6a 6563 7473 2e4d 6c72 756e 5072 6f6a  ojects.MlrunProj
-00018340: 6563 742e 6672 6f6d 5f64 6963 7428 7265  ect.from_dict(re
-00018350: 7370 6f6e 7365 2e6a 736f 6e28 2929 0a0a  sponse.json())..
-00018360: 2020 2020 6465 6620 6372 6561 7465 5f70      def create_p
-00018370: 726f 6a65 6374 280a 2020 2020 2020 2020  roject(.        
-00018380: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
-00018390: 6f6a 6563 743a 2055 6e69 6f6e 5b64 6963  oject: Union[dic
-000183a0: 742c 206d 6c72 756e 2e70 726f 6a65 6374  t, mlrun.project
-000183b0: 732e 4d6c 7275 6e50 726f 6a65 6374 2c20  s.MlrunProject, 
-000183c0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-000183d0: 656d 6173 2e50 726f 6a65 6374 5d2c 0a20  emas.Project],. 
-000183e0: 2020 2029 202d 3e20 6d6c 7275 6e2e 7072     ) -> mlrun.pr
-000183f0: 6f6a 6563 7473 2e4d 6c72 756e 5072 6f6a  ojects.MlrunProj
-00018400: 6563 743a 0a20 2020 2020 2020 2022 2222  ect:.        """
-00018410: 4372 6561 7465 2061 206e 6577 2070 726f  Create a new pro
-00018420: 6a65 6374 2e20 4120 7072 6f6a 6563 7420  ject. A project 
-00018430: 7769 7468 2074 6865 2073 616d 6520 6e61  with the same na
-00018440: 6d65 206d 7573 7420 6e6f 7420 6578 6973  me must not exis
-00018450: 7420 7072 696f 7220 746f 2063 7265 6174  t prior to creat
-00018460: 696f 6e2e 2222 220a 0a20 2020 2020 2020  ion."""..       
-00018470: 2069 6620 6973 696e 7374 616e 6365 2870   if isinstance(p
-00018480: 726f 6a65 6374 2c20 6d6c 7275 6e2e 636f  roject, mlrun.co
-00018490: 6d6d 6f6e 2e73 6368 656d 6173 2e50 726f  mmon.schemas.Pro
-000184a0: 6a65 6374 293a 0a20 2020 2020 2020 2020  ject):.         
-000184b0: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
-000184c0: 6a65 6374 2e64 6963 7428 290a 2020 2020  ject.dict().    
-000184d0: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-000184e0: 6e63 6528 7072 6f6a 6563 742c 206d 6c72  nce(project, mlr
-000184f0: 756e 2e70 726f 6a65 6374 732e 4d6c 7275  un.projects.Mlru
-00018500: 6e50 726f 6a65 6374 293a 0a20 2020 2020  nProject):.     
-00018510: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
-00018520: 2070 726f 6a65 6374 2e74 6f5f 6469 6374   project.to_dict
-00018530: 2829 0a20 2020 2020 2020 2070 726f 6a65  ().        proje
-00018540: 6374 5f6e 616d 6520 3d20 7072 6f6a 6563  ct_name = projec
-00018550: 745b 226d 6574 6164 6174 6122 5d5b 226e  t["metadata"]["n
-00018560: 616d 6522 5d0a 2020 2020 2020 2020 6572  ame"].        er
-00018570: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-00018580: 4661 696c 6564 2063 7265 6174 696e 6720  Failed creating 
-00018590: 7072 6f6a 6563 7420 7b70 726f 6a65 6374  project {project
-000185a0: 5f6e 616d 657d 220a 2020 2020 2020 2020  _name}".        
-000185b0: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
-000185c0: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
-000185d0: 2020 2020 2020 2250 4f53 5422 2c0a 2020        "POST",.  
-000185e0: 2020 2020 2020 2020 2020 2270 726f 6a65            "proje
-000185f0: 6374 7322 2c0a 2020 2020 2020 2020 2020  cts",.          
-00018600: 2020 6572 726f 725f 6d65 7373 6167 652c    error_message,
-00018610: 0a20 2020 2020 2020 2020 2020 2062 6f64  .            bod
-00018620: 793d 6469 6374 5f74 6f5f 6a73 6f6e 2870  y=dict_to_json(p
-00018630: 726f 6a65 6374 292c 0a20 2020 2020 2020  roject),.       
-00018640: 2029 0a20 2020 2020 2020 2069 6620 7265   ).        if re
-00018650: 7370 6f6e 7365 2e73 7461 7475 735f 636f  sponse.status_co
-00018660: 6465 203d 3d20 6874 7470 2e48 5454 5053  de == http.HTTPS
-00018670: 7461 7475 732e 4143 4345 5054 4544 3a0a  tatus.ACCEPTED:.
-00018680: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00018690: 726e 2073 656c 662e 5f77 6169 745f 666f  rn self._wait_fo
-000186a0: 725f 7072 6f6a 6563 745f 746f 5f72 6561  r_project_to_rea
-000186b0: 6368 5f74 6572 6d69 6e61 6c5f 7374 6174  ch_terminal_stat
-000186c0: 6528 7072 6f6a 6563 745f 6e61 6d65 290a  e(project_name).
-000186d0: 2020 2020 2020 2020 7265 7475 726e 206d          return m
-000186e0: 6c72 756e 2e70 726f 6a65 6374 732e 4d6c  lrun.projects.Ml
-000186f0: 7275 6e50 726f 6a65 6374 2e66 726f 6d5f  runProject.from_
-00018700: 6469 6374 2872 6573 706f 6e73 652e 6a73  dict(response.js
-00018710: 6f6e 2829 290a 0a20 2020 2064 6566 205f  on())..    def _
-00018720: 7761 6974 5f66 6f72 5f70 726f 6a65 6374  wait_for_project
-00018730: 5f74 6f5f 7265 6163 685f 7465 726d 696e  _to_reach_termin
-00018740: 616c 5f73 7461 7465 280a 2020 2020 2020  al_state(.      
-00018750: 2020 7365 6c66 2c20 7072 6f6a 6563 745f    self, project_
-00018760: 6e61 6d65 3a20 7374 720a 2020 2020 2920  name: str.    ) 
-00018770: 2d3e 206d 6c72 756e 2e70 726f 6a65 6374  -> mlrun.project
-00018780: 732e 4d6c 7275 6e50 726f 6a65 6374 3a0a  s.MlrunProject:.
-00018790: 2020 2020 2020 2020 6465 6620 5f76 6572          def _ver
-000187a0: 6966 795f 7072 6f6a 6563 745f 696e 5f74  ify_project_in_t
-000187b0: 6572 6d69 6e61 6c5f 7374 6174 6528 293a  erminal_state():
-000187c0: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
-000187d0: 6a65 6374 203d 2073 656c 662e 6765 745f  ject = self.get_
-000187e0: 7072 6f6a 6563 7428 7072 6f6a 6563 745f  project(project_
-000187f0: 6e61 6d65 290a 2020 2020 2020 2020 2020  name).          
-00018800: 2020 6966 2028 0a20 2020 2020 2020 2020    if (.         
-00018810: 2020 2020 2020 2070 726f 6a65 6374 2e73         project.s
-00018820: 7461 7475 732e 7374 6174 650a 2020 2020  tatus.state.    
-00018830: 2020 2020 2020 2020 2020 2020 6e6f 7420              not 
-00018840: 696e 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  in mlrun.common.
-00018850: 7363 6865 6d61 732e 5072 6f6a 6563 7453  schemas.ProjectS
-00018860: 7461 7465 2e74 6572 6d69 6e61 6c5f 7374  tate.terminal_st
-00018870: 6174 6573 2829 0a20 2020 2020 2020 2020  ates().         
-00018880: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-00018890: 2020 2020 2020 7261 6973 6520 4578 6365        raise Exce
-000188a0: 7074 696f 6e28 0a20 2020 2020 2020 2020  ption(.         
-000188b0: 2020 2020 2020 2020 2020 2066 2250 726f             f"Pro
-000188c0: 6a65 6374 206e 6f74 2069 6e20 7465 726d  ject not in term
-000188d0: 696e 616c 2073 7461 7465 2e20 5374 6174  inal state. Stat
-000188e0: 653a 207b 7072 6f6a 6563 742e 7374 6174  e: {project.stat
-000188f0: 7573 2e73 7461 7465 7d22 0a20 2020 2020  us.state}".     
-00018900: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00018910: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00018920: 7072 6f6a 6563 740a 0a20 2020 2020 2020  project..       
-00018930: 2072 6574 7572 6e20 6d6c 7275 6e2e 7574   return mlrun.ut
-00018940: 696c 732e 6865 6c70 6572 732e 7265 7472  ils.helpers.retr
-00018950: 795f 756e 7469 6c5f 7375 6363 6573 7366  y_until_successf
-00018960: 756c 280a 2020 2020 2020 2020 2020 2020  ul(.            
-00018970: 7365 6c66 2e5f 7761 6974 5f66 6f72 5f70  self._wait_for_p
-00018980: 726f 6a65 6374 5f74 6572 6d69 6e61 6c5f  roject_terminal_
-00018990: 7374 6174 655f 7265 7472 795f 696e 7465  state_retry_inte
-000189a0: 7276 616c 2c0a 2020 2020 2020 2020 2020  rval,.          
-000189b0: 2020 3132 302c 0a20 2020 2020 2020 2020    120,.         
-000189c0: 2020 206c 6f67 6765 722c 0a20 2020 2020     logger,.     
-000189d0: 2020 2020 2020 2046 616c 7365 2c0a 2020         False,.  
-000189e0: 2020 2020 2020 2020 2020 5f76 6572 6966            _verif
-000189f0: 795f 7072 6f6a 6563 745f 696e 5f74 6572  y_project_in_ter
-00018a00: 6d69 6e61 6c5f 7374 6174 652c 0a20 2020  minal_state,.   
-00018a10: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-00018a20: 5f77 6169 745f 666f 725f 6261 636b 6772  _wait_for_backgr
-00018a30: 6f75 6e64 5f74 6173 6b5f 746f 5f72 6561  ound_task_to_rea
-00018a40: 6368 5f74 6572 6d69 6e61 6c5f 7374 6174  ch_terminal_stat
-00018a50: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
-00018a60: 206e 616d 653a 2073 7472 0a20 2020 2029   name: str.    )
-00018a70: 202d 3e20 6d6c 7275 6e2e 636f 6d6d 6f6e   -> mlrun.common
-00018a80: 2e73 6368 656d 6173 2e42 6163 6b67 726f  .schemas.Backgro
-00018a90: 756e 6454 6173 6b3a 0a20 2020 2020 2020  undTask:.       
-00018aa0: 2064 6566 205f 7665 7269 6679 5f62 6163   def _verify_bac
-00018ab0: 6b67 726f 756e 645f 7461 736b 5f69 6e5f  kground_task_in_
-00018ac0: 7465 726d 696e 616c 5f73 7461 7465 2829  terminal_state()
-00018ad0: 3a0a 2020 2020 2020 2020 2020 2020 6261  :.            ba
-00018ae0: 636b 6772 6f75 6e64 5f74 6173 6b20 3d20  ckground_task = 
-00018af0: 7365 6c66 2e67 6574 5f62 6163 6b67 726f  self.get_backgro
-00018b00: 756e 645f 7461 736b 286e 616d 6529 0a20  und_task(name). 
-00018b10: 2020 2020 2020 2020 2020 2073 7461 7465             state
-00018b20: 203d 2062 6163 6b67 726f 756e 645f 7461   = background_ta
-00018b30: 736b 2e73 7461 7475 732e 7374 6174 650a  sk.status.state.
-00018b40: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00018b50: 7461 7465 206e 6f74 2069 6e20 6d6c 7275  tate not in mlru
-00018b60: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00018b70: 2e42 6163 6b67 726f 756e 6454 6173 6b53  .BackgroundTaskS
-00018b80: 7461 7465 2e74 6572 6d69 6e61 6c5f 7374  tate.terminal_st
-00018b90: 6174 6573 2829 3a0a 2020 2020 2020 2020  ates():.        
-00018ba0: 2020 2020 2020 2020 7261 6973 6520 4578          raise Ex
-00018bb0: 6365 7074 696f 6e28 0a20 2020 2020 2020  ception(.       
-00018bc0: 2020 2020 2020 2020 2020 2020 2066 2242               f"B
-00018bd0: 6163 6b67 726f 756e 6420 7461 736b 206e  ackground task n
-00018be0: 6f74 2069 6e20 7465 726d 696e 616c 2073  ot in terminal s
-00018bf0: 7461 7465 2e20 6e61 6d65 3d7b 6e61 6d65  tate. name={name
-00018c00: 7d2c 2073 7461 7465 3d7b 7374 6174 657d  }, state={state}
-00018c10: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00018c20: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00018c30: 7265 7475 726e 2062 6163 6b67 726f 756e  return backgroun
-00018c40: 645f 7461 736b 0a0a 2020 2020 2020 2020  d_task..        
-00018c50: 7265 7475 726e 206d 6c72 756e 2e75 7469  return mlrun.uti
-00018c60: 6c73 2e68 656c 7065 7273 2e72 6574 7279  ls.helpers.retry
-00018c70: 5f75 6e74 696c 5f73 7563 6365 7373 6675  _until_successfu
-00018c80: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
-00018c90: 656c 662e 5f77 6169 745f 666f 725f 6261  elf._wait_for_ba
-00018ca0: 636b 6772 6f75 6e64 5f74 6173 6b5f 7465  ckground_task_te
-00018cb0: 726d 696e 616c 5f73 7461 7465 5f72 6574  rminal_state_ret
-00018cc0: 7279 5f69 6e74 6572 7661 6c2c 0a20 2020  ry_interval,.   
-00018cd0: 2020 2020 2020 2020 2036 3020 2a20 3630           60 * 60
-00018ce0: 2c0a 2020 2020 2020 2020 2020 2020 6c6f  ,.            lo
-00018cf0: 6767 6572 2c0a 2020 2020 2020 2020 2020  gger,.          
-00018d00: 2020 4661 6c73 652c 0a20 2020 2020 2020    False,.       
-00018d10: 2020 2020 205f 7665 7269 6679 5f62 6163       _verify_bac
-00018d20: 6b67 726f 756e 645f 7461 736b 5f69 6e5f  kground_task_in_
-00018d30: 7465 726d 696e 616c 5f73 7461 7465 2c0a  terminal_state,.
-00018d40: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00018d50: 6566 205f 7761 6974 5f66 6f72 5f70 726f  ef _wait_for_pro
-00018d60: 6a65 6374 5f74 6f5f 6265 5f64 656c 6574  ject_to_be_delet
-00018d70: 6564 2873 656c 662c 2070 726f 6a65 6374  ed(self, project
-00018d80: 5f6e 616d 653a 2073 7472 293a 0a20 2020  _name: str):.   
-00018d90: 2020 2020 2064 6566 205f 7665 7269 6679       def _verify
-00018da0: 5f70 726f 6a65 6374 5f64 656c 6574 6564  _project_deleted
-00018db0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00018dc0: 7072 6f6a 6563 7473 203d 2073 656c 662e  projects = self.
-00018dd0: 6c69 7374 5f70 726f 6a65 6374 7328 0a20  list_projects(. 
-00018de0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00018df0: 6f72 6d61 745f 3d6d 6c72 756e 2e63 6f6d  ormat_=mlrun.com
-00018e00: 6d6f 6e2e 7363 6865 6d61 732e 5072 6f6a  mon.schemas.Proj
-00018e10: 6563 7473 466f 726d 6174 2e6e 616d 655f  ectsFormat.name_
-00018e20: 6f6e 6c79 0a20 2020 2020 2020 2020 2020  only.           
-00018e30: 2029 0a20 2020 2020 2020 2020 2020 2069   ).            i
-00018e40: 6620 7072 6f6a 6563 745f 6e61 6d65 2069  f project_name i
-00018e50: 6e20 7072 6f6a 6563 7473 3a0a 2020 2020  n projects:.    
-00018e60: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00018e70: 6520 4578 6365 7074 696f 6e28 6622 5072  e Exception(f"Pr
-00018e80: 6f6a 6563 7420 7b70 726f 6a65 6374 5f6e  oject {project_n
-00018e90: 616d 657d 2073 7469 6c6c 2065 7869 7374  ame} still exist
-00018ea0: 7322 290a 0a20 2020 2020 2020 2072 6574  s")..        ret
-00018eb0: 7572 6e20 6d6c 7275 6e2e 7574 696c 732e  urn mlrun.utils.
-00018ec0: 6865 6c70 6572 732e 7265 7472 795f 756e  helpers.retry_un
-00018ed0: 7469 6c5f 7375 6363 6573 7366 756c 280a  til_successful(.
-00018ee0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00018ef0: 2e5f 7761 6974 5f66 6f72 5f70 726f 6a65  ._wait_for_proje
-00018f00: 6374 5f64 656c 6574 696f 6e5f 696e 7465  ct_deletion_inte
-00018f10: 7276 616c 2c0a 2020 2020 2020 2020 2020  rval,.          
-00018f20: 2020 3132 302c 0a20 2020 2020 2020 2020    120,.         
-00018f30: 2020 206c 6f67 6765 722c 0a20 2020 2020     logger,.     
-00018f40: 2020 2020 2020 2046 616c 7365 2c0a 2020         False,.  
-00018f50: 2020 2020 2020 2020 2020 5f76 6572 6966            _verif
-00018f60: 795f 7072 6f6a 6563 745f 6465 6c65 7465  y_project_delete
-00018f70: 642c 0a20 2020 2020 2020 2029 0a0a 2020  d,.        )..  
-00018f80: 2020 6465 6620 6372 6561 7465 5f70 726f    def create_pro
-00018f90: 6a65 6374 5f73 6563 7265 7473 280a 2020  ject_secrets(.  
-00018fa0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00018fb0: 2020 2020 7072 6f6a 6563 743a 2073 7472      project: str
-00018fc0: 2c0a 2020 2020 2020 2020 7072 6f76 6964  ,.        provid
-00018fd0: 6572 3a20 556e 696f 6e5b 0a20 2020 2020  er: Union[.     
-00018fe0: 2020 2020 2020 2073 7472 2c20 6d6c 7275         str, mlru
-00018ff0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00019000: 2e53 6563 7265 7450 726f 7669 6465 724e  .SecretProviderN
-00019010: 616d 650a 2020 2020 2020 2020 5d20 3d20  ame.        ] = 
-00019020: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00019030: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
-00019040: 6465 724e 616d 652e 6b75 6265 726e 6574  derName.kubernet
-00019050: 6573 2c0a 2020 2020 2020 2020 7365 6372  es,.        secr
-00019060: 6574 733a 2064 6963 7420 3d20 4e6f 6e65  ets: dict = None
-00019070: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00019080: 2022 2222 4372 6561 7465 2070 726f 6a65   """Create proje
-00019090: 6374 2d63 6f6e 7465 7874 2073 6563 7265  ct-context secre
-000190a0: 7473 2075 7369 6e67 2065 6974 6865 7220  ts using either 
-000190b0: 6060 7661 756c 7460 6020 6f72 2060 606b  ``vault`` or ``k
-000190c0: 7562 6572 6e65 7465 7360 6020 7072 6f76  ubernetes`` prov
-000190d0: 6964 6572 2e0a 2020 2020 2020 2020 5768  ider..        Wh
-000190e0: 656e 2075 7369 6e67 2077 6974 6820 5661  en using with Va
-000190f0: 756c 742c 2074 6869 7320 7769 6c6c 2063  ult, this will c
-00019100: 7265 6174 6520 6e65 6564 6564 2056 6175  reate needed Vau
-00019110: 6c74 2073 7472 7563 7475 7265 7320 666f  lt structures fo
-00019120: 7220 7374 6f72 696e 6720 7365 6372 6574  r storing secret
-00019130: 7320 696e 2070 726f 6a65 6374 2d63 6f6e  s in project-con
-00019140: 7465 7874 2c20 616e 640a 2020 2020 2020  text, and.      
-00019150: 2020 7374 6f72 6520 6120 7365 7420 6f66    store a set of
-00019160: 2073 6563 7265 7420 7661 6c75 6573 2e20   secret values. 
-00019170: 5468 6520 6d65 7468 6f64 2067 656e 6572  The method gener
-00019180: 6174 6573 204b 7562 6572 6e65 7465 7320  ates Kubernetes 
-00019190: 7365 7276 6963 652d 6163 636f 756e 7420  service-account 
-000191a0: 616e 6420 7468 6520 5661 756c 7420 6175  and the Vault au
-000191b0: 7468 656e 7469 6361 7469 6f6e 0a20 2020  thentication.   
-000191c0: 2020 2020 2073 7472 7563 7475 7265 7320       structures 
-000191d0: 7468 6174 2061 7265 2072 6571 7569 7265  that are require
-000191e0: 6420 666f 7220 6675 6e63 7469 6f6e 2050  d for function P
-000191f0: 6f64 7320 746f 2061 7574 6865 6e74 6963  ods to authentic
-00019200: 6174 6520 7769 7468 2056 6175 6c74 2061  ate with Vault a
-00019210: 6e64 2062 6520 6162 6c65 2074 6f20 6578  nd be able to ex
-00019220: 7472 6163 7420 7365 6372 6574 2076 616c  tract secret val
-00019230: 7565 730a 2020 2020 2020 2020 7061 7373  ues.        pass
-00019240: 6564 2061 7320 7061 7274 206f 6620 7468  ed as part of th
-00019250: 6569 7220 636f 6e74 6578 742e 0a0a 2020  eir context...  
-00019260: 2020 2020 2020 4e6f 7465 3a0a 2020 2020        Note:.    
-00019270: 2020 2020 2020 2020 2020 2020 5468 6973              This
-00019280: 206d 6574 686f 6420 7573 6564 2077 6974   method used wit
-00019290: 6820 5661 756c 7420 6973 2063 7572 7265  h Vault is curre
-000192a0: 6e74 6c79 2069 6e20 7465 6368 6e69 6361  ntly in technica
-000192b0: 6c20 7072 6576 6965 772c 2061 6e64 2072  l preview, and r
-000192c0: 6571 7569 7265 7320 6120 4861 7368 6943  equires a HashiC
-000192d0: 6f72 7020 5661 756c 740a 2020 2020 2020  orp Vault.      
-000192e0: 2020 2020 2020 2020 2020 696e 6672 6173            infras
-000192f0: 7472 7563 7475 7265 2070 726f 7065 726c  tructure properl
-00019300: 7920 7365 7420 7570 2061 6e64 2063 6f6e  y set up and con
-00019310: 6e65 6374 6564 2074 6f20 7468 6520 4d4c  nected to the ML
-00019320: 5275 6e20 4150 4920 7365 7276 6572 2e0a  Run API server..
-00019330: 0a20 2020 2020 2020 2057 6865 6e20 7573  .        When us
-00019340: 6564 2077 6974 6820 4b75 6265 726e 6574  ed with Kubernet
-00019350: 6573 2c20 7468 6973 2077 696c 6c20 6d61  es, this will ma
-00019360: 6b65 2073 7572 6520 7468 6174 2074 6865  ke sure that the
-00019370: 2070 726f 6a65 6374 2d73 7065 6369 6669   project-specifi
-00019380: 6320 6b38 7320 7365 6372 6574 2069 7320  c k8s secret is 
-00019390: 6372 6561 7465 642c 2061 6e64 2077 696c  created, and wil
-000193a0: 6c0a 2020 2020 2020 2020 706f 7075 6c61  l.        popula
-000193b0: 7465 2069 7420 7769 7468 2074 6865 2073  te it with the s
-000193c0: 6563 7265 7473 2070 726f 7669 6465 642c  ecrets provided,
-000193d0: 2072 6570 6c61 6369 6e67 2074 6865 6972   replacing their
-000193e0: 2076 616c 7565 7320 6966 2074 6865 7920   values if they 
-000193f0: 6578 6973 742e 0a0a 2020 2020 2020 2020  exist...        
-00019400: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
-00019410: 5468 6520 7072 6f6a 6563 7420 636f 6e74  The project cont
-00019420: 6578 7420 666f 7220 7768 6963 6820 746f  ext for which to
-00019430: 2067 656e 6572 6174 6520 7468 6520 696e   generate the in
-00019440: 6672 6120 616e 6420 7374 6f72 6520 7365  fra and store se
-00019450: 6372 6574 732e 0a20 2020 2020 2020 203a  crets..        :
-00019460: 7061 7261 6d20 7072 6f76 6964 6572 3a20  param provider: 
-00019470: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
-00019480: 7365 6372 6574 732d 7072 6f76 6964 6572  secrets-provider
-00019490: 2074 6f20 776f 726b 2077 6974 682e 2041   to work with. A
-000194a0: 6363 6570 7473 2061 0a20 2020 2020 2020  ccepts a.       
-000194b0: 2020 2020 203a 7079 3a63 6c61 7373 3a60       :py:class:`
-000194c0: 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  ~mlrun.common.sc
-000194d0: 6865 6d61 732e 7365 6372 6574 2e53 6563  hemas.secret.Sec
-000194e0: 7265 7450 726f 7669 6465 724e 616d 6560  retProviderName`
-000194f0: 2065 6e75 6d2e 0a20 2020 2020 2020 203a   enum..        :
-00019500: 7061 7261 6d20 7365 6372 6574 733a 2041  param secrets: A
-00019510: 2073 6574 206f 6620 7365 6372 6574 2076   set of secret v
-00019520: 616c 7565 7320 746f 2073 746f 7265 2e0a  alues to store..
-00019530: 2020 2020 2020 2020 2020 2020 4578 616d              Exam
-00019540: 706c 653a 3a0a 0a20 2020 2020 2020 2020  ple::..         
-00019550: 2020 2020 2020 2073 6563 7265 7473 203d         secrets =
-00019560: 207b 2770 6173 7377 6f72 6427 3a20 276d   {'password': 'm
-00019570: 7950 6173 7377 3072 6427 2c20 2761 7773  yPassw0rd', 'aws
-00019580: 5f6b 6579 273a 2027 3131 3132 3232 3333  _key': '11122233
-00019590: 3327 7d0a 2020 2020 2020 2020 2020 2020  3'}.            
-000195a0: 2020 2020 6462 2e63 7265 6174 655f 7072      db.create_pr
-000195b0: 6f6a 6563 745f 7365 6372 6574 7328 0a20  oject_secrets(. 
-000195c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000195d0: 2020 2022 7072 6f6a 6563 7431 222c 0a20     "project1",. 
-000195e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000195f0: 2020 2070 726f 7669 6465 723d 6d6c 7275     provider=mlru
-00019600: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00019610: 2e53 6563 7265 7450 726f 7669 6465 724e  .SecretProviderN
-00019620: 616d 652e 6b75 6265 726e 6574 6573 2c0a  ame.kubernetes,.
-00019630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019640: 2020 2020 7365 6372 6574 733d 7365 6372      secrets=secr
-00019650: 6574 730a 2020 2020 2020 2020 2020 2020  ets.            
-00019660: 2020 2020 290a 2020 2020 2020 2020 2222      ).        ""
-00019670: 220a 2020 2020 2020 2020 7061 7468 203d  ".        path =
-00019680: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-00019690: 6a65 6374 7d2f 7365 6372 6574 7322 0a20  ject}/secrets". 
-000196a0: 2020 2020 2020 2073 6563 7265 7473 5f69         secrets_i
-000196b0: 6e70 7574 203d 206d 6c72 756e 2e63 6f6d  nput = mlrun.com
-000196c0: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
-000196d0: 6574 7344 6174 6128 0a20 2020 2020 2020  etsData(.       
-000196e0: 2020 2020 2073 6563 7265 7473 3d73 6563       secrets=sec
-000196f0: 7265 7473 2c20 7072 6f76 6964 6572 3d70  rets, provider=p
-00019700: 726f 7669 6465 720a 2020 2020 2020 2020  rovider.        
-00019710: 290a 2020 2020 2020 2020 626f 6479 203d  ).        body =
-00019720: 2073 6563 7265 7473 5f69 6e70 7574 2e64   secrets_input.d
-00019730: 6963 7428 290a 2020 2020 2020 2020 6572  ict().        er
-00019740: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-00019750: 4661 696c 6564 2063 7265 6174 696e 6720  Failed creating 
-00019760: 7365 6372 6574 2070 726f 7669 6465 7220  secret provider 
-00019770: 7b70 726f 6a65 6374 7d2f 7b70 726f 7669  {project}/{provi
-00019780: 6465 727d 220a 2020 2020 2020 2020 7365  der}".        se
-00019790: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
-000197a0: 2020 2020 2020 2020 2022 504f 5354 222c           "POST",
-000197b0: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
-000197c0: 682c 0a20 2020 2020 2020 2020 2020 2065  h,.            e
-000197d0: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
-000197e0: 2020 2020 2020 2020 2020 626f 6479 3d64            body=d
-000197f0: 6963 745f 746f 5f6a 736f 6e28 626f 6479  ict_to_json(body
-00019800: 292c 0a20 2020 2020 2020 2029 0a0a 2020  ),.        )..  
-00019810: 2020 6465 6620 6c69 7374 5f70 726f 6a65    def list_proje
-00019820: 6374 5f73 6563 7265 7473 280a 2020 2020  ct_secrets(.    
-00019830: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00019840: 2020 7072 6f6a 6563 743a 2073 7472 2c0a    project: str,.
-00019850: 2020 2020 2020 2020 746f 6b65 6e3a 2073          token: s
-00019860: 7472 203d 204e 6f6e 652c 0a20 2020 2020  tr = None,.     
-00019870: 2020 2070 726f 7669 6465 723a 2055 6e69     provider: Uni
-00019880: 6f6e 5b0a 2020 2020 2020 2020 2020 2020  on[.            
-00019890: 7374 722c 206d 6c72 756e 2e63 6f6d 6d6f  str, mlrun.commo
-000198a0: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
-000198b0: 5072 6f76 6964 6572 4e61 6d65 0a20 2020  ProviderName.   
-000198c0: 2020 2020 205d 203d 206d 6c72 756e 2e63       ] = mlrun.c
-000198d0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5365  ommon.schemas.Se
-000198e0: 6372 6574 5072 6f76 6964 6572 4e61 6d65  cretProviderName
-000198f0: 2e6b 7562 6572 6e65 7465 732c 0a20 2020  .kubernetes,.   
-00019900: 2020 2020 2073 6563 7265 7473 3a20 4c69       secrets: Li
-00019910: 7374 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  st[str] = None,.
-00019920: 2020 2020 2920 2d3e 206d 6c72 756e 2e63      ) -> mlrun.c
-00019930: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5365  ommon.schemas.Se
-00019940: 6372 6574 7344 6174 613a 0a20 2020 2020  cretsData:.     
-00019950: 2020 2022 2222 5265 7472 6965 7665 2070     """Retrieve p
-00019960: 726f 6a65 6374 2d63 6f6e 7465 7874 2073  roject-context s
-00019970: 6563 7265 7473 2066 726f 6d20 5661 756c  ecrets from Vaul
-00019980: 742e 0a0a 2020 2020 2020 2020 4e6f 7465  t...        Note
-00019990: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000199a0: 2020 5468 6973 206d 6574 686f 6420 666f    This method fo
-000199b0: 7220 5661 756c 7420 6675 6e63 7469 6f6e  r Vault function
-000199c0: 616c 6974 7920 6973 2063 7572 7265 6e74  ality is current
-000199d0: 6c79 2069 6e20 7465 6368 6e69 6361 6c20  ly in technical 
-000199e0: 7072 6576 6965 772c 2061 6e64 2072 6571  preview, and req
-000199f0: 7569 7265 7320 6120 4861 7368 6943 6f72  uires a HashiCor
-00019a00: 7020 5661 756c 740a 2020 2020 2020 2020  p Vault.        
-00019a10: 2020 2020 2020 2020 696e 6672 6173 7472          infrastr
-00019a20: 7563 7475 7265 2070 726f 7065 726c 7920  ucture properly 
-00019a30: 7365 7420 7570 2061 6e64 2063 6f6e 6e65  set up and conne
-00019a40: 6374 6564 2074 6f20 7468 6520 4d4c 5275  cted to the MLRu
-00019a50: 6e20 4150 4920 7365 7276 6572 2e0a 0a20  n API server... 
-00019a60: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00019a70: 6f6a 6563 743a 2054 6865 2070 726f 6a65  oject: The proje
-00019a80: 6374 206e 616d 652e 0a20 2020 2020 2020  ct name..       
-00019a90: 203a 7061 7261 6d20 746f 6b65 6e3a 2056   :param token: V
-00019aa0: 6175 6c74 2074 6f6b 656e 2074 6f20 7573  ault token to us
-00019ab0: 6520 666f 7220 7265 7472 6965 7669 6e67  e for retrieving
-00019ac0: 2073 6563 7265 7473 2e0a 2020 2020 2020   secrets..      
-00019ad0: 2020 2020 2020 4d75 7374 2062 6520 6120        Must be a 
-00019ae0: 7661 6c69 6420 5661 756c 7420 746f 6b65  valid Vault toke
-00019af0: 6e2c 2077 6974 6820 7065 726d 6973 7369  n, with permissi
-00019b00: 6f6e 7320 746f 2072 6574 7269 6576 6520  ons to retrieve 
-00019b10: 7365 6372 6574 7320 6f66 2074 6865 2070  secrets of the p
-00019b20: 726f 6a65 6374 2069 6e20 7175 6573 7469  roject in questi
-00019b30: 6f6e 2e0a 2020 2020 2020 2020 3a70 6172  on..        :par
-00019b40: 616d 2070 726f 7669 6465 723a 2054 6865  am provider: The
-00019b50: 206e 616d 6520 6f66 2074 6865 2073 6563   name of the sec
-00019b60: 7265 7473 2d70 726f 7669 6465 7220 746f  rets-provider to
-00019b70: 2077 6f72 6b20 7769 7468 2e20 4375 7272   work with. Curr
-00019b80: 656e 746c 7920 6f6e 6c79 2060 6076 6175  ently only ``vau
-00019b90: 6c74 6060 2069 7320 6163 6365 7074 6564  lt`` is accepted
-00019ba0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00019bb0: 2073 6563 7265 7473 3a20 4120 6c69 7374   secrets: A list
-00019bc0: 206f 6620 7365 6372 6574 206e 616d 6573   of secret names
-00019bd0: 2074 6f20 7265 7472 6965 7665 2e20 416e   to retrieve. An
-00019be0: 2065 6d70 7479 206c 6973 7420 6060 5b5d   empty list ``[]
-00019bf0: 6060 2077 696c 6c20 7265 7472 6965 7665  `` will retrieve
-00019c00: 2061 6c6c 2073 6563 7265 7473 2061 7373   all secrets ass
-00019c10: 6967 6e65 640a 2020 2020 2020 2020 2020  igned.          
-00019c20: 2020 746f 2074 6869 7320 7370 6563 6966    to this specif
-00019c30: 6963 2070 726f 6a65 6374 2e20 6060 6b75  ic project. ``ku
-00019c40: 6265 726e 6574 6573 6060 2070 726f 7669  bernetes`` provi
-00019c50: 6465 7220 6f6e 6c79 2073 7570 706f 7274  der only support
-00019c60: 7320 616e 2065 6d70 7479 206c 6973 742e  s an empty list.
-00019c70: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00019c80: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
-00019c90: 2020 2020 2020 2070 726f 7669 6465 7220         provider 
-00019ca0: 3d3d 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  == mlrun.common.
-00019cb0: 7363 6865 6d61 732e 5365 6372 6574 5072  schemas.SecretPr
-00019cc0: 6f76 6964 6572 4e61 6d65 2e76 6175 6c74  oviderName.vault
-00019cd0: 2e76 616c 7565 0a20 2020 2020 2020 2020  .value.         
-00019ce0: 2020 2061 6e64 206e 6f74 2074 6f6b 656e     and not token
-00019cf0: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
-00019d00: 2020 2020 2020 2020 7261 6973 6520 4d4c          raise ML
-00019d10: 5275 6e49 6e76 616c 6964 4172 6775 6d65  RunInvalidArgume
-00019d20: 6e74 4572 726f 7228 0a20 2020 2020 2020  ntError(.       
-00019d30: 2020 2020 2020 2020 2022 4120 7661 756c           "A vaul
-00019d40: 7420 746f 6b65 6e20 6d75 7374 2062 6520  t token must be 
-00019d50: 7072 6f76 6964 6564 2077 6865 6e20 6163  provided when ac
-00019d60: 6365 7373 696e 6720 7661 756c 7420 7365  cessing vault se
-00019d70: 6372 6574 7322 0a20 2020 2020 2020 2020  crets".         
-00019d80: 2020 2029 0a0a 2020 2020 2020 2020 7061     )..        pa
-00019d90: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-00019da0: 7b70 726f 6a65 6374 7d2f 7365 6372 6574  {project}/secret
-00019db0: 7322 0a20 2020 2020 2020 2070 6172 616d  s".        param
-00019dc0: 7320 3d20 7b22 7072 6f76 6964 6572 223a  s = {"provider":
-00019dd0: 2070 726f 7669 6465 722c 2022 7365 6372   provider, "secr
-00019de0: 6574 223a 2073 6563 7265 7473 7d0a 2020  et": secrets}.  
-00019df0: 2020 2020 2020 6865 6164 6572 7320 3d20        headers = 
-00019e00: 7b6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  {mlrun.common.sc
-00019e10: 6865 6d61 732e 4865 6164 6572 4e61 6d65  hemas.HeaderName
-00019e20: 732e 7365 6372 6574 5f73 746f 7265 5f74  s.secret_store_t
-00019e30: 6f6b 656e 3a20 746f 6b65 6e7d 0a20 2020  oken: token}.   
-00019e40: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-00019e50: 6765 203d 2066 2246 6169 6c65 6420 7265  ge = f"Failed re
-00019e60: 7472 6965 7669 6e67 2073 6563 7265 7473  trieving secrets
-00019e70: 207b 7072 6f6a 6563 747d 2f7b 7072 6f76   {project}/{prov
-00019e80: 6964 6572 7d22 0a20 2020 2020 2020 2072  ider}".        r
-00019e90: 6573 756c 7420 3d20 7365 6c66 2e61 7069  esult = self.api
-00019ea0: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-00019eb0: 2020 2022 4745 5422 2c0a 2020 2020 2020     "GET",.      
-00019ec0: 2020 2020 2020 7061 7468 2c0a 2020 2020        path,.    
-00019ed0: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-00019ee0: 7373 6167 652c 0a20 2020 2020 2020 2020  ssage,.         
-00019ef0: 2020 2070 6172 616d 733d 7061 7261 6d73     params=params
-00019f00: 2c0a 2020 2020 2020 2020 2020 2020 6865  ,.            he
-00019f10: 6164 6572 733d 6865 6164 6572 732c 0a20  aders=headers,. 
-00019f20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00019f30: 2072 6574 7572 6e20 6d6c 7275 6e2e 636f   return mlrun.co
-00019f40: 6d6d 6f6e 2e73 6368 656d 6173 2e53 6563  mmon.schemas.Sec
-00019f50: 7265 7473 4461 7461 282a 2a72 6573 756c  retsData(**resul
-00019f60: 742e 6a73 6f6e 2829 290a 0a20 2020 2064  t.json())..    d
-00019f70: 6566 206c 6973 745f 7072 6f6a 6563 745f  ef list_project_
-00019f80: 7365 6372 6574 5f6b 6579 7328 0a20 2020  secret_keys(.   
-00019f90: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00019fa0: 2020 2070 726f 6a65 6374 3a20 7374 722c     project: str,
-00019fb0: 0a20 2020 2020 2020 2070 726f 7669 6465  .        provide
-00019fc0: 723a 2055 6e69 6f6e 5b0a 2020 2020 2020  r: Union[.      
-00019fd0: 2020 2020 2020 7374 722c 206d 6c72 756e        str, mlrun
-00019fe0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00019ff0: 5365 6372 6574 5072 6f76 6964 6572 4e61  SecretProviderNa
-0001a000: 6d65 0a20 2020 2020 2020 205d 203d 206d  me.        ] = m
-0001a010: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0001a020: 6d61 732e 5365 6372 6574 5072 6f76 6964  mas.SecretProvid
-0001a030: 6572 4e61 6d65 2e6b 7562 6572 6e65 7465  erName.kubernete
-0001a040: 732c 0a20 2020 2020 2020 2074 6f6b 656e  s,.        token
-0001a050: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
-0001a060: 2020 2920 2d3e 206d 6c72 756e 2e63 6f6d    ) -> mlrun.com
-0001a070: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
-0001a080: 6574 4b65 7973 4461 7461 3a0a 2020 2020  etKeysData:.    
-0001a090: 2020 2020 2222 2252 6574 7269 6576 6520      """Retrieve 
-0001a0a0: 7072 6f6a 6563 742d 636f 6e74 6578 7420  project-context 
-0001a0b0: 7365 6372 6574 206b 6579 7320 6672 6f6d  secret keys from
-0001a0c0: 2056 6175 6c74 206f 7220 4b75 6265 726e   Vault or Kubern
-0001a0d0: 6574 6573 2e0a 0a20 2020 2020 2020 204e  etes...        N
-0001a0e0: 6f74 653a 0a20 2020 2020 2020 2020 2020  ote:.           
-0001a0f0: 2020 2020 2054 6869 7320 6d65 7468 6f64       This method
-0001a100: 2066 6f72 2056 6175 6c74 2066 756e 6374   for Vault funct
-0001a110: 696f 6e61 6c69 7479 2069 7320 6375 7272  ionality is curr
-0001a120: 656e 746c 7920 696e 2074 6563 686e 6963  ently in technic
-0001a130: 616c 2070 7265 7669 6577 2c20 616e 6420  al preview, and 
-0001a140: 7265 7175 6972 6573 2061 2048 6173 6869  requires a Hashi
-0001a150: 436f 7270 2056 6175 6c74 0a20 2020 2020  Corp Vault.     
-0001a160: 2020 2020 2020 2020 2020 2069 6e66 7261             infra
-0001a170: 7374 7275 6374 7572 6520 7072 6f70 6572  structure proper
-0001a180: 6c79 2073 6574 2075 7020 616e 6420 636f  ly set up and co
-0001a190: 6e6e 6563 7465 6420 746f 2074 6865 204d  nnected to the M
-0001a1a0: 4c52 756e 2041 5049 2073 6572 7665 722e  LRun API server.
-0001a1b0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001a1c0: 2070 726f 6a65 6374 3a20 5468 6520 7072   project: The pr
-0001a1d0: 6f6a 6563 7420 6e61 6d65 2e0a 2020 2020  oject name..    
-0001a1e0: 2020 2020 3a70 6172 616d 2070 726f 7669      :param provi
-0001a1f0: 6465 723a 2054 6865 206e 616d 6520 6f66  der: The name of
-0001a200: 2074 6865 2073 6563 7265 7473 2d70 726f   the secrets-pro
-0001a210: 7669 6465 7220 746f 2077 6f72 6b20 7769  vider to work wi
-0001a220: 7468 2e20 4163 6365 7074 7320 610a 2020  th. Accepts a.  
-0001a230: 2020 2020 2020 2020 2020 3a70 793a 636c            :py:cl
-0001a240: 6173 733a 607e 6d6c 7275 6e2e 636f 6d6d  ass:`~mlrun.comm
-0001a250: 6f6e 2e73 6368 656d 6173 2e73 6563 7265  on.schemas.secre
-0001a260: 742e 5365 6372 6574 5072 6f76 6964 6572  t.SecretProvider
-0001a270: 4e61 6d65 6020 656e 756d 2e0a 2020 2020  Name` enum..    
-0001a280: 2020 2020 3a70 6172 616d 2074 6f6b 656e      :param token
-0001a290: 3a20 5661 756c 7420 746f 6b65 6e20 746f  : Vault token to
-0001a2a0: 2075 7365 2066 6f72 2072 6574 7269 6576   use for retriev
-0001a2b0: 696e 6720 7365 6372 6574 732e 204f 6e6c  ing secrets. Onl
-0001a2c0: 7920 696e 2075 7365 2069 6620 6060 7072  y in use if ``pr
-0001a2d0: 6f76 6964 6572 6060 2069 7320 6060 7661  ovider`` is ``va
-0001a2e0: 756c 7460 602e 0a20 2020 2020 2020 2020  ult``..         
-0001a2f0: 2020 204d 7573 7420 6265 2061 2076 616c     Must be a val
-0001a300: 6964 2056 6175 6c74 2074 6f6b 656e 2c20  id Vault token, 
-0001a310: 7769 7468 2070 6572 6d69 7373 696f 6e73  with permissions
-0001a320: 2074 6f20 7265 7472 6965 7665 2073 6563   to retrieve sec
-0001a330: 7265 7473 206f 6620 7468 6520 7072 6f6a  rets of the proj
-0001a340: 6563 7420 696e 2071 7565 7374 696f 6e2e  ect in question.
-0001a350: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-0001a360: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
-0001a370: 2020 2020 2020 2070 726f 7669 6465 7220         provider 
-0001a380: 3d3d 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  == mlrun.common.
-0001a390: 7363 6865 6d61 732e 5365 6372 6574 5072  schemas.SecretPr
-0001a3a0: 6f76 6964 6572 4e61 6d65 2e76 6175 6c74  oviderName.vault
-0001a3b0: 2e76 616c 7565 0a20 2020 2020 2020 2020  .value.         
-0001a3c0: 2020 2061 6e64 206e 6f74 2074 6f6b 656e     and not token
-0001a3d0: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
-0001a3e0: 2020 2020 2020 2020 7261 6973 6520 4d4c          raise ML
-0001a3f0: 5275 6e49 6e76 616c 6964 4172 6775 6d65  RunInvalidArgume
-0001a400: 6e74 4572 726f 7228 0a20 2020 2020 2020  ntError(.       
-0001a410: 2020 2020 2020 2020 2022 4120 7661 756c           "A vaul
-0001a420: 7420 746f 6b65 6e20 6d75 7374 2062 6520  t token must be 
-0001a430: 7072 6f76 6964 6564 2077 6865 6e20 6163  provided when ac
-0001a440: 6365 7373 696e 6720 7661 756c 7420 7365  cessing vault se
-0001a450: 6372 6574 7322 0a20 2020 2020 2020 2020  crets".         
-0001a460: 2020 2029 0a0a 2020 2020 2020 2020 7061     )..        pa
-0001a470: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-0001a480: 7b70 726f 6a65 6374 7d2f 7365 6372 6574  {project}/secret
-0001a490: 2d6b 6579 7322 0a20 2020 2020 2020 2070  -keys".        p
-0001a4a0: 6172 616d 7320 3d20 7b22 7072 6f76 6964  arams = {"provid
-0001a4b0: 6572 223a 2070 726f 7669 6465 727d 0a20  er": provider}. 
-0001a4c0: 2020 2020 2020 2068 6561 6465 7273 203d         headers =
-0001a4d0: 2028 0a20 2020 2020 2020 2020 2020 207b   (.            {
-0001a4e0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0001a4f0: 656d 6173 2e48 6561 6465 724e 616d 6573  emas.HeaderNames
-0001a500: 2e73 6563 7265 745f 7374 6f72 655f 746f  .secret_store_to
-0001a510: 6b65 6e3a 2074 6f6b 656e 7d0a 2020 2020  ken: token}.    
-0001a520: 2020 2020 2020 2020 6966 2070 726f 7669          if provi
-0001a530: 6465 7220 3d3d 206d 6c72 756e 2e63 6f6d  der == mlrun.com
-0001a540: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
-0001a550: 6574 5072 6f76 6964 6572 4e61 6d65 2e76  etProviderName.v
-0001a560: 6175 6c74 2e76 616c 7565 0a20 2020 2020  ault.value.     
-0001a570: 2020 2020 2020 2065 6c73 6520 4e6f 6e65         else None
-0001a580: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0001a590: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-0001a5a0: 203d 2066 2246 6169 6c65 6420 7265 7472   = f"Failed retr
-0001a5b0: 6965 7669 6e67 2073 6563 7265 7420 6b65  ieving secret ke
-0001a5c0: 7973 207b 7072 6f6a 6563 747d 2f7b 7072  ys {project}/{pr
-0001a5d0: 6f76 6964 6572 7d22 0a20 2020 2020 2020  ovider}".       
-0001a5e0: 2072 6573 756c 7420 3d20 7365 6c66 2e61   result = self.a
-0001a5f0: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
-0001a600: 2020 2020 2022 4745 5422 2c0a 2020 2020       "GET",.    
-0001a610: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
-0001a620: 2020 2020 2020 2020 2020 6572 726f 725f            error_
-0001a630: 6d65 7373 6167 652c 0a20 2020 2020 2020  message,.       
-0001a640: 2020 2020 2070 6172 616d 733d 7061 7261       params=para
-0001a650: 6d73 2c0a 2020 2020 2020 2020 2020 2020  ms,.            
-0001a660: 6865 6164 6572 733d 6865 6164 6572 732c  headers=headers,
-0001a670: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0001a680: 2020 2072 6574 7572 6e20 6d6c 7275 6e2e     return mlrun.
-0001a690: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
-0001a6a0: 6563 7265 744b 6579 7344 6174 6128 2a2a  ecretKeysData(**
-0001a6b0: 7265 7375 6c74 2e6a 736f 6e28 2929 0a0a  result.json())..
-0001a6c0: 2020 2020 6465 6620 6465 6c65 7465 5f70      def delete_p
-0001a6d0: 726f 6a65 6374 5f73 6563 7265 7473 280a  roject_secrets(.
-0001a6e0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0001a6f0: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
-0001a700: 7472 2c0a 2020 2020 2020 2020 7072 6f76  tr,.        prov
-0001a710: 6964 6572 3a20 556e 696f 6e5b 0a20 2020  ider: Union[.   
-0001a720: 2020 2020 2020 2020 2073 7472 2c20 6d6c           str, ml
-0001a730: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0001a740: 6173 2e53 6563 7265 7450 726f 7669 6465  as.SecretProvide
-0001a750: 724e 616d 650a 2020 2020 2020 2020 5d20  rName.        ] 
-0001a760: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
-0001a770: 6368 656d 6173 2e53 6563 7265 7450 726f  chemas.SecretPro
-0001a780: 7669 6465 724e 616d 652e 6b75 6265 726e  viderName.kubern
-0001a790: 6574 6573 2c0a 2020 2020 2020 2020 7365  etes,.        se
-0001a7a0: 6372 6574 733a 204c 6973 745b 7374 725d  crets: List[str]
-0001a7b0: 203d 204e 6f6e 652c 0a20 2020 2029 3a0a   = None,.    ):.
-0001a7c0: 2020 2020 2020 2020 2222 2244 656c 6574          """Delet
-0001a7d0: 6520 7072 6f6a 6563 742d 636f 6e74 6578  e project-contex
-0001a7e0: 7420 7365 6372 6574 7320 6672 6f6d 204b  t secrets from K
-0001a7f0: 7562 6572 6e65 7465 732e 0a0a 2020 2020  ubernetes...    
-0001a800: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
-0001a810: 6374 3a20 5468 6520 7072 6f6a 6563 7420  ct: The project 
-0001a820: 6e61 6d65 2e0a 2020 2020 2020 2020 3a70  name..        :p
-0001a830: 6172 616d 2070 726f 7669 6465 723a 2054  aram provider: T
-0001a840: 6865 206e 616d 6520 6f66 2074 6865 2073  he name of the s
-0001a850: 6563 7265 7473 2d70 726f 7669 6465 7220  ecrets-provider 
-0001a860: 746f 2077 6f72 6b20 7769 7468 2e20 4375  to work with. Cu
-0001a870: 7272 656e 746c 7920 6f6e 6c79 2060 606b  rrently only ``k
-0001a880: 7562 6572 6e65 7465 7360 6020 6973 2073  ubernetes`` is s
-0001a890: 7570 706f 7274 6564 2e0a 2020 2020 2020  upported..      
-0001a8a0: 2020 3a70 6172 616d 2073 6563 7265 7473    :param secrets
-0001a8b0: 3a20 4120 6c69 7374 206f 6620 7365 6372  : A list of secr
-0001a8c0: 6574 206e 616d 6573 2074 6f20 6465 6c65  et names to dele
-0001a8d0: 7465 2e20 416e 2065 6d70 7479 206c 6973  te. An empty lis
-0001a8e0: 7420 7769 6c6c 2064 656c 6574 6520 616c  t will delete al
-0001a8f0: 6c20 7365 6372 6574 7320 6173 7369 676e  l secrets assign
-0001a900: 6564 0a20 2020 2020 2020 2020 2020 2074  ed.            t
-0001a910: 6f20 7468 6973 2073 7065 6369 6669 6320  o this specific 
-0001a920: 7072 6f6a 6563 742e 0a20 2020 2020 2020  project..       
-0001a930: 2022 2222 0a0a 2020 2020 2020 2020 7061   """..        pa
-0001a940: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-0001a950: 7b70 726f 6a65 6374 7d2f 7365 6372 6574  {project}/secret
-0001a960: 7322 0a20 2020 2020 2020 2070 6172 616d  s".        param
-0001a970: 7320 3d20 7b22 7072 6f76 6964 6572 223a  s = {"provider":
-0001a980: 2070 726f 7669 6465 722c 2022 7365 6372   provider, "secr
-0001a990: 6574 223a 2073 6563 7265 7473 7d0a 2020  et": secrets}.  
-0001a9a0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-0001a9b0: 6167 6520 3d20 6622 4661 696c 6564 2064  age = f"Failed d
-0001a9c0: 656c 6574 696e 6720 7365 6372 6574 7320  eleting secrets 
-0001a9d0: 7b70 726f 6a65 6374 7d2f 7b70 726f 7669  {project}/{provi
-0001a9e0: 6465 727d 220a 2020 2020 2020 2020 7365  der}".        se
-0001a9f0: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
-0001aa00: 2020 2020 2020 2020 2022 4445 4c45 5445           "DELETE
-0001aa10: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
-0001aa20: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
-0001aa30: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
-0001aa40: 2020 2020 2020 2020 2020 2020 7061 7261              para
-0001aa50: 6d73 3d70 6172 616d 732c 0a20 2020 2020  ms=params,.     
-0001aa60: 2020 2029 0a0a 2020 2020 6465 6620 6372     )..    def cr
-0001aa70: 6561 7465 5f75 7365 725f 7365 6372 6574  eate_user_secret
-0001aa80: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
-0001aa90: 0a20 2020 2020 2020 2075 7365 723a 2073  .        user: s
-0001aaa0: 7472 2c0a 2020 2020 2020 2020 7072 6f76  tr,.        prov
-0001aab0: 6964 6572 3a20 556e 696f 6e5b 0a20 2020  ider: Union[.   
-0001aac0: 2020 2020 2020 2020 2073 7472 2c20 6d6c           str, ml
-0001aad0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0001aae0: 6173 2e53 6563 7265 7450 726f 7669 6465  as.SecretProvide
-0001aaf0: 724e 616d 650a 2020 2020 2020 2020 5d20  rName.        ] 
-0001ab00: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
-0001ab10: 6368 656d 6173 2e53 6563 7265 7450 726f  chemas.SecretPro
-0001ab20: 7669 6465 724e 616d 652e 7661 756c 742c  viderName.vault,
-0001ab30: 0a20 2020 2020 2020 2073 6563 7265 7473  .        secrets
-0001ab40: 3a20 6469 6374 203d 204e 6f6e 652c 0a20  : dict = None,. 
-0001ab50: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-0001ab60: 2243 7265 6174 6520 7573 6572 2d63 6f6e  "Create user-con
-0001ab70: 7465 7874 2073 6563 7265 7420 696e 2056  text secret in V
-0001ab80: 6175 6c74 2e20 506c 6561 7365 2072 6566  ault. Please ref
-0001ab90: 6572 2074 6f20 3a70 793a 6675 6e63 3a60  er to :py:func:`
-0001aba0: 6372 6561 7465 5f70 726f 6a65 6374 5f73  create_project_s
-0001abb0: 6563 7265 7473 6020 666f 7220 6d6f 7265  ecrets` for more
-0001abc0: 2064 6574 6169 6c73 0a20 2020 2020 2020   details.       
-0001abd0: 2061 6e64 2073 7461 7475 7320 6f66 2074   and status of t
-0001abe0: 6869 7320 6675 6e63 7469 6f6e 616c 6974  his functionalit
-0001abf0: 792e 0a0a 2020 2020 2020 2020 4e6f 7465  y...        Note
-0001ac00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001ac10: 2020 5468 6973 206d 6574 686f 6420 6973    This method is
-0001ac20: 2063 7572 7265 6e74 6c79 2069 6e20 7465   currently in te
-0001ac30: 6368 6e69 6361 6c20 7072 6576 6965 772c  chnical preview,
-0001ac40: 2061 6e64 2072 6571 7569 7265 7320 6120   and requires a 
-0001ac50: 4861 7368 6943 6f72 7020 5661 756c 7420  HashiCorp Vault 
-0001ac60: 696e 6672 6173 7472 7563 7475 7265 0a20  infrastructure. 
-0001ac70: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0001ac80: 726f 7065 726c 7920 7365 7420 7570 2061  roperly set up a
-0001ac90: 6e64 2063 6f6e 6e65 6374 6564 2074 6f20  nd connected to 
-0001aca0: 7468 6520 4d4c 5275 6e20 4150 4920 7365  the MLRun API se
-0001acb0: 7276 6572 2e0a 0a20 2020 2020 2020 203a  rver...        :
-0001acc0: 7061 7261 6d20 7573 6572 3a20 5468 6520  param user: The 
-0001acd0: 7573 6572 2063 6f6e 7465 7874 2066 6f72  user context for
-0001ace0: 2077 6869 6368 2074 6f20 6765 6e65 7261   which to genera
-0001acf0: 7465 2074 6865 2069 6e66 7261 2061 6e64  te the infra and
-0001ad00: 2073 746f 7265 2073 6563 7265 7473 2e0a   store secrets..
-0001ad10: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-0001ad20: 726f 7669 6465 723a 2054 6865 206e 616d  rovider: The nam
-0001ad30: 6520 6f66 2074 6865 2073 6563 7265 7473  e of the secrets
-0001ad40: 2d70 726f 7669 6465 7220 746f 2077 6f72  -provider to wor
-0001ad50: 6b20 7769 7468 2e20 4375 7272 656e 746c  k with. Currentl
-0001ad60: 7920 6f6e 6c79 2060 6076 6175 6c74 6060  y only ``vault``
-0001ad70: 2069 7320 7375 7070 6f72 7465 642e 0a20   is supported.. 
-0001ad80: 2020 2020 2020 203a 7061 7261 6d20 7365         :param se
-0001ad90: 6372 6574 733a 2041 2073 6574 206f 6620  crets: A set of 
-0001ada0: 7365 6372 6574 2076 616c 7565 7320 746f  secret values to
-0001adb0: 2073 746f 7265 2077 6974 6869 6e20 7468   store within th
-0001adc0: 6520 5661 756c 742e 0a20 2020 2020 2020  e Vault..       
-0001add0: 2022 2222 0a20 2020 2020 2020 2070 6174   """.        pat
-0001ade0: 6820 3d20 2275 7365 722d 7365 6372 6574  h = "user-secret
-0001adf0: 7322 0a20 2020 2020 2020 2073 6563 7265  s".        secre
-0001ae00: 7473 5f63 7265 6174 696f 6e5f 7265 7175  ts_creation_requ
-0001ae10: 6573 7420 3d20 6d6c 7275 6e2e 636f 6d6d  est = mlrun.comm
-0001ae20: 6f6e 2e73 6368 656d 6173 2e55 7365 7253  on.schemas.UserS
-0001ae30: 6563 7265 7443 7265 6174 696f 6e52 6571  ecretCreationReq
-0001ae40: 7565 7374 280a 2020 2020 2020 2020 2020  uest(.          
-0001ae50: 2020 7573 6572 3d75 7365 722c 0a20 2020    user=user,.   
-0001ae60: 2020 2020 2020 2020 2070 726f 7669 6465           provide
-0001ae70: 723d 7072 6f76 6964 6572 2c0a 2020 2020  r=provider,.    
-0001ae80: 2020 2020 2020 2020 7365 6372 6574 733d          secrets=
-0001ae90: 7365 6372 6574 732c 0a20 2020 2020 2020  secrets,.       
-0001aea0: 2029 0a20 2020 2020 2020 2062 6f64 7920   ).        body 
-0001aeb0: 3d20 7365 6372 6574 735f 6372 6561 7469  = secrets_creati
-0001aec0: 6f6e 5f72 6571 7565 7374 2e64 6963 7428  on_request.dict(
-0001aed0: 290a 2020 2020 2020 2020 6572 726f 725f  ).        error_
-0001aee0: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
-0001aef0: 6564 2063 7265 6174 696e 6720 7573 6572  ed creating user
-0001af00: 2073 6563 7265 7473 202d 207b 7573 6572   secrets - {user
-0001af10: 7d22 0a20 2020 2020 2020 2073 656c 662e  }".        self.
-0001af20: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
-0001af30: 2020 2020 2020 2250 4f53 5422 2c0a 2020        "POST",.  
-0001af40: 2020 2020 2020 2020 2020 7061 7468 2c0a            path,.
-0001af50: 2020 2020 2020 2020 2020 2020 6572 726f              erro
-0001af60: 725f 6d65 7373 6167 652c 0a20 2020 2020  r_message,.     
-0001af70: 2020 2020 2020 2062 6f64 793d 6469 6374         body=dict
-0001af80: 5f74 6f5f 6a73 6f6e 2862 6f64 7929 2c0a  _to_json(body),.
-0001af90: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-0001afa0: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
-0001afb0: 2064 6566 205f 7661 6c69 6461 7465 5f76   def _validate_v
-0001afc0: 6572 7369 6f6e 5f63 6f6d 7061 7469 6269  ersion_compatibi
-0001afd0: 6c69 7479 2873 6572 7665 725f 7665 7273  lity(server_vers
-0001afe0: 696f 6e2c 2063 6c69 656e 745f 7665 7273  ion, client_vers
-0001aff0: 696f 6e29 202d 3e20 626f 6f6c 3a0a 2020  ion) -> bool:.  
-0001b000: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-0001b010: 2020 2020 2020 2070 6172 7365 645f 7365         parsed_se
-0001b020: 7276 6572 5f76 6572 7369 6f6e 203d 2073  rver_version = s
-0001b030: 656d 7665 722e 5665 7273 696f 6e49 6e66  emver.VersionInf
-0001b040: 6f2e 7061 7273 6528 7365 7276 6572 5f76  o.parse(server_v
-0001b050: 6572 7369 6f6e 290a 2020 2020 2020 2020  ersion).        
-0001b060: 2020 2020 7061 7273 6564 5f63 6c69 656e      parsed_clien
-0001b070: 745f 7665 7273 696f 6e20 3d20 7365 6d76  t_version = semv
-0001b080: 6572 2e56 6572 7369 6f6e 496e 666f 2e70  er.VersionInfo.p
-0001b090: 6172 7365 2863 6c69 656e 745f 7665 7273  arse(client_vers
-0001b0a0: 696f 6e29 0a20 2020 2020 2020 2065 7863  ion).        exc
-0001b0b0: 6570 7420 5661 6c75 6545 7272 6f72 3a0a  ept ValueError:.
-0001b0c0: 2020 2020 2020 2020 2020 2020 2320 5468              # Th
-0001b0d0: 6973 2077 696c 6c20 6d6f 7374 6c79 2068  is will mostly h
-0001b0e0: 6170 7065 6e20 696e 2064 6576 2073 6365  appen in dev sce
-0001b0f0: 6e61 7269 6f73 2077 6865 6e20 7468 6520  narios when the 
-0001b100: 7665 7273 696f 6e20 6973 2075 6e73 7461  version is unsta
-0001b110: 626c 6520 616e 6420 7375 6368 202d 2074  ble and such - t
-0001b120: 6865 7265 666f 7265 2077 6527 7265 2069  herefore we're i
-0001b130: 676e 6f72 696e 670a 2020 2020 2020 2020  gnoring.        
-0001b140: 2020 2020 6c6f 6767 6572 2e77 6172 6e69      logger.warni
-0001b150: 6e67 280a 2020 2020 2020 2020 2020 2020  ng(.            
-0001b160: 2020 2020 2255 6e61 626c 6520 746f 2070      "Unable to p
-0001b170: 6172 7365 2073 6572 7665 7220 6f72 2063  arse server or c
-0001b180: 6c69 656e 7420 7665 7273 696f 6e2e 2041  lient version. A
-0001b190: 7373 756d 696e 6720 636f 6d70 6174 6962  ssuming compatib
-0001b1a0: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
-0001b1b0: 2020 2020 2073 6572 7665 725f 7665 7273       server_vers
-0001b1c0: 696f 6e3d 7365 7276 6572 5f76 6572 7369  ion=server_versi
-0001b1d0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-0001b1e0: 2020 2020 636c 6965 6e74 5f76 6572 7369      client_versi
-0001b1f0: 6f6e 3d63 6c69 656e 745f 7665 7273 696f  on=client_versio
-0001b200: 6e2c 0a20 2020 2020 2020 2020 2020 2029  n,.            )
-0001b210: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001b220: 7572 6e20 5472 7565 0a20 2020 2020 2020  urn True.       
-0001b230: 2069 6620 2870 6172 7365 645f 7365 7276   if (parsed_serv
-0001b240: 6572 5f76 6572 7369 6f6e 2e6d 616a 6f72  er_version.major
-0001b250: 203d 3d20 3020 616e 6420 7061 7273 6564   == 0 and parsed
-0001b260: 5f73 6572 7665 725f 7665 7273 696f 6e2e  _server_version.
-0001b270: 6d69 6e6f 7220 3d3d 2030 2920 6f72 2028  minor == 0) or (
-0001b280: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-0001b290: 7365 645f 636c 6965 6e74 5f76 6572 7369  sed_client_versi
-0001b2a0: 6f6e 2e6d 616a 6f72 203d 3d20 3020 616e  on.major == 0 an
-0001b2b0: 6420 7061 7273 6564 5f63 6c69 656e 745f  d parsed_client_
-0001b2c0: 7665 7273 696f 6e2e 6d69 6e6f 7220 3d3d  version.minor ==
-0001b2d0: 2030 0a20 2020 2020 2020 2029 3a0a 2020   0.        ):.  
-0001b2e0: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
-0001b2f0: 2e77 6172 6e69 6e67 280a 2020 2020 2020  .warning(.      
-0001b300: 2020 2020 2020 2020 2020 2253 6572 7665            "Serve
-0001b310: 7220 6f72 2063 6c69 656e 7420 7665 7273  r or client vers
-0001b320: 696f 6e20 6973 2075 6e73 7461 626c 652e  ion is unstable.
-0001b330: 2041 7373 756d 696e 6720 636f 6d70 6174   Assuming compat
-0001b340: 6962 6c65 222c 0a20 2020 2020 2020 2020  ible",.         
-0001b350: 2020 2020 2020 2073 6572 7665 725f 7665         server_ve
-0001b360: 7273 696f 6e3d 7365 7276 6572 5f76 6572  rsion=server_ver
-0001b370: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
-0001b380: 2020 2020 2020 636c 6965 6e74 5f76 6572        client_ver
-0001b390: 7369 6f6e 3d63 6c69 656e 745f 7665 7273  sion=client_vers
-0001b3a0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-0001b3b0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
-0001b3c0: 6574 7572 6e20 5472 7565 0a20 2020 2020  eturn True.     
-0001b3d0: 2020 2069 6620 7061 7273 6564 5f73 6572     if parsed_ser
-0001b3e0: 7665 725f 7665 7273 696f 6e2e 6d61 6a6f  ver_version.majo
-0001b3f0: 7220 213d 2070 6172 7365 645f 636c 6965  r != parsed_clie
-0001b400: 6e74 5f76 6572 7369 6f6e 2e6d 616a 6f72  nt_version.major
-0001b410: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
-0001b420: 6767 6572 2e77 6172 6e69 6e67 280a 2020  gger.warning(.  
-0001b430: 2020 2020 2020 2020 2020 2020 2020 2253                "S
-0001b440: 6572 7665 7220 616e 6420 636c 6965 6e74  erver and client
-0001b450: 2076 6572 7369 6f6e 7320 6172 6520 696e   versions are in
-0001b460: 636f 6d70 6174 6962 6c65 222c 0a20 2020  compatible",.   
-0001b470: 2020 2020 2020 2020 2020 2020 2070 6172               par
-0001b480: 7365 645f 7365 7276 6572 5f76 6572 7369  sed_server_versi
-0001b490: 6f6e 3d70 6172 7365 645f 7365 7276 6572  on=parsed_server
-0001b4a0: 5f76 6572 7369 6f6e 2c0a 2020 2020 2020  _version,.      
-0001b4b0: 2020 2020 2020 2020 2020 7061 7273 6564            parsed
-0001b4c0: 5f63 6c69 656e 745f 7665 7273 696f 6e3d  _client_version=
-0001b4d0: 7061 7273 6564 5f63 6c69 656e 745f 7665  parsed_client_ve
-0001b4e0: 7273 696f 6e2c 0a20 2020 2020 2020 2020  rsion,.         
-0001b4f0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0001b500: 2072 6574 7572 6e20 4661 6c73 650a 2020   return False.  
-0001b510: 2020 2020 2020 6966 2070 6172 7365 645f        if parsed_
-0001b520: 7365 7276 6572 5f76 6572 7369 6f6e 2e6d  server_version.m
-0001b530: 696e 6f72 203e 2070 6172 7365 645f 636c  inor > parsed_cl
-0001b540: 6965 6e74 5f76 6572 7369 6f6e 2e6d 696e  ient_version.min
-0001b550: 6f72 202b 2032 3a0a 2020 2020 2020 2020  or + 2:.        
-0001b560: 2020 2020 6c6f 6767 6572 2e69 6e66 6f28      logger.info(
-0001b570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b580: 2022 4261 636b 7761 7264 7320 636f 6d70   "Backwards comp
-0001b590: 6174 6962 696c 6974 7920 6d69 6768 7420  atibility might 
-0001b5a0: 6e6f 7420 6170 706c 7920 6265 7477 6565  not apply betwee
-0001b5b0: 6e20 7468 6520 7365 7276 6572 2061 6e64  n the server and
-0001b5c0: 2063 6c69 656e 7420 7665 7273 696f 6e22   client version"
-0001b5d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001b5e0: 2020 7061 7273 6564 5f73 6572 7665 725f    parsed_server_
-0001b5f0: 7665 7273 696f 6e3d 7061 7273 6564 5f73  version=parsed_s
-0001b600: 6572 7665 725f 7665 7273 696f 6e2c 0a20  erver_version,. 
-0001b610: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0001b620: 6172 7365 645f 636c 6965 6e74 5f76 6572  arsed_client_ver
-0001b630: 7369 6f6e 3d70 6172 7365 645f 636c 6965  sion=parsed_clie
-0001b640: 6e74 5f76 6572 7369 6f6e 2c0a 2020 2020  nt_version,.    
-0001b650: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001b660: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
-0001b670: 7365 0a20 2020 2020 2020 2069 6620 7061  se.        if pa
-0001b680: 7273 6564 5f63 6c69 656e 745f 7665 7273  rsed_client_vers
-0001b690: 696f 6e2e 6d69 6e6f 7220 3e20 7061 7273  ion.minor > pars
-0001b6a0: 6564 5f73 6572 7665 725f 7665 7273 696f  ed_server_versio
-0001b6b0: 6e2e 6d69 6e6f 723a 0a20 2020 2020 2020  n.minor:.       
-0001b6c0: 2020 2020 206c 6f67 6765 722e 7761 726e       logger.warn
-0001b6d0: 696e 6728 0a20 2020 2020 2020 2020 2020  ing(.           
-0001b6e0: 2020 2020 2022 436c 6965 6e74 2076 6572       "Client ver
-0001b6f0: 7369 6f6e 2077 6974 6820 6869 6768 6572  sion with higher
-0001b700: 2076 6572 7369 6f6e 2074 6861 6e20 7365   version than se
-0001b710: 7276 6572 2076 6572 7369 6f6e 2069 736e  rver version isn
-0001b720: 2774 2073 7570 706f 7274 6564 2c22 0a20  't supported,". 
-0001b730: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b740: 2061 6c69 676e 2079 6f75 7220 636c 6965   align your clie
-0001b750: 6e74 2074 6f20 7468 6520 7365 7276 6572  nt to the server
-0001b760: 2076 6572 7369 6f6e 222c 0a20 2020 2020   version",.     
-0001b770: 2020 2020 2020 2020 2020 2070 6172 7365             parse
-0001b780: 645f 7365 7276 6572 5f76 6572 7369 6f6e  d_server_version
-0001b790: 3d70 6172 7365 645f 7365 7276 6572 5f76  =parsed_server_v
-0001b7a0: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
-0001b7b0: 2020 2020 2020 2020 7061 7273 6564 5f63          parsed_c
-0001b7c0: 6c69 656e 745f 7665 7273 696f 6e3d 7061  lient_version=pa
-0001b7d0: 7273 6564 5f63 6c69 656e 745f 7665 7273  rsed_client_vers
-0001b7e0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-0001b7f0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
-0001b800: 6574 7572 6e20 4661 6c73 650a 2020 2020  eturn False.    
-0001b810: 2020 2020 6966 2070 6172 7365 645f 7365      if parsed_se
-0001b820: 7276 6572 5f76 6572 7369 6f6e 2e6d 696e  rver_version.min
-0001b830: 6f72 2021 3d20 7061 7273 6564 5f63 6c69  or != parsed_cli
-0001b840: 656e 745f 7665 7273 696f 6e2e 6d69 6e6f  ent_version.mino
-0001b850: 723a 0a20 2020 2020 2020 2020 2020 206c  r:.            l
-0001b860: 6f67 6765 722e 696e 666f 280a 2020 2020  ogger.info(.    
-0001b870: 2020 2020 2020 2020 2020 2020 2253 6572              "Ser
-0001b880: 7665 7220 616e 6420 636c 6965 6e74 2076  ver and client v
-0001b890: 6572 7369 6f6e 7320 6172 6520 6e6f 7420  ersions are not 
-0001b8a0: 7468 6520 7361 6d65 2062 7574 2063 6f6d  the same but com
-0001b8b0: 7061 7469 626c 6522 2c0a 2020 2020 2020  patible",.      
-0001b8c0: 2020 2020 2020 2020 2020 7061 7273 6564            parsed
-0001b8d0: 5f73 6572 7665 725f 7665 7273 696f 6e3d  _server_version=
-0001b8e0: 7061 7273 6564 5f73 6572 7665 725f 7665  parsed_server_ve
-0001b8f0: 7273 696f 6e2c 0a20 2020 2020 2020 2020  rsion,.         
-0001b900: 2020 2020 2020 2070 6172 7365 645f 636c         parsed_cl
-0001b910: 6965 6e74 5f76 6572 7369 6f6e 3d70 6172  ient_version=par
-0001b920: 7365 645f 636c 6965 6e74 5f76 6572 7369  sed_client_versi
-0001b930: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-0001b940: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0001b950: 2054 7275 650a 0a20 2020 2064 6566 2063   True..    def c
-0001b960: 7265 6174 655f 6d6f 6465 6c5f 656e 6470  reate_model_endp
-0001b970: 6f69 6e74 280a 2020 2020 2020 2020 7365  oint(.        se
-0001b980: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
-0001b990: 6563 743a 2073 7472 2c0a 2020 2020 2020  ect: str,.      
-0001b9a0: 2020 656e 6470 6f69 6e74 5f69 643a 2073    endpoint_id: s
-0001b9b0: 7472 2c0a 2020 2020 2020 2020 6d6f 6465  tr,.        mode
-0001b9c0: 6c5f 656e 6470 6f69 6e74 3a20 556e 696f  l_endpoint: Unio
-0001b9d0: 6e5b 0a20 2020 2020 2020 2020 2020 206d  n[.            m
-0001b9e0: 6c72 756e 2e6d 6f64 656c 5f6d 6f6e 6974  lrun.model_monit
-0001b9f0: 6f72 696e 672e 6d6f 6465 6c5f 656e 6470  oring.model_endp
-0001ba00: 6f69 6e74 2e4d 6f64 656c 456e 6470 6f69  oint.ModelEndpoi
-0001ba10: 6e74 2c20 6469 6374 0a20 2020 2020 2020  nt, dict.       
-0001ba20: 205d 2c0a 2020 2020 293a 0a20 2020 2020   ],.    ):.     
-0001ba30: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-0001ba40: 7265 6174 6573 2061 2044 4220 7265 636f  reates a DB reco
-0001ba50: 7264 2077 6974 6820 7468 6520 6769 7665  rd with the give
-0001ba60: 6e20 6d6f 6465 6c5f 656e 6470 6f69 6e74  n model_endpoint
-0001ba70: 2072 6563 6f72 642e 0a0a 2020 2020 2020   record...      
-0001ba80: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
-0001ba90: 3a20 5468 6520 6e61 6d65 206f 6620 7468  : The name of th
-0001baa0: 6520 7072 6f6a 6563 742e 0a20 2020 2020  e project..     
-0001bab0: 2020 203a 7061 7261 6d20 656e 6470 6f69     :param endpoi
-0001bac0: 6e74 5f69 643a 2054 6865 2069 6420 6f66  nt_id: The id of
-0001bad0: 2074 6865 2065 6e64 706f 696e 742e 0a20   the endpoint.. 
-0001bae0: 2020 2020 2020 203a 7061 7261 6d20 6d6f         :param mo
-0001baf0: 6465 6c5f 656e 6470 6f69 6e74 3a20 416e  del_endpoint: An
-0001bb00: 206f 626a 6563 7420 7265 7072 6573 656e   object represen
-0001bb10: 7469 6e67 2074 6865 206d 6f64 656c 2065  ting the model e
-0001bb20: 6e64 706f 696e 742e 0a20 2020 2020 2020  ndpoint..       
-0001bb30: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
-0001bb40: 2069 7369 6e73 7461 6e63 6528 0a20 2020   isinstance(.   
-0001bb50: 2020 2020 2020 2020 206d 6f64 656c 5f65           model_e
-0001bb60: 6e64 706f 696e 742c 206d 6c72 756e 2e6d  ndpoint, mlrun.m
-0001bb70: 6f64 656c 5f6d 6f6e 6974 6f72 696e 672e  odel_monitoring.
-0001bb80: 6d6f 6465 6c5f 656e 6470 6f69 6e74 2e4d  model_endpoint.M
-0001bb90: 6f64 656c 456e 6470 6f69 6e74 0a20 2020  odelEndpoint.   
-0001bba0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-0001bbb0: 2020 2020 6d6f 6465 6c5f 656e 6470 6f69      model_endpoi
-0001bbc0: 6e74 203d 206d 6f64 656c 5f65 6e64 706f  nt = model_endpo
-0001bbd0: 696e 742e 746f 5f64 6963 7428 290a 0a20  int.to_dict().. 
-0001bbe0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-0001bbf0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-0001bc00: 747d 2f6d 6f64 656c 2d65 6e64 706f 696e  t}/model-endpoin
-0001bc10: 7473 2f7b 656e 6470 6f69 6e74 5f69 647d  ts/{endpoint_id}
-0001bc20: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
-0001bc30: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
-0001bc40: 2020 2020 206d 6574 686f 643d 2250 4f53       method="POS
-0001bc50: 5422 2c0a 2020 2020 2020 2020 2020 2020  T",.            
-0001bc60: 7061 7468 3d70 6174 682c 0a20 2020 2020  path=path,.     
-0001bc70: 2020 2020 2020 2062 6f64 793d 6469 6374         body=dict
-0001bc80: 5f74 6f5f 6a73 6f6e 286d 6f64 656c 5f65  _to_json(model_e
-0001bc90: 6e64 706f 696e 7429 2c0a 2020 2020 2020  ndpoint),.      
-0001bca0: 2020 290a 0a20 2020 2064 6566 2064 656c    )..    def del
-0001bcb0: 6574 655f 6d6f 6465 6c5f 656e 6470 6f69  ete_model_endpoi
-0001bcc0: 6e74 280a 2020 2020 2020 2020 7365 6c66  nt(.        self
-0001bcd0: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
-0001bce0: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
-0001bcf0: 656e 6470 6f69 6e74 5f69 643a 2073 7472  endpoint_id: str
-0001bd00: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-0001bd10: 2022 2222 0a20 2020 2020 2020 2044 656c   """.        Del
-0001bd20: 6574 6573 2074 6865 2044 4220 7265 636f  etes the DB reco
-0001bd30: 7264 206f 6620 6120 6769 7665 6e20 6d6f  rd of a given mo
-0001bd40: 6465 6c20 656e 6470 6f69 6e74 2c20 7072  del endpoint, pr
-0001bd50: 6f6a 6563 7420 616e 6420 656e 6470 6f69  oject and endpoi
-0001bd60: 6e74 5f69 6420 6172 6520 7573 6564 2066  nt_id are used f
-0001bd70: 6f72 206c 6f6f 6b75 700a 0a20 2020 2020  or lookup..     
-0001bd80: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-0001bd90: 743a 2054 6865 206e 616d 6520 6f66 2074  t: The name of t
-0001bda0: 6865 2070 726f 6a65 6374 0a20 2020 2020  he project.     
-0001bdb0: 2020 203a 7061 7261 6d20 656e 6470 6f69     :param endpoi
-0001bdc0: 6e74 5f69 643a 2054 6865 2069 6420 6f66  nt_id: The id of
-0001bdd0: 2074 6865 2065 6e64 706f 696e 740a 2020   the endpoint.  
-0001bde0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-0001bdf0: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
-0001be00: 6563 7473 2f7b 7072 6f6a 6563 747d 2f6d  ects/{project}/m
-0001be10: 6f64 656c 2d65 6e64 706f 696e 7473 2f7b  odel-endpoints/{
-0001be20: 656e 6470 6f69 6e74 5f69 647d 220a 2020  endpoint_id}".  
-0001be30: 2020 2020 2020 7365 6c66 2e61 7069 5f63        self.api_c
-0001be40: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
-0001be50: 206d 6574 686f 643d 2244 454c 4554 4522   method="DELETE"
-0001be60: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-0001be70: 7468 3d70 6174 682c 0a20 2020 2020 2020  th=path,.       
-0001be80: 2029 0a0a 2020 2020 6465 6620 6c69 7374   )..    def list
-0001be90: 5f6d 6f64 656c 5f65 6e64 706f 696e 7473  _model_endpoints
-0001bea0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0001beb0: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
-0001bec0: 2073 7472 2c0a 2020 2020 2020 2020 6d6f   str,.        mo
-0001bed0: 6465 6c3a 204f 7074 696f 6e61 6c5b 7374  del: Optional[st
-0001bee0: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
-0001bef0: 2020 2066 756e 6374 696f 6e3a 204f 7074     function: Opt
-0001bf00: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-0001bf10: 652c 0a20 2020 2020 2020 206c 6162 656c  e,.        label
-0001bf20: 733a 204c 6973 745b 7374 725d 203d 204e  s: List[str] = N
-0001bf30: 6f6e 652c 0a20 2020 2020 2020 2073 7461  one,.        sta
-0001bf40: 7274 3a20 7374 7220 3d20 226e 6f77 2d31  rt: str = "now-1
-0001bf50: 6822 2c0a 2020 2020 2020 2020 656e 643a  h",.        end:
-0001bf60: 2073 7472 203d 2022 6e6f 7722 2c0a 2020   str = "now",.  
-0001bf70: 2020 2020 2020 6d65 7472 6963 733a 204f        metrics: O
-0001bf80: 7074 696f 6e61 6c5b 4c69 7374 5b73 7472  ptional[List[str
-0001bf90: 5d5d 203d 204e 6f6e 652c 0a20 2020 2020  ]] = None,.     
-0001bfa0: 2020 2074 6f70 5f6c 6576 656c 3a20 626f     top_level: bo
-0001bfb0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-0001bfc0: 2020 2020 7569 6473 3a20 4f70 7469 6f6e      uids: Option
-0001bfd0: 616c 5b4c 6973 745b 7374 725d 5d20 3d20  al[List[str]] = 
-0001bfe0: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 204c  None,.    ) -> L
-0001bff0: 6973 745b 6d6c 7275 6e2e 6d6f 6465 6c5f  ist[mlrun.model_
-0001c000: 6d6f 6e69 746f 7269 6e67 2e6d 6f64 656c  monitoring.model
-0001c010: 5f65 6e64 706f 696e 742e 4d6f 6465 6c45  _endpoint.ModelE
-0001c020: 6e64 706f 696e 745d 3a0a 2020 2020 2020  ndpoint]:.      
-0001c030: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-0001c040: 7475 726e 7320 6120 6c69 7374 206f 6620  turns a list of 
-0001c050: 604d 6f64 656c 456e 6470 6f69 6e74 6020  `ModelEndpoint` 
-0001c060: 6f62 6a65 6374 732e 2045 6163 6820 604d  objects. Each `M
-0001c070: 6f64 656c 456e 6470 6f69 6e74 6020 6f62  odelEndpoint` ob
-0001c080: 6a65 6374 2072 6570 7265 7365 6e74 7320  ject represents 
-0001c090: 7468 6520 6375 7272 656e 7420 7374 6174  the current stat
-0001c0a0: 6520 6f66 2061 0a20 2020 2020 2020 206d  e of a.        m
-0001c0b0: 6f64 656c 2065 6e64 706f 696e 742e 2054  odel endpoint. T
-0001c0c0: 6869 7320 6675 6e63 7469 6f6e 7320 7375  his functions su
-0001c0d0: 7070 6f72 7473 2066 696c 7465 7269 6e67  pports filtering
-0001c0e0: 2062 7920 7468 6520 666f 6c6c 6f77 696e   by the followin
-0001c0f0: 6720 7061 7261 6d65 7465 7273 3a0a 2020  g parameters:.  
-0001c100: 2020 2020 2020 3129 206d 6f64 656c 0a20        1) model. 
-0001c110: 2020 2020 2020 2032 2920 6675 6e63 7469         2) functi
-0001c120: 6f6e 0a20 2020 2020 2020 2033 2920 6c61  on.        3) la
-0001c130: 6265 6c73 0a20 2020 2020 2020 2034 2920  bels.        4) 
-0001c140: 746f 7020 6c65 7665 6c0a 2020 2020 2020  top level.      
-0001c150: 2020 3529 2075 6964 730a 2020 2020 2020    5) uids.      
-0001c160: 2020 4279 2064 6566 6175 6c74 2c20 7768    By default, wh
-0001c170: 656e 206e 6f20 6669 6c74 6572 7320 6172  en no filters ar
-0001c180: 6520 6170 706c 6965 642c 2061 6c6c 2061  e applied, all a
-0001c190: 7661 696c 6162 6c65 2065 6e64 706f 696e  vailable endpoin
-0001c1a0: 7473 2066 6f72 2074 6865 2067 6976 656e  ts for the given
-0001c1b0: 2070 726f 6a65 6374 2077 696c 6c20 6265   project will be
-0001c1c0: 206c 6973 7465 642e 0a0a 2020 2020 2020   listed...      
-0001c1d0: 2020 496e 2061 6464 6974 696f 6e2c 2074    In addition, t
-0001c1e0: 6869 7320 6675 6e63 7469 6f6e 7320 7072  his functions pr
-0001c1f0: 6f76 6964 6573 2061 2066 6163 6164 6520  ovides a facade 
-0001c200: 666f 7220 6c69 7374 696e 6720 656e 6470  for listing endp
-0001c210: 6f69 6e74 2072 656c 6174 6564 206d 6574  oint related met
-0001c220: 7269 6373 2e20 5468 6973 2066 6163 6164  rics. This facad
-0001c230: 6520 6973 2074 696d 652d 6261 7365 640a  e is time-based.
-0001c240: 2020 2020 2020 2020 616e 6420 6465 7065          and depe
-0001c250: 6e64 7320 6f6e 2074 6865 2027 7374 6172  nds on the 'star
-0001c260: 7427 2061 6e64 2027 656e 6427 2070 6172  t' and 'end' par
-0001c270: 616d 6574 6572 732e 2042 7920 6465 6661  ameters. By defa
-0001c280: 756c 742c 2077 6865 6e20 7468 6520 6d65  ult, when the me
-0001c290: 7472 6963 7320 7061 7261 6d65 7465 7220  trics parameter 
-0001c2a0: 6973 204e 6f6e 652c 206e 6f20 6d65 7472  is None, no metr
-0001c2b0: 6963 7320 6172 650a 2020 2020 2020 2020  ics are.        
-0001c2c0: 6164 6465 6420 746f 2074 6865 206f 7574  added to the out
-0001c2d0: 7075 7420 6f66 2074 6869 7320 6675 6e63  put of this func
-0001c2e0: 7469 6f6e 2e0a 0a20 2020 2020 2020 203a  tion...        :
-0001c2f0: 7061 7261 6d20 7072 6f6a 6563 743a 2054  param project: T
-0001c300: 6865 206e 616d 6520 6f66 2074 6865 2070  he name of the p
-0001c310: 726f 6a65 6374 0a20 2020 2020 2020 203a  roject.        :
-0001c320: 7061 7261 6d20 6d6f 6465 6c3a 2054 6865  param model: The
-0001c330: 206e 616d 6520 6f66 2074 6865 206d 6f64   name of the mod
-0001c340: 656c 2074 6f20 6669 6c74 6572 2062 790a  el to filter by.
-0001c350: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
-0001c360: 756e 6374 696f 6e3a 2054 6865 206e 616d  unction: The nam
-0001c370: 6520 6f66 2074 6865 2066 756e 6374 696f  e of the functio
-0001c380: 6e20 746f 2066 696c 7465 7220 6279 0a20  n to filter by. 
-0001c390: 2020 2020 2020 203a 7061 7261 6d20 6c61         :param la
-0001c3a0: 6265 6c73 3a20 4120 6c69 7374 206f 6620  bels: A list of 
-0001c3b0: 6c61 6265 6c73 2074 6f20 6669 6c74 6572  labels to filter
-0001c3c0: 2062 792e 204c 6162 656c 2066 696c 7465   by. Label filte
-0001c3d0: 7273 2077 6f72 6b20 6279 2065 6974 6865  rs work by eithe
-0001c3e0: 7220 6669 6c74 6572 696e 6720 6120 7370  r filtering a sp
-0001c3f0: 6563 6966 6963 2076 616c 7565 206f 6620  ecific value of 
-0001c400: 610a 2020 2020 2020 2020 206c 6162 656c  a.         label
-0001c410: 2028 692e 652e 206c 6973 7428 226b 6579   (i.e. list("key
-0001c420: 3d76 616c 7565 2229 2920 6f72 2062 7920  =value")) or by 
-0001c430: 6c6f 6f6b 696e 6720 666f 7220 7468 6520  looking for the 
-0001c440: 6578 6973 7465 6e63 6520 6f66 2061 2067  existence of a g
-0001c450: 6976 656e 206b 6579 2028 692e 652e 2022  iven key (i.e. "
-0001c460: 6b65 7922 290a 2020 2020 2020 2020 3a70  key").        :p
-0001c470: 6172 616d 206d 6574 7269 6373 3a20 4120  aram metrics: A 
-0001c480: 6c69 7374 206f 6620 6d65 7472 6963 7320  list of metrics 
-0001c490: 746f 2072 6574 7572 6e20 666f 7220 6561  to return for ea
-0001c4a0: 6368 2065 6e64 706f 696e 742c 2072 6561  ch endpoint, rea
-0001c4b0: 6420 6d6f 7265 2069 6e20 2754 696d 654d  d more in 'TimeM
-0001c4c0: 6574 7269 6327 0a20 2020 2020 2020 203a  etric'.        :
-0001c4d0: 7061 7261 6d20 7374 6172 743a 2054 6865  param start: The
-0001c4e0: 2073 7461 7274 2074 696d 6520 6f66 2074   start time of t
-0001c4f0: 6865 206d 6574 7269 6373 2e20 4361 6e20  he metrics. Can 
-0001c500: 6265 2072 6570 7265 7365 6e74 6564 2062  be represented b
-0001c510: 7920 6120 7374 7269 6e67 2063 6f6e 7461  y a string conta
-0001c520: 696e 696e 6720 616e 2052 4643 2033 3333  ining an RFC 333
-0001c530: 390a 2020 2020 2020 2020 2020 2020 2020  9.              
-0001c540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c550: 2020 2074 696d 652c 2061 2055 6e69 7820     time, a Unix 
-0001c560: 7469 6d65 7374 616d 7020 696e 206d 696c  timestamp in mil
-0001c570: 6c69 7365 636f 6e64 732c 2061 2072 656c  liseconds, a rel
-0001c580: 6174 6976 6520 7469 6d65 2028 6027 6e6f  ative time (`'no
-0001c590: 7727 6020 6f72 0a20 2020 2020 2020 2020  w'` or.         
-0001c5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c5b0: 2020 2020 2020 2020 6027 6e6f 772d 5b30          `'now-[0
-0001c5c0: 2d39 5d2b 5b6d 6864 5d27 602c 2077 6865  -9]+[mhd]'`, whe
-0001c5d0: 7265 2060 6d60 203d 206d 696e 7574 6573  re `m` = minutes
-0001c5e0: 2c20 6068 6020 3d20 686f 7572 732c 2061  , `h` = hours, a
-0001c5f0: 6e64 2060 2764 2760 203d 0a20 2020 2020  nd `'d'` =.     
-0001c600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c610: 2020 2020 2020 2020 2020 2020 6461 7973              days
-0001c620: 292c 206f 7220 3020 666f 7220 7468 6520  ), or 0 for the 
-0001c630: 6561 726c 6965 7374 2074 696d 652e 0a20  earliest time.. 
-0001c640: 2020 2020 2020 203a 7061 7261 6d20 656e         :param en
-0001c650: 643a 2054 6865 2065 6e64 2074 696d 6520  d: The end time 
-0001c660: 6f66 2074 6865 206d 6574 7269 6373 2e20  of the metrics. 
-0001c670: 4361 6e20 6265 2072 6570 7265 7365 6e74  Can be represent
-0001c680: 6564 2062 7920 6120 7374 7269 6e67 2063  ed by a string c
-0001c690: 6f6e 7461 696e 696e 6720 616e 2052 4643  ontaining an RFC
-0001c6a0: 2033 3333 390a 2020 2020 2020 2020 2020   3339.          
-0001c6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c6c0: 2020 2020 2020 2074 696d 652c 2061 2055         time, a U
-0001c6d0: 6e69 7820 7469 6d65 7374 616d 7020 696e  nix timestamp in
-0001c6e0: 206d 696c 6c69 7365 636f 6e64 732c 2061   milliseconds, a
-0001c6f0: 2072 656c 6174 6976 6520 7469 6d65 2028   relative time (
-0001c700: 6027 6e6f 7727 6020 6f72 0a20 2020 2020  `'now'` or.     
-0001c710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c720: 2020 2020 2020 2020 2020 2020 6027 6e6f              `'no
-0001c730: 772d 5b30 2d39 5d2b 5b6d 6864 5d27 602c  w-[0-9]+[mhd]'`,
-0001c740: 2077 6865 7265 2060 6d60 203d 206d 696e   where `m` = min
-0001c750: 7574 6573 2c20 6068 6020 3d20 686f 7572  utes, `h` = hour
-0001c760: 732c 2061 6e64 2060 2764 2760 203d 0a20  s, and `'d'` =. 
-0001c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000db50: 7265 7370 2e68 6561 6465 7273 2e67 6574  resp.headers.get
+0000db60: 2822 782d 6d6c 7275 6e2d 6c61 7374 2d74  ("x-mlrun-last-t
+0000db70: 696d 6573 7461 6d70 222c 2022 302e 3022  imestamp", "0.0"
+0000db80: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+0000db90: 2020 2020 2020 2020 2020 2020 6966 2066              if f
+0000dba0: 756e 632e 6b69 6e64 2069 6e20 6d6c 7275  unc.kind in mlru
+0000dbb0: 6e2e 7275 6e74 696d 6573 2e52 756e 7469  n.runtimes.Runti
+0000dbc0: 6d65 4b69 6e64 732e 6e75 636c 696f 5f72  meKinds.nuclio_r
+0000dbd0: 756e 7469 6d65 7328 293a 0a20 2020 2020  untimes():.     
+0000dbe0: 2020 2020 2020 2020 2020 2066 756e 632e             func.
+0000dbf0: 7374 6174 7573 2e61 6464 7265 7373 203d  status.address =
+0000dc00: 2072 6573 702e 6865 6164 6572 732e 6765   resp.headers.ge
+0000dc10: 7428 2278 2d6d 6c72 756e 2d61 6464 7265  t("x-mlrun-addre
+0000dc20: 7373 222c 2022 2229 0a20 2020 2020 2020  ss", "").       
+0000dc30: 2020 2020 2020 2020 2066 756e 632e 7374           func.st
+0000dc40: 6174 7573 2e6e 7563 6c69 6f5f 6e61 6d65  atus.nuclio_name
+0000dc50: 203d 2072 6573 702e 6865 6164 6572 732e   = resp.headers.
+0000dc60: 6765 7428 2278 2d6d 6c72 756e 2d6e 616d  get("x-mlrun-nam
+0000dc70: 6522 2c20 2222 290a 2020 2020 2020 2020  e", "").        
+0000dc80: 2020 2020 2020 2020 6675 6e63 2e73 7461          func.sta
+0000dc90: 7475 732e 696e 7465 726e 616c 5f69 6e76  tus.internal_inv
+0000dca0: 6f63 6174 696f 6e5f 7572 6c73 203d 2072  ocation_urls = r
+0000dcb0: 6573 702e 6865 6164 6572 732e 6765 7428  esp.headers.get(
+0000dcc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000dcd0: 2020 2020 2022 782d 6d6c 7275 6e2d 696e       "x-mlrun-in
+0000dce0: 7465 726e 616c 2d69 6e76 6f63 6174 696f  ternal-invocatio
+0000dcf0: 6e2d 7572 6c73 222c 2022 220a 2020 2020  n-urls", "".    
+0000dd00: 2020 2020 2020 2020 2020 2020 292e 7370              ).sp
+0000dd10: 6c69 7428 222c 2229 0a20 2020 2020 2020  lit(",").       
+0000dd20: 2020 2020 2020 2020 2066 756e 632e 7374           func.st
+0000dd30: 6174 7573 2e65 7874 6572 6e61 6c5f 696e  atus.external_in
+0000dd40: 766f 6361 7469 6f6e 5f75 726c 7320 3d20  vocation_urls = 
+0000dd50: 7265 7370 2e68 6561 6465 7273 2e67 6574  resp.headers.get
+0000dd60: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000dd70: 2020 2020 2020 2278 2d6d 6c72 756e 2d65        "x-mlrun-e
+0000dd80: 7874 6572 6e61 6c2d 696e 766f 6361 7469  xternal-invocati
+0000dd90: 6f6e 2d75 726c 7322 2c20 2222 0a20 2020  on-urls", "".   
+0000dda0: 2020 2020 2020 2020 2020 2020 2029 2e73               ).s
+0000ddb0: 706c 6974 2822 2c22 290a 2020 2020 2020  plit(",").      
+0000ddc0: 2020 2020 2020 2020 2020 6675 6e63 2e73            func.s
+0000ddd0: 7461 7475 732e 636f 6e74 6169 6e65 725f  tatus.container_
+0000dde0: 696d 6167 6520 3d20 7265 7370 2e68 6561  image = resp.hea
+0000ddf0: 6465 7273 2e67 6574 280a 2020 2020 2020  ders.get(.      
+0000de00: 2020 2020 2020 2020 2020 2020 2020 2278                "x
+0000de10: 2d6d 6c72 756e 2d63 6f6e 7461 696e 6572  -mlrun-container
+0000de20: 2d69 6d61 6765 222c 2022 220a 2020 2020  -image", "".    
+0000de30: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000de40: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0000de50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000de60: 6675 6e63 2e73 7461 7475 732e 6275 696c  func.status.buil
+0000de70: 645f 706f 6420 3d20 7265 7370 2e68 6561  d_pod = resp.hea
+0000de80: 6465 7273 2e67 6574 2822 6275 696c 6465  ders.get("builde
+0000de90: 725f 706f 6422 2c20 2222 290a 2020 2020  r_pod", "").    
+0000dea0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+0000deb0: 2e73 7065 632e 696d 6167 6520 3d20 7265  .spec.image = re
+0000dec0: 7370 2e68 6561 6465 7273 2e67 6574 2822  sp.headers.get("
+0000ded0: 6675 6e63 7469 6f6e 5f69 6d61 6765 222c  function_image",
+0000dee0: 2022 2229 0a0a 2020 2020 2020 2020 7465   "")..        te
+0000def0: 7874 203d 2022 220a 2020 2020 2020 2020  xt = "".        
+0000df00: 6966 2072 6573 702e 636f 6e74 656e 743a  if resp.content:
+0000df10: 0a20 2020 2020 2020 2020 2020 2074 6578  .            tex
+0000df20: 7420 3d20 7265 7370 2e63 6f6e 7465 6e74  t = resp.content
+0000df30: 2e64 6563 6f64 6528 290a 2020 2020 2020  .decode().      
+0000df40: 2020 7265 7475 726e 2074 6578 742c 206c    return text, l
+0000df50: 6173 745f 6c6f 675f 7469 6d65 7374 616d  ast_log_timestam
+0000df60: 700a 0a20 2020 2064 6566 2073 7461 7274  p..    def start
+0000df70: 5f66 756e 6374 696f 6e28 0a20 2020 2020  _function(.     
+0000df80: 2020 2073 656c 662c 2066 756e 635f 7572     self, func_ur
+0000df90: 6c3a 2073 7472 203d 204e 6f6e 652c 2066  l: str = None, f
+0000dfa0: 756e 6374 696f 6e3a 2022 6d6c 7275 6e2e  unction: "mlrun.
+0000dfb0: 7275 6e74 696d 6573 2e42 6173 6552 756e  runtimes.BaseRun
+0000dfc0: 7469 6d65 2220 3d20 4e6f 6e65 0a20 2020  time" = None.   
+0000dfd0: 2029 202d 3e20 6d6c 7275 6e2e 636f 6d6d   ) -> mlrun.comm
+0000dfe0: 6f6e 2e73 6368 656d 6173 2e42 6163 6b67  on.schemas.Backg
+0000dff0: 726f 756e 6454 6173 6b3a 0a20 2020 2020  roundTask:.     
+0000e000: 2020 2022 2222 4578 6563 7574 6520 6120     """Execute a 
+0000e010: 6675 6e63 7469 6f6e 2072 656d 6f74 656c  function remotel
+0000e020: 792c 2055 7365 6420 666f 7220 6060 6461  y, Used for ``da
+0000e030: 736b 6060 2066 756e 6374 696f 6e73 2e0a  sk`` functions..
+0000e040: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000e050: 6675 6e63 5f75 726c 3a20 5552 4c20 746f  func_url: URL to
+0000e060: 2074 6865 2066 756e 6374 696f 6e20 746f   the function to
+0000e070: 2062 6520 6578 6563 7574 6564 2e0a 2020   be executed..  
+0000e080: 2020 2020 2020 3a70 6172 616d 2066 756e        :param fun
+0000e090: 6374 696f 6e3a 2054 6865 2066 756e 6374  ction: The funct
+0000e0a0: 696f 6e20 6f62 6a65 6374 2074 6f20 7374  ion object to st
+0000e0b0: 6172 742c 206e 6f74 206e 6565 6465 6420  art, not needed 
+0000e0c0: 6865 7265 2e0a 2020 2020 2020 2020 3a72  here..        :r
+0000e0d0: 6574 7572 6e73 3a20 4120 4261 636b 6772  eturns: A Backgr
+0000e0e0: 6f75 6e64 5461 736b 206f 626a 6563 742c  oundTask object,
+0000e0f0: 2077 6974 6820 6465 7461 696c 7320 6f6e   with details on
+0000e100: 2065 7865 6375 7469 6f6e 2070 726f 6365   execution proce
+0000e110: 7373 2061 6e64 2069 7473 2073 7461 7475  ss and its statu
+0000e120: 732e 0a20 2020 2020 2020 2022 2222 0a0a  s..        """..
+0000e130: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+0000e140: 2020 2020 2020 2020 2072 6571 203d 207b           req = {
+0000e150: 2266 756e 6374 696f 6e55 726c 223a 2066  "functionUrl": f
+0000e160: 756e 635f 7572 6c7d 0a20 2020 2020 2020  unc_url}.       
+0000e170: 2020 2020 2072 6573 7020 3d20 7365 6c66       resp = self
+0000e180: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
+0000e190: 2020 2020 2020 2020 2020 2022 504f 5354             "POST
+0000e1a0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0000e1b0: 2020 2022 7374 6172 742f 6675 6e63 7469     "start/functi
+0000e1c0: 6f6e 222c 0a20 2020 2020 2020 2020 2020  on",.           
+0000e1d0: 2020 2020 206a 736f 6e3d 7265 712c 0a20       json=req,. 
+0000e1e0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0000e1f0: 696d 656f 7574 3d69 6e74 2863 6f6e 6669  imeout=int(confi
+0000e200: 672e 7375 626d 6974 5f74 696d 656f 7574  g.submit_timeout
+0000e210: 2920 6f72 2036 302c 0a20 2020 2020 2020  ) or 60,.       
+0000e220: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+0000e230: 7863 6570 7420 4f53 4572 726f 7220 6173  xcept OSError as
+0000e240: 2065 7272 3a0a 2020 2020 2020 2020 2020   err:.          
+0000e250: 2020 6c6f 6767 6572 2e65 7272 6f72 2866    logger.error(f
+0000e260: 2265 7272 6f72 2073 7461 7274 696e 6720  "error starting 
+0000e270: 6675 6e63 7469 6f6e 3a20 7b65 7272 5f74  function: {err_t
+0000e280: 6f5f 7374 7228 6572 7229 7d22 290a 2020  o_str(err)}").  
+0000e290: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000e2a0: 4f53 4572 726f 7228 6622 6572 726f 723a  OSError(f"error:
+0000e2b0: 2063 616e 6e6f 7420 7374 6172 7420 6675   cannot start fu
+0000e2c0: 6e63 7469 6f6e 2c20 7b65 7272 5f74 6f5f  nction, {err_to_
+0000e2d0: 7374 7228 6572 7229 7d22 290a 0a20 2020  str(err)}")..   
+0000e2e0: 2020 2020 2069 6620 6e6f 7420 7265 7370       if not resp
+0000e2f0: 2e6f 6b3a 0a20 2020 2020 2020 2020 2020  .ok:.           
+0000e300: 206c 6f67 6765 722e 6572 726f 7228 6622   logger.error(f"
+0000e310: 6261 6420 7265 7370 2121 5c6e 7b72 6573  bad resp!!\n{res
+0000e320: 702e 7465 7874 7d22 290a 2020 2020 2020  p.text}").      
+0000e330: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0000e340: 6545 7272 6f72 2822 6261 6420 6675 6e63  eError("bad func
+0000e350: 7469 6f6e 2073 7461 7274 2072 6573 706f  tion start respo
+0000e360: 6e73 6522 290a 0a20 2020 2020 2020 2072  nse")..        r
+0000e370: 6574 7572 6e20 6d6c 7275 6e2e 636f 6d6d  eturn mlrun.comm
+0000e380: 6f6e 2e73 6368 656d 6173 2e42 6163 6b67  on.schemas.Backg
+0000e390: 726f 756e 6454 6173 6b28 2a2a 7265 7370  roundTask(**resp
+0000e3a0: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
+0000e3b0: 6620 6765 745f 7072 6f6a 6563 745f 6261  f get_project_ba
+0000e3c0: 636b 6772 6f75 6e64 5f74 6173 6b28 0a20  ckground_task(. 
+0000e3d0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0000e3e0: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
+0000e3f0: 722c 0a20 2020 2020 2020 206e 616d 653a  r,.        name:
+0000e400: 2073 7472 2c0a 2020 2020 2920 2d3e 206d   str,.    ) -> m
+0000e410: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0000e420: 6d61 732e 4261 636b 6772 6f75 6e64 5461  mas.BackgroundTa
+0000e430: 736b 3a0a 2020 2020 2020 2020 2222 2252  sk:.        """R
+0000e440: 6574 7269 6576 6520 7570 6461 7465 6420  etrieve updated 
+0000e450: 696e 666f 726d 6174 696f 6e20 6f6e 2061  information on a
+0000e460: 2070 726f 6a65 6374 2062 6163 6b67 726f   project backgro
+0000e470: 756e 6420 7461 736b 2062 6569 6e67 2065  und task being e
+0000e480: 7865 6375 7465 642e 2222 220a 0a20 2020  xecuted."""..   
+0000e490: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
+0000e4a0: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
+0000e4b0: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
+0000e4c0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+0000e4d0: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+0000e4e0: 6563 747d 2f62 6163 6b67 726f 756e 642d  ect}/background-
+0000e4f0: 7461 736b 732f 7b6e 616d 657d 220a 2020  tasks/{name}".  
+0000e500: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+0000e510: 6167 6520 3d20 280a 2020 2020 2020 2020  age = (.        
+0000e520: 2020 2020 6622 4661 696c 6564 2067 6574      f"Failed get
+0000e530: 7469 6e67 2070 726f 6a65 6374 2062 6163  ting project bac
+0000e540: 6b67 726f 756e 6420 7461 736b 2e20 7072  kground task. pr
+0000e550: 6f6a 6563 743d 7b70 726f 6a65 6374 7d2c  oject={project},
+0000e560: 206e 616d 653d 7b6e 616d 657d 220a 2020   name={name}".  
+0000e570: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000e580: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
+0000e590: 6170 695f 6361 6c6c 2822 4745 5422 2c20  api_call("GET", 
+0000e5a0: 7061 7468 2c20 6572 726f 725f 6d65 7373  path, error_mess
+0000e5b0: 6167 6529 0a20 2020 2020 2020 2072 6574  age).        ret
+0000e5c0: 7572 6e20 6d6c 7275 6e2e 636f 6d6d 6f6e  urn mlrun.common
+0000e5d0: 2e73 6368 656d 6173 2e42 6163 6b67 726f  .schemas.Backgro
+0000e5e0: 756e 6454 6173 6b28 2a2a 7265 7370 6f6e  undTask(**respon
+0000e5f0: 7365 2e6a 736f 6e28 2929 0a0a 2020 2020  se.json())..    
+0000e600: 6465 6620 6765 745f 6261 636b 6772 6f75  def get_backgrou
+0000e610: 6e64 5f74 6173 6b28 7365 6c66 2c20 6e61  nd_task(self, na
+0000e620: 6d65 3a20 7374 7229 202d 3e20 6d6c 7275  me: str) -> mlru
+0000e630: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0000e640: 2e42 6163 6b67 726f 756e 6454 6173 6b3a  .BackgroundTask:
+0000e650: 0a20 2020 2020 2020 2022 2222 5265 7472  .        """Retr
+0000e660: 6965 7665 2075 7064 6174 6564 2069 6e66  ieve updated inf
+0000e670: 6f72 6d61 7469 6f6e 206f 6e20 6120 6261  ormation on a ba
+0000e680: 636b 6772 6f75 6e64 2074 6173 6b20 6265  ckground task be
+0000e690: 696e 6720 6578 6563 7574 6564 2e22 2222  ing executed."""
+0000e6a0: 0a0a 2020 2020 2020 2020 7061 7468 203d  ..        path =
+0000e6b0: 2066 2262 6163 6b67 726f 756e 642d 7461   f"background-ta
+0000e6c0: 736b 732f 7b6e 616d 657d 220a 2020 2020  sks/{name}".    
+0000e6d0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+0000e6e0: 6520 3d20 6622 4661 696c 6564 2067 6574  e = f"Failed get
+0000e6f0: 7469 6e67 2062 6163 6b67 726f 756e 6420  ting background 
+0000e700: 7461 736b 2e20 6e61 6d65 3d7b 6e61 6d65  task. name={name
+0000e710: 7d22 0a20 2020 2020 2020 2072 6573 706f  }".        respo
+0000e720: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
+0000e730: 616c 6c28 2247 4554 222c 2070 6174 682c  all("GET", path,
+0000e740: 2065 7272 6f72 5f6d 6573 7361 6765 290a   error_message).
+0000e750: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+0000e760: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0000e770: 6d61 732e 4261 636b 6772 6f75 6e64 5461  mas.BackgroundTa
+0000e780: 736b 282a 2a72 6573 706f 6e73 652e 6a73  sk(**response.js
+0000e790: 6f6e 2829 290a 0a20 2020 2064 6566 2066  on())..    def f
+0000e7a0: 756e 6374 696f 6e5f 7374 6174 7573 2873  unction_status(s
+0000e7b0: 656c 662c 2070 726f 6a65 6374 2c20 6e61  elf, project, na
+0000e7c0: 6d65 2c20 6b69 6e64 2c20 7365 6c65 6374  me, kind, select
+0000e7d0: 6f72 293a 0a20 2020 2020 2020 2022 2222  or):.        """
+0000e7e0: 5265 7472 6965 7665 2073 7461 7475 7320  Retrieve status 
+0000e7f0: 6f66 2061 2066 756e 6374 696f 6e20 6265  of a function be
+0000e800: 696e 6720 6578 6563 7574 6564 2072 656d  ing executed rem
+0000e810: 6f74 656c 7920 2872 656c 6576 616e 7420  otely (relevant 
+0000e820: 746f 2060 6064 6173 6b60 6020 6675 6e63  to ``dask`` func
+0000e830: 7469 6f6e 7329 2e0a 0a20 2020 2020 2020  tions)...       
+0000e840: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
+0000e850: 2020 2020 2054 6865 2070 726f 6a65 6374       The project
+0000e860: 206f 6620 7468 6520 6675 6e63 7469 6f6e   of the function
+0000e870: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000e880: 6e61 6d65 3a20 2020 2020 2020 2054 6865  name:        The
+0000e890: 206e 616d 6520 6f66 2074 6865 2066 756e   name of the fun
+0000e8a0: 6374 696f 6e0a 2020 2020 2020 2020 3a70  ction.        :p
+0000e8b0: 6172 616d 206b 696e 643a 2020 2020 2020  aram kind:      
+0000e8c0: 2020 5468 6520 6b69 6e64 206f 6620 7468    The kind of th
+0000e8d0: 6520 6675 6e63 7469 6f6e 2c20 6375 7272  e function, curr
+0000e8e0: 656e 746c 7920 6060 6461 736b 6060 2069  ently ``dask`` i
+0000e8f0: 7320 7375 7070 6f72 7465 642e 0a20 2020  s supported..   
+0000e900: 2020 2020 203a 7061 7261 6d20 7365 6c65       :param sele
+0000e910: 6374 6f72 3a20 2020 2053 656c 6563 746f  ctor:    Selecto
+0000e920: 7220 636c 6175 7365 2074 6f20 6265 2061  r clause to be a
+0000e930: 7070 6c69 6564 2074 6f20 7468 6520 4b75  pplied to the Ku
+0000e940: 6265 726e 6574 6573 2073 7461 7475 7320  bernetes status 
+0000e950: 7175 6572 7920 746f 2066 696c 7465 7220  query to filter 
+0000e960: 7468 6520 7265 7375 6c74 732e 0a20 2020  the results..   
+0000e970: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+0000e980: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+0000e990: 2020 2072 6571 203d 207b 226b 696e 6422     req = {"kind"
+0000e9a0: 3a20 6b69 6e64 2c20 2273 656c 6563 746f  : kind, "selecto
+0000e9b0: 7222 3a20 7365 6c65 6374 6f72 2c20 2270  r": selector, "p
+0000e9c0: 726f 6a65 6374 223a 2070 726f 6a65 6374  roject": project
+0000e9d0: 2c20 226e 616d 6522 3a20 6e61 6d65 7d0a  , "name": name}.
+0000e9e0: 2020 2020 2020 2020 2020 2020 7265 7370              resp
+0000e9f0: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+0000ea00: 2822 504f 5354 222c 2022 7374 6174 7573  ("POST", "status
+0000ea10: 2f66 756e 6374 696f 6e22 2c20 6a73 6f6e  /function", json
+0000ea20: 3d72 6571 290a 2020 2020 2020 2020 6578  =req).        ex
+0000ea30: 6365 7074 204f 5345 7272 6f72 2061 7320  cept OSError as 
+0000ea40: 6572 723a 0a20 2020 2020 2020 2020 2020  err:.           
+0000ea50: 206c 6f67 6765 722e 6572 726f 7228 6622   logger.error(f"
+0000ea60: 6572 726f 7220 7374 6172 7469 6e67 2066  error starting f
+0000ea70: 756e 6374 696f 6e3a 207b 6572 725f 746f  unction: {err_to
+0000ea80: 5f73 7472 2865 7272 297d 2229 0a20 2020  _str(err)}").   
+0000ea90: 2020 2020 2020 2020 2072 6169 7365 204f           raise O
+0000eaa0: 5345 7272 6f72 2866 2265 7272 6f72 3a20  SError(f"error: 
+0000eab0: 6361 6e6e 6f74 2073 7461 7274 2066 756e  cannot start fun
+0000eac0: 6374 696f 6e2c 207b 6572 725f 746f 5f73  ction, {err_to_s
+0000ead0: 7472 2865 7272 297d 2229 0a0a 2020 2020  tr(err)}")..    
+0000eae0: 2020 2020 6966 206e 6f74 2072 6573 702e      if not resp.
+0000eaf0: 6f6b 3a0a 2020 2020 2020 2020 2020 2020  ok:.            
+0000eb00: 6c6f 6767 6572 2e65 7272 6f72 2866 2262  logger.error(f"b
+0000eb10: 6164 2072 6573 7021 215c 6e7b 7265 7370  ad resp!!\n{resp
+0000eb20: 2e74 6578 747d 2229 0a20 2020 2020 2020  .text}").       
+0000eb30: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0000eb40: 4572 726f 7228 2262 6164 2066 756e 6374  Error("bad funct
+0000eb50: 696f 6e20 7374 6174 7573 2072 6573 706f  ion status respo
+0000eb60: 6e73 6522 290a 0a20 2020 2020 2020 2072  nse")..        r
+0000eb70: 6574 7572 6e20 7265 7370 2e6a 736f 6e28  eturn resp.json(
+0000eb80: 295b 2264 6174 6122 5d0a 0a20 2020 2064  )["data"]..    d
+0000eb90: 6566 2073 7562 6d69 745f 6a6f 6228 0a20  ef submit_job(. 
+0000eba0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0000ebb0: 2020 2020 2072 756e 7370 6563 2c0a 2020       runspec,.  
+0000ebc0: 2020 2020 2020 7363 6865 6475 6c65 3a20        schedule: 
+0000ebd0: 556e 696f 6e5b 7374 722c 206d 6c72 756e  Union[str, mlrun
+0000ebe0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+0000ebf0: 5363 6865 6475 6c65 4372 6f6e 5472 6967  ScheduleCronTrig
+0000ec00: 6765 725d 203d 204e 6f6e 652c 0a20 2020  ger] = None,.   
+0000ec10: 2029 3a0a 2020 2020 2020 2020 2222 2253   ):.        """S
+0000ec20: 7562 6d69 7420 6120 6a6f 6220 666f 7220  ubmit a job for 
+0000ec30: 7265 6d6f 7465 2065 7865 6375 7469 6f6e  remote execution
+0000ec40: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0000ec50: 6d20 7275 6e73 7065 633a 2054 6865 2072  m runspec: The r
+0000ec60: 756e 7469 6d65 206f 626a 6563 7420 7370  untime object sp
+0000ec70: 6563 2028 5461 736b 2920 746f 2065 7865  ec (Task) to exe
+0000ec80: 6375 7465 2e0a 2020 2020 2020 2020 3a70  cute..        :p
+0000ec90: 6172 616d 2073 6368 6564 756c 653a 2057  aram schedule: W
+0000eca0: 6865 7468 6572 2074 6f20 7363 6865 6475  hether to schedu
+0000ecb0: 6c65 2074 6869 7320 6a6f 6220 7573 696e  le this job usin
+0000ecc0: 6720 6120 4372 6f6e 2074 7269 6767 6572  g a Cron trigger
+0000ecd0: 2e20 4966 206e 6f74 2073 7065 6369 6669  . If not specifi
+0000ece0: 6564 2c20 7468 6520 6a6f 6220 7769 6c6c  ed, the job will
+0000ecf0: 2062 6520 7375 626d 6974 7465 640a 2020   be submitted.  
+0000ed00: 2020 2020 2020 2020 2020 696d 6d65 6469            immedi
+0000ed10: 6174 656c 792e 0a20 2020 2020 2020 2022  ately..        "
+0000ed20: 2222 0a0a 2020 2020 2020 2020 7472 793a  ""..        try:
+0000ed30: 0a20 2020 2020 2020 2020 2020 2072 6571  .            req
+0000ed40: 203d 207b 2274 6173 6b22 3a20 7275 6e73   = {"task": runs
+0000ed50: 7065 632e 746f 5f64 6963 7428 297d 0a20  pec.to_dict()}. 
+0000ed60: 2020 2020 2020 2020 2020 2069 6620 7363             if sc
+0000ed70: 6865 6475 6c65 3a0a 2020 2020 2020 2020  hedule:.        
+0000ed80: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0000ed90: 7461 6e63 6528 7363 6865 6475 6c65 2c20  tance(schedule, 
+0000eda0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0000edb0: 656d 6173 2e53 6368 6564 756c 6543 726f  emas.ScheduleCro
+0000edc0: 6e54 7269 6767 6572 293a 0a20 2020 2020  nTrigger):.     
+0000edd0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000ede0: 6368 6564 756c 6520 3d20 7363 6865 6475  chedule = schedu
+0000edf0: 6c65 2e64 6963 7428 290a 2020 2020 2020  le.dict().      
+0000ee00: 2020 2020 2020 2020 2020 7265 715b 2273            req["s
+0000ee10: 6368 6564 756c 6522 5d20 3d20 7363 6865  chedule"] = sche
+0000ee20: 6475 6c65 0a20 2020 2020 2020 2020 2020  dule.           
+0000ee30: 2074 696d 656f 7574 203d 2028 696e 7428   timeout = (int(
+0000ee40: 636f 6e66 6967 2e73 7562 6d69 745f 7469  config.submit_ti
+0000ee50: 6d65 6f75 7429 206f 7220 3132 3029 202b  meout) or 120) +
+0000ee60: 2032 300a 2020 2020 2020 2020 2020 2020   20.            
+0000ee70: 7265 7370 203d 2073 656c 662e 6170 695f  resp = self.api_
+0000ee80: 6361 6c6c 2822 504f 5354 222c 2022 7375  call("POST", "su
+0000ee90: 626d 6974 5f6a 6f62 222c 206a 736f 6e3d  bmit_job", json=
+0000eea0: 7265 712c 2074 696d 656f 7574 3d74 696d  req, timeout=tim
+0000eeb0: 656f 7574 290a 0a20 2020 2020 2020 2065  eout)..        e
+0000eec0: 7863 6570 7420 7265 7175 6573 7473 2e48  xcept requests.H
+0000eed0: 5454 5045 7272 6f72 2061 7320 6572 723a  TTPError as err:
+0000eee0: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
+0000eef0: 6765 722e 6572 726f 7228 6622 6572 726f  ger.error(f"erro
+0000ef00: 7220 7375 626d 6974 7469 6e67 2074 6173  r submitting tas
+0000ef10: 6b3a 207b 6572 725f 746f 5f73 7472 2865  k: {err_to_str(e
+0000ef20: 7272 297d 2229 0a20 2020 2020 2020 2020  rr)}").         
+0000ef30: 2020 2023 206e 6f74 2063 7265 6174 696e     # not creatin
+0000ef40: 6720 6120 6e65 7720 6578 6365 7074 696f  g a new exceptio
+0000ef50: 6e20 6865 7265 2c20 696e 206f 7264 6572  n here, in order
+0000ef60: 2074 6f20 6b65 6570 2074 6865 2072 6573   to keep the res
+0000ef70: 706f 6e73 6520 616e 6420 7374 6174 7573  ponse and status
+0000ef80: 2063 6f64 6520 696e 2074 6865 2065 7863   code in the exc
+0000ef90: 6570 7469 6f6e 0a20 2020 2020 2020 2020  eption.         
+0000efa0: 2020 2072 6169 7365 0a0a 2020 2020 2020     raise..      
+0000efb0: 2020 6578 6365 7074 204f 5345 7272 6f72    except OSError
+0000efc0: 2061 7320 6572 723a 0a20 2020 2020 2020   as err:.       
+0000efd0: 2020 2020 206c 6f67 6765 722e 6572 726f       logger.erro
+0000efe0: 7228 6622 6572 726f 7220 7375 626d 6974  r(f"error submit
+0000eff0: 7469 6e67 2074 6173 6b3a 207b 6572 725f  ting task: {err_
+0000f000: 746f 5f73 7472 2865 7272 297d 2229 0a20  to_str(err)}"). 
+0000f010: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000f020: 204f 5345 7272 6f72 2822 6572 726f 723a   OSError("error:
+0000f030: 2063 616e 6e6f 7420 7375 626d 6974 2074   cannot submit t
+0000f040: 6173 6b22 2920 6672 6f6d 2065 7272 0a0a  ask") from err..
+0000f050: 2020 2020 2020 2020 6966 206e 6f74 2072          if not r
+0000f060: 6573 702e 6f6b 3a0a 2020 2020 2020 2020  esp.ok:.        
+0000f070: 2020 2020 6c6f 6767 6572 2e65 7272 6f72      logger.error
+0000f080: 2866 2262 6164 2072 6573 7021 215c 6e7b  (f"bad resp!!\n{
+0000f090: 7265 7370 2e74 6578 747d 2229 0a20 2020  resp.text}").   
+0000f0a0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0000f0b0: 616c 7565 4572 726f 7228 6622 6261 6420  alueError(f"bad 
+0000f0c0: 6675 6e63 7469 6f6e 2072 756e 2072 6573  function run res
+0000f0d0: 706f 6e73 652c 207b 7265 7370 2e74 6578  ponse, {resp.tex
+0000f0e0: 747d 2229 0a0a 2020 2020 2020 2020 7265  t}")..        re
+0000f0f0: 7370 203d 2072 6573 702e 6a73 6f6e 2829  sp = resp.json()
+0000f100: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000f110: 7265 7370 5b22 6461 7461 225d 0a0a 2020  resp["data"]..  
+0000f120: 2020 6465 6620 7375 626d 6974 5f70 6970    def submit_pip
+0000f130: 656c 696e 6528 0a20 2020 2020 2020 2073  eline(.        s
+0000f140: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
+0000f150: 6a65 6374 2c0a 2020 2020 2020 2020 7069  ject,.        pi
+0000f160: 7065 6c69 6e65 2c0a 2020 2020 2020 2020  peline,.        
+0000f170: 6172 6775 6d65 6e74 733d 4e6f 6e65 2c0a  arguments=None,.
+0000f180: 2020 2020 2020 2020 6578 7065 7269 6d65          experime
+0000f190: 6e74 3d4e 6f6e 652c 0a20 2020 2020 2020  nt=None,.       
+0000f1a0: 2072 756e 3d4e 6f6e 652c 0a20 2020 2020   run=None,.     
+0000f1b0: 2020 206e 616d 6573 7061 6365 3d4e 6f6e     namespace=Non
+0000f1c0: 652c 0a20 2020 2020 2020 2061 7274 6966  e,.        artif
+0000f1d0: 6163 745f 7061 7468 3d4e 6f6e 652c 0a20  act_path=None,. 
+0000f1e0: 2020 2020 2020 206f 7073 3d4e 6f6e 652c         ops=None,
+0000f1f0: 0a20 2020 2020 2020 2063 6c65 616e 7570  .        cleanup
+0000f200: 5f74 746c 3d4e 6f6e 652c 0a20 2020 2029  _ttl=None,.    )
+0000f210: 3a0a 2020 2020 2020 2020 2222 2253 7562  :.        """Sub
+0000f220: 6d69 7420 6120 4b46 5020 7069 7065 6c69  mit a KFP pipeli
+0000f230: 6e65 2066 6f72 2065 7865 6375 7469 6f6e  ne for execution
+0000f240: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0000f250: 6d20 7072 6f6a 6563 743a 2054 6865 2070  m project: The p
+0000f260: 726f 6a65 6374 206f 6620 7468 6520 7069  roject of the pi
+0000f270: 7065 6c69 6e65 0a20 2020 2020 2020 203a  peline.        :
+0000f280: 7061 7261 6d20 7069 7065 6c69 6e65 3a20  param pipeline: 
+0000f290: 5069 7065 6c69 6e65 2066 756e 6374 696f  Pipeline functio
+0000f2a0: 6e20 6f72 2070 6174 6820 746f 202e 7961  n or path to .ya
+0000f2b0: 6d6c 2f2e 7a69 7020 7069 7065 6c69 6e65  ml/.zip pipeline
+0000f2c0: 2066 696c 652e 0a20 2020 2020 2020 203a   file..        :
+0000f2d0: 7061 7261 6d20 6172 6775 6d65 6e74 733a  param arguments:
+0000f2e0: 2041 2064 6963 7469 6f6e 6172 7920 6f66   A dictionary of
+0000f2f0: 2061 7267 756d 656e 7473 2074 6f20 7061   arguments to pa
+0000f300: 7373 2074 6f20 7468 6520 7069 7065 6c69  ss to the pipeli
+0000f310: 6e65 2e0a 2020 2020 2020 2020 3a70 6172  ne..        :par
+0000f320: 616d 2065 7870 6572 696d 656e 743a 2041  am experiment: A
+0000f330: 206e 616d 6520 746f 2061 7373 6967 6e20   name to assign 
+0000f340: 666f 7220 7468 6520 7370 6563 6966 6963  for the specific
+0000f350: 2065 7870 6572 696d 656e 742e 0a20 2020   experiment..   
+0000f360: 2020 2020 203a 7061 7261 6d20 7275 6e3a       :param run:
+0000f370: 2041 206e 616d 6520 666f 7220 7468 6973   A name for this
+0000f380: 2073 7065 6369 6669 6320 7275 6e2e 0a20   specific run.. 
+0000f390: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
+0000f3a0: 6d65 7370 6163 653a 204b 7562 6572 6e65  mespace: Kuberne
+0000f3b0: 7465 7320 6e61 6d65 7370 6163 6520 746f  tes namespace to
+0000f3c0: 2065 7865 6375 7465 2074 6865 2070 6970   execute the pip
+0000f3d0: 656c 696e 6520 696e 2e0a 2020 2020 2020  eline in..      
+0000f3e0: 2020 3a70 6172 616d 2061 7274 6966 6163    :param artifac
+0000f3f0: 745f 7061 7468 3a20 4120 7061 7468 2074  t_path: A path t
+0000f400: 6f20 6172 7469 6661 6374 7320 7573 6564  o artifacts used
+0000f410: 2062 7920 7468 6973 2070 6970 656c 696e   by this pipelin
+0000f420: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+0000f430: 6d20 6f70 733a 2054 7261 6e73 666f 726d  m ops: Transform
+0000f440: 6572 7320 746f 2061 7070 6c79 206f 6e20  ers to apply on 
+0000f450: 616c 6c20 6f70 7320 696e 2074 6865 2070  all ops in the p
+0000f460: 6970 656c 696e 652e 0a20 2020 2020 2020  ipeline..       
+0000f470: 203a 7061 7261 6d20 636c 6561 6e75 705f   :param cleanup_
+0000f480: 7474 6c3a 2070 6970 656c 696e 6520 636c  ttl: pipeline cl
+0000f490: 6561 6e75 7020 7474 6c20 696e 2073 6563  eanup ttl in sec
+0000f4a0: 7320 2874 696d 6520 746f 2077 6169 7420  s (time to wait 
+0000f4b0: 6166 7465 7220 776f 726b 666c 6f77 2063  after workflow c
+0000f4c0: 6f6d 706c 6574 696f 6e2c 2061 7420 7768  ompletion, at wh
+0000f4d0: 6963 6820 706f 696e 7420 7468 650a 2020  ich point the.  
+0000f4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f4f0: 2020 2020 2020 2020 2020 776f 726b 666c            workfl
+0000f500: 6f77 2061 6e64 2061 6c6c 2069 7473 2072  ow and all its r
+0000f510: 6573 6f75 7263 6573 2061 7265 2064 656c  esources are del
+0000f520: 6574 6564 290a 2020 2020 2020 2020 2222  eted).        ""
+0000f530: 220a 0a20 2020 2020 2020 2069 6620 6973  "..        if is
+0000f540: 696e 7374 616e 6365 2870 6970 656c 696e  instance(pipelin
+0000f550: 652c 2073 7472 293a 0a20 2020 2020 2020  e, str):.       
+0000f560: 2020 2020 2070 6970 655f 6669 6c65 203d       pipe_file =
+0000f570: 2070 6970 656c 696e 650a 2020 2020 2020   pipeline.      
+0000f580: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000f590: 2020 2020 7069 7065 5f66 696c 6520 3d20      pipe_file = 
+0000f5a0: 7465 6d70 6669 6c65 2e4e 616d 6564 5465  tempfile.NamedTe
+0000f5b0: 6d70 6f72 6172 7946 696c 6528 7375 6666  mporaryFile(suff
+0000f5c0: 6978 3d22 2e79 616d 6c22 2c20 6465 6c65  ix=".yaml", dele
+0000f5d0: 7465 3d46 616c 7365 292e 6e61 6d65 0a20  te=False).name. 
+0000f5e0: 2020 2020 2020 2020 2020 2063 6f6e 6620             conf 
+0000f5f0: 3d20 6e65 775f 7069 7065 5f6d 6574 6164  = new_pipe_metad
+0000f600: 6174 6128 0a20 2020 2020 2020 2020 2020  ata(.           
+0000f610: 2020 2020 2061 7274 6966 6163 745f 7061       artifact_pa
+0000f620: 7468 3d61 7274 6966 6163 745f 7061 7468  th=artifact_path
+0000f630: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000f640: 2020 636c 6561 6e75 705f 7474 6c3d 636c    cleanup_ttl=cl
+0000f650: 6561 6e75 705f 7474 6c2c 0a20 2020 2020  eanup_ttl,.     
+0000f660: 2020 2020 2020 2020 2020 206f 705f 7472             op_tr
+0000f670: 616e 7366 6f72 6d65 7273 3d6f 7073 2c0a  ansformers=ops,.
+0000f680: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000f690: 2020 2020 2020 2020 2020 6b66 702e 636f            kfp.co
+0000f6a0: 6d70 696c 6572 2e43 6f6d 7069 6c65 7228  mpiler.Compiler(
+0000f6b0: 292e 636f 6d70 696c 6528 0a20 2020 2020  ).compile(.     
+0000f6c0: 2020 2020 2020 2020 2020 2070 6970 656c             pipel
+0000f6d0: 696e 652c 2070 6970 655f 6669 6c65 2c20  ine, pipe_file, 
+0000f6e0: 7479 7065 5f63 6865 636b 3d46 616c 7365  type_check=False
+0000f6f0: 2c20 7069 7065 6c69 6e65 5f63 6f6e 663d  , pipeline_conf=
+0000f700: 636f 6e66 0a20 2020 2020 2020 2020 2020  conf.           
+0000f710: 2029 0a0a 2020 2020 2020 2020 6966 2070   )..        if p
+0000f720: 6970 655f 6669 6c65 2e65 6e64 7377 6974  ipe_file.endswit
+0000f730: 6828 222e 7961 6d6c 2229 3a0a 2020 2020  h(".yaml"):.    
+0000f740: 2020 2020 2020 2020 6865 6164 6572 7320          headers 
+0000f750: 3d20 7b22 636f 6e74 656e 742d 7479 7065  = {"content-type
+0000f760: 223a 2022 6170 706c 6963 6174 696f 6e2f  ": "application/
+0000f770: 7961 6d6c 227d 0a20 2020 2020 2020 2065  yaml"}.        e
+0000f780: 6c69 6620 7069 7065 5f66 696c 652e 656e  lif pipe_file.en
+0000f790: 6473 7769 7468 2822 2e7a 6970 2229 3a0a  dswith(".zip"):.
+0000f7a0: 2020 2020 2020 2020 2020 2020 6865 6164              head
+0000f7b0: 6572 7320 3d20 7b22 636f 6e74 656e 742d  ers = {"content-
+0000f7c0: 7479 7065 223a 2022 6170 706c 6963 6174  type": "applicat
+0000f7d0: 696f 6e2f 7a69 7022 7d0a 2020 2020 2020  ion/zip"}.      
+0000f7e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000f7f0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0000f800: 7272 6f72 2822 7069 7065 6c69 6e65 2066  rror("pipeline f
+0000f810: 696c 6520 6d75 7374 2062 6520 2e79 616d  ile must be .yam
+0000f820: 6c20 6f72 202e 7a69 7022 290a 2020 2020  l or .zip").    
+0000f830: 2020 2020 6966 2061 7267 756d 656e 7473      if arguments
+0000f840: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0000f850: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+0000f860: 6172 6775 6d65 6e74 732c 2064 6963 7429  arguments, dict)
+0000f870: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000f880: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0000f890: 6f72 2822 6172 6775 6d65 6e74 7320 6d75  or("arguments mu
+0000f8a0: 7374 2062 6520 6469 6374 2074 7970 6522  st be dict type"
+0000f8b0: 290a 2020 2020 2020 2020 2020 2020 6865  ).            he
+0000f8c0: 6164 6572 735b 6d6c 7275 6e2e 636f 6d6d  aders[mlrun.comm
+0000f8d0: 6f6e 2e73 6368 656d 6173 2e48 6561 6465  on.schemas.Heade
+0000f8e0: 724e 616d 6573 2e70 6970 656c 696e 655f  rNames.pipeline_
+0000f8f0: 6172 6775 6d65 6e74 735d 203d 2073 7472  arguments] = str
+0000f900: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000f910: 2020 6172 6775 6d65 6e74 730a 2020 2020    arguments.    
+0000f920: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0000f930: 2020 2069 6620 6e6f 7420 7061 7468 2e69     if not path.i
+0000f940: 7366 696c 6528 7069 7065 5f66 696c 6529  sfile(pipe_file)
+0000f950: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000f960: 6973 6520 4f53 4572 726f 7228 6622 6669  ise OSError(f"fi
+0000f970: 6c65 207b 7069 7065 5f66 696c 657d 2064  le {pipe_file} d
+0000f980: 6f65 736e 7420 6578 6973 7422 290a 2020  oesnt exist").  
+0000f990: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
+0000f9a0: 7069 7065 5f66 696c 652c 2022 7262 2229  pipe_file, "rb")
+0000f9b0: 2061 7320 6670 3a0a 2020 2020 2020 2020   as fp:.        
+0000f9c0: 2020 2020 6461 7461 203d 2066 702e 7265      data = fp.re
+0000f9d0: 6164 2829 0a20 2020 2020 2020 2069 6620  ad().        if 
+0000f9e0: 6e6f 7420 6973 696e 7374 616e 6365 2870  not isinstance(p
+0000f9f0: 6970 656c 696e 652c 2073 7472 293a 0a20  ipeline, str):. 
+0000fa00: 2020 2020 2020 2020 2020 2072 656d 6f76             remov
+0000fa10: 6528 7069 7065 5f66 696c 6529 0a0a 2020  e(pipe_file)..  
+0000fa20: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+0000fa30: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
+0000fa40: 7b22 6e61 6d65 7370 6163 6522 3a20 6e61  {"namespace": na
+0000fa50: 6d65 7370 6163 652c 2022 6578 7065 7269  mespace, "experi
+0000fa60: 6d65 6e74 223a 2065 7870 6572 696d 656e  ment": experimen
+0000fa70: 742c 2022 7275 6e22 3a20 7275 6e7d 0a20  t, "run": run}. 
+0000fa80: 2020 2020 2020 2020 2020 2072 6573 7020             resp 
+0000fa90: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+0000faa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fab0: 2022 504f 5354 222c 0a20 2020 2020 2020   "POST",.       
+0000fac0: 2020 2020 2020 2020 2066 2270 726f 6a65           f"proje
+0000fad0: 6374 732f 7b70 726f 6a65 6374 7d2f 7069  cts/{project}/pi
+0000fae0: 7065 6c69 6e65 7322 2c0a 2020 2020 2020  pelines",.      
+0000faf0: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+0000fb00: 3d70 6172 616d 732c 0a20 2020 2020 2020  =params,.       
+0000fb10: 2020 2020 2020 2020 2074 696d 656f 7574           timeout
+0000fb20: 3d32 302c 0a20 2020 2020 2020 2020 2020  =20,.           
+0000fb30: 2020 2020 2062 6f64 793d 6461 7461 2c0a       body=data,.
+0000fb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fb50: 6865 6164 6572 733d 6865 6164 6572 732c  headers=headers,
+0000fb60: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0000fb70: 2020 2020 2020 2065 7863 6570 7420 4f53         except OS
+0000fb80: 4572 726f 7220 6173 2065 7272 3a0a 2020  Error as err:.  
+0000fb90: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
+0000fba0: 2e65 7272 6f72 2866 2265 7272 6f72 2063  .error(f"error c
+0000fbb0: 616e 6e6f 7420 7375 626d 6974 2070 6970  annot submit pip
+0000fbc0: 656c 696e 653a 207b 6572 725f 746f 5f73  eline: {err_to_s
+0000fbd0: 7472 2865 7272 297d 2229 0a20 2020 2020  tr(err)}").     
+0000fbe0: 2020 2020 2020 2072 6169 7365 204f 5345         raise OSE
+0000fbf0: 7272 6f72 2866 2265 7272 6f72 3a20 6361  rror(f"error: ca
+0000fc00: 6e6e 6f74 2063 616e 6e6f 7420 7375 626d  nnot cannot subm
+0000fc10: 6974 2070 6970 656c 696e 652c 207b 6572  it pipeline, {er
+0000fc20: 725f 746f 5f73 7472 2865 7272 297d 2229  r_to_str(err)}")
+0000fc30: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+0000fc40: 2072 6573 702e 6f6b 3a0a 2020 2020 2020   resp.ok:.      
+0000fc50: 2020 2020 2020 6c6f 6767 6572 2e65 7272        logger.err
+0000fc60: 6f72 2866 2262 6164 2072 6573 7021 215c  or(f"bad resp!!\
+0000fc70: 6e7b 7265 7370 2e74 6578 747d 2229 0a20  n{resp.text}"). 
+0000fc80: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000fc90: 2056 616c 7565 4572 726f 7228 6622 6261   ValueError(f"ba
+0000fca0: 6420 7375 626d 6974 2070 6970 656c 696e  d submit pipelin
+0000fcb0: 6520 7265 7370 6f6e 7365 2c20 7b72 6573  e response, {res
+0000fcc0: 702e 7465 7874 7d22 290a 0a20 2020 2020  p.text}")..     
+0000fcd0: 2020 2072 6573 7020 3d20 7265 7370 2e6a     resp = resp.j
+0000fce0: 736f 6e28 290a 2020 2020 2020 2020 6c6f  son().        lo
+0000fcf0: 6767 6572 2e69 6e66 6f28 6622 7375 626d  gger.info(f"subm
+0000fd00: 6974 7465 6420 7069 7065 6c69 6e65 207b  itted pipeline {
+0000fd10: 7265 7370 5b27 6e61 6d65 275d 7d20 6964  resp['name']} id
+0000fd20: 3d7b 7265 7370 5b27 6964 275d 7d22 290a  ={resp['id']}").
+0000fd30: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+0000fd40: 6573 705b 2269 6422 5d0a 0a20 2020 2064  esp["id"]..    d
+0000fd50: 6566 206c 6973 745f 7069 7065 6c69 6e65  ef list_pipeline
+0000fd60: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
+0000fd70: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+0000fd80: 3a20 7374 722c 0a20 2020 2020 2020 206e  : str,.        n
+0000fd90: 616d 6573 7061 6365 3a20 7374 7220 3d20  amespace: str = 
+0000fda0: 4e6f 6e65 2c0a 2020 2020 2020 2020 736f  None,.        so
+0000fdb0: 7274 5f62 793a 2073 7472 203d 2022 222c  rt_by: str = "",
+0000fdc0: 0a20 2020 2020 2020 2070 6167 655f 746f  .        page_to
+0000fdd0: 6b65 6e3a 2073 7472 203d 2022 222c 0a20  ken: str = "",. 
+0000fde0: 2020 2020 2020 2066 696c 7465 725f 3a20         filter_: 
+0000fdf0: 7374 7220 3d20 2222 2c0a 2020 2020 2020  str = "",.      
+0000fe00: 2020 666f 726d 6174 5f3a 2055 6e69 6f6e    format_: Union
+0000fe10: 5b0a 2020 2020 2020 2020 2020 2020 7374  [.            st
+0000fe20: 722c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  r, mlrun.common.
+0000fe30: 7363 6865 6d61 732e 5069 7065 6c69 6e65  schemas.Pipeline
+0000fe40: 7346 6f72 6d61 740a 2020 2020 2020 2020  sFormat.        
+0000fe50: 5d20 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e  ] = mlrun.common
+0000fe60: 2e73 6368 656d 6173 2e50 6970 656c 696e  .schemas.Pipelin
+0000fe70: 6573 466f 726d 6174 2e6d 6574 6164 6174  esFormat.metadat
+0000fe80: 615f 6f6e 6c79 2c0a 2020 2020 2020 2020  a_only,.        
+0000fe90: 7061 6765 5f73 697a 653a 2069 6e74 203d  page_size: int =
+0000fea0: 204e 6f6e 652c 0a20 2020 2029 202d 3e20   None,.    ) -> 
+0000feb0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0000fec0: 656d 6173 2e50 6970 656c 696e 6573 4f75  emas.PipelinesOu
+0000fed0: 7470 7574 3a0a 2020 2020 2020 2020 2222  tput:.        ""
+0000fee0: 2252 6574 7269 6576 6520 6120 6c69 7374  "Retrieve a list
+0000fef0: 206f 6620 4b46 5020 7069 7065 6c69 6e65   of KFP pipeline
+0000ff00: 732e 2054 6869 7320 6675 6e63 7469 6f6e  s. This function
+0000ff10: 2063 616e 2062 6520 696e 766f 6b65 6420   can be invoked 
+0000ff20: 746f 2067 6574 2061 6c6c 2070 6970 656c  to get all pipel
+0000ff30: 696e 6573 2066 726f 6d20 616c 6c20 7072  ines from all pr
+0000ff40: 6f6a 6563 7473 2c0a 2020 2020 2020 2020  ojects,.        
+0000ff50: 6279 2073 7065 6369 6679 696e 6720 6060  by specifying ``
+0000ff60: 7072 6f6a 6563 743d 2a60 602c 2069 6e20  project=*``, in 
+0000ff70: 7768 6963 6820 6361 7365 2070 6167 696e  which case pagin
+0000ff80: 6174 696f 6e20 6361 6e20 6265 2075 7365  ation can be use
+0000ff90: 6420 616e 6420 7468 6520 7661 7269 6f75  d and the variou
+0000ffa0: 7320 736f 7274 696e 6720 616e 6420 7061  s sorting and pa
+0000ffb0: 6769 6e61 7469 6f6e 0a20 2020 2020 2020  gination.       
+0000ffc0: 2070 726f 7065 7274 6965 7320 6361 6e20   properties can 
+0000ffd0: 6265 2061 7070 6c69 6564 2e20 4966 2061  be applied. If a
+0000ffe0: 2073 7065 6369 6669 6320 7072 6f6a 6563   specific projec
+0000fff0: 7420 6973 2072 6571 7565 7374 6564 2c20  t is requested, 
+00010000: 7468 656e 2074 6865 2070 6167 696e 6174  then the paginat
+00010010: 696f 6e20 6f70 7469 6f6e 7320 6361 6e6e  ion options cann
+00010020: 6f74 2062 650a 2020 2020 2020 2020 7573  ot be.        us
+00010030: 6564 2061 6e64 2070 6167 696e 6174 696f  ed and paginatio
+00010040: 6e20 6973 206e 6f74 2061 7070 6c69 6564  n is not applied
+00010050: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00010060: 6d20 7072 6f6a 6563 743a 2050 726f 6a65  m project: Proje
+00010070: 6374 206e 616d 652e 2043 616e 2062 6520  ct name. Can be 
+00010080: 6060 2a60 6020 666f 7220 7175 6572 7920  ``*`` for query 
+00010090: 6163 726f 7373 2061 6c6c 2070 726f 6a65  across all proje
+000100a0: 6374 732e 0a20 2020 2020 2020 203a 7061  cts..        :pa
+000100b0: 7261 6d20 6e61 6d65 7370 6163 653a 204b  ram namespace: K
+000100c0: 7562 6572 6e65 7465 7320 6e61 6d65 7370  ubernetes namesp
+000100d0: 6163 6520 696e 2077 6869 6368 2074 6865  ace in which the
+000100e0: 2070 6970 656c 696e 6573 2061 7265 2065   pipelines are e
+000100f0: 7865 6375 7469 6e67 2e0a 2020 2020 2020  xecuting..      
+00010100: 2020 3a70 6172 616d 2073 6f72 745f 6279    :param sort_by
+00010110: 3a20 4669 656c 6420 746f 2073 6f72 7420  : Field to sort 
+00010120: 7468 6520 7265 7375 6c74 7320 6279 2e0a  the results by..
+00010130: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+00010140: 6167 655f 746f 6b65 6e3a 2055 7365 2066  age_token: Use f
+00010150: 6f72 2070 6167 696e 6174 696f 6e2c 2074  or pagination, t
+00010160: 6f20 7265 7472 6965 7665 206e 6578 7420  o retrieve next 
+00010170: 7061 6765 2e0a 2020 2020 2020 2020 3a70  page..        :p
+00010180: 6172 616d 2066 696c 7465 725f 3a20 4b75  aram filter_: Ku
+00010190: 6265 726e 6574 6573 2066 696c 7465 7220  bernetes filter 
+000101a0: 746f 2061 7070 6c79 2074 6f20 7468 6520  to apply to the 
+000101b0: 7175 6572 792c 2063 616e 2062 6520 7573  query, can be us
+000101c0: 6564 2074 6f20 6669 6c74 6572 206f 6e20  ed to filter on 
+000101d0: 7370 6563 6966 6963 206f 626a 6563 7420  specific object 
+000101e0: 6669 656c 6473 2e0a 2020 2020 2020 2020  fields..        
+000101f0: 3a70 6172 616d 2066 6f72 6d61 745f 3a20  :param format_: 
+00010200: 5265 7375 6c74 2066 6f72 6d61 742e 2043  Result format. C
+00010210: 616e 2062 6520 6f6e 6520 6f66 3a0a 0a20  an be one of:.. 
+00010220: 2020 2020 2020 2020 2020 202d 2060 6066             - ``f
+00010230: 756c 6c60 6020 2d20 7265 7475 726e 2074  ull`` - return t
+00010240: 6865 2066 756c 6c20 6f62 6a65 6374 732e  he full objects.
+00010250: 0a20 2020 2020 2020 2020 2020 202d 2060  .            - `
+00010260: 606d 6574 6164 6174 615f 6f6e 6c79 6060  `metadata_only``
+00010270: 2028 6465 6661 756c 7429 202d 2072 6574   (default) - ret
+00010280: 7572 6e20 6a75 7374 206d 6574 6164 6174  urn just metadat
+00010290: 6120 6f66 2074 6865 2070 6970 656c 696e  a of the pipelin
+000102a0: 6573 206f 626a 6563 7473 2e0a 2020 2020  es objects..    
+000102b0: 2020 2020 2020 2020 2d20 6060 6e61 6d65          - ``name
+000102c0: 5f6f 6e6c 7960 6020 2d20 7265 7475 726e  _only`` - return
+000102d0: 206a 7573 7420 7468 6520 6e61 6d65 7320   just the names 
+000102e0: 6f66 2074 6865 2070 6970 656c 696e 6520  of the pipeline 
+000102f0: 6f62 6a65 6374 732e 0a20 2020 2020 2020  objects..       
+00010300: 203a 7061 7261 6d20 7061 6765 5f73 697a   :param page_siz
+00010310: 653a 2053 697a 6520 6f66 2061 2073 696e  e: Size of a sin
+00010320: 676c 6520 7061 6765 2077 6865 6e20 6170  gle page when ap
+00010330: 706c 7969 6e67 2070 6167 696e 6174 696f  plying paginatio
+00010340: 6e2e 0a20 2020 2020 2020 2022 2222 0a0a  n..        """..
+00010350: 2020 2020 2020 2020 6966 2070 726f 6a65          if proje
+00010360: 6374 2021 3d20 222a 2220 616e 6420 2870  ct != "*" and (p
+00010370: 6167 655f 746f 6b65 6e20 6f72 2070 6167  age_token or pag
+00010380: 655f 7369 7a65 293a 0a20 2020 2020 2020  e_size):.       
+00010390: 2020 2020 2072 6169 7365 206d 6c72 756e       raise mlrun
+000103a0: 2e65 7272 6f72 732e 4d4c 5275 6e49 6e76  .errors.MLRunInv
+000103b0: 616c 6964 4172 6775 6d65 6e74 4572 726f  alidArgumentErro
+000103c0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+000103d0: 2020 2022 4669 6c74 6572 696e 6720 6279     "Filtering by
+000103e0: 2070 726f 6a65 6374 2063 616e 206e 6f74   project can not
+000103f0: 2062 6520 7573 6564 2074 6f67 6574 6865   be used togethe
+00010400: 7220 7769 7468 2070 6167 696e 6174 696f  r with paginatio
+00010410: 6e22 0a20 2020 2020 2020 2020 2020 2029  n".            )
+00010420: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+00010430: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00010440: 226e 616d 6573 7061 6365 223a 206e 616d  "namespace": nam
+00010450: 6573 7061 6365 2c0a 2020 2020 2020 2020  espace,.        
+00010460: 2020 2020 2273 6f72 745f 6279 223a 2073      "sort_by": s
+00010470: 6f72 745f 6279 2c0a 2020 2020 2020 2020  ort_by,.        
+00010480: 2020 2020 2270 6167 655f 746f 6b65 6e22      "page_token"
+00010490: 3a20 7061 6765 5f74 6f6b 656e 2c0a 2020  : page_token,.  
+000104a0: 2020 2020 2020 2020 2020 2266 696c 7465            "filte
+000104b0: 7222 3a20 6669 6c74 6572 5f2c 0a20 2020  r": filter_,.   
+000104c0: 2020 2020 2020 2020 2022 666f 726d 6174           "format
+000104d0: 223a 2066 6f72 6d61 745f 2c0a 2020 2020  ": format_,.    
+000104e0: 2020 2020 2020 2020 2270 6167 655f 7369          "page_si
+000104f0: 7a65 223a 2070 6167 655f 7369 7a65 2c0a  ze": page_size,.
+00010500: 2020 2020 2020 2020 7d0a 0a20 2020 2020          }..     
+00010510: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+00010520: 203d 2066 2246 6169 6c65 6420 6c69 7374   = f"Failed list
+00010530: 696e 6720 7069 7065 6c69 6e65 732c 2071  ing pipelines, q
+00010540: 7565 7279 3a20 7b70 6172 616d 737d 220a  uery: {params}".
+00010550: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
+00010560: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+00010570: 280a 2020 2020 2020 2020 2020 2020 2247  (.            "G
+00010580: 4554 222c 2066 2270 726f 6a65 6374 732f  ET", f"projects/
+00010590: 7b70 726f 6a65 6374 7d2f 7069 7065 6c69  {project}/pipeli
+000105a0: 6e65 7322 2c20 6572 726f 725f 6d65 7373  nes", error_mess
+000105b0: 6167 652c 2070 6172 616d 733d 7061 7261  age, params=para
+000105c0: 6d73 0a20 2020 2020 2020 2029 0a20 2020  ms.        ).   
+000105d0: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
+000105e0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+000105f0: 2e50 6970 656c 696e 6573 4f75 7470 7574  .PipelinesOutput
+00010600: 282a 2a72 6573 706f 6e73 652e 6a73 6f6e  (**response.json
+00010610: 2829 290a 0a20 2020 2064 6566 2067 6574  ())..    def get
+00010620: 5f70 6970 656c 696e 6528 0a20 2020 2020  _pipeline(.     
+00010630: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00010640: 2072 756e 5f69 643a 2073 7472 2c0a 2020   run_id: str,.  
+00010650: 2020 2020 2020 6e61 6d65 7370 6163 653a        namespace:
+00010660: 2073 7472 203d 204e 6f6e 652c 0a20 2020   str = None,.   
+00010670: 2020 2020 2074 696d 656f 7574 3a20 696e       timeout: in
+00010680: 7420 3d20 3130 2c0a 2020 2020 2020 2020  t = 10,.        
+00010690: 666f 726d 6174 5f3a 2055 6e69 6f6e 5b0a  format_: Union[.
+000106a0: 2020 2020 2020 2020 2020 2020 7374 722c              str,
+000106b0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+000106c0: 6865 6d61 732e 5069 7065 6c69 6e65 7346  hemas.PipelinesF
+000106d0: 6f72 6d61 740a 2020 2020 2020 2020 5d20  ormat.        ] 
+000106e0: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
+000106f0: 6368 656d 6173 2e50 6970 656c 696e 6573  chemas.Pipelines
+00010700: 466f 726d 6174 2e73 756d 6d61 7279 2c0a  Format.summary,.
+00010710: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
+00010720: 2073 7472 203d 204e 6f6e 652c 0a20 2020   str = None,.   
+00010730: 2029 3a0a 2020 2020 2020 2020 2222 2252   ):.        """R
+00010740: 6574 7269 6576 6520 6465 7461 696c 7320  etrieve details 
+00010750: 6f66 2061 2073 7065 6369 6669 6320 7069  of a specific pi
+00010760: 7065 6c69 6e65 2075 7369 6e67 2069 7473  peline using its
+00010770: 2072 756e 2049 4420 2861 7320 7072 6f76   run ID (as prov
+00010780: 6964 6564 2077 6865 6e20 7468 6520 7069  ided when the pi
+00010790: 7065 6c69 6e65 2077 6173 2065 7865 6375  peline was execu
+000107a0: 7465 6429 2e22 2222 0a0a 2020 2020 2020  ted)."""..      
+000107b0: 2020 7061 7261 6d73 203d 207b 7d0a 2020    params = {}.  
+000107c0: 2020 2020 2020 6966 206e 616d 6573 7061        if namespa
+000107d0: 6365 3a0a 2020 2020 2020 2020 2020 2020  ce:.            
+000107e0: 7061 7261 6d73 5b22 6e61 6d65 7370 6163  params["namespac
+000107f0: 6522 5d20 3d20 6e61 6d65 7370 6163 650a  e"] = namespace.
+00010800: 2020 2020 2020 2020 7061 7261 6d73 5b22          params["
+00010810: 666f 726d 6174 225d 203d 2066 6f72 6d61  format"] = forma
+00010820: 745f 0a20 2020 2020 2020 2070 726f 6a65  t_.        proje
+00010830: 6374 5f70 6174 6820 3d20 7072 6f6a 6563  ct_path = projec
+00010840: 7420 6966 2070 726f 6a65 6374 2065 6c73  t if project els
+00010850: 6520 222a 220a 2020 2020 2020 2020 7265  e "*".        re
+00010860: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
+00010870: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
+00010880: 2247 4554 222c 0a20 2020 2020 2020 2020  "GET",.         
+00010890: 2020 2066 2270 726f 6a65 6374 732f 7b70     f"projects/{p
+000108a0: 726f 6a65 6374 5f70 6174 687d 2f70 6970  roject_path}/pip
+000108b0: 656c 696e 6573 2f7b 7275 6e5f 6964 7d22  elines/{run_id}"
+000108c0: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+000108d0: 7261 6d73 3d70 6172 616d 732c 0a20 2020  rams=params,.   
+000108e0: 2020 2020 2020 2020 2074 696d 656f 7574           timeout
+000108f0: 3d74 696d 656f 7574 2c0a 2020 2020 2020  =timeout,.      
+00010900: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
+00010910: 6e6f 7420 7265 7370 2e6f 6b3a 0a20 2020  not resp.ok:.   
+00010920: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
+00010930: 6572 726f 7228 6622 6261 6420 7265 7370  error(f"bad resp
+00010940: 2121 5c6e 7b72 6573 702e 7465 7874 7d22  !!\n{resp.text}"
+00010950: 290a 2020 2020 2020 2020 2020 2020 7261  ).            ra
+00010960: 6973 6520 5661 6c75 6545 7272 6f72 2866  ise ValueError(f
+00010970: 2262 6164 2067 6574 2070 6970 656c 696e  "bad get pipelin
+00010980: 6520 7265 7370 6f6e 7365 2c20 7b72 6573  e response, {res
+00010990: 702e 7465 7874 7d22 290a 0a20 2020 2020  p.text}")..     
+000109a0: 2020 2072 6574 7572 6e20 7265 7370 2e6a     return resp.j
+000109b0: 736f 6e28 290a 0a20 2020 2040 7374 6174  son()..    @stat
+000109c0: 6963 6d65 7468 6f64 0a20 2020 2064 6566  icmethod.    def
+000109d0: 205f 7265 736f 6c76 655f 7265 6665 7265   _resolve_refere
+000109e0: 6e63 6528 7461 672c 2075 6964 293a 0a20  nce(tag, uid):. 
+000109f0: 2020 2020 2020 2069 6620 7569 6420 616e         if uid an
+00010a00: 6420 7461 673a 0a20 2020 2020 2020 2020  d tag:.         
+00010a10: 2020 2072 6169 7365 204d 4c52 756e 496e     raise MLRunIn
+00010a20: 7661 6c69 6441 7267 756d 656e 7445 7272  validArgumentErr
+00010a30: 6f72 2822 626f 7468 2075 6964 2061 6e64  or("both uid and
+00010a40: 2074 6167 2077 6572 6520 7072 6f76 6964   tag were provid
+00010a50: 6564 2229 0a20 2020 2020 2020 2072 6574  ed").        ret
+00010a60: 7572 6e20 7569 6420 6f72 2074 6167 206f  urn uid or tag o
+00010a70: 7220 226c 6174 6573 7422 0a0a 2020 2020  r "latest"..    
+00010a80: 6465 6620 6372 6561 7465 5f66 6561 7475  def create_featu
+00010a90: 7265 5f73 6574 280a 2020 2020 2020 2020  re_set(.        
+00010aa0: 7365 6c66 2c0a 2020 2020 2020 2020 6665  self,.        fe
+00010ab0: 6174 7572 655f 7365 743a 2055 6e69 6f6e  ature_set: Union
+00010ac0: 5b64 6963 742c 206d 6c72 756e 2e63 6f6d  [dict, mlrun.com
+00010ad0: 6d6f 6e2e 7363 6865 6d61 732e 4665 6174  mon.schemas.Feat
+00010ae0: 7572 6553 6574 2c20 4665 6174 7572 6553  ureSet, FeatureS
+00010af0: 6574 5d2c 0a20 2020 2020 2020 2070 726f  et],.        pro
+00010b00: 6a65 6374 3d22 222c 0a20 2020 2020 2020  ject="",.       
+00010b10: 2076 6572 7369 6f6e 6564 3d54 7275 652c   versioned=True,
+00010b20: 0a20 2020 2029 202d 3e20 6469 6374 3a0a  .    ) -> dict:.
+00010b30: 2020 2020 2020 2020 2222 2243 7265 6174          """Creat
+00010b40: 6520 6120 6e65 7720 3a70 793a 636c 6173  e a new :py:clas
+00010b50: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
+00010b60: 655f 7374 6f72 652e 4665 6174 7572 6553  e_store.FeatureS
+00010b70: 6574 6020 616e 6420 7361 7665 2069 6e20  et` and save in 
+00010b80: 7468 6520 3a70 793a 6d6f 643a 606d 6c72  the :py:mod:`mlr
+00010b90: 756e 6020 4442 2e20 5468 650a 2020 2020  un` DB. The.    
+00010ba0: 2020 2020 6665 6174 7572 652d 7365 7420      feature-set 
+00010bb0: 6d75 7374 206e 6f74 2070 7265 7669 6f75  must not previou
+00010bc0: 736c 7920 6578 6973 7420 696e 2074 6865  sly exist in the
+00010bd0: 2044 422e 0a0a 2020 2020 2020 2020 3a70   DB...        :p
+00010be0: 6172 616d 2066 6561 7475 7265 5f73 6574  aram feature_set
+00010bf0: 3a20 5468 6520 6e65 7720 3a70 793a 636c  : The new :py:cl
+00010c00: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
+00010c10: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
+00010c20: 6553 6574 6020 746f 2063 7265 6174 652e  eSet` to create.
+00010c30: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00010c40: 7072 6f6a 6563 743a 204e 616d 6520 6f66  project: Name of
+00010c50: 2070 726f 6a65 6374 2074 6869 7320 6665   project this fe
+00010c60: 6174 7572 652d 7365 7420 6265 6c6f 6e67  ature-set belong
+00010c70: 7320 746f 2e0a 2020 2020 2020 2020 3a70  s to..        :p
+00010c80: 6172 616d 2076 6572 7369 6f6e 6564 3a20  aram versioned: 
+00010c90: 5768 6574 6865 7220 746f 206d 6169 6e74  Whether to maint
+00010ca0: 6169 6e20 7665 7273 696f 6e73 2066 6f72  ain versions for
+00010cb0: 2074 6869 7320 6665 6174 7572 652d 7365   this feature-se
+00010cc0: 742e 2041 6c6c 2076 6572 7369 6f6e 7320  t. All versions 
+00010cd0: 6f66 2061 2076 6572 7369 6f6e 6564 206f  of a versioned o
+00010ce0: 626a 6563 740a 2020 2020 2020 2020 2020  bject.          
+00010cf0: 2020 7769 6c6c 2062 6520 6b65 7074 2069    will be kept i
+00010d00: 6e20 7468 6520 4442 2061 6e64 2063 616e  n the DB and can
+00010d10: 2062 6520 7265 7472 6965 7665 6420 756e   be retrieved un
+00010d20: 7469 6c20 6578 706c 6963 6974 6c79 2064  til explicitly d
+00010d30: 656c 6574 6564 2e0a 2020 2020 2020 2020  eleted..        
+00010d40: 3a72 6574 7572 6e73 3a20 5468 6520 3a70  :returns: The :p
+00010d50: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+00010d60: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
+00010d70: 6174 7572 6553 6574 6020 6f62 6a65 6374  atureSet` object
+00010d80: 2028 6173 2064 6963 7429 2e0a 2020 2020   (as dict)..    
+00010d90: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00010da0: 6966 2069 7369 6e73 7461 6e63 6528 6665  if isinstance(fe
+00010db0: 6174 7572 655f 7365 742c 206d 6c72 756e  ature_set, mlrun
+00010dc0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00010dd0: 4665 6174 7572 6553 6574 293a 0a20 2020  FeatureSet):.   
+00010de0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+00010df0: 5f73 6574 203d 2066 6561 7475 7265 5f73  _set = feature_s
+00010e00: 6574 2e64 6963 7428 290a 2020 2020 2020  et.dict().      
+00010e10: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+00010e20: 6528 6665 6174 7572 655f 7365 742c 2046  e(feature_set, F
+00010e30: 6561 7475 7265 5365 7429 3a0a 2020 2020  eatureSet):.    
+00010e40: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+00010e50: 7365 7420 3d20 6665 6174 7572 655f 7365  set = feature_se
+00010e60: 742e 746f 5f64 6963 7428 290a 0a20 2020  t.to_dict()..   
+00010e70: 2020 2020 2070 726f 6a65 6374 203d 2028       project = (
+00010e80: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
+00010e90: 6a65 6374 0a20 2020 2020 2020 2020 2020  ject.           
+00010ea0: 206f 7220 6665 6174 7572 655f 7365 745b   or feature_set[
+00010eb0: 226d 6574 6164 6174 6122 5d2e 6765 7428  "metadata"].get(
+00010ec0: 2270 726f 6a65 6374 222c 204e 6f6e 6529  "project", None)
+00010ed0: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
+00010ee0: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
+00010ef0: 726f 6a65 6374 0a20 2020 2020 2020 2029  roject.        )
+00010f00: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+00010f10: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+00010f20: 6563 747d 2f66 6561 7475 7265 2d73 6574  ect}/feature-set
+00010f30: 7322 0a20 2020 2020 2020 2070 6172 616d  s".        param
+00010f40: 7320 3d20 7b22 7665 7273 696f 6e65 6422  s = {"versioned"
+00010f50: 3a20 7665 7273 696f 6e65 647d 0a0a 2020  : versioned}..  
+00010f60: 2020 2020 2020 6e61 6d65 203d 2066 6561        name = fea
+00010f70: 7475 7265 5f73 6574 5b22 6d65 7461 6461  ture_set["metada
+00010f80: 7461 225d 5b22 6e61 6d65 225d 0a20 2020  ta"]["name"].   
+00010f90: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+00010fa0: 6765 203d 2066 2246 6169 6c65 6420 6372  ge = f"Failed cr
+00010fb0: 6561 7469 6e67 2066 6561 7475 7265 2d73  eating feature-s
+00010fc0: 6574 207b 7072 6f6a 6563 747d 2f7b 6e61  et {project}/{na
+00010fd0: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
+00010fe0: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
+00010ff0: 6c28 0a20 2020 2020 2020 2020 2020 2022  l(.            "
+00011000: 504f 5354 222c 0a20 2020 2020 2020 2020  POST",.         
+00011010: 2020 2070 6174 682c 0a20 2020 2020 2020     path,.       
+00011020: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+00011030: 6765 2c0a 2020 2020 2020 2020 2020 2020  ge,.            
+00011040: 7061 7261 6d73 3d70 6172 616d 732c 0a20  params=params,. 
+00011050: 2020 2020 2020 2020 2020 2062 6f64 793d             body=
+00011060: 6469 6374 5f74 6f5f 6a73 6f6e 2866 6561  dict_to_json(fea
+00011070: 7475 7265 5f73 6574 292c 0a20 2020 2020  ture_set),.     
+00011080: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+00011090: 7572 6e20 7265 7370 2e6a 736f 6e28 290a  urn resp.json().
+000110a0: 0a20 2020 2064 6566 2067 6574 5f66 6561  .    def get_fea
+000110b0: 7475 7265 5f73 6574 280a 2020 2020 2020  ture_set(.      
+000110c0: 2020 7365 6c66 2c20 6e61 6d65 3a20 7374    self, name: st
+000110d0: 722c 2070 726f 6a65 6374 3a20 7374 7220  r, project: str 
+000110e0: 3d20 2222 2c20 7461 673a 2073 7472 203d  = "", tag: str =
+000110f0: 204e 6f6e 652c 2075 6964 3a20 7374 7220   None, uid: str 
+00011100: 3d20 4e6f 6e65 0a20 2020 2029 202d 3e20  = None.    ) -> 
+00011110: 4665 6174 7572 6553 6574 3a0a 2020 2020  FeatureSet:.    
+00011120: 2020 2020 2222 2252 6574 7269 6576 6520      """Retrieve 
+00011130: 6120 7e6d 6c72 756e 2e66 6561 7475 7265  a ~mlrun.feature
+00011140: 5f73 746f 7265 2e46 6561 7475 7265 5365  _store.FeatureSe
+00011150: 7460 206f 626a 6563 742e 2049 6620 626f  t` object. If bo
+00011160: 7468 2060 6074 6167 6060 2061 6e64 2060  th ``tag`` and `
+00011170: 6075 6964 6060 2061 7265 206e 6f74 2073  `uid`` are not s
+00011180: 7065 6369 6669 6564 2c20 7468 656e 0a20  pecified, then. 
+00011190: 2020 2020 2020 2074 6865 206f 626a 6563         the objec
+000111a0: 7420 7461 6767 6564 2060 606c 6174 6573  t tagged ``lates
+000111b0: 7460 6020 7769 6c6c 2062 6520 7265 7472  t`` will be retr
+000111c0: 6965 7665 642e 0a0a 2020 2020 2020 2020  ieved...        
+000111d0: 3a70 6172 616d 206e 616d 653a 204e 616d  :param name: Nam
+000111e0: 6520 6f66 206f 626a 6563 7420 746f 2072  e of object to r
+000111f0: 6574 7269 6576 652e 0a20 2020 2020 2020  etrieve..       
+00011200: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
+00011210: 2050 726f 6a65 6374 2074 6865 2046 6561   Project the Fea
+00011220: 7475 7265 5365 7420 6265 6c6f 6e67 7320  tureSet belongs 
+00011230: 746f 2e0a 2020 2020 2020 2020 3a70 6172  to..        :par
+00011240: 616d 2074 6167 3a20 5461 6720 6f66 2074  am tag: Tag of t
+00011250: 6865 2073 7065 6369 6669 6320 6f62 6a65  he specific obje
+00011260: 6374 2076 6572 7369 6f6e 2074 6f20 7265  ct version to re
+00011270: 7472 6965 7665 2e0a 2020 2020 2020 2020  trieve..        
+00011280: 3a70 6172 616d 2075 6964 3a20 7569 6420  :param uid: uid 
+00011290: 6f66 2074 6865 206f 626a 6563 7420 746f  of the object to
+000112a0: 2072 6574 7269 6576 6520 2863 616e 206f   retrieve (can o
+000112b0: 6e6c 7920 6265 2075 7365 6420 666f 7220  nly be used for 
+000112c0: 7665 7273 696f 6e65 6420 6f62 6a65 6374  versioned object
+000112d0: 7329 2e0a 2020 2020 2020 2020 2222 220a  s)..        """.
+000112e0: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+000112f0: 203d 2070 726f 6a65 6374 206f 7220 636f   = project or co
+00011300: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
+00011310: 6a65 6374 0a20 2020 2020 2020 2072 6566  ject.        ref
+00011320: 6572 656e 6365 203d 2073 656c 662e 5f72  erence = self._r
+00011330: 6573 6f6c 7665 5f72 6566 6572 656e 6365  esolve_reference
+00011340: 2874 6167 2c20 7569 6429 0a20 2020 2020  (tag, uid).     
+00011350: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
+00011360: 6563 7473 2f7b 7072 6f6a 6563 747d 2f66  ects/{project}/f
+00011370: 6561 7475 7265 2d73 6574 732f 7b6e 616d  eature-sets/{nam
+00011380: 657d 2f72 6566 6572 656e 6365 732f 7b72  e}/references/{r
+00011390: 6566 6572 656e 6365 7d22 0a20 2020 2020  eference}".     
+000113a0: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+000113b0: 203d 2066 2246 6169 6c65 6420 7265 7472   = f"Failed retr
+000113c0: 6965 7669 6e67 2066 6561 7475 7265 2d73  ieving feature-s
+000113d0: 6574 207b 7072 6f6a 6563 747d 2f7b 6e61  et {project}/{na
+000113e0: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
+000113f0: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
+00011400: 6c28 2247 4554 222c 2070 6174 682c 2065  l("GET", path, e
+00011410: 7272 6f72 5f6d 6573 7361 6765 290a 2020  rror_message).  
+00011420: 2020 2020 2020 7265 7475 726e 2046 6561        return Fea
+00011430: 7475 7265 5365 742e 6672 6f6d 5f64 6963  tureSet.from_dic
+00011440: 7428 7265 7370 2e6a 736f 6e28 2929 0a0a  t(resp.json())..
+00011450: 2020 2020 6465 6620 6c69 7374 5f66 6561      def list_fea
+00011460: 7475 7265 7328 0a20 2020 2020 2020 2073  tures(.        s
+00011470: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
+00011480: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
+00011490: 2020 206e 616d 653a 2073 7472 203d 204e     name: str = N
+000114a0: 6f6e 652c 0a20 2020 2020 2020 2074 6167  one,.        tag
+000114b0: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
+000114c0: 2020 2020 2020 656e 7469 7469 6573 3a20        entities: 
+000114d0: 4c69 7374 5b73 7472 5d20 3d20 4e6f 6e65  List[str] = None
+000114e0: 2c0a 2020 2020 2020 2020 6c61 6265 6c73  ,.        labels
+000114f0: 3a20 4c69 7374 5b73 7472 5d20 3d20 4e6f  : List[str] = No
+00011500: 6e65 2c0a 2020 2020 2920 2d3e 204c 6973  ne,.    ) -> Lis
+00011510: 745b 6469 6374 5d3a 0a20 2020 2020 2020  t[dict]:.       
+00011520: 2022 2222 4c69 7374 2066 6561 7475 7265   """List feature
+00011530: 2d73 6574 7320 7768 6963 6820 636f 6e74  -sets which cont
+00011540: 6169 6e20 7370 6563 6966 6963 2066 6561  ain specific fea
+00011550: 7475 7265 732e 2054 6869 7320 6675 6e63  tures. This func
+00011560: 7469 6f6e 206d 6179 2072 6574 7572 6e20  tion may return 
+00011570: 6d75 6c74 6970 6c65 2076 6572 7369 6f6e  multiple version
+00011580: 7320 6f66 2074 6865 2073 616d 650a 2020  s of the same.  
+00011590: 2020 2020 2020 6665 6174 7572 652d 7365        feature-se
+000115a0: 7420 6966 2061 2073 7065 6369 6669 6320  t if a specific 
+000115b0: 7461 6720 6973 206e 6f74 2072 6571 7565  tag is not reque
+000115c0: 7374 6564 2e20 4e6f 7465 2074 6861 7420  sted. Note that 
+000115d0: 7468 6520 7661 7269 6f75 7320 6669 6c74  the various filt
+000115e0: 6572 7320 6f66 2074 6869 7320 6675 6e63  ers of this func
+000115f0: 7469 6f6e 2061 6374 7561 6c6c 790a 2020  tion actually.  
+00011600: 2020 2020 2020 7265 6665 7220 746f 2074        refer to t
+00011610: 6865 2066 6561 7475 7265 2d73 6574 206f  he feature-set o
+00011620: 626a 6563 7420 636f 6e74 6169 6e69 6e67  bject containing
+00011630: 2074 6865 2066 6561 7475 7265 732c 206e   the features, n
+00011640: 6f74 2074 6f20 7468 6520 6665 6174 7572  ot to the featur
+00011650: 6573 2074 6865 6d73 656c 7665 732e 0a0a  es themselves...
+00011660: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+00011670: 726f 6a65 6374 3a20 5072 6f6a 6563 7420  roject: Project 
+00011680: 7768 6963 6820 636f 6e74 6169 6e73 2074  which contains t
+00011690: 6865 7365 2066 6561 7475 7265 732e 0a20  hese features.. 
+000116a0: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
+000116b0: 6d65 3a20 4e61 6d65 206f 6620 7468 6520  me: Name of the 
+000116c0: 6665 6174 7572 6520 746f 206c 6f6f 6b20  feature to look 
+000116d0: 666f 722e 2054 6865 206e 616d 6520 6973  for. The name is
+000116e0: 2075 7365 6420 696e 2061 206c 696b 6520   used in a like 
+000116f0: 7175 6572 792c 2061 6e64 2069 7320 6e6f  query, and is no
+00011700: 7420 6361 7365 2d73 656e 7369 7469 7665  t case-sensitive
+00011710: 2e20 466f 720a 2020 2020 2020 2020 2020  . For.          
+00011720: 2020 6578 616d 706c 652c 206c 6f6f 6b69    example, looki
+00011730: 6e67 2066 6f72 2060 6066 6561 7460 6020  ng for ``feat`` 
+00011740: 7769 6c6c 2072 6574 7572 6e20 6665 6174  will return feat
+00011750: 7572 6573 2077 6869 6368 2061 7265 206e  ures which are n
+00011760: 616d 6564 2060 604d 7946 6561 7475 7265  amed ``MyFeature
+00011770: 6060 2061 7320 7765 6c6c 2061 7320 6060  `` as well as ``
+00011780: 6465 6665 6174 6060 2e0a 2020 2020 2020  defeat``..      
+00011790: 2020 3a70 6172 616d 2074 6167 3a20 5265    :param tag: Re
+000117a0: 7475 726e 2066 6561 7475 7265 2d73 6574  turn feature-set
+000117b0: 7320 7768 6963 6820 636f 6e74 6169 6e20  s which contain 
+000117c0: 7468 6520 6665 6174 7572 6573 206c 6f6f  the features loo
+000117d0: 6b65 6420 666f 722c 2061 6e64 2061 7265  ked for, and are
+000117e0: 2074 6167 6765 6420 7769 7468 2074 6865   tagged with the
+000117f0: 2073 7065 6369 6669 6320 7461 672e 0a20   specific tag.. 
+00011800: 2020 2020 2020 203a 7061 7261 6d20 656e         :param en
+00011810: 7469 7469 6573 3a20 5265 7475 726e 206f  tities: Return o
+00011820: 6e6c 7920 6665 6174 7572 652d 7365 7473  nly feature-sets
+00011830: 2077 6869 6368 2063 6f6e 7461 696e 2061   which contain a
+00011840: 6e20 656e 7469 7479 2077 686f 7365 206e  n entity whose n
+00011850: 616d 6520 6973 2063 6f6e 7461 696e 6564  ame is contained
+00011860: 2069 6e20 7468 6973 206c 6973 742e 0a20   in this list.. 
+00011870: 2020 2020 2020 203a 7061 7261 6d20 6c61         :param la
+00011880: 6265 6c73 3a20 5265 7475 726e 206f 6e6c  bels: Return onl
+00011890: 7920 6665 6174 7572 652d 7365 7473 2077  y feature-sets w
+000118a0: 6869 6368 2061 7265 206c 6162 656c 6564  hich are labeled
+000118b0: 2061 7320 7265 7175 6573 7465 642e 0a20   as requested.. 
+000118c0: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
+000118d0: 2041 206c 6973 7420 6f66 206d 6170 7069   A list of mappi
+000118e0: 6e67 2066 726f 6d20 6665 6174 7572 6520  ng from feature 
+000118f0: 746f 2061 2064 6967 6573 7420 6f66 2074  to a digest of t
+00011900: 6865 2066 6561 7475 7265 2d73 6574 2c20  he feature-set, 
+00011910: 7768 6963 6820 636f 6e74 6169 6e73 2074  which contains t
+00011920: 6865 2066 6561 7475 7265 2d73 6574 0a20  he feature-set. 
+00011930: 2020 2020 2020 2020 2020 206d 6574 612d             meta-
+00011940: 6461 7461 2e20 4d75 6c74 6970 6c65 2065  data. Multiple e
+00011950: 6e74 7269 6573 206d 6179 2062 6520 7265  ntries may be re
+00011960: 7475 726e 6564 2066 6f72 2061 6e79 2073  turned for any s
+00011970: 7065 6369 6669 6320 6665 6174 7572 6520  pecific feature 
+00011980: 6475 6520 746f 206d 756c 7469 706c 6520  due to multiple 
+00011990: 7461 6773 206f 7220 7665 7273 696f 6e73  tags or versions
+000119a0: 0a20 2020 2020 2020 2020 2020 206f 6620  .            of 
+000119b0: 7468 6520 6665 6174 7572 652d 7365 742e  the feature-set.
+000119c0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+000119d0: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
+000119e0: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
+000119f0: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
+00011a00: 740a 2020 2020 2020 2020 7061 7261 6d73  t.        params
+00011a10: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+00011a20: 2022 6e61 6d65 223a 206e 616d 652c 0a20   "name": name,. 
+00011a30: 2020 2020 2020 2020 2020 2022 7461 6722             "tag"
+00011a40: 3a20 7461 672c 0a20 2020 2020 2020 2020  : tag,.         
+00011a50: 2020 2022 656e 7469 7479 223a 2065 6e74     "entity": ent
+00011a60: 6974 6965 7320 6f72 205b 5d2c 0a20 2020  ities or [],.   
+00011a70: 2020 2020 2020 2020 2022 6c61 6265 6c22           "label"
+00011a80: 3a20 6c61 6265 6c73 206f 7220 5b5d 2c0a  : labels or [],.
+00011a90: 2020 2020 2020 2020 7d0a 0a20 2020 2020          }..     
+00011aa0: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
+00011ab0: 6563 7473 2f7b 7072 6f6a 6563 747d 2f66  ects/{project}/f
+00011ac0: 6561 7475 7265 7322 0a0a 2020 2020 2020  eatures"..      
+00011ad0: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
+00011ae0: 3d20 6622 4661 696c 6564 206c 6973 7469  = f"Failed listi
+00011af0: 6e67 2066 6561 7475 7265 732c 2070 726f  ng features, pro
+00011b00: 6a65 6374 3a20 7b70 726f 6a65 6374 7d2c  ject: {project},
+00011b10: 2071 7565 7279 3a20 7b70 6172 616d 737d   query: {params}
+00011b20: 220a 2020 2020 2020 2020 7265 7370 203d  ".        resp =
+00011b30: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
+00011b40: 4745 5422 2c20 7061 7468 2c20 6572 726f  GET", path, erro
+00011b50: 725f 6d65 7373 6167 652c 2070 6172 616d  r_message, param
+00011b60: 733d 7061 7261 6d73 290a 2020 2020 2020  s=params).      
+00011b70: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
+00011b80: 6f6e 2829 5b22 6665 6174 7572 6573 225d  on()["features"]
+00011b90: 0a0a 2020 2020 6465 6620 6c69 7374 5f65  ..    def list_e
+00011ba0: 6e74 6974 6965 7328 0a20 2020 2020 2020  ntities(.       
+00011bb0: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
+00011bc0: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
+00011bd0: 2020 2020 206e 616d 653a 2073 7472 203d       name: str =
+00011be0: 204e 6f6e 652c 0a20 2020 2020 2020 2074   None,.        t
+00011bf0: 6167 3a20 7374 7220 3d20 4e6f 6e65 2c0a  ag: str = None,.
+00011c00: 2020 2020 2020 2020 6c61 6265 6c73 3a20          labels: 
+00011c10: 4c69 7374 5b73 7472 5d20 3d20 4e6f 6e65  List[str] = None
+00011c20: 2c0a 2020 2020 2920 2d3e 204c 6973 745b  ,.    ) -> List[
+00011c30: 6469 6374 5d3a 0a20 2020 2020 2020 2022  dict]:.        "
+00011c40: 2222 5265 7472 6965 7665 2061 206c 6973  ""Retrieve a lis
+00011c50: 7420 6f66 2065 6e74 6974 6965 7320 616e  t of entities an
+00011c60: 6420 7468 6569 7220 6d61 7070 696e 6720  d their mapping 
+00011c70: 746f 2074 6865 2063 6f6e 7461 696e 696e  to the containin
+00011c80: 6720 6665 6174 7572 652d 7365 7473 2e20  g feature-sets. 
+00011c90: 5468 6973 2066 756e 6374 696f 6e20 6973  This function is
+00011ca0: 2073 696d 696c 6172 0a20 2020 2020 2020   similar.       
+00011cb0: 2074 6f20 7468 6520 3a70 793a 6675 6e63   to the :py:func
+00011cc0: 3a60 7e6c 6973 745f 6665 6174 7572 6573  :`~list_features
+00011cd0: 6020 6675 6e63 7469 6f6e 2c20 616e 6420  ` function, and 
+00011ce0: 7573 6573 2074 6865 2073 616d 6520 6c6f  uses the same lo
+00011cf0: 6769 632e 2048 6f77 6576 6572 2c20 7468  gic. However, th
+00011d00: 6520 656e 7469 7469 6573 2061 7265 206d  e entities are m
+00011d10: 6174 6368 6564 0a20 2020 2020 2020 2061  atched.        a
+00011d20: 6761 696e 7374 2074 6865 206e 616d 6520  gainst the name 
+00011d30: 7261 7468 6572 2074 6861 6e20 7468 6520  rather than the 
+00011d40: 6665 6174 7572 6573 2e0a 2020 2020 2020  features..      
+00011d50: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
+00011d60: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
+00011d70: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
+00011d80: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
+00011d90: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
+00011da0: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
+00011db0: 3a20 6e61 6d65 2c0a 2020 2020 2020 2020  : name,.        
+00011dc0: 2020 2020 2274 6167 223a 2074 6167 2c0a      "tag": tag,.
+00011dd0: 2020 2020 2020 2020 2020 2020 226c 6162              "lab
+00011de0: 656c 223a 206c 6162 656c 7320 6f72 205b  el": labels or [
+00011df0: 5d2c 0a20 2020 2020 2020 207d 0a0a 2020  ],.        }..  
+00011e00: 2020 2020 2020 7061 7468 203d 2066 2270        path = f"p
+00011e10: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
+00011e20: 7d2f 656e 7469 7469 6573 220a 0a20 2020  }/entities"..   
+00011e30: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+00011e40: 6765 203d 2066 2246 6169 6c65 6420 6c69  ge = f"Failed li
+00011e50: 7374 696e 6720 656e 7469 7469 6573 2c20  sting entities, 
+00011e60: 7072 6f6a 6563 743a 207b 7072 6f6a 6563  project: {projec
+00011e70: 747d 2c20 7175 6572 793a 207b 7061 7261  t}, query: {para
+00011e80: 6d73 7d22 0a20 2020 2020 2020 2072 6573  ms}".        res
+00011e90: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
+00011ea0: 6c28 2247 4554 222c 2070 6174 682c 2065  l("GET", path, e
+00011eb0: 7272 6f72 5f6d 6573 7361 6765 2c20 7061  rror_message, pa
+00011ec0: 7261 6d73 3d70 6172 616d 7329 0a20 2020  rams=params).   
+00011ed0: 2020 2020 2072 6574 7572 6e20 7265 7370       return resp
+00011ee0: 2e6a 736f 6e28 295b 2265 6e74 6974 6965  .json()["entitie
+00011ef0: 7322 5d0a 0a20 2020 2040 7374 6174 6963  s"]..    @static
+00011f00: 6d65 7468 6f64 0a20 2020 2064 6566 205f  method.    def _
+00011f10: 6765 6e65 7261 7465 5f70 6172 7469 7469  generate_partiti
+00011f20: 6f6e 5f62 795f 7061 7261 6d73 280a 2020  on_by_params(.  
+00011f30: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
+00011f40: 6279 5f63 6c73 2c0a 2020 2020 2020 2020  by_cls,.        
+00011f50: 7061 7274 6974 696f 6e5f 6279 2c0a 2020  partition_by,.  
+00011f60: 2020 2020 2020 726f 7773 5f70 6572 5f70        rows_per_p
+00011f70: 6172 7469 7469 6f6e 2c0a 2020 2020 2020  artition,.      
+00011f80: 2020 736f 7274 5f62 792c 0a20 2020 2020    sort_by,.     
+00011f90: 2020 206f 7264 6572 2c0a 2020 2020 2020     order,.      
+00011fa0: 2020 6d61 785f 7061 7274 6974 696f 6e73    max_partitions
+00011fb0: 3d4e 6f6e 652c 0a20 2020 2029 3a0a 0a20  =None,.    ):.. 
+00011fc0: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+00011fd0: 5f70 6172 616d 7320 3d20 7b0a 2020 2020  _params = {.    
+00011fe0: 2020 2020 2020 2020 2270 6172 7469 7469          "partiti
+00011ff0: 6f6e 2d62 7922 3a20 7061 7274 6974 696f  on-by": partitio
+00012000: 6e5f 6279 2c0a 2020 2020 2020 2020 2020  n_by,.          
+00012010: 2020 2272 6f77 732d 7065 722d 7061 7274    "rows-per-part
+00012020: 6974 696f 6e22 3a20 726f 7773 5f70 6572  ition": rows_per
+00012030: 5f70 6172 7469 7469 6f6e 2c0a 2020 2020  _partition,.    
+00012040: 2020 2020 2020 2020 2270 6172 7469 7469          "partiti
+00012050: 6f6e 2d73 6f72 742d 6279 223a 2073 6f72  on-sort-by": sor
+00012060: 745f 6279 2c0a 2020 2020 2020 2020 2020  t_by,.          
+00012070: 2020 2270 6172 7469 7469 6f6e 2d6f 7264    "partition-ord
+00012080: 6572 223a 206f 7264 6572 2c0a 2020 2020  er": order,.    
+00012090: 2020 2020 7d0a 2020 2020 2020 2020 6966      }.        if
+000120a0: 206d 6178 5f70 6172 7469 7469 6f6e 7320   max_partitions 
+000120b0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+000120c0: 2020 2020 2020 2020 2070 6172 7469 7469           partiti
+000120d0: 6f6e 5f70 6172 616d 735b 226d 6178 2d70  on_params["max-p
+000120e0: 6172 7469 7469 6f6e 7322 5d20 3d20 6d61  artitions"] = ma
+000120f0: 785f 7061 7274 6974 696f 6e73 0a20 2020  x_partitions.   
+00012100: 2020 2020 2072 6574 7572 6e20 7061 7274       return part
+00012110: 6974 696f 6e5f 7061 7261 6d73 0a0a 2020  ition_params..  
+00012120: 2020 6465 6620 6c69 7374 5f66 6561 7475    def list_featu
+00012130: 7265 5f73 6574 7328 0a20 2020 2020 2020  re_sets(.       
+00012140: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
+00012150: 726f 6a65 6374 3a20 7374 7220 3d20 2222  roject: str = ""
+00012160: 2c0a 2020 2020 2020 2020 6e61 6d65 3a20  ,.        name: 
+00012170: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
+00012180: 2020 2020 7461 673a 2073 7472 203d 204e      tag: str = N
+00012190: 6f6e 652c 0a20 2020 2020 2020 2073 7461  one,.        sta
+000121a0: 7465 3a20 7374 7220 3d20 4e6f 6e65 2c0a  te: str = None,.
+000121b0: 2020 2020 2020 2020 656e 7469 7469 6573          entities
+000121c0: 3a20 4c69 7374 5b73 7472 5d20 3d20 4e6f  : List[str] = No
+000121d0: 6e65 2c0a 2020 2020 2020 2020 6665 6174  ne,.        feat
+000121e0: 7572 6573 3a20 4c69 7374 5b73 7472 5d20  ures: List[str] 
+000121f0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00012200: 6c61 6265 6c73 3a20 4c69 7374 5b73 7472  labels: List[str
+00012210: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+00012220: 2020 7061 7274 6974 696f 6e5f 6279 3a20    partition_by: 
+00012230: 556e 696f 6e5b 0a20 2020 2020 2020 2020  Union[.         
+00012240: 2020 206d 6c72 756e 2e63 6f6d 6d6f 6e2e     mlrun.common.
+00012250: 7363 6865 6d61 732e 4665 6174 7572 6553  schemas.FeatureS
+00012260: 746f 7265 5061 7274 6974 696f 6e42 7946  torePartitionByF
+00012270: 6965 6c64 2c20 7374 720a 2020 2020 2020  ield, str.      
+00012280: 2020 5d20 3d20 4e6f 6e65 2c0a 2020 2020    ] = None,.    
+00012290: 2020 2020 726f 7773 5f70 6572 5f70 6172      rows_per_par
+000122a0: 7469 7469 6f6e 3a20 696e 7420 3d20 312c  tition: int = 1,
+000122b0: 0a20 2020 2020 2020 2070 6172 7469 7469  .        partiti
+000122c0: 6f6e 5f73 6f72 745f 6279 3a20 556e 696f  on_sort_by: Unio
+000122d0: 6e5b 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  n[mlrun.common.s
+000122e0: 6368 656d 6173 2e53 6f72 7446 6965 6c64  chemas.SortField
+000122f0: 2c20 7374 725d 203d 204e 6f6e 652c 0a20  , str] = None,. 
+00012300: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+00012310: 5f6f 7264 6572 3a20 556e 696f 6e5b 0a20  _order: Union[. 
+00012320: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
+00012330: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00012340: 4f72 6465 7254 7970 652c 2073 7472 0a20  OrderType, str. 
+00012350: 2020 2020 2020 205d 203d 206d 6c72 756e         ] = mlrun
+00012360: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00012370: 4f72 6465 7254 7970 652e 6465 7363 2c0a  OrderType.desc,.
+00012380: 2020 2020 2920 2d3e 204c 6973 745b 4665      ) -> List[Fe
+00012390: 6174 7572 6553 6574 5d3a 0a20 2020 2020  atureSet]:.     
+000123a0: 2020 2022 2222 5265 7472 6965 7665 2061     """Retrieve a
+000123b0: 206c 6973 7420 6f66 2066 6561 7475 7265   list of feature
+000123c0: 2d73 6574 7320 6d61 7463 6869 6e67 2074  -sets matching t
+000123d0: 6865 2063 7269 7465 7269 6120 7072 6f76  he criteria prov
+000123e0: 6964 6564 2e0a 0a20 2020 2020 2020 203a  ided...        :
+000123f0: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
+00012400: 726f 6a65 6374 206e 616d 652e 0a20 2020  roject name..   
+00012410: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
+00012420: 3a20 4e61 6d65 206f 6620 6665 6174 7572  : Name of featur
+00012430: 652d 7365 7420 746f 206d 6174 6368 2e20  e-set to match. 
+00012440: 5468 6973 2069 7320 6120 6c69 6b65 2071  This is a like q
+00012450: 7565 7279 2c20 616e 6420 6973 2063 6173  uery, and is cas
+00012460: 652d 696e 7365 6e73 6974 6976 652e 0a20  e-insensitive.. 
+00012470: 2020 2020 2020 203a 7061 7261 6d20 7461         :param ta
+00012480: 673a 204d 6174 6368 2066 6561 7475 7265  g: Match feature
+00012490: 2d73 6574 7320 7769 7468 2073 7065 6369  -sets with speci
+000124a0: 6669 6320 7461 672e 0a20 2020 2020 2020  fic tag..       
+000124b0: 203a 7061 7261 6d20 7374 6174 653a 204d   :param state: M
+000124c0: 6174 6368 2066 6561 7475 7265 2d73 6574  atch feature-set
+000124d0: 7320 7769 7468 2061 2073 7065 6369 6669  s with a specifi
+000124e0: 6320 7374 6174 652e 0a20 2020 2020 2020  c state..       
+000124f0: 203a 7061 7261 6d20 656e 7469 7469 6573   :param entities
+00012500: 3a20 4d61 7463 6820 6665 6174 7572 652d  : Match feature-
+00012510: 7365 7473 2077 6869 6368 2063 6f6e 7461  sets which conta
+00012520: 696e 2065 6e74 6974 6965 7320 7768 6f73  in entities whos
+00012530: 6520 6e61 6d65 2069 7320 696e 2074 6869  e name is in thi
+00012540: 7320 6c69 7374 2e0a 2020 2020 2020 2020  s list..        
+00012550: 3a70 6172 616d 2066 6561 7475 7265 733a  :param features:
+00012560: 204d 6174 6368 2066 6561 7475 7265 2d73   Match feature-s
+00012570: 6574 7320 7768 6963 6820 636f 6e74 6169  ets which contai
+00012580: 6e20 6665 6174 7572 6573 2077 686f 7365  n features whose
+00012590: 206e 616d 6520 6973 2069 6e20 7468 6973   name is in this
+000125a0: 206c 6973 742e 0a20 2020 2020 2020 203a   list..        :
+000125b0: 7061 7261 6d20 6c61 6265 6c73 3a20 4d61  param labels: Ma
+000125c0: 7463 6820 6665 6174 7572 652d 7365 7473  tch feature-sets
+000125d0: 2077 6869 6368 2068 6176 6520 7468 6573   which have thes
+000125e0: 6520 6c61 6265 6c73 2e0a 2020 2020 2020  e labels..      
+000125f0: 2020 3a70 6172 616d 2070 6172 7469 7469    :param partiti
+00012600: 6f6e 5f62 793a 2046 6965 6c64 2074 6f20  on_by: Field to 
+00012610: 6772 6f75 7020 7265 7375 6c74 7320 6279  group results by
+00012620: 2e20 4f6e 6c79 2061 6c6c 6f77 6564 2076  . Only allowed v
+00012630: 616c 7565 2069 7320 606e 616d 6560 2e20  alue is `name`. 
+00012640: 5768 656e 2060 7061 7274 6974 696f 6e5f  When `partition_
+00012650: 6279 6020 6973 2073 7065 6369 6669 6564  by` is specified
+00012660: 2c0a 2020 2020 2020 2020 2020 2020 7468  ,.            th
+00012670: 6520 6070 6172 7469 7469 6f6e 5f73 6f72  e `partition_sor
+00012680: 745f 6279 6020 7061 7261 6d65 7465 7220  t_by` parameter 
+00012690: 6d75 7374 2062 6520 7072 6f76 6964 6564  must be provided
+000126a0: 2061 7320 7765 6c6c 2e0a 2020 2020 2020   as well..      
+000126b0: 2020 3a70 6172 616d 2072 6f77 735f 7065    :param rows_pe
+000126c0: 725f 7061 7274 6974 696f 6e3a 2048 6f77  r_partition: How
+000126d0: 206d 616e 7920 746f 7020 726f 7773 2028   many top rows (
+000126e0: 7065 7220 736f 7274 696e 6720 6465 6669  per sorting defi
+000126f0: 6e65 6420 6279 2060 7061 7274 6974 696f  ned by `partitio
+00012700: 6e5f 736f 7274 5f62 7960 2061 6e64 2060  n_sort_by` and `
+00012710: 7061 7274 6974 696f 6e5f 6f72 6465 7260  partition_order`
+00012720: 290a 2020 2020 2020 2020 2020 2020 746f  ).            to
+00012730: 2072 6574 7572 6e20 7065 7220 6772 6f75   return per grou
+00012740: 702e 2044 6566 6175 6c74 2076 616c 7565  p. Default value
+00012750: 2069 7320 312e 0a20 2020 2020 2020 203a   is 1..        :
+00012760: 7061 7261 6d20 7061 7274 6974 696f 6e5f  param partition_
+00012770: 736f 7274 5f62 793a 2057 6861 7420 6669  sort_by: What fi
+00012780: 656c 6420 746f 2073 6f72 7420 7468 6520  eld to sort the 
+00012790: 7265 7375 6c74 7320 6279 2c20 7769 7468  results by, with
+000127a0: 696e 2065 6163 6820 7061 7274 6974 696f  in each partitio
+000127b0: 6e20 6465 6669 6e65 6420 6279 2060 7061  n defined by `pa
+000127c0: 7274 6974 696f 6e5f 6279 602e 0a20 2020  rtition_by`..   
+000127d0: 2020 2020 2020 2020 2043 7572 7265 6e74           Current
+000127e0: 6c79 2074 6865 206f 6e6c 7920 616c 6c6f  ly the only allo
+000127f0: 7765 6420 7661 6c75 6520 6172 6520 6063  wed value are `c
+00012800: 7265 6174 6564 6020 616e 6420 6075 7064  reated` and `upd
+00012810: 6174 6564 602e 0a20 2020 2020 2020 203a  ated`..        :
+00012820: 7061 7261 6d20 7061 7274 6974 696f 6e5f  param partition_
+00012830: 6f72 6465 723a 204f 7264 6572 206f 6620  order: Order of 
+00012840: 736f 7274 696e 6720 7769 7468 696e 2070  sorting within p
+00012850: 6172 7469 7469 6f6e 7320 2d20 6061 7363  artitions - `asc
+00012860: 6020 6f72 2060 6465 7363 602e 2044 6566  ` or `desc`. Def
+00012870: 6175 6c74 2069 7320 6064 6573 6360 2e0a  ault is `desc`..
+00012880: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
+00012890: 3a20 4c69 7374 206f 6620 6d61 7463 6869  : List of matchi
+000128a0: 6e67 203a 7079 3a63 6c61 7373 3a60 7e6d  ng :py:class:`~m
+000128b0: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
+000128c0: 7265 2e46 6561 7475 7265 5365 7460 206f  re.FeatureSet` o
+000128d0: 626a 6563 7473 2e0a 2020 2020 2020 2020  bjects..        
+000128e0: 2222 220a 0a20 2020 2020 2020 2070 726f  """..        pro
+000128f0: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
+00012900: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
+00012910: 5f70 726f 6a65 6374 0a0a 2020 2020 2020  _project..      
+00012920: 2020 7061 7261 6d73 203d 207b 0a20 2020    params = {.   
+00012930: 2020 2020 2020 2020 2022 6e61 6d65 223a           "name":
+00012940: 206e 616d 652c 0a20 2020 2020 2020 2020   name,.         
+00012950: 2020 2022 7374 6174 6522 3a20 7374 6174     "state": stat
+00012960: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+00012970: 7461 6722 3a20 7461 672c 0a20 2020 2020  tag": tag,.     
+00012980: 2020 2020 2020 2022 656e 7469 7479 223a         "entity":
+00012990: 2065 6e74 6974 6965 7320 6f72 205b 5d2c   entities or [],
+000129a0: 0a20 2020 2020 2020 2020 2020 2022 6665  .            "fe
+000129b0: 6174 7572 6522 3a20 6665 6174 7572 6573  ature": features
+000129c0: 206f 7220 5b5d 2c0a 2020 2020 2020 2020   or [],.        
+000129d0: 2020 2020 226c 6162 656c 223a 206c 6162      "label": lab
+000129e0: 656c 7320 6f72 205b 5d2c 0a20 2020 2020  els or [],.     
+000129f0: 2020 207d 0a20 2020 2020 2020 2069 6620     }.        if 
+00012a00: 7061 7274 6974 696f 6e5f 6279 3a0a 2020  partition_by:.  
+00012a10: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+00012a20: 2e75 7064 6174 6528 0a20 2020 2020 2020  .update(.       
+00012a30: 2020 2020 2020 2020 2073 656c 662e 5f67           self._g
+00012a40: 656e 6572 6174 655f 7061 7274 6974 696f  enerate_partitio
+00012a50: 6e5f 6279 5f70 6172 616d 7328 0a20 2020  n_by_params(.   
+00012a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012a70: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+00012a80: 6865 6d61 732e 4665 6174 7572 6553 746f  hemas.FeatureSto
+00012a90: 7265 5061 7274 6974 696f 6e42 7946 6965  rePartitionByFie
+00012aa0: 6c64 2c0a 2020 2020 2020 2020 2020 2020  ld,.            
+00012ab0: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
+00012ac0: 6e5f 6279 2c0a 2020 2020 2020 2020 2020  n_by,.          
+00012ad0: 2020 2020 2020 2020 2020 726f 7773 5f70            rows_p
+00012ae0: 6572 5f70 6172 7469 7469 6f6e 2c0a 2020  er_partition,.  
+00012af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012b00: 2020 7061 7274 6974 696f 6e5f 736f 7274    partition_sort
+00012b10: 5f62 792c 0a20 2020 2020 2020 2020 2020  _by,.           
+00012b20: 2020 2020 2020 2020 2070 6172 7469 7469           partiti
+00012b30: 6f6e 5f6f 7264 6572 2c0a 2020 2020 2020  on_order,.      
+00012b40: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00012b50: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00012b60: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
+00012b70: 6563 7473 2f7b 7072 6f6a 6563 747d 2f66  ects/{project}/f
+00012b80: 6561 7475 7265 2d73 6574 7322 0a0a 2020  eature-sets"..  
+00012b90: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+00012ba0: 6167 6520 3d20 280a 2020 2020 2020 2020  age = (.        
+00012bb0: 2020 2020 6622 4661 696c 6564 206c 6973      f"Failed lis
+00012bc0: 7469 6e67 2066 6561 7475 7265 2d73 6574  ting feature-set
+00012bd0: 732c 2070 726f 6a65 6374 3a20 7b70 726f  s, project: {pro
+00012be0: 6a65 6374 7d2c 2071 7565 7279 3a20 7b70  ject}, query: {p
+00012bf0: 6172 616d 737d 220a 2020 2020 2020 2020  arams}".        
+00012c00: 290a 2020 2020 2020 2020 7265 7370 203d  ).        resp =
+00012c10: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
+00012c20: 4745 5422 2c20 7061 7468 2c20 6572 726f  GET", path, erro
+00012c30: 725f 6d65 7373 6167 652c 2070 6172 616d  r_message, param
+00012c40: 733d 7061 7261 6d73 290a 2020 2020 2020  s=params).      
+00012c50: 2020 6665 6174 7572 655f 7365 7473 203d    feature_sets =
+00012c60: 2072 6573 702e 6a73 6f6e 2829 5b22 6665   resp.json()["fe
+00012c70: 6174 7572 655f 7365 7473 225d 0a20 2020  ature_sets"].   
+00012c80: 2020 2020 2069 6620 6665 6174 7572 655f       if feature_
+00012c90: 7365 7473 3a0a 2020 2020 2020 2020 2020  sets:.          
+00012ca0: 2020 7265 7475 726e 205b 4665 6174 7572    return [Featur
+00012cb0: 6553 6574 2e66 726f 6d5f 6469 6374 286f  eSet.from_dict(o
+00012cc0: 626a 2920 666f 7220 6f62 6a20 696e 2066  bj) for obj in f
+00012cd0: 6561 7475 7265 5f73 6574 735d 0a0a 2020  eature_sets]..  
+00012ce0: 2020 6465 6620 7374 6f72 655f 6665 6174    def store_feat
+00012cf0: 7572 655f 7365 7428 0a20 2020 2020 2020  ure_set(.       
+00012d00: 2073 656c 662c 0a20 2020 2020 2020 2066   self,.        f
+00012d10: 6561 7475 7265 5f73 6574 3a20 556e 696f  eature_set: Unio
+00012d20: 6e5b 6469 6374 2c20 6d6c 7275 6e2e 636f  n[dict, mlrun.co
+00012d30: 6d6d 6f6e 2e73 6368 656d 6173 2e46 6561  mmon.schemas.Fea
+00012d40: 7475 7265 5365 742c 2046 6561 7475 7265  tureSet, Feature
+00012d50: 5365 745d 2c0a 2020 2020 2020 2020 6e61  Set],.        na
+00012d60: 6d65 3d4e 6f6e 652c 0a20 2020 2020 2020  me=None,.       
+00012d70: 2070 726f 6a65 6374 3d22 222c 0a20 2020   project="",.   
+00012d80: 2020 2020 2074 6167 3d4e 6f6e 652c 0a20       tag=None,. 
+00012d90: 2020 2020 2020 2075 6964 3d4e 6f6e 652c         uid=None,
+00012da0: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
+00012db0: 6564 3d54 7275 652c 0a20 2020 2029 202d  ed=True,.    ) -
+00012dc0: 3e20 6469 6374 3a0a 2020 2020 2020 2020  > dict:.        
+00012dd0: 2222 2253 6176 6520 6120 3a70 793a 636c  """Save a :py:cl
+00012de0: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
+00012df0: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
+00012e00: 6553 6574 6020 6f62 6a65 6374 2069 6e20  eSet` object in 
+00012e10: 7468 6520 3a70 793a 6d6f 643a 606d 6c72  the :py:mod:`mlr
+00012e20: 756e 6020 4442 2e20 5468 650a 2020 2020  un` DB. The.    
+00012e30: 2020 2020 6665 6174 7572 652d 7365 7420      feature-set 
+00012e40: 6361 6e20 6265 2065 6974 6865 7220 6120  can be either a 
+00012e50: 6e65 7720 6f62 6a65 6374 206f 7220 6120  new object or a 
+00012e60: 6d6f 6469 6669 6361 7469 6f6e 2074 6f20  modification to 
+00012e70: 6578 6973 7469 6e67 206f 626a 6563 7420  existing object 
+00012e80: 7265 6665 7265 6e63 6564 2062 7920 7468  referenced by th
+00012e90: 6520 7061 7261 6d73 206f 660a 2020 2020  e params of.    
+00012ea0: 2020 2020 7468 6520 6675 6e63 7469 6f6e      the function
+00012eb0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00012ec0: 6d20 6665 6174 7572 655f 7365 743a 2054  m feature_set: T
+00012ed0: 6865 203a 7079 3a63 6c61 7373 3a60 7e6d  he :py:class:`~m
+00012ee0: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
+00012ef0: 7265 2e46 6561 7475 7265 5365 7460 2074  re.FeatureSet` t
+00012f00: 6f20 7374 6f72 652e 0a20 2020 2020 2020  o store..       
+00012f10: 203a 7061 7261 6d20 6e61 6d65 3a20 2020   :param name:   
+00012f20: 204e 616d 6520 6f66 2066 6561 7475 7265   Name of feature
+00012f30: 2073 6574 2e0a 2020 2020 2020 2020 3a70   set..        :p
+00012f40: 6172 616d 2070 726f 6a65 6374 3a20 4e61  aram project: Na
+00012f50: 6d65 206f 6620 7072 6f6a 6563 7420 7468  me of project th
+00012f60: 6973 2066 6561 7475 7265 2d73 6574 2062  is feature-set b
+00012f70: 656c 6f6e 6773 2074 6f2e 0a20 2020 2020  elongs to..     
+00012f80: 2020 203a 7061 7261 6d20 7461 673a 2054     :param tag: T
+00012f90: 6865 2060 6074 6167 6060 206f 6620 7468  he ``tag`` of th
+00012fa0: 6520 6f62 6a65 6374 2074 6f20 7265 706c  e object to repl
+00012fb0: 6163 6520 696e 2074 6865 2044 422c 2066  ace in the DB, f
+00012fc0: 6f72 2065 7861 6d70 6c65 2060 606c 6174  or example ``lat
+00012fd0: 6573 7460 602e 0a20 2020 2020 2020 203a  est``..        :
+00012fe0: 7061 7261 6d20 7569 643a 2054 6865 2060  param uid: The `
+00012ff0: 6075 6964 6060 206f 6620 7468 6520 6f62  `uid`` of the ob
+00013000: 6a65 6374 2074 6f20 7265 706c 6163 6520  ject to replace 
+00013010: 696e 2074 6865 2044 422e 2049 6620 7573  in the DB. If us
+00013020: 696e 6720 7468 6973 2070 6172 616d 6574  ing this paramet
+00013030: 6572 2c20 7468 6520 6d6f 6469 6669 6564  er, the modified
+00013040: 206f 626a 6563 740a 2020 2020 2020 2020   object.        
+00013050: 2020 2020 6d75 7374 2068 6176 6520 7468      must have th
+00013060: 6520 7361 6d65 2060 6075 6964 6060 206f  e same ``uid`` o
+00013070: 6620 7468 6520 7072 6576 696f 7573 6c79  f the previously
+00013080: 2d65 7869 7374 696e 6720 6f62 6a65 6374  -existing object
+00013090: 2e20 5468 6973 2063 616e 6e6f 7420 6265  . This cannot be
+000130a0: 2075 7365 6420 666f 7220 6e6f 6e2d 7665   used for non-ve
+000130b0: 7273 696f 6e65 6420 6f62 6a65 6374 732e  rsioned objects.
+000130c0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000130d0: 7665 7273 696f 6e65 643a 2057 6865 7468  versioned: Wheth
+000130e0: 6572 2074 6f20 6d61 696e 7461 696e 2076  er to maintain v
+000130f0: 6572 7369 6f6e 7320 666f 7220 7468 6973  ersions for this
+00013100: 2066 6561 7475 7265 2d73 6574 2e20 416c   feature-set. Al
+00013110: 6c20 7665 7273 696f 6e73 206f 6620 6120  l versions of a 
+00013120: 7665 7273 696f 6e65 6420 6f62 6a65 6374  versioned object
+00013130: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
+00013140: 6c20 6265 206b 6570 7420 696e 2074 6865  l be kept in the
+00013150: 2044 4220 616e 6420 6361 6e20 6265 2072   DB and can be r
+00013160: 6574 7269 6576 6564 2075 6e74 696c 2065  etrieved until e
+00013170: 7870 6c69 6369 746c 7920 6465 6c65 7465  xplicitly delete
+00013180: 642e 0a20 2020 2020 2020 203a 7265 7475  d..        :retu
+00013190: 726e 733a 2054 6865 203a 7079 3a63 6c61  rns: The :py:cla
+000131a0: 7373 3a60 7e6d 6c72 756e 2e66 6561 7475  ss:`~mlrun.featu
+000131b0: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
+000131c0: 5365 7460 206f 626a 6563 7420 2861 7320  Set` object (as 
+000131d0: 6469 6374 292e 0a20 2020 2020 2020 2022  dict)..        "
+000131e0: 2222 0a0a 2020 2020 2020 2020 7265 6665  ""..        refe
+000131f0: 7265 6e63 6520 3d20 7365 6c66 2e5f 7265  rence = self._re
+00013200: 736f 6c76 655f 7265 6665 7265 6e63 6528  solve_reference(
+00013210: 7461 672c 2075 6964 290a 2020 2020 2020  tag, uid).      
+00013220: 2020 7061 7261 6d73 203d 207b 2276 6572    params = {"ver
+00013230: 7369 6f6e 6564 223a 2076 6572 7369 6f6e  sioned": version
+00013240: 6564 7d0a 0a20 2020 2020 2020 2069 6620  ed}..        if 
+00013250: 6973 696e 7374 616e 6365 2866 6561 7475  isinstance(featu
+00013260: 7265 5f73 6574 2c20 6d6c 7275 6e2e 636f  re_set, mlrun.co
+00013270: 6d6d 6f6e 2e73 6368 656d 6173 2e46 6561  mmon.schemas.Fea
+00013280: 7475 7265 5365 7429 3a0a 2020 2020 2020  tureSet):.      
+00013290: 2020 2020 2020 6665 6174 7572 655f 7365        feature_se
+000132a0: 7420 3d20 6665 6174 7572 655f 7365 742e  t = feature_set.
+000132b0: 6469 6374 2829 0a20 2020 2020 2020 2065  dict().        e
+000132c0: 6c69 6620 6973 696e 7374 616e 6365 2866  lif isinstance(f
+000132d0: 6561 7475 7265 5f73 6574 2c20 4665 6174  eature_set, Feat
+000132e0: 7572 6553 6574 293a 0a20 2020 2020 2020  ureSet):.       
+000132f0: 2020 2020 2066 6561 7475 7265 5f73 6574       feature_set
+00013300: 203d 2066 6561 7475 7265 5f73 6574 2e74   = feature_set.t
+00013310: 6f5f 6469 6374 2829 0a0a 2020 2020 2020  o_dict()..      
+00013320: 2020 6e61 6d65 203d 206e 616d 6520 6f72    name = name or
+00013330: 2066 6561 7475 7265 5f73 6574 5b22 6d65   feature_set["me
+00013340: 7461 6461 7461 225d 5b22 6e61 6d65 225d  tadata"]["name"]
+00013350: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+00013360: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00013370: 2070 726f 6a65 6374 206f 7220 6665 6174   project or feat
+00013380: 7572 655f 7365 745b 226d 6574 6164 6174  ure_set["metadat
+00013390: 6122 5d2e 6765 7428 2270 726f 6a65 6374  a"].get("project
+000133a0: 2229 206f 7220 636f 6e66 6967 2e64 6566  ") or config.def
+000133b0: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
+000133c0: 2020 2020 2029 0a20 2020 2020 2020 2070       ).        p
+000133d0: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
+000133e0: 2f7b 7072 6f6a 6563 747d 2f66 6561 7475  /{project}/featu
+000133f0: 7265 2d73 6574 732f 7b6e 616d 657d 2f72  re-sets/{name}/r
+00013400: 6566 6572 656e 6365 732f 7b72 6566 6572  eferences/{refer
+00013410: 656e 6365 7d22 0a20 2020 2020 2020 2065  ence}".        e
+00013420: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
+00013430: 2246 6169 6c65 6420 7374 6f72 696e 6720  "Failed storing 
+00013440: 6665 6174 7572 652d 7365 7420 7b70 726f  feature-set {pro
+00013450: 6a65 6374 7d2f 7b6e 616d 657d 220a 2020  ject}/{name}".  
+00013460: 2020 2020 2020 7265 7370 203d 2073 656c        resp = sel
+00013470: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
+00013480: 2020 2020 2020 2020 2250 5554 222c 2070          "PUT", p
+00013490: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
+000134a0: 6765 2c20 7061 7261 6d73 3d70 6172 616d  ge, params=param
+000134b0: 732c 2062 6f64 793d 6469 6374 5f74 6f5f  s, body=dict_to_
+000134c0: 6a73 6f6e 2866 6561 7475 7265 5f73 6574  json(feature_set
+000134d0: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
+000134e0: 2020 2020 7265 7475 726e 2072 6573 702e      return resp.
+000134f0: 6a73 6f6e 2829 0a0a 2020 2020 6465 6620  json()..    def 
+00013500: 7061 7463 685f 6665 6174 7572 655f 7365  patch_feature_se
+00013510: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
+00013520: 0a20 2020 2020 2020 206e 616d 652c 0a20  .        name,. 
+00013530: 2020 2020 2020 2066 6561 7475 7265 5f73         feature_s
+00013540: 6574 5f75 7064 6174 653a 2064 6963 742c  et_update: dict,
+00013550: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+00013560: 3d22 222c 0a20 2020 2020 2020 2074 6167  ="",.        tag
+00013570: 3d4e 6f6e 652c 0a20 2020 2020 2020 2075  =None,.        u
+00013580: 6964 3d4e 6f6e 652c 0a20 2020 2020 2020  id=None,.       
+00013590: 2070 6174 6368 5f6d 6f64 653a 2055 6e69   patch_mode: Uni
+000135a0: 6f6e 5b0a 2020 2020 2020 2020 2020 2020  on[.            
+000135b0: 7374 722c 206d 6c72 756e 2e63 6f6d 6d6f  str, mlrun.commo
+000135c0: 6e2e 7363 6865 6d61 732e 5061 7463 684d  n.schemas.PatchM
+000135d0: 6f64 650a 2020 2020 2020 2020 5d20 3d20  ode.        ] = 
+000135e0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+000135f0: 656d 6173 2e50 6174 6368 4d6f 6465 2e72  emas.PatchMode.r
+00013600: 6570 6c61 6365 2c0a 2020 2020 293a 0a20  eplace,.    ):. 
+00013610: 2020 2020 2020 2022 2222 4d6f 6469 6679         """Modify
+00013620: 2028 7061 7463 6829 2061 6e20 6578 6973   (patch) an exis
+00013630: 7469 6e67 203a 7079 3a63 6c61 7373 3a60  ting :py:class:`
+00013640: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
+00013650: 746f 7265 2e46 6561 7475 7265 5365 7460  tore.FeatureSet`
+00013660: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
+00013670: 2054 6865 206f 626a 6563 7420 6973 2069   The object is i
+00013680: 6465 6e74 6966 6965 6420 6279 2069 7473  dentified by its
+00013690: 206e 616d 6520 2861 6e64 2070 726f 6a65   name (and proje
+000136a0: 6374 2069 7420 6265 6c6f 6e67 7320 746f  ct it belongs to
+000136b0: 292c 2061 7320 7765 6c6c 2061 7320 6f70  ), as well as op
+000136c0: 7469 6f6e 616c 6c79 2061 2060 6074 6167  tionally a ``tag
+000136d0: 6060 206f 7220 6974 730a 2020 2020 2020  `` or its.      
+000136e0: 2020 6060 7569 6460 6020 2866 6f72 2076    ``uid`` (for v
+000136f0: 6572 7369 6f6e 6564 206f 626a 6563 7429  ersioned object)
+00013700: 2e20 4966 2062 6f74 6820 6060 7461 6760  . If both ``tag`
+00013710: 6020 616e 6420 6060 7569 6460 6020 6172  ` and ``uid`` ar
+00013720: 6520 6f6d 6974 7465 6420 7468 656e 2074  e omitted then t
+00013730: 6865 206f 626a 6563 7420 7769 7468 2074  he object with t
+00013740: 6167 2060 606c 6174 6573 7460 600a 2020  ag ``latest``.  
+00013750: 2020 2020 2020 6973 206d 6f64 6966 6965        is modifie
+00013760: 642e 0a0a 2020 2020 2020 2020 3a70 6172  d...        :par
+00013770: 616d 206e 616d 653a 204e 616d 6520 6f66  am name: Name of
+00013780: 2074 6865 206f 626a 6563 7420 746f 2070   the object to p
+00013790: 6174 6368 2e0a 2020 2020 2020 2020 3a70  atch..        :p
+000137a0: 6172 616d 2066 6561 7475 7265 5f73 6574  aram feature_set
+000137b0: 5f75 7064 6174 653a 2054 6865 206d 6f64  _update: The mod
+000137c0: 6966 6963 6174 696f 6e73 206e 6565 6465  ifications neede
+000137d0: 6420 696e 2074 6865 206f 626a 6563 742e  d in the object.
+000137e0: 2054 6869 7320 7061 7261 6d65 7465 7220   This parameter 
+000137f0: 6f6e 6c79 2068 6173 2074 6865 2063 6861  only has the cha
+00013800: 6e67 6573 2069 6e20 6974 2c0a 2020 2020  nges in it,.    
+00013810: 2020 2020 2020 2020 6e6f 7420 6120 6675          not a fu
+00013820: 6c6c 206f 626a 6563 742e 0a20 2020 2020  ll object..     
+00013830: 2020 2020 2020 2045 7861 6d70 6c65 3a3a         Example::
+00013840: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013850: 2020 6665 6174 7572 655f 7365 745f 7570    feature_set_up
+00013860: 6461 7465 203d 207b 2273 7461 7475 7322  date = {"status"
+00013870: 3a20 7b22 7072 6f63 6573 7365 6422 203a  : {"processed" :
+00013880: 2054 7275 657d 7d0a 0a20 2020 2020 2020   True}}..       
+00013890: 2020 2020 2057 696c 6c20 6170 706c 7920       Will apply 
+000138a0: 7468 6520 6669 656c 6420 6060 7374 6174  the field ``stat
+000138b0: 7573 2e70 726f 6365 7373 6564 6060 2074  us.processed`` t
+000138c0: 6f20 7468 6520 6578 6973 7469 6e67 206f  o the existing o
+000138d0: 626a 6563 742e 0a20 2020 2020 2020 203a  bject..        :
+000138e0: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
+000138f0: 726f 6a65 6374 2077 6869 6368 2063 6f6e  roject which con
+00013900: 7461 696e 7320 7468 6520 6d6f 6469 6669  tains the modifi
+00013910: 6564 206f 626a 6563 742e 0a20 2020 2020  ed object..     
+00013920: 2020 203a 7061 7261 6d20 7461 673a 2054     :param tag: T
+00013930: 6865 2074 6167 206f 6620 7468 6520 6f62  he tag of the ob
+00013940: 6a65 6374 2074 6f20 6d6f 6469 6679 2e0a  ject to modify..
+00013950: 2020 2020 2020 2020 3a70 6172 616d 2075          :param u
+00013960: 6964 3a20 7569 6420 6f66 2074 6865 206f  id: uid of the o
+00013970: 626a 6563 7420 746f 206d 6f64 6966 792e  bject to modify.
+00013980: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00013990: 7061 7463 685f 6d6f 6465 3a20 5468 6520  patch_mode: The 
+000139a0: 7374 7261 7465 6779 2066 6f72 206d 6572  strategy for mer
+000139b0: 6769 6e67 2074 6865 2063 6861 6e67 6573  ging the changes
+000139c0: 2077 6974 6820 7468 6520 6578 6973 7469   with the existi
+000139d0: 6e67 206f 626a 6563 742e 2043 616e 2062  ng object. Can b
+000139e0: 6520 6569 7468 6572 2060 6072 6570 6c61  e either ``repla
+000139f0: 6365 6060 0a20 2020 2020 2020 2020 2020  ce``.           
+00013a00: 206f 7220 6060 6164 6469 7469 7665 6060   or ``additive``
+00013a10: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00013a20: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
+00013a30: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
+00013a40: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
+00013a50: 740a 2020 2020 2020 2020 7265 6665 7265  t.        refere
+00013a60: 6e63 6520 3d20 7365 6c66 2e5f 7265 736f  nce = self._reso
+00013a70: 6c76 655f 7265 6665 7265 6e63 6528 7461  lve_reference(ta
+00013a80: 672c 2075 6964 290a 2020 2020 2020 2020  g, uid).        
+00013a90: 6865 6164 6572 7320 3d20 7b6d 6c72 756e  headers = {mlrun
+00013aa0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00013ab0: 4865 6164 6572 4e61 6d65 732e 7061 7463  HeaderNames.patc
+00013ac0: 685f 6d6f 6465 3a20 7061 7463 685f 6d6f  h_mode: patch_mo
+00013ad0: 6465 7d0a 2020 2020 2020 2020 7061 7468  de}.        path
+00013ae0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+00013af0: 726f 6a65 6374 7d2f 6665 6174 7572 652d  roject}/feature-
+00013b00: 7365 7473 2f7b 6e61 6d65 7d2f 7265 6665  sets/{name}/refe
+00013b10: 7265 6e63 6573 2f7b 7265 6665 7265 6e63  rences/{referenc
+00013b20: 657d 220a 2020 2020 2020 2020 6572 726f  e}".        erro
+00013b30: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+00013b40: 696c 6564 2075 7064 6174 696e 6720 6665  iled updating fe
+00013b50: 6174 7572 652d 7365 7420 7b70 726f 6a65  ature-set {proje
+00013b60: 6374 7d2f 7b6e 616d 657d 220a 2020 2020  ct}/{name}".    
+00013b70: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
+00013b80: 6c28 0a20 2020 2020 2020 2020 2020 2022  l(.            "
+00013b90: 5041 5443 4822 2c0a 2020 2020 2020 2020  PATCH",.        
+00013ba0: 2020 2020 7061 7468 2c0a 2020 2020 2020      path,.      
+00013bb0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+00013bc0: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
+00013bd0: 2062 6f64 793d 6469 6374 5f74 6f5f 6a73   body=dict_to_js
+00013be0: 6f6e 2866 6561 7475 7265 5f73 6574 5f75  on(feature_set_u
+00013bf0: 7064 6174 6529 2c0a 2020 2020 2020 2020  pdate),.        
+00013c00: 2020 2020 6865 6164 6572 733d 6865 6164      headers=head
+00013c10: 6572 732c 0a20 2020 2020 2020 2029 0a0a  ers,.        )..
+00013c20: 2020 2020 6465 6620 6465 6c65 7465 5f66      def delete_f
+00013c30: 6561 7475 7265 5f73 6574 2873 656c 662c  eature_set(self,
+00013c40: 206e 616d 652c 2070 726f 6a65 6374 3d22   name, project="
+00013c50: 222c 2074 6167 3d4e 6f6e 652c 2075 6964  ", tag=None, uid
+00013c60: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00013c70: 2222 2244 656c 6574 6520 6120 3a70 793a  """Delete a :py:
+00013c80: 636c 6173 733a 607e 6d6c 7275 6e2e 6665  class:`~mlrun.fe
+00013c90: 6174 7572 655f 7374 6f72 652e 4665 6174  ature_store.Feat
+00013ca0: 7572 6553 6574 6020 6f62 6a65 6374 2066  ureSet` object f
+00013cb0: 726f 6d20 7468 6520 4442 2e0a 2020 2020  rom the DB..    
+00013cc0: 2020 2020 4966 2060 6074 6167 6060 206f      If ``tag`` o
+00013cd0: 7220 6060 7569 6460 6020 6172 6520 7370  r ``uid`` are sp
+00013ce0: 6563 6966 6965 642c 2074 6865 6e20 6a75  ecified, then ju
+00013cf0: 7374 2074 6865 2076 6572 7369 6f6e 2072  st the version r
+00013d00: 6566 6572 656e 6365 6420 6279 2074 6865  eferenced by the
+00013d10: 6d20 7769 6c6c 2062 6520 6465 6c65 7465  m will be delete
+00013d20: 642e 2055 7369 6e67 2062 6f74 680a 2020  d. Using both.  
+00013d30: 2020 2020 2020 6973 206e 6f74 2061 6c6c        is not all
+00013d40: 6f77 6564 2e0a 2020 2020 2020 2020 4966  owed..        If
+00013d50: 206e 6f6e 6520 6172 6520 7370 6563 6966   none are specif
+00013d60: 6965 642c 2074 6865 6e20 616c 6c20 696e  ied, then all in
+00013d70: 7374 616e 6365 7320 6f66 2074 6865 206f  stances of the o
+00013d80: 626a 6563 7420 7768 6f73 6520 6e61 6d65  bject whose name
+00013d90: 2069 7320 6060 6e61 6d65 6060 2077 696c   is ``name`` wil
+00013da0: 6c20 6265 2064 656c 6574 6564 2e0a 2020  l be deleted..  
+00013db0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00013dc0: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
+00013dd0: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
+00013de0: 6661 756c 745f 7072 6f6a 6563 740a 2020  fault_project.  
+00013df0: 2020 2020 2020 7061 7468 203d 2066 2270        path = f"p
+00013e00: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
+00013e10: 7d2f 6665 6174 7572 652d 7365 7473 2f7b  }/feature-sets/{
+00013e20: 6e61 6d65 7d22 0a0a 2020 2020 2020 2020  name}"..        
+00013e30: 6966 2074 6167 206f 7220 7569 643a 0a20  if tag or uid:. 
+00013e40: 2020 2020 2020 2020 2020 2072 6566 6572             refer
+00013e50: 656e 6365 203d 2073 656c 662e 5f72 6573  ence = self._res
+00013e60: 6f6c 7665 5f72 6566 6572 656e 6365 2874  olve_reference(t
+00013e70: 6167 2c20 7569 6429 0a20 2020 2020 2020  ag, uid).       
+00013e80: 2020 2020 2070 6174 6820 3d20 7061 7468       path = path
+00013e90: 202b 2066 222f 7265 6665 7265 6e63 6573   + f"/references
+00013ea0: 2f7b 7265 6665 7265 6e63 657d 220a 0a20  /{reference}".. 
+00013eb0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00013ec0: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+00013ed0: 6465 6c65 7469 6e67 2066 6561 7475 7265  deleting feature
+00013ee0: 2d73 6574 207b 6e61 6d65 7d22 0a20 2020  -set {name}".   
+00013ef0: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
+00013f00: 6c6c 2822 4445 4c45 5445 222c 2070 6174  ll("DELETE", pat
+00013f10: 682c 2065 7272 6f72 5f6d 6573 7361 6765  h, error_message
+00013f20: 290a 0a20 2020 2064 6566 2063 7265 6174  )..    def creat
+00013f30: 655f 6665 6174 7572 655f 7665 6374 6f72  e_feature_vector
+00013f40: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00013f50: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+00013f60: 7665 6374 6f72 3a20 556e 696f 6e5b 6469  vector: Union[di
+00013f70: 6374 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  ct, mlrun.common
+00013f80: 2e73 6368 656d 6173 2e46 6561 7475 7265  .schemas.Feature
+00013f90: 5665 6374 6f72 2c20 4665 6174 7572 6556  Vector, FeatureV
+00013fa0: 6563 746f 725d 2c0a 2020 2020 2020 2020  ector],.        
+00013fb0: 7072 6f6a 6563 743d 2222 2c0a 2020 2020  project="",.    
+00013fc0: 2020 2020 7665 7273 696f 6e65 643d 5472      versioned=Tr
+00013fd0: 7565 2c0a 2020 2020 2920 2d3e 2064 6963  ue,.    ) -> dic
+00013fe0: 743a 0a20 2020 2020 2020 2022 2222 4372  t:.        """Cr
+00013ff0: 6561 7465 2061 206e 6577 203a 7079 3a63  eate a new :py:c
+00014000: 6c61 7373 3a60 7e6d 6c72 756e 2e66 6561  lass:`~mlrun.fea
+00014010: 7475 7265 5f73 746f 7265 2e46 6561 7475  ture_store.Featu
+00014020: 7265 5665 6374 6f72 6020 616e 6420 7361  reVector` and sa
+00014030: 7665 2069 6e20 7468 6520 3a70 793a 6d6f  ve in the :py:mo
+00014040: 643a 606d 6c72 756e 6020 4442 2e0a 0a20  d:`mlrun` DB... 
+00014050: 2020 2020 2020 203a 7061 7261 6d20 6665         :param fe
+00014060: 6174 7572 655f 7665 6374 6f72 3a20 5468  ature_vector: Th
+00014070: 6520 6e65 7720 3a70 793a 636c 6173 733a  e new :py:class:
+00014080: 607e 6d6c 7275 6e2e 6665 6174 7572 655f  `~mlrun.feature_
+00014090: 7374 6f72 652e 4665 6174 7572 6556 6563  store.FeatureVec
+000140a0: 746f 7260 2074 6f20 6372 6561 7465 2e0a  tor` to create..
+000140b0: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+000140c0: 726f 6a65 6374 3a20 4e61 6d65 206f 6620  roject: Name of 
+000140d0: 7072 6f6a 6563 7420 7468 6973 2066 6561  project this fea
+000140e0: 7475 7265 2d76 6563 746f 7220 6265 6c6f  ture-vector belo
+000140f0: 6e67 7320 746f 2e0a 2020 2020 2020 2020  ngs to..        
+00014100: 3a70 6172 616d 2076 6572 7369 6f6e 6564  :param versioned
+00014110: 3a20 5768 6574 6865 7220 746f 206d 6169  : Whether to mai
+00014120: 6e74 6169 6e20 7665 7273 696f 6e73 2066  ntain versions f
+00014130: 6f72 2074 6869 7320 6665 6174 7572 652d  or this feature-
+00014140: 7665 6374 6f72 2e20 416c 6c20 7665 7273  vector. All vers
+00014150: 696f 6e73 206f 6620 6120 7665 7273 696f  ions of a versio
+00014160: 6e65 6420 6f62 6a65 6374 0a20 2020 2020  ned object.     
+00014170: 2020 2020 2020 2077 696c 6c20 6265 206b         will be k
+00014180: 6570 7420 696e 2074 6865 2044 4220 616e  ept in the DB an
+00014190: 6420 6361 6e20 6265 2072 6574 7269 6576  d can be retriev
+000141a0: 6564 2075 6e74 696c 2065 7870 6c69 6369  ed until explici
+000141b0: 746c 7920 6465 6c65 7465 642e 0a20 2020  tly deleted..   
+000141c0: 2020 2020 203a 7265 7475 726e 733a 2054       :returns: T
+000141d0: 6865 203a 7079 3a63 6c61 7373 3a60 7e6d  he :py:class:`~m
+000141e0: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
+000141f0: 7265 2e46 6561 7475 7265 5665 6374 6f72  re.FeatureVector
+00014200: 6020 6f62 6a65 6374 2028 6173 2064 6963  ` object (as dic
+00014210: 7429 2e0a 2020 2020 2020 2020 2222 220a  t)..        """.
+00014220: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00014230: 7461 6e63 6528 6665 6174 7572 655f 7665  tance(feature_ve
+00014240: 6374 6f72 2c20 6d6c 7275 6e2e 636f 6d6d  ctor, mlrun.comm
+00014250: 6f6e 2e73 6368 656d 6173 2e46 6561 7475  on.schemas.Featu
+00014260: 7265 5665 6374 6f72 293a 0a20 2020 2020  reVector):.     
+00014270: 2020 2020 2020 2066 6561 7475 7265 5f76         feature_v
+00014280: 6563 746f 7220 3d20 6665 6174 7572 655f  ector = feature_
+00014290: 7665 6374 6f72 2e64 6963 7428 290a 2020  vector.dict().  
+000142a0: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+000142b0: 7461 6e63 6528 6665 6174 7572 655f 7665  tance(feature_ve
+000142c0: 6374 6f72 2c20 4665 6174 7572 6556 6563  ctor, FeatureVec
+000142d0: 746f 7229 3a0a 2020 2020 2020 2020 2020  tor):.          
+000142e0: 2020 6665 6174 7572 655f 7665 6374 6f72    feature_vector
+000142f0: 203d 2066 6561 7475 7265 5f76 6563 746f   = feature_vecto
+00014300: 722e 746f 5f64 6963 7428 290a 0a20 2020  r.to_dict()..   
+00014310: 2020 2020 2070 726f 6a65 6374 203d 2028       project = (
+00014320: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
+00014330: 6a65 6374 0a20 2020 2020 2020 2020 2020  ject.           
+00014340: 206f 7220 6665 6174 7572 655f 7665 6374   or feature_vect
+00014350: 6f72 5b22 6d65 7461 6461 7461 225d 2e67  or["metadata"].g
+00014360: 6574 2822 7072 6f6a 6563 7422 2c20 4e6f  et("project", No
+00014370: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
+00014380: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
+00014390: 745f 7072 6f6a 6563 740a 2020 2020 2020  t_project.      
+000143a0: 2020 290a 2020 2020 2020 2020 7061 7468    ).        path
+000143b0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+000143c0: 726f 6a65 6374 7d2f 6665 6174 7572 652d  roject}/feature-
+000143d0: 7665 6374 6f72 7322 0a20 2020 2020 2020  vectors".       
+000143e0: 2070 6172 616d 7320 3d20 7b22 7665 7273   params = {"vers
+000143f0: 696f 6e65 6422 3a20 7665 7273 696f 6e65  ioned": versione
+00014400: 647d 0a0a 2020 2020 2020 2020 6e61 6d65  d}..        name
+00014410: 203d 2066 6561 7475 7265 5f76 6563 746f   = feature_vecto
+00014420: 725b 226d 6574 6164 6174 6122 5d5b 226e  r["metadata"]["n
+00014430: 616d 6522 5d0a 2020 2020 2020 2020 6572  ame"].        er
+00014440: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
+00014450: 4661 696c 6564 2063 7265 6174 696e 6720  Failed creating 
+00014460: 6665 6174 7572 652d 7665 6374 6f72 207b  feature-vector {
+00014470: 7072 6f6a 6563 747d 2f7b 6e61 6d65 7d22  project}/{name}"
+00014480: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
+00014490: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+000144a0: 2020 2020 2020 2020 2020 2022 504f 5354             "POST
+000144b0: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
+000144c0: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
+000144d0: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
+000144e0: 2020 2020 2020 2020 2020 2020 7061 7261              para
+000144f0: 6d73 3d70 6172 616d 732c 0a20 2020 2020  ms=params,.     
+00014500: 2020 2020 2020 2062 6f64 793d 6469 6374         body=dict
+00014510: 5f74 6f5f 6a73 6f6e 2866 6561 7475 7265  _to_json(feature
+00014520: 5f76 6563 746f 7229 2c0a 2020 2020 2020  _vector),.      
+00014530: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
+00014540: 726e 2072 6573 702e 6a73 6f6e 2829 0a0a  rn resp.json()..
+00014550: 2020 2020 6465 6620 6765 745f 6665 6174      def get_feat
+00014560: 7572 655f 7665 6374 6f72 280a 2020 2020  ure_vector(.    
+00014570: 2020 2020 7365 6c66 2c20 6e61 6d65 3a20      self, name: 
+00014580: 7374 722c 2070 726f 6a65 6374 3a20 7374  str, project: st
+00014590: 7220 3d20 2222 2c20 7461 673a 2073 7472  r = "", tag: str
+000145a0: 203d 204e 6f6e 652c 2075 6964 3a20 7374   = None, uid: st
+000145b0: 7220 3d20 4e6f 6e65 0a20 2020 2029 202d  r = None.    ) -
+000145c0: 3e20 4665 6174 7572 6556 6563 746f 723a  > FeatureVector:
+000145d0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+000145e0: 726e 2061 2073 7065 6369 6669 6320 6665  rn a specific fe
+000145f0: 6174 7572 652d 7665 6374 6f72 2072 6566  ature-vector ref
+00014600: 6572 656e 6365 6420 6279 2069 7473 2074  erenced by its t
+00014610: 6167 206f 7220 7569 642e 2049 6620 6e6f  ag or uid. If no
+00014620: 6e65 2061 7265 2070 726f 7669 6465 642c  ne are provided,
+00014630: 2060 606c 6174 6573 7460 6020 7461 6720   ``latest`` tag 
+00014640: 7769 6c6c 0a20 2020 2020 2020 2062 6520  will.        be 
+00014650: 7573 6564 2e22 2222 0a0a 2020 2020 2020  used."""..      
+00014660: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
+00014670: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
+00014680: 6661 756c 745f 7072 6f6a 6563 740a 2020  fault_project.  
+00014690: 2020 2020 2020 7265 6665 7265 6e63 6520        reference 
+000146a0: 3d20 7365 6c66 2e5f 7265 736f 6c76 655f  = self._resolve_
+000146b0: 7265 6665 7265 6e63 6528 7461 672c 2075  reference(tag, u
+000146c0: 6964 290a 2020 2020 2020 2020 7061 7468  id).        path
+000146d0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+000146e0: 726f 6a65 6374 7d2f 6665 6174 7572 652d  roject}/feature-
+000146f0: 7665 6374 6f72 732f 7b6e 616d 657d 2f72  vectors/{name}/r
+00014700: 6566 6572 656e 6365 732f 7b72 6566 6572  eferences/{refer
+00014710: 656e 6365 7d22 0a20 2020 2020 2020 2065  ence}".        e
+00014720: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
+00014730: 2246 6169 6c65 6420 7265 7472 6965 7669  "Failed retrievi
+00014740: 6e67 2066 6561 7475 7265 2d76 6563 746f  ng feature-vecto
+00014750: 7220 7b70 726f 6a65 6374 7d2f 7b6e 616d  r {project}/{nam
+00014760: 657d 220a 2020 2020 2020 2020 7265 7370  e}".        resp
+00014770: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+00014780: 2822 4745 5422 2c20 7061 7468 2c20 6572  ("GET", path, er
+00014790: 726f 725f 6d65 7373 6167 6529 0a20 2020  ror_message).   
+000147a0: 2020 2020 2072 6574 7572 6e20 4665 6174       return Feat
+000147b0: 7572 6556 6563 746f 722e 6672 6f6d 5f64  ureVector.from_d
+000147c0: 6963 7428 7265 7370 2e6a 736f 6e28 2929  ict(resp.json())
+000147d0: 0a0a 2020 2020 6465 6620 6c69 7374 5f66  ..    def list_f
+000147e0: 6561 7475 7265 5f76 6563 746f 7273 280a  eature_vectors(.
+000147f0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00014800: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
+00014810: 7472 203d 2022 222c 0a20 2020 2020 2020  tr = "",.       
+00014820: 206e 616d 653a 2073 7472 203d 204e 6f6e   name: str = Non
+00014830: 652c 0a20 2020 2020 2020 2074 6167 3a20  e,.        tag: 
+00014840: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
+00014850: 2020 2020 7374 6174 653a 2073 7472 203d      state: str =
+00014860: 204e 6f6e 652c 0a20 2020 2020 2020 206c   None,.        l
+00014870: 6162 656c 733a 204c 6973 745b 7374 725d  abels: List[str]
+00014880: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00014890: 2070 6172 7469 7469 6f6e 5f62 793a 2055   partition_by: U
+000148a0: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
+000148b0: 2020 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73    mlrun.common.s
+000148c0: 6368 656d 6173 2e46 6561 7475 7265 5374  chemas.FeatureSt
+000148d0: 6f72 6550 6172 7469 7469 6f6e 4279 4669  orePartitionByFi
+000148e0: 656c 642c 2073 7472 0a20 2020 2020 2020  eld, str.       
+000148f0: 205d 203d 204e 6f6e 652c 0a20 2020 2020   ] = None,.     
+00014900: 2020 2072 6f77 735f 7065 725f 7061 7274     rows_per_part
+00014910: 6974 696f 6e3a 2069 6e74 203d 2031 2c0a  ition: int = 1,.
+00014920: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
+00014930: 6e5f 736f 7274 5f62 793a 2055 6e69 6f6e  n_sort_by: Union
+00014940: 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  [mlrun.common.sc
+00014950: 6865 6d61 732e 536f 7274 4669 656c 642c  hemas.SortField,
+00014960: 2073 7472 5d20 3d20 4e6f 6e65 2c0a 2020   str] = None,.  
+00014970: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
+00014980: 6f72 6465 723a 2055 6e69 6f6e 5b0a 2020  order: Union[.  
+00014990: 2020 2020 2020 2020 2020 6d6c 7275 6e2e            mlrun.
+000149a0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e4f  common.schemas.O
+000149b0: 7264 6572 5479 7065 2c20 7374 720a 2020  rderType, str.  
+000149c0: 2020 2020 2020 5d20 3d20 6d6c 7275 6e2e        ] = mlrun.
+000149d0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e4f  common.schemas.O
+000149e0: 7264 6572 5479 7065 2e64 6573 632c 0a20  rderType.desc,. 
+000149f0: 2020 2029 202d 3e20 4c69 7374 5b46 6561     ) -> List[Fea
+00014a00: 7475 7265 5665 6374 6f72 5d3a 0a20 2020  tureVector]:.   
+00014a10: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
+00014a20: 2061 206c 6973 7420 6f66 2066 6561 7475   a list of featu
+00014a30: 7265 2d76 6563 746f 7273 206d 6174 6368  re-vectors match
+00014a40: 696e 6720 7468 6520 6372 6974 6572 6961  ing the criteria
+00014a50: 2070 726f 7669 6465 642e 0a0a 2020 2020   provided...    
+00014a60: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+00014a70: 6374 3a20 5072 6f6a 6563 7420 6e61 6d65  ct: Project name
+00014a80: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00014a90: 206e 616d 653a 204e 616d 6520 6f66 2066   name: Name of f
+00014aa0: 6561 7475 7265 2d76 6563 746f 7220 746f  eature-vector to
+00014ab0: 206d 6174 6368 2e20 5468 6973 2069 7320   match. This is 
+00014ac0: 6120 6c69 6b65 2071 7565 7279 2c20 616e  a like query, an
+00014ad0: 6420 6973 2063 6173 652d 696e 7365 6e73  d is case-insens
+00014ae0: 6974 6976 652e 0a20 2020 2020 2020 203a  itive..        :
+00014af0: 7061 7261 6d20 7461 673a 204d 6174 6368  param tag: Match
+00014b00: 2066 6561 7475 7265 2d76 6563 746f 7273   feature-vectors
+00014b10: 2077 6974 6820 7370 6563 6966 6963 2074   with specific t
+00014b20: 6167 2e0a 2020 2020 2020 2020 3a70 6172  ag..        :par
+00014b30: 616d 2073 7461 7465 3a20 4d61 7463 6820  am state: Match 
+00014b40: 6665 6174 7572 652d 7665 6374 6f72 7320  feature-vectors 
+00014b50: 7769 7468 2061 2073 7065 6369 6669 6320  with a specific 
+00014b60: 7374 6174 652e 0a20 2020 2020 2020 203a  state..        :
+00014b70: 7061 7261 6d20 6c61 6265 6c73 3a20 4d61  param labels: Ma
+00014b80: 7463 6820 6665 6174 7572 652d 7665 6374  tch feature-vect
+00014b90: 6f72 7320 7768 6963 6820 6861 7665 2074  ors which have t
+00014ba0: 6865 7365 206c 6162 656c 732e 0a20 2020  hese labels..   
+00014bb0: 2020 2020 203a 7061 7261 6d20 7061 7274       :param part
+00014bc0: 6974 696f 6e5f 6279 3a20 4669 656c 6420  ition_by: Field 
+00014bd0: 746f 2067 726f 7570 2072 6573 756c 7473  to group results
+00014be0: 2062 792e 204f 6e6c 7920 616c 6c6f 7765   by. Only allowe
+00014bf0: 6420 7661 6c75 6520 6973 2060 6e61 6d65  d value is `name
+00014c00: 602e 2057 6865 6e20 6070 6172 7469 7469  `. When `partiti
+00014c10: 6f6e 5f62 7960 2069 7320 7370 6563 6966  on_by` is specif
+00014c20: 6965 642c 0a20 2020 2020 2020 2020 2020  ied,.           
+00014c30: 2074 6865 2060 7061 7274 6974 696f 6e5f   the `partition_
+00014c40: 736f 7274 5f62 7960 2070 6172 616d 6574  sort_by` paramet
+00014c50: 6572 206d 7573 7420 6265 2070 726f 7669  er must be provi
+00014c60: 6465 6420 6173 2077 656c 6c2e 0a20 2020  ded as well..   
+00014c70: 2020 2020 203a 7061 7261 6d20 726f 7773       :param rows
+00014c80: 5f70 6572 5f70 6172 7469 7469 6f6e 3a20  _per_partition: 
+00014c90: 486f 7720 6d61 6e79 2074 6f70 2072 6f77  How many top row
+00014ca0: 7320 2870 6572 2073 6f72 7469 6e67 2064  s (per sorting d
+00014cb0: 6566 696e 6564 2062 7920 6070 6172 7469  efined by `parti
+00014cc0: 7469 6f6e 5f73 6f72 745f 6279 6020 616e  tion_sort_by` an
+00014cd0: 6420 6070 6172 7469 7469 6f6e 5f6f 7264  d `partition_ord
+00014ce0: 6572 6029 0a20 2020 2020 2020 2020 2020  er`).           
+00014cf0: 2074 6f20 7265 7475 726e 2070 6572 2067   to return per g
+00014d00: 726f 7570 2e20 4465 6661 756c 7420 7661  roup. Default va
+00014d10: 6c75 6520 6973 2031 2e0a 2020 2020 2020  lue is 1..      
+00014d20: 2020 3a70 6172 616d 2070 6172 7469 7469    :param partiti
+00014d30: 6f6e 5f73 6f72 745f 6279 3a20 5768 6174  on_sort_by: What
+00014d40: 2066 6965 6c64 2074 6f20 736f 7274 2074   field to sort t
+00014d50: 6865 2072 6573 756c 7473 2062 792c 2077  he results by, w
+00014d60: 6974 6869 6e20 6561 6368 2070 6172 7469  ithin each parti
+00014d70: 7469 6f6e 2064 6566 696e 6564 2062 7920  tion defined by 
+00014d80: 6070 6172 7469 7469 6f6e 5f62 7960 2e0a  `partition_by`..
+00014d90: 2020 2020 2020 2020 2020 2020 4375 7272              Curr
+00014da0: 656e 746c 7920 7468 6520 6f6e 6c79 2061  ently the only a
+00014db0: 6c6c 6f77 6564 2076 616c 7565 7320 6172  llowed values ar
+00014dc0: 6520 6063 7265 6174 6564 6020 616e 6420  e `created` and 
+00014dd0: 6075 7064 6174 6564 602e 0a20 2020 2020  `updated`..     
+00014de0: 2020 203a 7061 7261 6d20 7061 7274 6974     :param partit
+00014df0: 696f 6e5f 6f72 6465 723a 204f 7264 6572  ion_order: Order
+00014e00: 206f 6620 736f 7274 696e 6720 7769 7468   of sorting with
+00014e10: 696e 2070 6172 7469 7469 6f6e 7320 2d20  in partitions - 
+00014e20: 6061 7363 6020 6f72 2060 6465 7363 602e  `asc` or `desc`.
+00014e30: 2044 6566 6175 6c74 2069 7320 6064 6573   Default is `des
+00014e40: 6360 2e0a 2020 2020 2020 2020 3a72 6574  c`..        :ret
+00014e50: 7572 6e73 3a20 4c69 7374 206f 6620 6d61  urns: List of ma
+00014e60: 7463 6869 6e67 203a 7079 3a63 6c61 7373  tching :py:class
+00014e70: 3a60 7e6d 6c72 756e 2e66 6561 7475 7265  :`~mlrun.feature
+00014e80: 5f73 746f 7265 2e46 6561 7475 7265 5665  _store.FeatureVe
+00014e90: 6374 6f72 6020 6f62 6a65 6374 732e 0a20  ctor` objects.. 
+00014ea0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00014eb0: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+00014ec0: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+00014ed0: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+00014ee0: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+00014ef0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00014f00: 226e 616d 6522 3a20 6e61 6d65 2c0a 2020  "name": name,.  
+00014f10: 2020 2020 2020 2020 2020 2273 7461 7465            "state
+00014f20: 223a 2073 7461 7465 2c0a 2020 2020 2020  ": state,.      
+00014f30: 2020 2020 2020 2274 6167 223a 2074 6167        "tag": tag
+00014f40: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
+00014f50: 6162 656c 223a 206c 6162 656c 7320 6f72  abel": labels or
+00014f60: 205b 5d2c 0a20 2020 2020 2020 207d 0a20   [],.        }. 
+00014f70: 2020 2020 2020 2069 6620 7061 7274 6974         if partit
+00014f80: 696f 6e5f 6279 3a0a 2020 2020 2020 2020  ion_by:.        
+00014f90: 2020 2020 7061 7261 6d73 2e75 7064 6174      params.updat
+00014fa0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00014fb0: 2020 2073 656c 662e 5f67 656e 6572 6174     self._generat
+00014fc0: 655f 7061 7274 6974 696f 6e5f 6279 5f70  e_partition_by_p
+00014fd0: 6172 616d 7328 0a20 2020 2020 2020 2020  arams(.         
+00014fe0: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
+00014ff0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00015000: 4665 6174 7572 6553 746f 7265 5061 7274  FeatureStorePart
+00015010: 6974 696f 6e42 7946 6965 6c64 2c0a 2020  itionByField,.  
+00015020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015030: 2020 7061 7274 6974 696f 6e5f 6279 2c0a    partition_by,.
+00015040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015050: 2020 2020 726f 7773 5f70 6572 5f70 6172      rows_per_par
+00015060: 7469 7469 6f6e 2c0a 2020 2020 2020 2020  tition,.        
+00015070: 2020 2020 2020 2020 2020 2020 7061 7274              part
+00015080: 6974 696f 6e5f 736f 7274 5f62 792c 0a20  ition_sort_by,. 
+00015090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000150a0: 2020 2070 6172 7469 7469 6f6e 5f6f 7264     partition_ord
+000150b0: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+000150c0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000150d0: 2020 290a 0a20 2020 2020 2020 2070 6174    )..        pat
+000150e0: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
+000150f0: 7072 6f6a 6563 747d 2f66 6561 7475 7265  project}/feature
+00015100: 2d76 6563 746f 7273 220a 0a20 2020 2020  -vectors"..     
+00015110: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+00015120: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00015130: 2066 2246 6169 6c65 6420 6c69 7374 696e   f"Failed listin
+00015140: 6720 6665 6174 7572 652d 7665 6374 6f72  g feature-vector
+00015150: 732c 2070 726f 6a65 6374 3a20 7b70 726f  s, project: {pro
+00015160: 6a65 6374 7d2c 2071 7565 7279 3a20 7b70  ject}, query: {p
+00015170: 6172 616d 737d 220a 2020 2020 2020 2020  arams}".        
+00015180: 290a 2020 2020 2020 2020 7265 7370 203d  ).        resp =
+00015190: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
+000151a0: 4745 5422 2c20 7061 7468 2c20 6572 726f  GET", path, erro
+000151b0: 725f 6d65 7373 6167 652c 2070 6172 616d  r_message, param
+000151c0: 733d 7061 7261 6d73 290a 2020 2020 2020  s=params).      
+000151d0: 2020 6665 6174 7572 655f 7665 6374 6f72    feature_vector
+000151e0: 7320 3d20 7265 7370 2e6a 736f 6e28 295b  s = resp.json()[
+000151f0: 2266 6561 7475 7265 5f76 6563 746f 7273  "feature_vectors
+00015200: 225d 0a20 2020 2020 2020 2069 6620 6665  "].        if fe
+00015210: 6174 7572 655f 7665 6374 6f72 733a 0a20  ature_vectors:. 
+00015220: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00015230: 6e20 5b46 6561 7475 7265 5665 6374 6f72  n [FeatureVector
+00015240: 2e66 726f 6d5f 6469 6374 286f 626a 2920  .from_dict(obj) 
+00015250: 666f 7220 6f62 6a20 696e 2066 6561 7475  for obj in featu
+00015260: 7265 5f76 6563 746f 7273 5d0a 0a20 2020  re_vectors]..   
+00015270: 2064 6566 2073 746f 7265 5f66 6561 7475   def store_featu
+00015280: 7265 5f76 6563 746f 7228 0a20 2020 2020  re_vector(.     
+00015290: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000152a0: 2066 6561 7475 7265 5f76 6563 746f 723a   feature_vector:
+000152b0: 2055 6e69 6f6e 5b64 6963 742c 206d 6c72   Union[dict, mlr
+000152c0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+000152d0: 732e 4665 6174 7572 6556 6563 746f 722c  s.FeatureVector,
+000152e0: 2046 6561 7475 7265 5665 6374 6f72 5d2c   FeatureVector],
+000152f0: 0a20 2020 2020 2020 206e 616d 653d 4e6f  .        name=No
+00015300: 6e65 2c0a 2020 2020 2020 2020 7072 6f6a  ne,.        proj
+00015310: 6563 743d 2222 2c0a 2020 2020 2020 2020  ect="",.        
+00015320: 7461 673d 4e6f 6e65 2c0a 2020 2020 2020  tag=None,.      
+00015330: 2020 7569 643d 4e6f 6e65 2c0a 2020 2020    uid=None,.    
+00015340: 2020 2020 7665 7273 696f 6e65 643d 5472      versioned=Tr
+00015350: 7565 2c0a 2020 2020 2920 2d3e 2064 6963  ue,.    ) -> dic
+00015360: 743a 0a20 2020 2020 2020 2022 2222 5374  t:.        """St
+00015370: 6f72 6520 6120 3a70 793a 636c 6173 733a  ore a :py:class:
+00015380: 607e 6d6c 7275 6e2e 6665 6174 7572 655f  `~mlrun.feature_
+00015390: 7374 6f72 652e 4665 6174 7572 6556 6563  store.FeatureVec
+000153a0: 746f 7260 206f 626a 6563 7420 696e 2074  tor` object in t
+000153b0: 6865 203a 7079 3a6d 6f64 3a60 6d6c 7275  he :py:mod:`mlru
+000153c0: 6e60 2044 422e 2054 6865 0a20 2020 2020  n` DB. The.     
+000153d0: 2020 2066 6561 7475 7265 2d76 6563 746f     feature-vecto
+000153e0: 7220 6361 6e20 6265 2065 6974 6865 7220  r can be either 
+000153f0: 6120 6e65 7720 6f62 6a65 6374 206f 7220  a new object or 
+00015400: 6120 6d6f 6469 6669 6361 7469 6f6e 2074  a modification t
+00015410: 6f20 6578 6973 7469 6e67 206f 626a 6563  o existing objec
+00015420: 7420 7265 6665 7265 6e63 6564 2062 7920  t referenced by 
+00015430: 7468 6520 7061 7261 6d73 0a20 2020 2020  the params.     
+00015440: 2020 206f 6620 7468 6520 6675 6e63 7469     of the functi
+00015450: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
+00015460: 7261 6d20 6665 6174 7572 655f 7665 6374  ram feature_vect
+00015470: 6f72 3a20 5468 6520 3a70 793a 636c 6173  or: The :py:clas
+00015480: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
+00015490: 655f 7374 6f72 652e 4665 6174 7572 6556  e_store.FeatureV
+000154a0: 6563 746f 7260 2074 6f20 7374 6f72 652e  ector` to store.
+000154b0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000154c0: 6e61 6d65 3a20 2020 204e 616d 6520 6f66  name:    Name of
+000154d0: 2066 6561 7475 7265 2076 6563 746f 722e   feature vector.
+000154e0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000154f0: 7072 6f6a 6563 743a 204e 616d 6520 6f66  project: Name of
+00015500: 2070 726f 6a65 6374 2074 6869 7320 6665   project this fe
+00015510: 6174 7572 652d 7665 6374 6f72 2062 656c  ature-vector bel
+00015520: 6f6e 6773 2074 6f2e 0a20 2020 2020 2020  ongs to..       
+00015530: 203a 7061 7261 6d20 7461 673a 2054 6865   :param tag: The
+00015540: 2060 6074 6167 6060 206f 6620 7468 6520   ``tag`` of the 
+00015550: 6f62 6a65 6374 2074 6f20 7265 706c 6163  object to replac
+00015560: 6520 696e 2074 6865 2044 422c 2066 6f72  e in the DB, for
+00015570: 2065 7861 6d70 6c65 2060 606c 6174 6573   example ``lates
+00015580: 7460 602e 0a20 2020 2020 2020 203a 7061  t``..        :pa
+00015590: 7261 6d20 7569 643a 2054 6865 2060 6075  ram uid: The ``u
+000155a0: 6964 6060 206f 6620 7468 6520 6f62 6a65  id`` of the obje
+000155b0: 6374 2074 6f20 7265 706c 6163 6520 696e  ct to replace in
+000155c0: 2074 6865 2044 422e 2049 6620 7573 696e   the DB. If usin
+000155d0: 6720 7468 6973 2070 6172 616d 6574 6572  g this parameter
+000155e0: 2c20 7468 6520 6d6f 6469 6669 6564 206f  , the modified o
+000155f0: 626a 6563 740a 2020 2020 2020 2020 2020  bject.          
+00015600: 2020 6d75 7374 2068 6176 6520 7468 6520    must have the 
+00015610: 7361 6d65 2060 6075 6964 6060 206f 6620  same ``uid`` of 
+00015620: 7468 6520 7072 6576 696f 7573 6c79 2d65  the previously-e
+00015630: 7869 7374 696e 6720 6f62 6a65 6374 2e20  xisting object. 
+00015640: 5468 6973 2063 616e 6e6f 7420 6265 2075  This cannot be u
+00015650: 7365 6420 666f 7220 6e6f 6e2d 7665 7273  sed for non-vers
+00015660: 696f 6e65 6420 6f62 6a65 6374 732e 0a20  ioned objects.. 
+00015670: 2020 2020 2020 203a 7061 7261 6d20 7665         :param ve
+00015680: 7273 696f 6e65 643a 2057 6865 7468 6572  rsioned: Whether
+00015690: 2074 6f20 6d61 696e 7461 696e 2076 6572   to maintain ver
+000156a0: 7369 6f6e 7320 666f 7220 7468 6973 2066  sions for this f
+000156b0: 6561 7475 7265 2d76 6563 746f 722e 2041  eature-vector. A
+000156c0: 6c6c 2076 6572 7369 6f6e 7320 6f66 2061  ll versions of a
+000156d0: 2076 6572 7369 6f6e 6564 206f 626a 6563   versioned objec
+000156e0: 740a 2020 2020 2020 2020 2020 2020 7769  t.            wi
+000156f0: 6c6c 2062 6520 6b65 7074 2069 6e20 7468  ll be kept in th
+00015700: 6520 4442 2061 6e64 2063 616e 2062 6520  e DB and can be 
+00015710: 7265 7472 6965 7665 6420 756e 7469 6c20  retrieved until 
+00015720: 6578 706c 6963 6974 6c79 2064 656c 6574  explicitly delet
+00015730: 6564 2e0a 2020 2020 2020 2020 3a72 6574  ed..        :ret
+00015740: 7572 6e73 3a20 5468 6520 3a70 793a 636c  urns: The :py:cl
+00015750: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
+00015760: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
+00015770: 6556 6563 746f 7260 206f 626a 6563 7420  eVector` object 
+00015780: 2861 7320 6469 6374 292e 0a20 2020 2020  (as dict)..     
+00015790: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+000157a0: 7265 6665 7265 6e63 6520 3d20 7365 6c66  reference = self
+000157b0: 2e5f 7265 736f 6c76 655f 7265 6665 7265  ._resolve_refere
+000157c0: 6e63 6528 7461 672c 2075 6964 290a 2020  nce(tag, uid).  
+000157d0: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
+000157e0: 2276 6572 7369 6f6e 6564 223a 2076 6572  "versioned": ver
+000157f0: 7369 6f6e 6564 7d0a 0a20 2020 2020 2020  sioned}..       
+00015800: 2069 6620 6973 696e 7374 616e 6365 2866   if isinstance(f
+00015810: 6561 7475 7265 5f76 6563 746f 722c 206d  eature_vector, m
+00015820: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+00015830: 6d61 732e 4665 6174 7572 6556 6563 746f  mas.FeatureVecto
+00015840: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+00015850: 6665 6174 7572 655f 7665 6374 6f72 203d  feature_vector =
+00015860: 2066 6561 7475 7265 5f76 6563 746f 722e   feature_vector.
+00015870: 6469 6374 2829 0a20 2020 2020 2020 2065  dict().        e
+00015880: 6c69 6620 6973 696e 7374 616e 6365 2866  lif isinstance(f
+00015890: 6561 7475 7265 5f76 6563 746f 722c 2046  eature_vector, F
+000158a0: 6561 7475 7265 5665 6374 6f72 293a 0a20  eatureVector):. 
+000158b0: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+000158c0: 7265 5f76 6563 746f 7220 3d20 6665 6174  re_vector = feat
+000158d0: 7572 655f 7665 6374 6f72 2e74 6f5f 6469  ure_vector.to_di
+000158e0: 6374 2829 0a0a 2020 2020 2020 2020 6e61  ct()..        na
+000158f0: 6d65 203d 206e 616d 6520 6f72 2066 6561  me = name or fea
+00015900: 7475 7265 5f76 6563 746f 725b 226d 6574  ture_vector["met
+00015910: 6164 6174 6122 5d5b 226e 616d 6522 5d0a  adata"]["name"].
+00015920: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
+00015930: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00015940: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
+00015950: 2020 2020 6f72 2066 6561 7475 7265 5f76      or feature_v
+00015960: 6563 746f 725b 226d 6574 6164 6174 6122  ector["metadata"
+00015970: 5d2e 6765 7428 2270 726f 6a65 6374 2229  ].get("project")
+00015980: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
+00015990: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
+000159a0: 726f 6a65 6374 0a20 2020 2020 2020 2029  roject.        )
+000159b0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+000159c0: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+000159d0: 6563 747d 2f66 6561 7475 7265 2d76 6563  ect}/feature-vec
+000159e0: 746f 7273 2f7b 6e61 6d65 7d2f 7265 6665  tors/{name}/refe
+000159f0: 7265 6e63 6573 2f7b 7265 6665 7265 6e63  rences/{referenc
+00015a00: 657d 220a 2020 2020 2020 2020 6572 726f  e}".        erro
+00015a10: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+00015a20: 696c 6564 2073 746f 7269 6e67 2066 6561  iled storing fea
+00015a30: 7475 7265 2d76 6563 746f 7220 7b70 726f  ture-vector {pro
+00015a40: 6a65 6374 7d2f 7b6e 616d 657d 220a 2020  ject}/{name}".  
+00015a50: 2020 2020 2020 7265 7370 203d 2073 656c        resp = sel
+00015a60: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
+00015a70: 2020 2020 2020 2020 2250 5554 222c 2070          "PUT", p
+00015a80: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
+00015a90: 6765 2c20 7061 7261 6d73 3d70 6172 616d  ge, params=param
+00015aa0: 732c 2062 6f64 793d 6469 6374 5f74 6f5f  s, body=dict_to_
+00015ab0: 6a73 6f6e 2866 6561 7475 7265 5f76 6563  json(feature_vec
+00015ac0: 746f 7229 0a20 2020 2020 2020 2029 0a20  tor).        ). 
+00015ad0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00015ae0: 7370 2e6a 736f 6e28 290a 0a20 2020 2064  sp.json()..    d
+00015af0: 6566 2070 6174 6368 5f66 6561 7475 7265  ef patch_feature
+00015b00: 5f76 6563 746f 7228 0a20 2020 2020 2020  _vector(.       
+00015b10: 2073 656c 662c 0a20 2020 2020 2020 206e   self,.        n
+00015b20: 616d 652c 0a20 2020 2020 2020 2066 6561  ame,.        fea
+00015b30: 7475 7265 5f76 6563 746f 725f 7570 6461  ture_vector_upda
+00015b40: 7465 3a20 6469 6374 2c0a 2020 2020 2020  te: dict,.      
+00015b50: 2020 7072 6f6a 6563 743d 2222 2c0a 2020    project="",.  
+00015b60: 2020 2020 2020 7461 673d 4e6f 6e65 2c0a        tag=None,.
+00015b70: 2020 2020 2020 2020 7569 643d 4e6f 6e65          uid=None
+00015b80: 2c0a 2020 2020 2020 2020 7061 7463 685f  ,.        patch_
+00015b90: 6d6f 6465 3a20 556e 696f 6e5b 0a20 2020  mode: Union[.   
+00015ba0: 2020 2020 2020 2020 2073 7472 2c20 6d6c           str, ml
+00015bb0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00015bc0: 6173 2e50 6174 6368 4d6f 6465 0a20 2020  as.PatchMode.   
+00015bd0: 2020 2020 205d 203d 206d 6c72 756e 2e63       ] = mlrun.c
+00015be0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5061  ommon.schemas.Pa
+00015bf0: 7463 684d 6f64 652e 7265 706c 6163 652c  tchMode.replace,
+00015c00: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00015c10: 2222 224d 6f64 6966 7920 2870 6174 6368  """Modify (patch
+00015c20: 2920 616e 2065 7869 7374 696e 6720 3a70  ) an existing :p
+00015c30: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+00015c40: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
+00015c50: 6174 7572 6556 6563 746f 7260 206f 626a  atureVector` obj
+00015c60: 6563 742e 0a20 2020 2020 2020 2054 6865  ect..        The
+00015c70: 206f 626a 6563 7420 6973 2069 6465 6e74   object is ident
+00015c80: 6966 6965 6420 6279 2069 7473 206e 616d  ified by its nam
+00015c90: 6520 2861 6e64 2070 726f 6a65 6374 2069  e (and project i
+00015ca0: 7420 6265 6c6f 6e67 7320 746f 292c 2061  t belongs to), a
+00015cb0: 7320 7765 6c6c 2061 7320 6f70 7469 6f6e  s well as option
+00015cc0: 616c 6c79 2061 2060 6074 6167 6060 206f  ally a ``tag`` o
+00015cd0: 7220 6974 730a 2020 2020 2020 2020 6060  r its.        ``
+00015ce0: 7569 6460 6020 2866 6f72 2076 6572 7369  uid`` (for versi
+00015cf0: 6f6e 6564 206f 626a 6563 7429 2e20 4966  oned object). If
+00015d00: 2062 6f74 6820 6060 7461 6760 6020 616e   both ``tag`` an
+00015d10: 6420 6060 7569 6460 6020 6172 6520 6f6d  d ``uid`` are om
+00015d20: 6974 7465 6420 7468 656e 2074 6865 206f  itted then the o
+00015d30: 626a 6563 7420 7769 7468 2074 6167 2060  bject with tag `
+00015d40: 606c 6174 6573 7460 600a 2020 2020 2020  `latest``.      
+00015d50: 2020 6973 206d 6f64 6966 6965 642e 0a0a    is modified...
+00015d60: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+00015d70: 616d 653a 204e 616d 6520 6f66 2074 6865  ame: Name of the
+00015d80: 206f 626a 6563 7420 746f 2070 6174 6368   object to patch
+00015d90: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00015da0: 2066 6561 7475 7265 5f76 6563 746f 725f   feature_vector_
+00015db0: 7570 6461 7465 3a20 5468 6520 6d6f 6469  update: The modi
+00015dc0: 6669 6361 7469 6f6e 7320 6e65 6564 6564  fications needed
+00015dd0: 2069 6e20 7468 6520 6f62 6a65 6374 2e20   in the object. 
+00015de0: 5468 6973 2070 6172 616d 6574 6572 206f  This parameter o
+00015df0: 6e6c 7920 6861 7320 7468 6520 6368 616e  nly has the chan
+00015e00: 6765 7320 696e 2069 742c 0a20 2020 2020  ges in it,.     
+00015e10: 2020 2020 2020 206e 6f74 2061 2066 756c         not a ful
+00015e20: 6c20 6f62 6a65 6374 2e0a 2020 2020 2020  l object..      
+00015e30: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+00015e40: 3a20 5072 6f6a 6563 7420 7768 6963 6820  : Project which 
+00015e50: 636f 6e74 6169 6e73 2074 6865 206d 6f64  contains the mod
+00015e60: 6966 6965 6420 6f62 6a65 6374 2e0a 2020  ified object..  
+00015e70: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
+00015e80: 3a20 5468 6520 7461 6720 6f66 2074 6865  : The tag of the
+00015e90: 206f 626a 6563 7420 746f 206d 6f64 6966   object to modif
+00015ea0: 792e 0a20 2020 2020 2020 203a 7061 7261  y..        :para
+00015eb0: 6d20 7569 643a 2075 6964 206f 6620 7468  m uid: uid of th
+00015ec0: 6520 6f62 6a65 6374 2074 6f20 6d6f 6469  e object to modi
+00015ed0: 6679 2e0a 2020 2020 2020 2020 3a70 6172  fy..        :par
+00015ee0: 616d 2070 6174 6368 5f6d 6f64 653a 2054  am patch_mode: T
+00015ef0: 6865 2073 7472 6174 6567 7920 666f 7220  he strategy for 
+00015f00: 6d65 7267 696e 6720 7468 6520 6368 616e  merging the chan
+00015f10: 6765 7320 7769 7468 2074 6865 2065 7869  ges with the exi
+00015f20: 7374 696e 6720 6f62 6a65 6374 2e20 4361  sting object. Ca
+00015f30: 6e20 6265 2065 6974 6865 7220 6060 7265  n be either ``re
+00015f40: 706c 6163 6560 600a 2020 2020 2020 2020  place``.        
+00015f50: 2020 2020 6f72 2060 6061 6464 6974 6976      or ``additiv
+00015f60: 6560 602e 0a20 2020 2020 2020 2022 2222  e``..        """
+00015f70: 0a20 2020 2020 2020 2072 6566 6572 656e  .        referen
+00015f80: 6365 203d 2073 656c 662e 5f72 6573 6f6c  ce = self._resol
+00015f90: 7665 5f72 6566 6572 656e 6365 2874 6167  ve_reference(tag
+00015fa0: 2c20 7569 6429 0a20 2020 2020 2020 2070  , uid).        p
+00015fb0: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
+00015fc0: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
+00015fd0: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
+00015fe0: 2020 2068 6561 6465 7273 203d 207b 6d6c     headers = {ml
+00015ff0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00016000: 6173 2e48 6561 6465 724e 616d 6573 2e70  as.HeaderNames.p
+00016010: 6174 6368 5f6d 6f64 653a 2070 6174 6368  atch_mode: patch
+00016020: 5f6d 6f64 657d 0a20 2020 2020 2020 2070  _mode}.        p
+00016030: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
+00016040: 2f7b 7072 6f6a 6563 747d 2f66 6561 7475  /{project}/featu
+00016050: 7265 2d76 6563 746f 7273 2f7b 6e61 6d65  re-vectors/{name
+00016060: 7d2f 7265 6665 7265 6e63 6573 2f7b 7265  }/references/{re
+00016070: 6665 7265 6e63 657d 220a 2020 2020 2020  ference}".      
+00016080: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
+00016090: 3d20 6622 4661 696c 6564 2075 7064 6174  = f"Failed updat
+000160a0: 696e 6720 6665 6174 7572 652d 7665 6374  ing feature-vect
+000160b0: 6f72 207b 7072 6f6a 6563 747d 2f7b 6e61  or {project}/{na
+000160c0: 6d65 7d22 0a20 2020 2020 2020 2073 656c  me}".        sel
+000160d0: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
+000160e0: 2020 2020 2020 2020 2250 4154 4348 222c          "PATCH",
+000160f0: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
+00016100: 682c 0a20 2020 2020 2020 2020 2020 2065  h,.            e
+00016110: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
+00016120: 2020 2020 2020 2020 2020 626f 6479 3d64            body=d
+00016130: 6963 745f 746f 5f6a 736f 6e28 6665 6174  ict_to_json(feat
+00016140: 7572 655f 7665 6374 6f72 5f75 7064 6174  ure_vector_updat
+00016150: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
+00016160: 6865 6164 6572 733d 6865 6164 6572 732c  headers=headers,
+00016170: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00016180: 6465 6620 6465 6c65 7465 5f66 6561 7475  def delete_featu
+00016190: 7265 5f76 6563 746f 7228 7365 6c66 2c20  re_vector(self, 
+000161a0: 6e61 6d65 2c20 7072 6f6a 6563 743d 2222  name, project=""
+000161b0: 2c20 7461 673d 4e6f 6e65 2c20 7569 643d  , tag=None, uid=
+000161c0: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
+000161d0: 2222 4465 6c65 7465 2061 203a 7079 3a63  ""Delete a :py:c
+000161e0: 6c61 7373 3a60 7e6d 6c72 756e 2e66 6561  lass:`~mlrun.fea
+000161f0: 7475 7265 5f73 746f 7265 2e46 6561 7475  ture_store.Featu
+00016200: 7265 5665 6374 6f72 6020 6f62 6a65 6374  reVector` object
+00016210: 2066 726f 6d20 7468 6520 4442 2e0a 2020   from the DB..  
+00016220: 2020 2020 2020 4966 2060 6074 6167 6060        If ``tag``
+00016230: 206f 7220 6060 7569 6460 6020 6172 6520   or ``uid`` are 
+00016240: 7370 6563 6966 6965 642c 2074 6865 6e20  specified, then 
+00016250: 6a75 7374 2074 6865 2076 6572 7369 6f6e  just the version
+00016260: 2072 6566 6572 656e 6365 6420 6279 2074   referenced by t
+00016270: 6865 6d20 7769 6c6c 2062 6520 6465 6c65  hem will be dele
+00016280: 7465 642e 2055 7369 6e67 2062 6f74 680a  ted. Using both.
+00016290: 2020 2020 2020 2020 6973 206e 6f74 2061          is not a
+000162a0: 6c6c 6f77 6564 2e0a 2020 2020 2020 2020  llowed..        
+000162b0: 4966 206e 6f6e 6520 6172 6520 7370 6563  If none are spec
+000162c0: 6966 6965 642c 2074 6865 6e20 616c 6c20  ified, then all 
+000162d0: 696e 7374 616e 6365 7320 6f66 2074 6865  instances of the
+000162e0: 206f 626a 6563 7420 7768 6f73 6520 6e61   object whose na
+000162f0: 6d65 2069 7320 6060 6e61 6d65 6060 2077  me is ``name`` w
+00016300: 696c 6c20 6265 2064 656c 6574 6564 2e0a  ill be deleted..
+00016310: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00016320: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+00016330: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+00016340: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+00016350: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+00016360: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
+00016370: 6374 7d2f 6665 6174 7572 652d 7665 6374  ct}/feature-vect
+00016380: 6f72 732f 7b6e 616d 657d 220a 2020 2020  ors/{name}".    
+00016390: 2020 2020 6966 2074 6167 206f 7220 7569      if tag or ui
+000163a0: 643a 0a20 2020 2020 2020 2020 2020 2072  d:.            r
+000163b0: 6566 6572 656e 6365 203d 2073 656c 662e  eference = self.
+000163c0: 5f72 6573 6f6c 7665 5f72 6566 6572 656e  _resolve_referen
+000163d0: 6365 2874 6167 2c20 7569 6429 0a20 2020  ce(tag, uid).   
+000163e0: 2020 2020 2020 2020 2070 6174 6820 3d20           path = 
+000163f0: 7061 7468 202b 2066 222f 7265 6665 7265  path + f"/refere
+00016400: 6e63 6573 2f7b 7265 6665 7265 6e63 657d  nces/{reference}
+00016410: 220a 0a20 2020 2020 2020 2065 7272 6f72  "..        error
+00016420: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
+00016430: 6c65 6420 6465 6c65 7469 6e67 2066 6561  led deleting fea
+00016440: 7475 7265 2d76 6563 746f 7220 7b6e 616d  ture-vector {nam
+00016450: 657d 220a 2020 2020 2020 2020 7365 6c66  e}".        self
+00016460: 2e61 7069 5f63 616c 6c28 2244 454c 4554  .api_call("DELET
+00016470: 4522 2c20 7061 7468 2c20 6572 726f 725f  E", path, error_
+00016480: 6d65 7373 6167 6529 0a0a 2020 2020 6465  message)..    de
+00016490: 6620 7461 675f 6f62 6a65 6374 7328 0a20  f tag_objects(. 
+000164a0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+000164b0: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
+000164c0: 722c 0a20 2020 2020 2020 2074 6167 5f6e  r,.        tag_n
+000164d0: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
+000164e0: 2020 6f62 6a65 6374 733a 2055 6e69 6f6e    objects: Union
+000164f0: 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  [mlrun.common.sc
+00016500: 6865 6d61 732e 5461 674f 626a 6563 7473  hemas.TagObjects
+00016510: 2c20 6469 6374 5d2c 0a20 2020 2020 2020  , dict],.       
+00016520: 2072 6570 6c61 6365 3a20 626f 6f6c 203d   replace: bool =
+00016530: 2046 616c 7365 2c0a 2020 2020 293a 0a20   False,.    ):. 
+00016540: 2020 2020 2020 2022 2222 5461 6720 6120         """Tag a 
+00016550: 6c69 7374 206f 6620 6f62 6a65 6374 732e  list of objects.
+00016560: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00016570: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
+00016580: 7420 7768 6963 6820 636f 6e74 6169 6e73  t which contains
+00016590: 2074 6865 206f 626a 6563 7473 2e0a 2020   the objects..  
+000165a0: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
+000165b0: 5f6e 616d 653a 2054 6865 2074 6167 2074  _name: The tag t
+000165c0: 6f20 7365 7420 6f6e 2074 6865 206f 626a  o set on the obj
+000165d0: 6563 7473 2e0a 2020 2020 2020 2020 3a70  ects..        :p
+000165e0: 6172 616d 206f 626a 6563 7473 3a20 5468  aram objects: Th
+000165f0: 6520 6f62 6a65 6374 7320 746f 2074 6167  e objects to tag
+00016600: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00016610: 2072 6570 6c61 6365 3a20 5768 6574 6865   replace: Whethe
+00016620: 7220 746f 2072 6570 6c61 6365 2074 6865  r to replace the
+00016630: 2065 7869 7374 696e 6720 7461 6773 206f   existing tags o
+00016640: 6620 7468 6520 6f62 6a65 6374 7320 6f72  f the objects or
+00016650: 2074 6f20 6164 6420 7468 6520 6e65 7720   to add the new 
+00016660: 7461 6720 746f 2074 6865 6d2e 0a20 2020  tag to them..   
+00016670: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00016680: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
+00016690: 6374 732f 7b70 726f 6a65 6374 7d2f 7461  cts/{project}/ta
+000166a0: 6773 2f7b 7461 675f 6e61 6d65 7d22 0a20  gs/{tag_name}". 
+000166b0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+000166c0: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+000166d0: 746f 2074 6167 207b 7461 675f 6e61 6d65  to tag {tag_name
+000166e0: 7d20 6f6e 206f 626a 6563 7473 207b 6f62  } on objects {ob
+000166f0: 6a65 6374 737d 220a 2020 2020 2020 2020  jects}".        
+00016700: 6d65 7468 6f64 203d 2022 504f 5354 2220  method = "POST" 
+00016710: 6966 2072 6570 6c61 6365 2065 6c73 6520  if replace else 
+00016720: 2250 5554 220a 2020 2020 2020 2020 7365  "PUT".        se
+00016730: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
+00016740: 2020 2020 2020 2020 206d 6574 686f 642c           method,
+00016750: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
+00016760: 682c 0a20 2020 2020 2020 2020 2020 2065  h,.            e
+00016770: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
+00016780: 2020 2020 2020 2020 2020 626f 6479 3d64            body=d
+00016790: 6963 745f 746f 5f6a 736f 6e28 0a20 2020  ict_to_json(.   
+000167a0: 2020 2020 2020 2020 2020 2020 206f 626a               obj
+000167b0: 6563 7473 2e64 6963 7428 290a 2020 2020  ects.dict().    
+000167c0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+000167d0: 7369 6e73 7461 6e63 6528 6f62 6a65 6374  sinstance(object
+000167e0: 732c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  s, mlrun.common.
+000167f0: 7363 6865 6d61 732e 5461 674f 626a 6563  schemas.TagObjec
+00016800: 7473 290a 2020 2020 2020 2020 2020 2020  ts).            
+00016810: 2020 2020 656c 7365 206f 626a 6563 7473      else objects
+00016820: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
+00016830: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00016840: 6566 2064 656c 6574 655f 6f62 6a65 6374  ef delete_object
+00016850: 735f 7461 6728 0a20 2020 2020 2020 2073  s_tag(.        s
+00016860: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
+00016870: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
+00016880: 2020 2074 6167 5f6e 616d 653a 2073 7472     tag_name: str
+00016890: 2c0a 2020 2020 2020 2020 7461 675f 6f62  ,.        tag_ob
+000168a0: 6a65 6374 733a 2055 6e69 6f6e 5b6d 6c72  jects: Union[mlr
+000168b0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+000168c0: 732e 5461 674f 626a 6563 7473 2c20 6469  s.TagObjects, di
+000168d0: 6374 5d2c 0a20 2020 2029 3a0a 2020 2020  ct],.    ):.    
+000168e0: 2020 2020 2222 2244 656c 6574 6520 6120      """Delete a 
+000168f0: 7461 6720 6672 6f6d 2061 206c 6973 7420  tag from a list 
+00016900: 6f66 206f 626a 6563 7473 2e0a 0a20 2020  of objects...   
+00016910: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+00016920: 6563 743a 2050 726f 6a65 6374 2077 6869  ect: Project whi
+00016930: 6368 2063 6f6e 7461 696e 7320 7468 6520  ch contains the 
+00016940: 6f62 6a65 6374 732e 0a20 2020 2020 2020  objects..       
+00016950: 203a 7061 7261 6d20 7461 675f 6e61 6d65   :param tag_name
+00016960: 3a20 5468 6520 7461 6720 746f 2064 656c  : The tag to del
+00016970: 6574 6520 6672 6f6d 2074 6865 206f 626a  ete from the obj
+00016980: 6563 7473 2e0a 2020 2020 2020 2020 3a70  ects..        :p
+00016990: 6172 616d 2074 6167 5f6f 626a 6563 7473  aram tag_objects
+000169a0: 3a20 5468 6520 6f62 6a65 6374 7320 746f  : The objects to
+000169b0: 2064 656c 6574 6520 7468 6520 7461 6720   delete the tag 
+000169c0: 6672 6f6d 2e0a 0a20 2020 2020 2020 2022  from...        "
+000169d0: 2222 0a20 2020 2020 2020 2070 6174 6820  "".        path 
+000169e0: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+000169f0: 6f6a 6563 747d 2f74 6167 732f 7b74 6167  oject}/tags/{tag
+00016a00: 5f6e 616d 657d 220a 2020 2020 2020 2020  _name}".        
+00016a10: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+00016a20: 6622 4661 696c 6564 2064 656c 6574 696e  f"Failed deletin
+00016a30: 6720 7461 6720 6672 6f6d 207b 7461 675f  g tag from {tag_
+00016a40: 6e61 6d65 7d22 0a20 2020 2020 2020 2073  name}".        s
+00016a50: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+00016a60: 2020 2020 2020 2020 2020 2244 454c 4554            "DELET
+00016a70: 4522 2c0a 2020 2020 2020 2020 2020 2020  E",.            
+00016a80: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
+00016a90: 2020 6572 726f 725f 6d65 7373 6167 652c    error_message,
+00016aa0: 0a20 2020 2020 2020 2020 2020 2062 6f64  .            bod
+00016ab0: 793d 6469 6374 5f74 6f5f 6a73 6f6e 280a  y=dict_to_json(.
+00016ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ad0: 7461 675f 6f62 6a65 6374 732e 6469 6374  tag_objects.dict
+00016ae0: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+00016af0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00016b00: 2874 6167 5f6f 626a 6563 7473 2c20 6d6c  (tag_objects, ml
+00016b10: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00016b20: 6173 2e54 6167 4f62 6a65 6374 7329 0a20  as.TagObjects). 
+00016b30: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00016b40: 6c73 6520 7461 675f 6f62 6a65 6374 730a  lse tag_objects.
+00016b50: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+00016b60: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00016b70: 6620 7461 675f 6172 7469 6661 6374 7328  f tag_artifacts(
+00016b80: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00016b90: 2020 2020 2020 2061 7274 6966 6163 7473         artifacts
+00016ba0: 3a20 556e 696f 6e5b 4c69 7374 5b41 7274  : Union[List[Art
+00016bb0: 6966 6163 745d 2c20 4c69 7374 5b64 6963  ifact], List[dic
+00016bc0: 745d 2c20 4172 7469 6661 6374 2c20 6469  t], Artifact, di
+00016bd0: 6374 5d2c 0a20 2020 2020 2020 2070 726f  ct],.        pro
+00016be0: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
+00016bf0: 2020 2074 6167 5f6e 616d 653a 2073 7472     tag_name: str
+00016c00: 2c0a 2020 2020 2020 2020 7265 706c 6163  ,.        replac
+00016c10: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
+00016c20: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00016c30: 2222 2254 6167 2061 206c 6973 7420 6f66  """Tag a list of
+00016c40: 2061 7274 6966 6163 7473 2e0a 0a20 2020   artifacts...   
+00016c50: 2020 2020 203a 7061 7261 6d20 6172 7469       :param arti
+00016c60: 6661 6374 733a 2054 6865 2061 7274 6966  facts: The artif
+00016c70: 6163 7473 2074 6f20 7461 672e 2043 616e  acts to tag. Can
+00016c80: 2062 6520 6120 6c69 7374 206f 6620 3a70   be a list of :p
+00016c90: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+00016ca0: 6172 7469 6661 6374 732e 4172 7469 6661  artifacts.Artifa
+00016cb0: 6374 6020 6f62 6a65 6374 7320 6f72 0a20  ct` objects or. 
+00016cc0: 2020 2020 2020 2020 2020 2064 6963 7469             dicti
+00016cd0: 6f6e 6172 6965 732c 206f 7220 6120 7369  onaries, or a si
+00016ce0: 6e67 6c65 206f 626a 6563 742e 0a20 2020  ngle object..   
+00016cf0: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+00016d00: 6563 743a 2050 726f 6a65 6374 2077 6869  ect: Project whi
+00016d10: 6368 2063 6f6e 7461 696e 7320 7468 6520  ch contains the 
+00016d20: 6172 7469 6661 6374 732e 0a20 2020 2020  artifacts..     
+00016d30: 2020 203a 7061 7261 6d20 7461 675f 6e61     :param tag_na
+00016d40: 6d65 3a20 5468 6520 7461 6720 746f 2073  me: The tag to s
+00016d50: 6574 206f 6e20 7468 6520 6172 7469 6661  et on the artifa
+00016d60: 6374 732e 0a20 2020 2020 2020 203a 7061  cts..        :pa
+00016d70: 7261 6d20 7265 706c 6163 653a 2049 6620  ram replace: If 
+00016d80: 5472 7565 2c20 7265 706c 6163 6520 6578  True, replace ex
+00016d90: 6973 7469 6e67 2074 6167 732c 206f 7468  isting tags, oth
+00016da0: 6572 7769 7365 2061 7070 656e 6420 746f  erwise append to
+00016db0: 2065 7869 7374 696e 6720 7461 6773 2e0a   existing tags..
+00016dc0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00016dd0: 2020 2020 7461 675f 6f62 6a65 6374 7320      tag_objects 
+00016de0: 3d20 7365 6c66 2e5f 7265 736f 6c76 655f  = self._resolve_
+00016df0: 6172 7469 6661 6374 735f 746f 5f74 6167  artifacts_to_tag
+00016e00: 5f6f 626a 6563 7473 2861 7274 6966 6163  _objects(artifac
+00016e10: 7473 290a 2020 2020 2020 2020 7365 6c66  ts).        self
+00016e20: 2e74 6167 5f6f 626a 6563 7473 2870 726f  .tag_objects(pro
+00016e30: 6a65 6374 2c20 7461 675f 6e61 6d65 2c20  ject, tag_name, 
+00016e40: 6f62 6a65 6374 733d 7461 675f 6f62 6a65  objects=tag_obje
+00016e50: 6374 732c 2072 6570 6c61 6365 3d72 6570  cts, replace=rep
+00016e60: 6c61 6365 290a 0a20 2020 2064 6566 2064  lace)..    def d
+00016e70: 656c 6574 655f 6172 7469 6661 6374 735f  elete_artifacts_
+00016e80: 7461 6773 280a 2020 2020 2020 2020 7365  tags(.        se
+00016e90: 6c66 2c0a 2020 2020 2020 2020 6172 7469  lf,.        arti
+00016ea0: 6661 6374 732c 0a20 2020 2020 2020 2070  facts,.        p
+00016eb0: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
+00016ec0: 2020 2020 2074 6167 5f6e 616d 653a 2073       tag_name: s
+00016ed0: 7472 2c0a 2020 2020 293a 0a20 2020 2020  tr,.    ):.     
+00016ee0: 2020 2022 2222 4465 6c65 7465 2074 6167     """Delete tag
+00016ef0: 2066 726f 6d20 6120 6c69 7374 206f 6620   from a list of 
+00016f00: 6172 7469 6661 6374 732e 0a0a 2020 2020  artifacts...    
+00016f10: 2020 2020 3a70 6172 616d 2061 7274 6966      :param artif
+00016f20: 6163 7473 3a20 5468 6520 6172 7469 6661  acts: The artifa
+00016f30: 6374 7320 746f 2064 656c 6574 6520 7468  cts to delete th
+00016f40: 6520 7461 6720 6672 6f6d 2e20 4361 6e20  e tag from. Can 
+00016f50: 6265 2061 206c 6973 7420 6f66 203a 7079  be a list of :py
+00016f60: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e61  :class:`~mlrun.a
+00016f70: 7274 6966 6163 7473 2e41 7274 6966 6163  rtifacts.Artifac
+00016f80: 7460 0a20 2020 2020 2020 2020 2020 206f  t`.            o
+00016f90: 626a 6563 7473 206f 7220 6469 6374 696f  bjects or dictio
+00016fa0: 6e61 7269 6573 2c20 6f72 2061 2073 696e  naries, or a sin
+00016fb0: 676c 6520 6f62 6a65 6374 2e0a 2020 2020  gle object..    
+00016fc0: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+00016fd0: 6374 3a20 5072 6f6a 6563 7420 7768 6963  ct: Project whic
+00016fe0: 6820 636f 6e74 6169 6e73 2074 6865 2061  h contains the a
+00016ff0: 7274 6966 6163 7473 2e0a 2020 2020 2020  rtifacts..      
+00017000: 2020 3a70 6172 616d 2074 6167 5f6e 616d    :param tag_nam
+00017010: 653a 2054 6865 2074 6167 2074 6f20 7365  e: The tag to se
+00017020: 7420 6f6e 2074 6865 2061 7274 6966 6163  t on the artifac
+00017030: 7473 2e0a 2020 2020 2020 2020 2222 220a  ts..        """.
+00017040: 2020 2020 2020 2020 7461 675f 6f62 6a65          tag_obje
+00017050: 6374 7320 3d20 7365 6c66 2e5f 7265 736f  cts = self._reso
+00017060: 6c76 655f 6172 7469 6661 6374 735f 746f  lve_artifacts_to
+00017070: 5f74 6167 5f6f 626a 6563 7473 2861 7274  _tag_objects(art
+00017080: 6966 6163 7473 290a 2020 2020 2020 2020  ifacts).        
+00017090: 7365 6c66 2e64 656c 6574 655f 6f62 6a65  self.delete_obje
+000170a0: 6374 735f 7461 6728 7072 6f6a 6563 742c  cts_tag(project,
+000170b0: 2074 6167 5f6e 616d 652c 2074 6167 5f6f   tag_name, tag_o
+000170c0: 626a 6563 7473 290a 0a20 2020 2064 6566  bjects)..    def
+000170d0: 206c 6973 745f 7072 6f6a 6563 7473 280a   list_projects(.
+000170e0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+000170f0: 2020 2020 2020 6f77 6e65 723a 2073 7472        owner: str
+00017100: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00017110: 2066 6f72 6d61 745f 3a20 556e 696f 6e5b   format_: Union[
+00017120: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+00017130: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
+00017140: 6368 656d 6173 2e50 726f 6a65 6374 7346  chemas.ProjectsF
+00017150: 6f72 6d61 740a 2020 2020 2020 2020 5d20  ormat.        ] 
+00017160: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
+00017170: 6368 656d 6173 2e50 726f 6a65 6374 7346  chemas.ProjectsF
+00017180: 6f72 6d61 742e 6675 6c6c 2c0a 2020 2020  ormat.full,.    
+00017190: 2020 2020 6c61 6265 6c73 3a20 4c69 7374      labels: List
+000171a0: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+000171b0: 2020 2020 2020 7374 6174 653a 2055 6e69        state: Uni
+000171c0: 6f6e 5b73 7472 2c20 6d6c 7275 6e2e 636f  on[str, mlrun.co
+000171d0: 6d6d 6f6e 2e73 6368 656d 6173 2e50 726f  mmon.schemas.Pro
+000171e0: 6a65 6374 5374 6174 655d 203d 204e 6f6e  jectState] = Non
+000171f0: 652c 0a20 2020 2029 202d 3e20 4c69 7374  e,.    ) -> List
+00017200: 5b55 6e69 6f6e 5b6d 6c72 756e 2e70 726f  [Union[mlrun.pro
+00017210: 6a65 6374 732e 4d6c 7275 6e50 726f 6a65  jects.MlrunProje
+00017220: 6374 2c20 7374 725d 5d3a 0a20 2020 2020  ct, str]]:.     
+00017230: 2020 2022 2222 5265 7475 726e 2061 206c     """Return a l
+00017240: 6973 7420 6f66 2074 6865 2065 7869 7374  ist of the exist
+00017250: 696e 6720 7072 6f6a 6563 7473 2c20 706f  ing projects, po
+00017260: 7465 6e74 6961 6c6c 7920 6669 6c74 6572  tentially filter
+00017270: 6564 2062 7920 7370 6563 6966 6963 2063  ed by specific c
+00017280: 7269 7465 7269 612e 0a0a 2020 2020 2020  riteria...      
+00017290: 2020 3a70 6172 616d 206f 776e 6572 3a20    :param owner: 
+000172a0: 4c69 7374 206f 6e6c 7920 7072 6f6a 6563  List only projec
+000172b0: 7473 2062 656c 6f6e 6769 6e67 2074 6f20  ts belonging to 
+000172c0: 7468 6973 2073 7065 6369 6669 6320 6f77  this specific ow
+000172d0: 6e65 722e 0a20 2020 2020 2020 203a 7061  ner..        :pa
+000172e0: 7261 6d20 666f 726d 6174 5f3a 2046 6f72  ram format_: For
+000172f0: 6d61 7420 6f66 2074 6865 2072 6573 756c  mat of the resul
+00017300: 7473 2e20 506f 7373 6962 6c65 2076 616c  ts. Possible val
+00017310: 7565 7320 6172 653a 0a0a 2020 2020 2020  ues are:..      
+00017320: 2020 2020 2020 2d20 6060 6675 6c6c 6060        - ``full``
+00017330: 2028 6465 6661 756c 7420 7661 6c75 6529   (default value)
+00017340: 202d 2052 6574 7572 6e20 6675 6c6c 2070   - Return full p
+00017350: 726f 6a65 6374 206f 626a 6563 7473 2e0a  roject objects..
+00017360: 2020 2020 2020 2020 2020 2020 2d20 6060              - ``
+00017370: 6d69 6e69 6d61 6c60 6020 2d20 5265 7475  minimal`` - Retu
+00017380: 726e 206d 696e 696d 616c 2070 726f 6a65  rn minimal proje
+00017390: 6374 206f 626a 6563 7473 2028 6d69 6e69  ct objects (mini
+000173a0: 6d69 7a61 7469 6f6e 2068 6170 7065 6e73  mization happens
+000173b0: 2069 6e20 7468 6520 4245 292e 0a20 2020   in the BE)..   
+000173c0: 2020 2020 2020 2020 202d 2060 606e 616d           - ``nam
+000173d0: 655f 6f6e 6c79 6060 202d 2052 6574 7572  e_only`` - Retur
+000173e0: 6e20 6a75 7374 2074 6865 206e 616d 6573  n just the names
+000173f0: 206f 6620 7468 6520 7072 6f6a 6563 7473   of the projects
+00017400: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00017410: 6d20 6c61 6265 6c73 3a20 4669 6c74 6572  m labels: Filter
+00017420: 2062 7920 6c61 6265 6c73 2061 7474 6163   by labels attac
+00017430: 6865 6420 746f 2074 6865 2070 726f 6a65  hed to the proje
+00017440: 6374 2e0a 2020 2020 2020 2020 3a70 6172  ct..        :par
+00017450: 616d 2073 7461 7465 3a20 4669 6c74 6572  am state: Filter
+00017460: 2062 7920 7072 6f6a 6563 7427 7320 7374   by project's st
+00017470: 6174 652e 2043 616e 2062 6520 6569 7468  ate. Can be eith
+00017480: 6572 2060 606f 6e6c 696e 6560 6020 6f72  er ``online`` or
+00017490: 2060 6061 7263 6869 7665 6460 602e 0a20   ``archived``.. 
+000174a0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+000174b0: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
+000174c0: 2020 2020 2020 2020 2020 2022 6f77 6e65             "owne
+000174d0: 7222 3a20 6f77 6e65 722c 0a20 2020 2020  r": owner,.     
+000174e0: 2020 2020 2020 2022 7374 6174 6522 3a20         "state": 
+000174f0: 7374 6174 652c 0a20 2020 2020 2020 2020  state,.         
+00017500: 2020 2022 666f 726d 6174 223a 2066 6f72     "format": for
+00017510: 6d61 745f 2c0a 2020 2020 2020 2020 2020  mat_,.          
+00017520: 2020 226c 6162 656c 223a 206c 6162 656c    "label": label
+00017530: 7320 6f72 205b 5d2c 0a20 2020 2020 2020  s or [],.       
+00017540: 207d 0a0a 2020 2020 2020 2020 6572 726f   }..        erro
+00017550: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+00017560: 696c 6564 206c 6973 7469 6e67 2070 726f  iled listing pro
+00017570: 6a65 6374 732c 2071 7565 7279 3a20 7b70  jects, query: {p
+00017580: 6172 616d 737d 220a 2020 2020 2020 2020  arams}".        
+00017590: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
+000175a0: 6170 695f 6361 6c6c 2822 4745 5422 2c20  api_call("GET", 
+000175b0: 2270 726f 6a65 6374 7322 2c20 6572 726f  "projects", erro
+000175c0: 725f 6d65 7373 6167 652c 2070 6172 616d  r_message, param
+000175d0: 733d 7061 7261 6d73 290a 2020 2020 2020  s=params).      
+000175e0: 2020 6966 2066 6f72 6d61 745f 203d 3d20    if format_ == 
+000175f0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00017600: 656d 6173 2e50 726f 6a65 6374 7346 6f72  emas.ProjectsFor
+00017610: 6d61 742e 6e61 6d65 5f6f 6e6c 793a 0a0a  mat.name_only:..
+00017620: 2020 2020 2020 2020 2020 2020 2320 7072              # pr
+00017630: 6f6a 6563 7473 2069 7320 6a75 7374 2061  ojects is just a
+00017640: 206c 6973 7420 6f66 2073 7472 696e 6773   list of strings
+00017650: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00017660: 7572 6e20 7265 7370 6f6e 7365 2e6a 736f  urn response.jso
+00017670: 6e28 295b 2270 726f 6a65 6374 7322 5d0a  n()["projects"].
+00017680: 0a20 2020 2020 2020 2023 2066 6f72 7761  .        # forwa
+00017690: 7264 7320 636f 6d70 6174 6962 696c 6974  rds compatibilit
+000176a0: 7920 2d20 7765 2077 616e 7420 746f 2062  y - we want to b
+000176b0: 6520 6162 6c65 2074 6f20 6861 6e64 6c65  e able to handle
+000176c0: 206e 6577 2066 6f72 6d61 7473 2074 6861   new formats tha
+000176d0: 7420 6d69 6768 7420 6265 2061 6464 6564  t might be added
+000176e0: 2069 6e20 7468 6520 6675 7475 7265 0a20   in the future. 
+000176f0: 2020 2020 2020 2023 2069 6620 666f 726d         # if form
+00017700: 6174 2069 7320 6e6f 7420 6b6e 6f77 6e20  at is not known 
+00017710: 746f 2074 6865 2061 7069 2c20 6974 2069  to the api, it i
+00017720: 7320 7570 2074 6f20 7468 6520 7365 7276  s up to the serv
+00017730: 6572 2074 6f20 7265 7475 726e 2065 6974  er to return eit
+00017740: 6865 7220 616e 2065 7272 6f72 206f 7220  her an error or 
+00017750: 6120 6465 6661 756c 7420 666f 726d 6174  a default format
+00017760: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00017770: 5b0a 2020 2020 2020 2020 2020 2020 6d6c  [.            ml
+00017780: 7275 6e2e 7072 6f6a 6563 7473 2e4d 6c72  run.projects.Mlr
+00017790: 756e 5072 6f6a 6563 742e 6672 6f6d 5f64  unProject.from_d
+000177a0: 6963 7428 7072 6f6a 6563 745f 6469 6374  ict(project_dict
+000177b0: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
+000177c0: 7220 7072 6f6a 6563 745f 6469 6374 2069  r project_dict i
+000177d0: 6e20 7265 7370 6f6e 7365 2e6a 736f 6e28  n response.json(
+000177e0: 295b 2270 726f 6a65 6374 7322 5d0a 2020  )["projects"].  
+000177f0: 2020 2020 2020 5d0a 0a20 2020 2064 6566        ]..    def
+00017800: 2067 6574 5f70 726f 6a65 6374 2873 656c   get_project(sel
+00017810: 662c 206e 616d 653a 2073 7472 2920 2d3e  f, name: str) ->
+00017820: 206d 6c72 756e 2e70 726f 6a65 6374 732e   mlrun.projects.
+00017830: 4d6c 7275 6e50 726f 6a65 6374 3a0a 2020  MlrunProject:.  
+00017840: 2020 2020 2020 2222 2247 6574 2064 6574        """Get det
+00017850: 6169 6c73 2066 6f72 2061 2073 7065 6369  ails for a speci
+00017860: 6669 6320 7072 6f6a 6563 742e 2222 220a  fic project.""".
+00017870: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00017880: 6e61 6d65 3a0a 2020 2020 2020 2020 2020  name:.          
+00017890: 2020 7261 6973 6520 4d4c 5275 6e49 6e76    raise MLRunInv
+000178a0: 616c 6964 4172 6775 6d65 6e74 4572 726f  alidArgumentErro
+000178b0: 7228 224e 616d 6520 6d75 7374 2062 6520  r("Name must be 
+000178c0: 7072 6f76 6964 6564 2229 0a0a 2020 2020  provided")..    
+000178d0: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+000178e0: 6a65 6374 732f 7b6e 616d 657d 220a 2020  jects/{name}".  
+000178f0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+00017900: 6167 6520 3d20 6622 4661 696c 6564 2072  age = f"Failed r
+00017910: 6574 7269 6576 696e 6720 7072 6f6a 6563  etrieving projec
+00017920: 7420 7b6e 616d 657d 220a 2020 2020 2020  t {name}".      
+00017930: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
+00017940: 662e 6170 695f 6361 6c6c 2822 4745 5422  f.api_call("GET"
+00017950: 2c20 7061 7468 2c20 6572 726f 725f 6d65  , path, error_me
+00017960: 7373 6167 6529 0a20 2020 2020 2020 2072  ssage).        r
+00017970: 6574 7572 6e20 6d6c 7275 6e2e 7072 6f6a  eturn mlrun.proj
+00017980: 6563 7473 2e4d 6c72 756e 5072 6f6a 6563  ects.MlrunProjec
+00017990: 742e 6672 6f6d 5f64 6963 7428 7265 7370  t.from_dict(resp
+000179a0: 6f6e 7365 2e6a 736f 6e28 2929 0a0a 2020  onse.json())..  
+000179b0: 2020 6465 6620 6465 6c65 7465 5f70 726f    def delete_pro
+000179c0: 6a65 6374 280a 2020 2020 2020 2020 7365  ject(.        se
+000179d0: 6c66 2c0a 2020 2020 2020 2020 6e61 6d65  lf,.        name
+000179e0: 3a20 7374 722c 0a20 2020 2020 2020 2064  : str,.        d
+000179f0: 656c 6574 696f 6e5f 7374 7261 7465 6779  eletion_strategy
+00017a00: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
+00017a10: 2020 2020 2073 7472 2c20 6d6c 7275 6e2e       str, mlrun.
+00017a20: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e44  common.schemas.D
+00017a30: 656c 6574 696f 6e53 7472 6174 6567 790a  eletionStrategy.
+00017a40: 2020 2020 2020 2020 5d20 3d20 6d6c 7275          ] = mlru
+00017a50: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+00017a60: 2e44 656c 6574 696f 6e53 7472 6174 6567  .DeletionStrateg
+00017a70: 792e 6465 6661 756c 7428 292c 0a20 2020  y.default(),.   
+00017a80: 2029 3a0a 2020 2020 2020 2020 2222 2244   ):.        """D
+00017a90: 656c 6574 6520 6120 7072 6f6a 6563 742e  elete a project.
+00017aa0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00017ab0: 206e 616d 653a 204e 616d 6520 6f66 2074   name: Name of t
+00017ac0: 6865 2070 726f 6a65 6374 2074 6f20 6465  he project to de
+00017ad0: 6c65 7465 2e0a 2020 2020 2020 2020 3a70  lete..        :p
+00017ae0: 6172 616d 2064 656c 6574 696f 6e5f 7374  aram deletion_st
+00017af0: 7261 7465 6779 3a20 486f 7720 746f 2074  rategy: How to t
+00017b00: 7265 6174 2063 6869 6c64 206f 626a 6563  reat child objec
+00017b10: 7473 206f 6620 7468 6520 7072 6f6a 6563  ts of the projec
+00017b20: 742e 2050 6f73 7369 626c 6520 7661 6c75  t. Possible valu
+00017b30: 6573 2061 7265 3a0a 0a20 2020 2020 2020  es are:..       
+00017b40: 2020 2020 202d 2060 6072 6573 7472 6963       - ``restric
+00017b50: 7460 6020 2864 6566 6175 6c74 2920 2d20  t`` (default) - 
+00017b60: 5072 6f6a 6563 7420 6d75 7374 206e 6f74  Project must not
+00017b70: 2068 6176 6520 616e 7920 6368 696c 6420   have any child 
+00017b80: 6f62 6a65 6374 7320 7768 656e 2064 656c  objects when del
+00017b90: 6574 6564 2e20 4966 2075 7369 6e67 2074  eted. If using t
+00017ba0: 6869 7320 6d6f 6465 2077 6869 6c65 0a20  his mode while. 
+00017bb0: 2020 2020 2020 2020 2020 2020 2063 6869               chi
+00017bc0: 6c64 206f 626a 6563 7473 2065 7869 7374  ld objects exist
+00017bd0: 2c20 7468 6520 6f70 6572 6174 696f 6e20  , the operation 
+00017be0: 7769 6c6c 2066 6169 6c2e 0a20 2020 2020  will fail..     
+00017bf0: 2020 2020 2020 202d 2060 6063 6173 6361         - ``casca
+00017c00: 6465 6060 202d 2041 7574 6f6d 6174 6963  de`` - Automatic
+00017c10: 616c 6c79 2064 656c 6574 6520 616c 6c20  ally delete all 
+00017c20: 6368 696c 6420 6f62 6a65 6374 7320 7768  child objects wh
+00017c30: 656e 2064 656c 6574 696e 6720 7468 6520  en deleting the 
+00017c40: 7072 6f6a 6563 742e 0a20 2020 2020 2020  project..       
+00017c50: 2022 2222 0a0a 2020 2020 2020 2020 7061   """..        pa
+00017c60: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+00017c70: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
+00017c80: 6865 6164 6572 7320 3d20 7b0a 2020 2020  headers = {.    
+00017c90: 2020 2020 2020 2020 6d6c 7275 6e2e 636f          mlrun.co
+00017ca0: 6d6d 6f6e 2e73 6368 656d 6173 2e48 6561  mmon.schemas.Hea
+00017cb0: 6465 724e 616d 6573 2e64 656c 6574 696f  derNames.deletio
+00017cc0: 6e5f 7374 7261 7465 6779 3a20 6465 6c65  n_strategy: dele
+00017cd0: 7469 6f6e 5f73 7472 6174 6567 790a 2020  tion_strategy.  
+00017ce0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00017cf0: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+00017d00: 6622 4661 696c 6564 2064 656c 6574 696e  f"Failed deletin
+00017d10: 6720 7072 6f6a 6563 7420 7b6e 616d 657d  g project {name}
+00017d20: 220a 2020 2020 2020 2020 7265 7370 6f6e  ".        respon
+00017d30: 7365 203d 2073 656c 662e 6170 695f 6361  se = self.api_ca
+00017d40: 6c6c 2822 4445 4c45 5445 222c 2070 6174  ll("DELETE", pat
+00017d50: 682c 2065 7272 6f72 5f6d 6573 7361 6765  h, error_message
+00017d60: 2c20 6865 6164 6572 733d 6865 6164 6572  , headers=header
+00017d70: 7329 0a20 2020 2020 2020 2069 6620 7265  s).        if re
+00017d80: 7370 6f6e 7365 2e73 7461 7475 735f 636f  sponse.status_co
+00017d90: 6465 203d 3d20 6874 7470 2e48 5454 5053  de == http.HTTPS
+00017da0: 7461 7475 732e 4143 4345 5054 4544 3a0a  tatus.ACCEPTED:.
+00017db0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00017dc0: 726e 2073 656c 662e 5f77 6169 745f 666f  rn self._wait_fo
+00017dd0: 725f 7072 6f6a 6563 745f 746f 5f62 655f  r_project_to_be_
+00017de0: 6465 6c65 7465 6428 6e61 6d65 290a 0a20  deleted(name).. 
+00017df0: 2020 2064 6566 2073 746f 7265 5f70 726f     def store_pro
+00017e00: 6a65 6374 280a 2020 2020 2020 2020 7365  ject(.        se
+00017e10: 6c66 2c0a 2020 2020 2020 2020 6e61 6d65  lf,.        name
+00017e20: 3a20 7374 722c 0a20 2020 2020 2020 2070  : str,.        p
+00017e30: 726f 6a65 6374 3a20 556e 696f 6e5b 6469  roject: Union[di
+00017e40: 6374 2c20 6d6c 7275 6e2e 7072 6f6a 6563  ct, mlrun.projec
+00017e50: 7473 2e4d 6c72 756e 5072 6f6a 6563 742c  ts.MlrunProject,
+00017e60: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+00017e70: 6865 6d61 732e 5072 6f6a 6563 745d 2c0a  hemas.Project],.
+00017e80: 2020 2020 2920 2d3e 206d 6c72 756e 2e70      ) -> mlrun.p
+00017e90: 726f 6a65 6374 732e 4d6c 7275 6e50 726f  rojects.MlrunPro
+00017ea0: 6a65 6374 3a0a 2020 2020 2020 2020 2222  ject:.        ""
+00017eb0: 2253 746f 7265 2061 2070 726f 6a65 6374  "Store a project
+00017ec0: 2069 6e20 7468 6520 4442 2e20 5468 6973   in the DB. This
+00017ed0: 206f 7065 7261 7469 6f6e 2077 696c 6c20   operation will 
+00017ee0: 6f76 6572 7772 6974 6520 6578 6973 7469  overwrite existi
+00017ef0: 6e67 2070 726f 6a65 6374 206f 6620 7468  ng project of th
+00017f00: 6520 7361 6d65 206e 616d 6520 6966 2065  e same name if e
+00017f10: 7869 7374 732e 2222 220a 0a20 2020 2020  xists."""..     
+00017f20: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
+00017f30: 6563 7473 2f7b 6e61 6d65 7d22 0a20 2020  ects/{name}".   
+00017f40: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+00017f50: 6765 203d 2066 2246 6169 6c65 6420 7374  ge = f"Failed st
+00017f60: 6f72 696e 6720 7072 6f6a 6563 7420 7b6e  oring project {n
+00017f70: 616d 657d 220a 2020 2020 2020 2020 6966  ame}".        if
+00017f80: 2069 7369 6e73 7461 6e63 6528 7072 6f6a   isinstance(proj
+00017f90: 6563 742c 206d 6c72 756e 2e63 6f6d 6d6f  ect, mlrun.commo
+00017fa0: 6e2e 7363 6865 6d61 732e 5072 6f6a 6563  n.schemas.Projec
+00017fb0: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+00017fc0: 7072 6f6a 6563 7420 3d20 7072 6f6a 6563  project = projec
+00017fd0: 742e 6469 6374 2829 0a20 2020 2020 2020  t.dict().       
+00017fe0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+00017ff0: 2870 726f 6a65 6374 2c20 6d6c 7275 6e2e  (project, mlrun.
+00018000: 7072 6f6a 6563 7473 2e4d 6c72 756e 5072  projects.MlrunPr
+00018010: 6f6a 6563 7429 3a0a 2020 2020 2020 2020  oject):.        
+00018020: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+00018030: 6f6a 6563 742e 746f 5f64 6963 7428 290a  oject.to_dict().
+00018040: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
+00018050: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+00018060: 280a 2020 2020 2020 2020 2020 2020 2250  (.            "P
+00018070: 5554 222c 0a20 2020 2020 2020 2020 2020  UT",.           
+00018080: 2070 6174 682c 0a20 2020 2020 2020 2020   path,.         
+00018090: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+000180a0: 2c0a 2020 2020 2020 2020 2020 2020 626f  ,.            bo
+000180b0: 6479 3d64 6963 745f 746f 5f6a 736f 6e28  dy=dict_to_json(
+000180c0: 7072 6f6a 6563 7429 2c0a 2020 2020 2020  project),.      
+000180d0: 2020 290a 2020 2020 2020 2020 6966 2072    ).        if r
+000180e0: 6573 706f 6e73 652e 7374 6174 7573 5f63  esponse.status_c
+000180f0: 6f64 6520 3d3d 2068 7474 702e 4854 5450  ode == http.HTTP
+00018100: 5374 6174 7573 2e41 4343 4550 5445 443a  Status.ACCEPTED:
+00018110: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00018120: 7572 6e20 7365 6c66 2e5f 7761 6974 5f66  urn self._wait_f
+00018130: 6f72 5f70 726f 6a65 6374 5f74 6f5f 7265  or_project_to_re
+00018140: 6163 685f 7465 726d 696e 616c 5f73 7461  ach_terminal_sta
+00018150: 7465 286e 616d 6529 0a20 2020 2020 2020  te(name).       
+00018160: 2072 6574 7572 6e20 6d6c 7275 6e2e 7072   return mlrun.pr
+00018170: 6f6a 6563 7473 2e4d 6c72 756e 5072 6f6a  ojects.MlrunProj
+00018180: 6563 742e 6672 6f6d 5f64 6963 7428 7265  ect.from_dict(re
+00018190: 7370 6f6e 7365 2e6a 736f 6e28 2929 0a0a  sponse.json())..
+000181a0: 2020 2020 6465 6620 7061 7463 685f 7072      def patch_pr
+000181b0: 6f6a 6563 7428 0a20 2020 2020 2020 2073  oject(.        s
+000181c0: 656c 662c 0a20 2020 2020 2020 206e 616d  elf,.        nam
+000181d0: 653a 2073 7472 2c0a 2020 2020 2020 2020  e: str,.        
+000181e0: 7072 6f6a 6563 743a 2064 6963 742c 0a20  project: dict,. 
+000181f0: 2020 2020 2020 2070 6174 6368 5f6d 6f64         patch_mod
+00018200: 653a 2055 6e69 6f6e 5b0a 2020 2020 2020  e: Union[.      
+00018210: 2020 2020 2020 7374 722c 206d 6c72 756e        str, mlrun
+00018220: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00018230: 5061 7463 684d 6f64 650a 2020 2020 2020  PatchMode.      
+00018240: 2020 5d20 3d20 6d6c 7275 6e2e 636f 6d6d    ] = mlrun.comm
+00018250: 6f6e 2e73 6368 656d 6173 2e50 6174 6368  on.schemas.Patch
+00018260: 4d6f 6465 2e72 6570 6c61 6365 2c0a 2020  Mode.replace,.  
+00018270: 2020 2920 2d3e 206d 6c72 756e 2e70 726f    ) -> mlrun.pro
+00018280: 6a65 6374 732e 4d6c 7275 6e50 726f 6a65  jects.MlrunProje
+00018290: 6374 3a0a 2020 2020 2020 2020 2222 2250  ct:.        """P
+000182a0: 6174 6368 2061 6e20 6578 6973 7469 6e67  atch an existing
+000182b0: 2070 726f 6a65 6374 206f 626a 6563 742e   project object.
+000182c0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000182d0: 206e 616d 653a 204e 616d 6520 6f66 2070   name: Name of p
+000182e0: 726f 6a65 6374 2074 6f20 7061 7463 682e  roject to patch.
+000182f0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00018300: 7072 6f6a 6563 743a 2054 6865 2061 6374  project: The act
+00018310: 7561 6c20 6368 616e 6765 7320 746f 2074  ual changes to t
+00018320: 6865 2070 726f 6a65 6374 206f 626a 6563  he project objec
+00018330: 742e 0a20 2020 2020 2020 203a 7061 7261  t..        :para
+00018340: 6d20 7061 7463 685f 6d6f 6465 3a20 5468  m patch_mode: Th
+00018350: 6520 7374 7261 7465 6779 2066 6f72 206d  e strategy for m
+00018360: 6572 6769 6e67 2074 6865 2063 6861 6e67  erging the chang
+00018370: 6573 2077 6974 6820 7468 6520 6578 6973  es with the exis
+00018380: 7469 6e67 206f 626a 6563 742e 2043 616e  ting object. Can
+00018390: 2062 6520 6569 7468 6572 2060 6072 6570   be either ``rep
+000183a0: 6c61 6365 6060 0a20 2020 2020 2020 2020  lace``.         
+000183b0: 2020 206f 7220 6060 6164 6469 7469 7665     or ``additive
+000183c0: 6060 2e0a 2020 2020 2020 2020 2222 220a  ``..        """.
+000183d0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+000183e0: 6622 7072 6f6a 6563 7473 2f7b 6e61 6d65  f"projects/{name
+000183f0: 7d22 0a20 2020 2020 2020 2068 6561 6465  }".        heade
+00018400: 7273 203d 207b 6d6c 7275 6e2e 636f 6d6d  rs = {mlrun.comm
+00018410: 6f6e 2e73 6368 656d 6173 2e48 6561 6465  on.schemas.Heade
+00018420: 724e 616d 6573 2e70 6174 6368 5f6d 6f64  rNames.patch_mod
+00018430: 653a 2070 6174 6368 5f6d 6f64 657d 0a20  e: patch_mode}. 
+00018440: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00018450: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+00018460: 7061 7463 6869 6e67 2070 726f 6a65 6374  patching project
+00018470: 207b 6e61 6d65 7d22 0a20 2020 2020 2020   {name}".       
+00018480: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
+00018490: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
+000184a0: 2020 2020 2020 2022 5041 5443 4822 2c20         "PATCH", 
+000184b0: 7061 7468 2c20 6572 726f 725f 6d65 7373  path, error_mess
+000184c0: 6167 652c 2062 6f64 793d 6469 6374 5f74  age, body=dict_t
+000184d0: 6f5f 6a73 6f6e 2870 726f 6a65 6374 292c  o_json(project),
+000184e0: 2068 6561 6465 7273 3d68 6561 6465 7273   headers=headers
+000184f0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00018500: 2020 2072 6574 7572 6e20 6d6c 7275 6e2e     return mlrun.
+00018510: 7072 6f6a 6563 7473 2e4d 6c72 756e 5072  projects.MlrunPr
+00018520: 6f6a 6563 742e 6672 6f6d 5f64 6963 7428  oject.from_dict(
+00018530: 7265 7370 6f6e 7365 2e6a 736f 6e28 2929  response.json())
+00018540: 0a0a 2020 2020 6465 6620 6372 6561 7465  ..    def create
+00018550: 5f70 726f 6a65 6374 280a 2020 2020 2020  _project(.      
+00018560: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00018570: 7072 6f6a 6563 743a 2055 6e69 6f6e 5b64  project: Union[d
+00018580: 6963 742c 206d 6c72 756e 2e70 726f 6a65  ict, mlrun.proje
+00018590: 6374 732e 4d6c 7275 6e50 726f 6a65 6374  cts.MlrunProject
+000185a0: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
+000185b0: 6368 656d 6173 2e50 726f 6a65 6374 5d2c  chemas.Project],
+000185c0: 0a20 2020 2029 202d 3e20 6d6c 7275 6e2e  .    ) -> mlrun.
+000185d0: 7072 6f6a 6563 7473 2e4d 6c72 756e 5072  projects.MlrunPr
+000185e0: 6f6a 6563 743a 0a20 2020 2020 2020 2022  oject:.        "
+000185f0: 2222 4372 6561 7465 2061 206e 6577 2070  ""Create a new p
+00018600: 726f 6a65 6374 2e20 4120 7072 6f6a 6563  roject. A projec
+00018610: 7420 7769 7468 2074 6865 2073 616d 6520  t with the same 
+00018620: 6e61 6d65 206d 7573 7420 6e6f 7420 6578  name must not ex
+00018630: 6973 7420 7072 696f 7220 746f 2063 7265  ist prior to cre
+00018640: 6174 696f 6e2e 2222 220a 0a20 2020 2020  ation."""..     
+00018650: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00018660: 2870 726f 6a65 6374 2c20 6d6c 7275 6e2e  (project, mlrun.
+00018670: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e50  common.schemas.P
+00018680: 726f 6a65 6374 293a 0a20 2020 2020 2020  roject):.       
+00018690: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
+000186a0: 726f 6a65 6374 2e64 6963 7428 290a 2020  roject.dict().  
+000186b0: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+000186c0: 7461 6e63 6528 7072 6f6a 6563 742c 206d  tance(project, m
+000186d0: 6c72 756e 2e70 726f 6a65 6374 732e 4d6c  lrun.projects.Ml
+000186e0: 7275 6e50 726f 6a65 6374 293a 0a20 2020  runProject):.   
+000186f0: 2020 2020 2020 2020 2070 726f 6a65 6374           project
+00018700: 203d 2070 726f 6a65 6374 2e74 6f5f 6469   = project.to_di
+00018710: 6374 2829 0a20 2020 2020 2020 2070 726f  ct().        pro
+00018720: 6a65 6374 5f6e 616d 6520 3d20 7072 6f6a  ject_name = proj
+00018730: 6563 745b 226d 6574 6164 6174 6122 5d5b  ect["metadata"][
+00018740: 226e 616d 6522 5d0a 2020 2020 2020 2020  "name"].        
+00018750: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+00018760: 6622 4661 696c 6564 2063 7265 6174 696e  f"Failed creatin
+00018770: 6720 7072 6f6a 6563 7420 7b70 726f 6a65  g project {proje
+00018780: 6374 5f6e 616d 657d 220a 2020 2020 2020  ct_name}".      
+00018790: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
+000187a0: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
+000187b0: 2020 2020 2020 2020 2250 4f53 5422 2c0a          "POST",.
+000187c0: 2020 2020 2020 2020 2020 2020 2270 726f              "pro
+000187d0: 6a65 6374 7322 2c0a 2020 2020 2020 2020  jects",.        
+000187e0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+000187f0: 652c 0a20 2020 2020 2020 2020 2020 2062  e,.            b
+00018800: 6f64 793d 6469 6374 5f74 6f5f 6a73 6f6e  ody=dict_to_json
+00018810: 2870 726f 6a65 6374 292c 0a20 2020 2020  (project),.     
+00018820: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
+00018830: 7265 7370 6f6e 7365 2e73 7461 7475 735f  response.status_
+00018840: 636f 6465 203d 3d20 6874 7470 2e48 5454  code == http.HTT
+00018850: 5053 7461 7475 732e 4143 4345 5054 4544  PStatus.ACCEPTED
+00018860: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00018870: 7475 726e 2073 656c 662e 5f77 6169 745f  turn self._wait_
+00018880: 666f 725f 7072 6f6a 6563 745f 746f 5f72  for_project_to_r
+00018890: 6561 6368 5f74 6572 6d69 6e61 6c5f 7374  each_terminal_st
+000188a0: 6174 6528 7072 6f6a 6563 745f 6e61 6d65  ate(project_name
+000188b0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000188c0: 206d 6c72 756e 2e70 726f 6a65 6374 732e   mlrun.projects.
+000188d0: 4d6c 7275 6e50 726f 6a65 6374 2e66 726f  MlrunProject.fro
+000188e0: 6d5f 6469 6374 2872 6573 706f 6e73 652e  m_dict(response.
+000188f0: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
+00018900: 205f 7761 6974 5f66 6f72 5f70 726f 6a65   _wait_for_proje
+00018910: 6374 5f74 6f5f 7265 6163 685f 7465 726d  ct_to_reach_term
+00018920: 696e 616c 5f73 7461 7465 280a 2020 2020  inal_state(.    
+00018930: 2020 2020 7365 6c66 2c20 7072 6f6a 6563      self, projec
+00018940: 745f 6e61 6d65 3a20 7374 720a 2020 2020  t_name: str.    
+00018950: 2920 2d3e 206d 6c72 756e 2e70 726f 6a65  ) -> mlrun.proje
+00018960: 6374 732e 4d6c 7275 6e50 726f 6a65 6374  cts.MlrunProject
+00018970: 3a0a 2020 2020 2020 2020 6465 6620 5f76  :.        def _v
+00018980: 6572 6966 795f 7072 6f6a 6563 745f 696e  erify_project_in
+00018990: 5f74 6572 6d69 6e61 6c5f 7374 6174 6528  _terminal_state(
+000189a0: 293a 0a20 2020 2020 2020 2020 2020 2070  ):.            p
+000189b0: 726f 6a65 6374 203d 2073 656c 662e 6765  roject = self.ge
+000189c0: 745f 7072 6f6a 6563 7428 7072 6f6a 6563  t_project(projec
+000189d0: 745f 6e61 6d65 290a 2020 2020 2020 2020  t_name).        
+000189e0: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
+000189f0: 2020 2020 2020 2020 2070 726f 6a65 6374           project
+00018a00: 2e73 7461 7475 732e 7374 6174 650a 2020  .status.state.  
+00018a10: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
+00018a20: 7420 696e 206d 6c72 756e 2e63 6f6d 6d6f  t in mlrun.commo
+00018a30: 6e2e 7363 6865 6d61 732e 5072 6f6a 6563  n.schemas.Projec
+00018a40: 7453 7461 7465 2e74 6572 6d69 6e61 6c5f  tState.terminal_
+00018a50: 7374 6174 6573 2829 0a20 2020 2020 2020  states().       
+00018a60: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+00018a70: 2020 2020 2020 2020 7261 6973 6520 4578          raise Ex
+00018a80: 6365 7074 696f 6e28 0a20 2020 2020 2020  ception(.       
+00018a90: 2020 2020 2020 2020 2020 2020 2066 2250               f"P
+00018aa0: 726f 6a65 6374 206e 6f74 2069 6e20 7465  roject not in te
+00018ab0: 726d 696e 616c 2073 7461 7465 2e20 5374  rminal state. St
+00018ac0: 6174 653a 207b 7072 6f6a 6563 742e 7374  ate: {project.st
+00018ad0: 6174 7573 2e73 7461 7465 7d22 0a20 2020  atus.state}".   
+00018ae0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00018af0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00018b00: 6e20 7072 6f6a 6563 740a 0a20 2020 2020  n project..     
+00018b10: 2020 2072 6574 7572 6e20 6d6c 7275 6e2e     return mlrun.
+00018b20: 7574 696c 732e 6865 6c70 6572 732e 7265  utils.helpers.re
+00018b30: 7472 795f 756e 7469 6c5f 7375 6363 6573  try_until_succes
+00018b40: 7366 756c 280a 2020 2020 2020 2020 2020  sful(.          
+00018b50: 2020 7365 6c66 2e5f 7761 6974 5f66 6f72    self._wait_for
+00018b60: 5f70 726f 6a65 6374 5f74 6572 6d69 6e61  _project_termina
+00018b70: 6c5f 7374 6174 655f 7265 7472 795f 696e  l_state_retry_in
+00018b80: 7465 7276 616c 2c0a 2020 2020 2020 2020  terval,.        
+00018b90: 2020 2020 3132 302c 0a20 2020 2020 2020      120,.       
+00018ba0: 2020 2020 206c 6f67 6765 722c 0a20 2020       logger,.   
+00018bb0: 2020 2020 2020 2020 2046 616c 7365 2c0a           False,.
+00018bc0: 2020 2020 2020 2020 2020 2020 5f76 6572              _ver
+00018bd0: 6966 795f 7072 6f6a 6563 745f 696e 5f74  ify_project_in_t
+00018be0: 6572 6d69 6e61 6c5f 7374 6174 652c 0a20  erminal_state,. 
+00018bf0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00018c00: 6620 5f77 6169 745f 666f 725f 6261 636b  f _wait_for_back
+00018c10: 6772 6f75 6e64 5f74 6173 6b5f 746f 5f72  ground_task_to_r
+00018c20: 6561 6368 5f74 6572 6d69 6e61 6c5f 7374  each_terminal_st
+00018c30: 6174 6528 0a20 2020 2020 2020 2073 656c  ate(.        sel
+00018c40: 662c 206e 616d 653a 2073 7472 0a20 2020  f, name: str.   
+00018c50: 2029 202d 3e20 6d6c 7275 6e2e 636f 6d6d   ) -> mlrun.comm
+00018c60: 6f6e 2e73 6368 656d 6173 2e42 6163 6b67  on.schemas.Backg
+00018c70: 726f 756e 6454 6173 6b3a 0a20 2020 2020  roundTask:.     
+00018c80: 2020 2064 6566 205f 7665 7269 6679 5f62     def _verify_b
+00018c90: 6163 6b67 726f 756e 645f 7461 736b 5f69  ackground_task_i
+00018ca0: 6e5f 7465 726d 696e 616c 5f73 7461 7465  n_terminal_state
+00018cb0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00018cc0: 6261 636b 6772 6f75 6e64 5f74 6173 6b20  background_task 
+00018cd0: 3d20 7365 6c66 2e67 6574 5f62 6163 6b67  = self.get_backg
+00018ce0: 726f 756e 645f 7461 736b 286e 616d 6529  round_task(name)
+00018cf0: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
+00018d00: 7465 203d 2062 6163 6b67 726f 756e 645f  te = background_
+00018d10: 7461 736b 2e73 7461 7475 732e 7374 6174  task.status.stat
+00018d20: 650a 2020 2020 2020 2020 2020 2020 6966  e.            if
+00018d30: 2073 7461 7465 206e 6f74 2069 6e20 6d6c   state not in ml
+00018d40: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00018d50: 6173 2e42 6163 6b67 726f 756e 6454 6173  as.BackgroundTas
+00018d60: 6b53 7461 7465 2e74 6572 6d69 6e61 6c5f  kState.terminal_
+00018d70: 7374 6174 6573 2829 3a0a 2020 2020 2020  states():.      
+00018d80: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00018d90: 4578 6365 7074 696f 6e28 0a20 2020 2020  Exception(.     
+00018da0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00018db0: 2242 6163 6b67 726f 756e 6420 7461 736b  "Background task
+00018dc0: 206e 6f74 2069 6e20 7465 726d 696e 616c   not in terminal
+00018dd0: 2073 7461 7465 2e20 6e61 6d65 3d7b 6e61   state. name={na
+00018de0: 6d65 7d2c 2073 7461 7465 3d7b 7374 6174  me}, state={stat
+00018df0: 657d 220a 2020 2020 2020 2020 2020 2020  e}".            
+00018e00: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00018e10: 2020 7265 7475 726e 2062 6163 6b67 726f    return backgro
+00018e20: 756e 645f 7461 736b 0a0a 2020 2020 2020  und_task..      
+00018e30: 2020 7265 7475 726e 206d 6c72 756e 2e75    return mlrun.u
+00018e40: 7469 6c73 2e68 656c 7065 7273 2e72 6574  tils.helpers.ret
+00018e50: 7279 5f75 6e74 696c 5f73 7563 6365 7373  ry_until_success
+00018e60: 6675 6c28 0a20 2020 2020 2020 2020 2020  ful(.           
+00018e70: 2073 656c 662e 5f77 6169 745f 666f 725f   self._wait_for_
+00018e80: 6261 636b 6772 6f75 6e64 5f74 6173 6b5f  background_task_
+00018e90: 7465 726d 696e 616c 5f73 7461 7465 5f72  terminal_state_r
+00018ea0: 6574 7279 5f69 6e74 6572 7661 6c2c 0a20  etry_interval,. 
+00018eb0: 2020 2020 2020 2020 2020 2036 3020 2a20             60 * 
+00018ec0: 3630 2c0a 2020 2020 2020 2020 2020 2020  60,.            
+00018ed0: 6c6f 6767 6572 2c0a 2020 2020 2020 2020  logger,.        
+00018ee0: 2020 2020 4661 6c73 652c 0a20 2020 2020      False,.     
+00018ef0: 2020 2020 2020 205f 7665 7269 6679 5f62         _verify_b
+00018f00: 6163 6b67 726f 756e 645f 7461 736b 5f69  ackground_task_i
+00018f10: 6e5f 7465 726d 696e 616c 5f73 7461 7465  n_terminal_state
+00018f20: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00018f30: 2064 6566 205f 7761 6974 5f66 6f72 5f70   def _wait_for_p
+00018f40: 726f 6a65 6374 5f74 6f5f 6265 5f64 656c  roject_to_be_del
+00018f50: 6574 6564 2873 656c 662c 2070 726f 6a65  eted(self, proje
+00018f60: 6374 5f6e 616d 653a 2073 7472 293a 0a20  ct_name: str):. 
+00018f70: 2020 2020 2020 2064 6566 205f 7665 7269         def _veri
+00018f80: 6679 5f70 726f 6a65 6374 5f64 656c 6574  fy_project_delet
+00018f90: 6564 2829 3a0a 2020 2020 2020 2020 2020  ed():.          
+00018fa0: 2020 7072 6f6a 6563 7473 203d 2073 656c    projects = sel
+00018fb0: 662e 6c69 7374 5f70 726f 6a65 6374 7328  f.list_projects(
+00018fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018fd0: 2066 6f72 6d61 745f 3d6d 6c72 756e 2e63   format_=mlrun.c
+00018fe0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5072  ommon.schemas.Pr
+00018ff0: 6f6a 6563 7473 466f 726d 6174 2e6e 616d  ojectsFormat.nam
+00019000: 655f 6f6e 6c79 0a20 2020 2020 2020 2020  e_only.         
+00019010: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00019020: 2069 6620 7072 6f6a 6563 745f 6e61 6d65   if project_name
+00019030: 2069 6e20 7072 6f6a 6563 7473 3a0a 2020   in projects:.  
+00019040: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00019050: 6973 6520 4578 6365 7074 696f 6e28 6622  ise Exception(f"
+00019060: 5072 6f6a 6563 7420 7b70 726f 6a65 6374  Project {project
+00019070: 5f6e 616d 657d 2073 7469 6c6c 2065 7869  _name} still exi
+00019080: 7374 7322 290a 0a20 2020 2020 2020 2072  sts")..        r
+00019090: 6574 7572 6e20 6d6c 7275 6e2e 7574 696c  eturn mlrun.util
+000190a0: 732e 6865 6c70 6572 732e 7265 7472 795f  s.helpers.retry_
+000190b0: 756e 7469 6c5f 7375 6363 6573 7366 756c  until_successful
+000190c0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+000190d0: 6c66 2e5f 7761 6974 5f66 6f72 5f70 726f  lf._wait_for_pro
+000190e0: 6a65 6374 5f64 656c 6574 696f 6e5f 696e  ject_deletion_in
+000190f0: 7465 7276 616c 2c0a 2020 2020 2020 2020  terval,.        
+00019100: 2020 2020 3132 302c 0a20 2020 2020 2020      120,.       
+00019110: 2020 2020 206c 6f67 6765 722c 0a20 2020       logger,.   
+00019120: 2020 2020 2020 2020 2046 616c 7365 2c0a           False,.
+00019130: 2020 2020 2020 2020 2020 2020 5f76 6572              _ver
+00019140: 6966 795f 7072 6f6a 6563 745f 6465 6c65  ify_project_dele
+00019150: 7465 642c 0a20 2020 2020 2020 2029 0a0a  ted,.        )..
+00019160: 2020 2020 6465 6620 6372 6561 7465 5f70      def create_p
+00019170: 726f 6a65 6374 5f73 6563 7265 7473 280a  roject_secrets(.
+00019180: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00019190: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
+000191a0: 7472 2c0a 2020 2020 2020 2020 7072 6f76  tr,.        prov
+000191b0: 6964 6572 3a20 556e 696f 6e5b 0a20 2020  ider: Union[.   
+000191c0: 2020 2020 2020 2020 2073 7472 2c20 6d6c           str, ml
+000191d0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+000191e0: 6173 2e53 6563 7265 7450 726f 7669 6465  as.SecretProvide
+000191f0: 724e 616d 650a 2020 2020 2020 2020 5d20  rName.        ] 
+00019200: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
+00019210: 6368 656d 6173 2e53 6563 7265 7450 726f  chemas.SecretPro
+00019220: 7669 6465 724e 616d 652e 6b75 6265 726e  viderName.kubern
+00019230: 6574 6573 2c0a 2020 2020 2020 2020 7365  etes,.        se
+00019240: 6372 6574 733a 2064 6963 7420 3d20 4e6f  crets: dict = No
+00019250: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
+00019260: 2020 2022 2222 4372 6561 7465 2070 726f     """Create pro
+00019270: 6a65 6374 2d63 6f6e 7465 7874 2073 6563  ject-context sec
+00019280: 7265 7473 2075 7369 6e67 2065 6974 6865  rets using eithe
+00019290: 7220 6060 7661 756c 7460 6020 6f72 2060  r ``vault`` or `
+000192a0: 606b 7562 6572 6e65 7465 7360 6020 7072  `kubernetes`` pr
+000192b0: 6f76 6964 6572 2e0a 2020 2020 2020 2020  ovider..        
+000192c0: 5768 656e 2075 7369 6e67 2077 6974 6820  When using with 
+000192d0: 5661 756c 742c 2074 6869 7320 7769 6c6c  Vault, this will
+000192e0: 2063 7265 6174 6520 6e65 6564 6564 2056   create needed V
+000192f0: 6175 6c74 2073 7472 7563 7475 7265 7320  ault structures 
+00019300: 666f 7220 7374 6f72 696e 6720 7365 6372  for storing secr
+00019310: 6574 7320 696e 2070 726f 6a65 6374 2d63  ets in project-c
+00019320: 6f6e 7465 7874 2c20 616e 640a 2020 2020  ontext, and.    
+00019330: 2020 2020 7374 6f72 6520 6120 7365 7420      store a set 
+00019340: 6f66 2073 6563 7265 7420 7661 6c75 6573  of secret values
+00019350: 2e20 5468 6520 6d65 7468 6f64 2067 656e  . The method gen
+00019360: 6572 6174 6573 204b 7562 6572 6e65 7465  erates Kubernete
+00019370: 7320 7365 7276 6963 652d 6163 636f 756e  s service-accoun
+00019380: 7420 616e 6420 7468 6520 5661 756c 7420  t and the Vault 
+00019390: 6175 7468 656e 7469 6361 7469 6f6e 0a20  authentication. 
+000193a0: 2020 2020 2020 2073 7472 7563 7475 7265         structure
+000193b0: 7320 7468 6174 2061 7265 2072 6571 7569  s that are requi
+000193c0: 7265 6420 666f 7220 6675 6e63 7469 6f6e  red for function
+000193d0: 2050 6f64 7320 746f 2061 7574 6865 6e74   Pods to authent
+000193e0: 6963 6174 6520 7769 7468 2056 6175 6c74  icate with Vault
+000193f0: 2061 6e64 2062 6520 6162 6c65 2074 6f20   and be able to 
+00019400: 6578 7472 6163 7420 7365 6372 6574 2076  extract secret v
+00019410: 616c 7565 730a 2020 2020 2020 2020 7061  alues.        pa
+00019420: 7373 6564 2061 7320 7061 7274 206f 6620  ssed as part of 
+00019430: 7468 6569 7220 636f 6e74 6578 742e 0a0a  their context...
+00019440: 2020 2020 2020 2020 4e6f 7465 3a0a 2020          Note:.  
+00019450: 2020 2020 2020 2020 2020 2020 2020 5468                Th
+00019460: 6973 206d 6574 686f 6420 7573 6564 2077  is method used w
+00019470: 6974 6820 5661 756c 7420 6973 2063 7572  ith Vault is cur
+00019480: 7265 6e74 6c79 2069 6e20 7465 6368 6e69  rently in techni
+00019490: 6361 6c20 7072 6576 6965 772c 2061 6e64  cal preview, and
+000194a0: 2072 6571 7569 7265 7320 6120 4861 7368   requires a Hash
+000194b0: 6943 6f72 7020 5661 756c 740a 2020 2020  iCorp Vault.    
+000194c0: 2020 2020 2020 2020 2020 2020 696e 6672              infr
+000194d0: 6173 7472 7563 7475 7265 2070 726f 7065  astructure prope
+000194e0: 726c 7920 7365 7420 7570 2061 6e64 2063  rly set up and c
+000194f0: 6f6e 6e65 6374 6564 2074 6f20 7468 6520  onnected to the 
+00019500: 4d4c 5275 6e20 4150 4920 7365 7276 6572  MLRun API server
+00019510: 2e0a 0a20 2020 2020 2020 2057 6865 6e20  ...        When 
+00019520: 7573 6564 2077 6974 6820 4b75 6265 726e  used with Kubern
+00019530: 6574 6573 2c20 7468 6973 2077 696c 6c20  etes, this will 
+00019540: 6d61 6b65 2073 7572 6520 7468 6174 2074  make sure that t
+00019550: 6865 2070 726f 6a65 6374 2d73 7065 6369  he project-speci
+00019560: 6669 6320 6b38 7320 7365 6372 6574 2069  fic k8s secret i
+00019570: 7320 6372 6561 7465 642c 2061 6e64 2077  s created, and w
+00019580: 696c 6c0a 2020 2020 2020 2020 706f 7075  ill.        popu
+00019590: 6c61 7465 2069 7420 7769 7468 2074 6865  late it with the
+000195a0: 2073 6563 7265 7473 2070 726f 7669 6465   secrets provide
+000195b0: 642c 2072 6570 6c61 6369 6e67 2074 6865  d, replacing the
+000195c0: 6972 2076 616c 7565 7320 6966 2074 6865  ir values if the
+000195d0: 7920 6578 6973 742e 0a0a 2020 2020 2020  y exist...      
+000195e0: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+000195f0: 3a20 5468 6520 7072 6f6a 6563 7420 636f  : The project co
+00019600: 6e74 6578 7420 666f 7220 7768 6963 6820  ntext for which 
+00019610: 746f 2067 656e 6572 6174 6520 7468 6520  to generate the 
+00019620: 696e 6672 6120 616e 6420 7374 6f72 6520  infra and store 
+00019630: 7365 6372 6574 732e 0a20 2020 2020 2020  secrets..       
+00019640: 203a 7061 7261 6d20 7072 6f76 6964 6572   :param provider
+00019650: 3a20 5468 6520 6e61 6d65 206f 6620 7468  : The name of th
+00019660: 6520 7365 6372 6574 732d 7072 6f76 6964  e secrets-provid
+00019670: 6572 2074 6f20 776f 726b 2077 6974 682e  er to work with.
+00019680: 2041 6363 6570 7473 2061 0a20 2020 2020   Accepts a.     
+00019690: 2020 2020 2020 203a 7079 3a63 6c61 7373         :py:class
+000196a0: 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e  :`~mlrun.common.
+000196b0: 7363 6865 6d61 732e 7365 6372 6574 2e53  schemas.secret.S
+000196c0: 6563 7265 7450 726f 7669 6465 724e 616d  ecretProviderNam
+000196d0: 6560 2065 6e75 6d2e 0a20 2020 2020 2020  e` enum..       
+000196e0: 203a 7061 7261 6d20 7365 6372 6574 733a   :param secrets:
+000196f0: 2041 2073 6574 206f 6620 7365 6372 6574   A set of secret
+00019700: 2076 616c 7565 7320 746f 2073 746f 7265   values to store
+00019710: 2e0a 2020 2020 2020 2020 2020 2020 4578  ..            Ex
+00019720: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00019730: 2020 2020 2020 2020 2073 6563 7265 7473           secrets
+00019740: 203d 207b 2770 6173 7377 6f72 6427 3a20   = {'password': 
+00019750: 276d 7950 6173 7377 3072 6427 2c20 2761  'myPassw0rd', 'a
+00019760: 7773 5f6b 6579 273a 2027 3131 3132 3232  ws_key': '111222
+00019770: 3333 3327 7d0a 2020 2020 2020 2020 2020  333'}.          
+00019780: 2020 2020 2020 6462 2e63 7265 6174 655f        db.create_
+00019790: 7072 6f6a 6563 745f 7365 6372 6574 7328  project_secrets(
+000197a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000197b0: 2020 2020 2022 7072 6f6a 6563 7431 222c       "project1",
+000197c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000197d0: 2020 2020 2070 726f 7669 6465 723d 6d6c       provider=ml
+000197e0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+000197f0: 6173 2e53 6563 7265 7450 726f 7669 6465  as.SecretProvide
+00019800: 724e 616d 652e 6b75 6265 726e 6574 6573  rName.kubernetes
+00019810: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00019820: 2020 2020 2020 7365 6372 6574 733d 7365        secrets=se
+00019830: 6372 6574 730a 2020 2020 2020 2020 2020  crets.          
+00019840: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00019850: 2222 220a 2020 2020 2020 2020 7061 7468  """.        path
+00019860: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+00019870: 726f 6a65 6374 7d2f 7365 6372 6574 7322  roject}/secrets"
+00019880: 0a20 2020 2020 2020 2073 6563 7265 7473  .        secrets
+00019890: 5f69 6e70 7574 203d 206d 6c72 756e 2e63  _input = mlrun.c
+000198a0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5365  ommon.schemas.Se
+000198b0: 6372 6574 7344 6174 6128 0a20 2020 2020  cretsData(.     
+000198c0: 2020 2020 2020 2073 6563 7265 7473 3d73         secrets=s
+000198d0: 6563 7265 7473 2c20 7072 6f76 6964 6572  ecrets, provider
+000198e0: 3d70 726f 7669 6465 720a 2020 2020 2020  =provider.      
+000198f0: 2020 290a 2020 2020 2020 2020 626f 6479    ).        body
+00019900: 203d 2073 6563 7265 7473 5f69 6e70 7574   = secrets_input
+00019910: 2e64 6963 7428 290a 2020 2020 2020 2020  .dict().        
+00019920: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+00019930: 6622 4661 696c 6564 2063 7265 6174 696e  f"Failed creatin
+00019940: 6720 7365 6372 6574 2070 726f 7669 6465  g secret provide
+00019950: 7220 7b70 726f 6a65 6374 7d2f 7b70 726f  r {project}/{pro
+00019960: 7669 6465 727d 220a 2020 2020 2020 2020  vider}".        
+00019970: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+00019980: 2020 2020 2020 2020 2020 2022 504f 5354             "POST
+00019990: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
+000199a0: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
+000199b0: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
+000199c0: 2020 2020 2020 2020 2020 2020 626f 6479              body
+000199d0: 3d64 6963 745f 746f 5f6a 736f 6e28 626f  =dict_to_json(bo
+000199e0: 6479 292c 0a20 2020 2020 2020 2029 0a0a  dy),.        )..
+000199f0: 2020 2020 6465 6620 6c69 7374 5f70 726f      def list_pro
+00019a00: 6a65 6374 5f73 6563 7265 7473 280a 2020  ject_secrets(.  
+00019a10: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00019a20: 2020 2020 7072 6f6a 6563 743a 2073 7472      project: str
+00019a30: 2c0a 2020 2020 2020 2020 746f 6b65 6e3a  ,.        token:
+00019a40: 2073 7472 203d 204e 6f6e 652c 0a20 2020   str = None,.   
+00019a50: 2020 2020 2070 726f 7669 6465 723a 2055       provider: U
+00019a60: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
+00019a70: 2020 7374 722c 206d 6c72 756e 2e63 6f6d    str, mlrun.com
+00019a80: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
+00019a90: 6574 5072 6f76 6964 6572 4e61 6d65 0a20  etProviderName. 
+00019aa0: 2020 2020 2020 205d 203d 206d 6c72 756e         ] = mlrun
+00019ab0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00019ac0: 5365 6372 6574 5072 6f76 6964 6572 4e61  SecretProviderNa
+00019ad0: 6d65 2e6b 7562 6572 6e65 7465 732c 0a20  me.kubernetes,. 
+00019ae0: 2020 2020 2020 2073 6563 7265 7473 3a20         secrets: 
+00019af0: 4c69 7374 5b73 7472 5d20 3d20 4e6f 6e65  List[str] = None
+00019b00: 2c0a 2020 2020 2920 2d3e 206d 6c72 756e  ,.    ) -> mlrun
+00019b10: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00019b20: 5365 6372 6574 7344 6174 613a 0a20 2020  SecretsData:.   
+00019b30: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
+00019b40: 2070 726f 6a65 6374 2d63 6f6e 7465 7874   project-context
+00019b50: 2073 6563 7265 7473 2066 726f 6d20 5661   secrets from Va
+00019b60: 756c 742e 0a0a 2020 2020 2020 2020 4e6f  ult...        No
+00019b70: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
+00019b80: 2020 2020 5468 6973 206d 6574 686f 6420      This method 
+00019b90: 666f 7220 5661 756c 7420 6675 6e63 7469  for Vault functi
+00019ba0: 6f6e 616c 6974 7920 6973 2063 7572 7265  onality is curre
+00019bb0: 6e74 6c79 2069 6e20 7465 6368 6e69 6361  ntly in technica
+00019bc0: 6c20 7072 6576 6965 772c 2061 6e64 2072  l preview, and r
+00019bd0: 6571 7569 7265 7320 6120 4861 7368 6943  equires a HashiC
+00019be0: 6f72 7020 5661 756c 740a 2020 2020 2020  orp Vault.      
+00019bf0: 2020 2020 2020 2020 2020 696e 6672 6173            infras
+00019c00: 7472 7563 7475 7265 2070 726f 7065 726c  tructure properl
+00019c10: 7920 7365 7420 7570 2061 6e64 2063 6f6e  y set up and con
+00019c20: 6e65 6374 6564 2074 6f20 7468 6520 4d4c  nected to the ML
+00019c30: 5275 6e20 4150 4920 7365 7276 6572 2e0a  Run API server..
+00019c40: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00019c50: 7072 6f6a 6563 743a 2054 6865 2070 726f  project: The pro
+00019c60: 6a65 6374 206e 616d 652e 0a20 2020 2020  ject name..     
+00019c70: 2020 203a 7061 7261 6d20 746f 6b65 6e3a     :param token:
+00019c80: 2056 6175 6c74 2074 6f6b 656e 2074 6f20   Vault token to 
+00019c90: 7573 6520 666f 7220 7265 7472 6965 7669  use for retrievi
+00019ca0: 6e67 2073 6563 7265 7473 2e0a 2020 2020  ng secrets..    
+00019cb0: 2020 2020 2020 2020 4d75 7374 2062 6520          Must be 
+00019cc0: 6120 7661 6c69 6420 5661 756c 7420 746f  a valid Vault to
+00019cd0: 6b65 6e2c 2077 6974 6820 7065 726d 6973  ken, with permis
+00019ce0: 7369 6f6e 7320 746f 2072 6574 7269 6576  sions to retriev
+00019cf0: 6520 7365 6372 6574 7320 6f66 2074 6865  e secrets of the
+00019d00: 2070 726f 6a65 6374 2069 6e20 7175 6573   project in ques
+00019d10: 7469 6f6e 2e0a 2020 2020 2020 2020 3a70  tion..        :p
+00019d20: 6172 616d 2070 726f 7669 6465 723a 2054  aram provider: T
+00019d30: 6865 206e 616d 6520 6f66 2074 6865 2073  he name of the s
+00019d40: 6563 7265 7473 2d70 726f 7669 6465 7220  ecrets-provider 
+00019d50: 746f 2077 6f72 6b20 7769 7468 2e20 4375  to work with. Cu
+00019d60: 7272 656e 746c 7920 6f6e 6c79 2060 6076  rrently only ``v
+00019d70: 6175 6c74 6060 2069 7320 6163 6365 7074  ault`` is accept
+00019d80: 6564 2e0a 2020 2020 2020 2020 3a70 6172  ed..        :par
+00019d90: 616d 2073 6563 7265 7473 3a20 4120 6c69  am secrets: A li
+00019da0: 7374 206f 6620 7365 6372 6574 206e 616d  st of secret nam
+00019db0: 6573 2074 6f20 7265 7472 6965 7665 2e20  es to retrieve. 
+00019dc0: 416e 2065 6d70 7479 206c 6973 7420 6060  An empty list ``
+00019dd0: 5b5d 6060 2077 696c 6c20 7265 7472 6965  []`` will retrie
+00019de0: 7665 2061 6c6c 2073 6563 7265 7473 2061  ve all secrets a
+00019df0: 7373 6967 6e65 640a 2020 2020 2020 2020  ssigned.        
+00019e00: 2020 2020 746f 2074 6869 7320 7370 6563      to this spec
+00019e10: 6966 6963 2070 726f 6a65 6374 2e20 6060  ific project. ``
+00019e20: 6b75 6265 726e 6574 6573 6060 2070 726f  kubernetes`` pro
+00019e30: 7669 6465 7220 6f6e 6c79 2073 7570 706f  vider only suppo
+00019e40: 7274 7320 616e 2065 6d70 7479 206c 6973  rts an empty lis
+00019e50: 742e 0a20 2020 2020 2020 2022 2222 0a0a  t..        """..
+00019e60: 2020 2020 2020 2020 6966 2028 0a20 2020          if (.   
+00019e70: 2020 2020 2020 2020 2070 726f 7669 6465           provide
+00019e80: 7220 3d3d 206d 6c72 756e 2e63 6f6d 6d6f  r == mlrun.commo
+00019e90: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
+00019ea0: 5072 6f76 6964 6572 4e61 6d65 2e76 6175  ProviderName.vau
+00019eb0: 6c74 2e76 616c 7565 0a20 2020 2020 2020  lt.value.       
+00019ec0: 2020 2020 2061 6e64 206e 6f74 2074 6f6b       and not tok
+00019ed0: 656e 0a20 2020 2020 2020 2029 3a0a 2020  en.        ):.  
+00019ee0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00019ef0: 4d4c 5275 6e49 6e76 616c 6964 4172 6775  MLRunInvalidArgu
+00019f00: 6d65 6e74 4572 726f 7228 0a20 2020 2020  mentError(.     
+00019f10: 2020 2020 2020 2020 2020 2022 4120 7661             "A va
+00019f20: 756c 7420 746f 6b65 6e20 6d75 7374 2062  ult token must b
+00019f30: 6520 7072 6f76 6964 6564 2077 6865 6e20  e provided when 
+00019f40: 6163 6365 7373 696e 6720 7661 756c 7420  accessing vault 
+00019f50: 7365 6372 6574 7322 0a20 2020 2020 2020  secrets".       
+00019f60: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00019f70: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+00019f80: 732f 7b70 726f 6a65 6374 7d2f 7365 6372  s/{project}/secr
+00019f90: 6574 7322 0a20 2020 2020 2020 2070 6172  ets".        par
+00019fa0: 616d 7320 3d20 7b22 7072 6f76 6964 6572  ams = {"provider
+00019fb0: 223a 2070 726f 7669 6465 722c 2022 7365  ": provider, "se
+00019fc0: 6372 6574 223a 2073 6563 7265 7473 7d0a  cret": secrets}.
+00019fd0: 2020 2020 2020 2020 6865 6164 6572 7320          headers 
+00019fe0: 3d20 7b6d 6c72 756e 2e63 6f6d 6d6f 6e2e  = {mlrun.common.
+00019ff0: 7363 6865 6d61 732e 4865 6164 6572 4e61  schemas.HeaderNa
+0001a000: 6d65 732e 7365 6372 6574 5f73 746f 7265  mes.secret_store
+0001a010: 5f74 6f6b 656e 3a20 746f 6b65 6e7d 0a20  _token: token}. 
+0001a020: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+0001a030: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+0001a040: 7265 7472 6965 7669 6e67 2073 6563 7265  retrieving secre
+0001a050: 7473 207b 7072 6f6a 6563 747d 2f7b 7072  ts {project}/{pr
+0001a060: 6f76 6964 6572 7d22 0a20 2020 2020 2020  ovider}".       
+0001a070: 2072 6573 756c 7420 3d20 7365 6c66 2e61   result = self.a
+0001a080: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
+0001a090: 2020 2020 2022 4745 5422 2c0a 2020 2020       "GET",.    
+0001a0a0: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
+0001a0b0: 2020 2020 2020 2020 2020 6572 726f 725f            error_
+0001a0c0: 6d65 7373 6167 652c 0a20 2020 2020 2020  message,.       
+0001a0d0: 2020 2020 2070 6172 616d 733d 7061 7261       params=para
+0001a0e0: 6d73 2c0a 2020 2020 2020 2020 2020 2020  ms,.            
+0001a0f0: 6865 6164 6572 733d 6865 6164 6572 732c  headers=headers,
+0001a100: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0001a110: 2020 2072 6574 7572 6e20 6d6c 7275 6e2e     return mlrun.
+0001a120: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
+0001a130: 6563 7265 7473 4461 7461 282a 2a72 6573  ecretsData(**res
+0001a140: 756c 742e 6a73 6f6e 2829 290a 0a20 2020  ult.json())..   
+0001a150: 2064 6566 206c 6973 745f 7072 6f6a 6563   def list_projec
+0001a160: 745f 7365 6372 6574 5f6b 6579 7328 0a20  t_secret_keys(. 
+0001a170: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0001a180: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
+0001a190: 722c 0a20 2020 2020 2020 2070 726f 7669  r,.        provi
+0001a1a0: 6465 723a 2055 6e69 6f6e 5b0a 2020 2020  der: Union[.    
+0001a1b0: 2020 2020 2020 2020 7374 722c 206d 6c72          str, mlr
+0001a1c0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0001a1d0: 732e 5365 6372 6574 5072 6f76 6964 6572  s.SecretProvider
+0001a1e0: 4e61 6d65 0a20 2020 2020 2020 205d 203d  Name.        ] =
+0001a1f0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+0001a200: 6865 6d61 732e 5365 6372 6574 5072 6f76  hemas.SecretProv
+0001a210: 6964 6572 4e61 6d65 2e6b 7562 6572 6e65  iderName.kuberne
+0001a220: 7465 732c 0a20 2020 2020 2020 2074 6f6b  tes,.        tok
+0001a230: 656e 3a20 7374 7220 3d20 4e6f 6e65 2c0a  en: str = None,.
+0001a240: 2020 2020 2920 2d3e 206d 6c72 756e 2e63      ) -> mlrun.c
+0001a250: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5365  ommon.schemas.Se
+0001a260: 6372 6574 4b65 7973 4461 7461 3a0a 2020  cretKeysData:.  
+0001a270: 2020 2020 2020 2222 2252 6574 7269 6576        """Retriev
+0001a280: 6520 7072 6f6a 6563 742d 636f 6e74 6578  e project-contex
+0001a290: 7420 7365 6372 6574 206b 6579 7320 6672  t secret keys fr
+0001a2a0: 6f6d 2056 6175 6c74 206f 7220 4b75 6265  om Vault or Kube
+0001a2b0: 726e 6574 6573 2e0a 0a20 2020 2020 2020  rnetes...       
+0001a2c0: 204e 6f74 653a 0a20 2020 2020 2020 2020   Note:.         
+0001a2d0: 2020 2020 2020 2054 6869 7320 6d65 7468         This meth
+0001a2e0: 6f64 2066 6f72 2056 6175 6c74 2066 756e  od for Vault fun
+0001a2f0: 6374 696f 6e61 6c69 7479 2069 7320 6375  ctionality is cu
+0001a300: 7272 656e 746c 7920 696e 2074 6563 686e  rrently in techn
+0001a310: 6963 616c 2070 7265 7669 6577 2c20 616e  ical preview, an
+0001a320: 6420 7265 7175 6972 6573 2061 2048 6173  d requires a Has
+0001a330: 6869 436f 7270 2056 6175 6c74 0a20 2020  hiCorp Vault.   
+0001a340: 2020 2020 2020 2020 2020 2020 2069 6e66               inf
+0001a350: 7261 7374 7275 6374 7572 6520 7072 6f70  rastructure prop
+0001a360: 6572 6c79 2073 6574 2075 7020 616e 6420  erly set up and 
+0001a370: 636f 6e6e 6563 7465 6420 746f 2074 6865  connected to the
+0001a380: 204d 4c52 756e 2041 5049 2073 6572 7665   MLRun API serve
+0001a390: 722e 0a0a 2020 2020 2020 2020 3a70 6172  r...        :par
+0001a3a0: 616d 2070 726f 6a65 6374 3a20 5468 6520  am project: The 
+0001a3b0: 7072 6f6a 6563 7420 6e61 6d65 2e0a 2020  project name..  
+0001a3c0: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
+0001a3d0: 7669 6465 723a 2054 6865 206e 616d 6520  vider: The name 
+0001a3e0: 6f66 2074 6865 2073 6563 7265 7473 2d70  of the secrets-p
+0001a3f0: 726f 7669 6465 7220 746f 2077 6f72 6b20  rovider to work 
+0001a400: 7769 7468 2e20 4163 6365 7074 7320 610a  with. Accepts a.
+0001a410: 2020 2020 2020 2020 2020 2020 3a70 793a              :py:
+0001a420: 636c 6173 733a 607e 6d6c 7275 6e2e 636f  class:`~mlrun.co
+0001a430: 6d6d 6f6e 2e73 6368 656d 6173 2e73 6563  mmon.schemas.sec
+0001a440: 7265 742e 5365 6372 6574 5072 6f76 6964  ret.SecretProvid
+0001a450: 6572 4e61 6d65 6020 656e 756d 2e0a 2020  erName` enum..  
+0001a460: 2020 2020 2020 3a70 6172 616d 2074 6f6b        :param tok
+0001a470: 656e 3a20 5661 756c 7420 746f 6b65 6e20  en: Vault token 
+0001a480: 746f 2075 7365 2066 6f72 2072 6574 7269  to use for retri
+0001a490: 6576 696e 6720 7365 6372 6574 732e 204f  eving secrets. O
+0001a4a0: 6e6c 7920 696e 2075 7365 2069 6620 6060  nly in use if ``
+0001a4b0: 7072 6f76 6964 6572 6060 2069 7320 6060  provider`` is ``
+0001a4c0: 7661 756c 7460 602e 0a20 2020 2020 2020  vault``..       
+0001a4d0: 2020 2020 204d 7573 7420 6265 2061 2076       Must be a v
+0001a4e0: 616c 6964 2056 6175 6c74 2074 6f6b 656e  alid Vault token
+0001a4f0: 2c20 7769 7468 2070 6572 6d69 7373 696f  , with permissio
+0001a500: 6e73 2074 6f20 7265 7472 6965 7665 2073  ns to retrieve s
+0001a510: 6563 7265 7473 206f 6620 7468 6520 7072  ecrets of the pr
+0001a520: 6f6a 6563 7420 696e 2071 7565 7374 696f  oject in questio
+0001a530: 6e2e 0a20 2020 2020 2020 2022 2222 0a0a  n..        """..
+0001a540: 2020 2020 2020 2020 6966 2028 0a20 2020          if (.   
+0001a550: 2020 2020 2020 2020 2070 726f 7669 6465           provide
+0001a560: 7220 3d3d 206d 6c72 756e 2e63 6f6d 6d6f  r == mlrun.commo
+0001a570: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
+0001a580: 5072 6f76 6964 6572 4e61 6d65 2e76 6175  ProviderName.vau
+0001a590: 6c74 2e76 616c 7565 0a20 2020 2020 2020  lt.value.       
+0001a5a0: 2020 2020 2061 6e64 206e 6f74 2074 6f6b       and not tok
+0001a5b0: 656e 0a20 2020 2020 2020 2029 3a0a 2020  en.        ):.  
+0001a5c0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001a5d0: 4d4c 5275 6e49 6e76 616c 6964 4172 6775  MLRunInvalidArgu
+0001a5e0: 6d65 6e74 4572 726f 7228 0a20 2020 2020  mentError(.     
+0001a5f0: 2020 2020 2020 2020 2020 2022 4120 7661             "A va
+0001a600: 756c 7420 746f 6b65 6e20 6d75 7374 2062  ult token must b
+0001a610: 6520 7072 6f76 6964 6564 2077 6865 6e20  e provided when 
+0001a620: 6163 6365 7373 696e 6720 7661 756c 7420  accessing vault 
+0001a630: 7365 6372 6574 7322 0a20 2020 2020 2020  secrets".       
+0001a640: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0001a650: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+0001a660: 732f 7b70 726f 6a65 6374 7d2f 7365 6372  s/{project}/secr
+0001a670: 6574 2d6b 6579 7322 0a20 2020 2020 2020  et-keys".       
+0001a680: 2070 6172 616d 7320 3d20 7b22 7072 6f76   params = {"prov
+0001a690: 6964 6572 223a 2070 726f 7669 6465 727d  ider": provider}
+0001a6a0: 0a20 2020 2020 2020 2068 6561 6465 7273  .        headers
+0001a6b0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+0001a6c0: 207b 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73   {mlrun.common.s
+0001a6d0: 6368 656d 6173 2e48 6561 6465 724e 616d  chemas.HeaderNam
+0001a6e0: 6573 2e73 6563 7265 745f 7374 6f72 655f  es.secret_store_
+0001a6f0: 746f 6b65 6e3a 2074 6f6b 656e 7d0a 2020  token: token}.  
+0001a700: 2020 2020 2020 2020 2020 6966 2070 726f            if pro
+0001a710: 7669 6465 7220 3d3d 206d 6c72 756e 2e63  vider == mlrun.c
+0001a720: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5365  ommon.schemas.Se
+0001a730: 6372 6574 5072 6f76 6964 6572 4e61 6d65  cretProviderName
+0001a740: 2e76 6175 6c74 2e76 616c 7565 0a20 2020  .vault.value.   
+0001a750: 2020 2020 2020 2020 2065 6c73 6520 4e6f           else No
+0001a760: 6e65 0a20 2020 2020 2020 2029 0a20 2020  ne.        ).   
+0001a770: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+0001a780: 6765 203d 2066 2246 6169 6c65 6420 7265  ge = f"Failed re
+0001a790: 7472 6965 7669 6e67 2073 6563 7265 7420  trieving secret 
+0001a7a0: 6b65 7973 207b 7072 6f6a 6563 747d 2f7b  keys {project}/{
+0001a7b0: 7072 6f76 6964 6572 7d22 0a20 2020 2020  provider}".     
+0001a7c0: 2020 2072 6573 756c 7420 3d20 7365 6c66     result = self
+0001a7d0: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
+0001a7e0: 2020 2020 2020 2022 4745 5422 2c0a 2020         "GET",.  
+0001a7f0: 2020 2020 2020 2020 2020 7061 7468 2c0a            path,.
+0001a800: 2020 2020 2020 2020 2020 2020 6572 726f              erro
+0001a810: 725f 6d65 7373 6167 652c 0a20 2020 2020  r_message,.     
+0001a820: 2020 2020 2020 2070 6172 616d 733d 7061         params=pa
+0001a830: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
+0001a840: 2020 6865 6164 6572 733d 6865 6164 6572    headers=header
+0001a850: 732c 0a20 2020 2020 2020 2029 0a20 2020  s,.        ).   
+0001a860: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
+0001a870: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0001a880: 2e53 6563 7265 744b 6579 7344 6174 6128  .SecretKeysData(
+0001a890: 2a2a 7265 7375 6c74 2e6a 736f 6e28 2929  **result.json())
+0001a8a0: 0a0a 2020 2020 6465 6620 6465 6c65 7465  ..    def delete
+0001a8b0: 5f70 726f 6a65 6374 5f73 6563 7265 7473  _project_secrets
+0001a8c0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0001a8d0: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
+0001a8e0: 2073 7472 2c0a 2020 2020 2020 2020 7072   str,.        pr
+0001a8f0: 6f76 6964 6572 3a20 556e 696f 6e5b 0a20  ovider: Union[. 
+0001a900: 2020 2020 2020 2020 2020 2073 7472 2c20             str, 
+0001a910: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001a920: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
+0001a930: 6465 724e 616d 650a 2020 2020 2020 2020  derName.        
+0001a940: 5d20 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e  ] = mlrun.common
+0001a950: 2e73 6368 656d 6173 2e53 6563 7265 7450  .schemas.SecretP
+0001a960: 726f 7669 6465 724e 616d 652e 6b75 6265  roviderName.kube
+0001a970: 726e 6574 6573 2c0a 2020 2020 2020 2020  rnetes,.        
+0001a980: 7365 6372 6574 733a 204c 6973 745b 7374  secrets: List[st
+0001a990: 725d 203d 204e 6f6e 652c 0a20 2020 2029  r] = None,.    )
+0001a9a0: 3a0a 2020 2020 2020 2020 2222 2244 656c  :.        """Del
+0001a9b0: 6574 6520 7072 6f6a 6563 742d 636f 6e74  ete project-cont
+0001a9c0: 6578 7420 7365 6372 6574 7320 6672 6f6d  ext secrets from
+0001a9d0: 204b 7562 6572 6e65 7465 732e 0a0a 2020   Kubernetes...  
+0001a9e0: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
+0001a9f0: 6a65 6374 3a20 5468 6520 7072 6f6a 6563  ject: The projec
+0001aa00: 7420 6e61 6d65 2e0a 2020 2020 2020 2020  t name..        
+0001aa10: 3a70 6172 616d 2070 726f 7669 6465 723a  :param provider:
+0001aa20: 2054 6865 206e 616d 6520 6f66 2074 6865   The name of the
+0001aa30: 2073 6563 7265 7473 2d70 726f 7669 6465   secrets-provide
+0001aa40: 7220 746f 2077 6f72 6b20 7769 7468 2e20  r to work with. 
+0001aa50: 4375 7272 656e 746c 7920 6f6e 6c79 2060  Currently only `
+0001aa60: 606b 7562 6572 6e65 7465 7360 6020 6973  `kubernetes`` is
+0001aa70: 2073 7570 706f 7274 6564 2e0a 2020 2020   supported..    
+0001aa80: 2020 2020 3a70 6172 616d 2073 6563 7265      :param secre
+0001aa90: 7473 3a20 4120 6c69 7374 206f 6620 7365  ts: A list of se
+0001aaa0: 6372 6574 206e 616d 6573 2074 6f20 6465  cret names to de
+0001aab0: 6c65 7465 2e20 416e 2065 6d70 7479 206c  lete. An empty l
+0001aac0: 6973 7420 7769 6c6c 2064 656c 6574 6520  ist will delete 
+0001aad0: 616c 6c20 7365 6372 6574 7320 6173 7369  all secrets assi
+0001aae0: 676e 6564 0a20 2020 2020 2020 2020 2020  gned.           
+0001aaf0: 2074 6f20 7468 6973 2073 7065 6369 6669   to this specifi
+0001ab00: 6320 7072 6f6a 6563 742e 0a20 2020 2020  c project..     
+0001ab10: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+0001ab20: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+0001ab30: 732f 7b70 726f 6a65 6374 7d2f 7365 6372  s/{project}/secr
+0001ab40: 6574 7322 0a20 2020 2020 2020 2070 6172  ets".        par
+0001ab50: 616d 7320 3d20 7b22 7072 6f76 6964 6572  ams = {"provider
+0001ab60: 223a 2070 726f 7669 6465 722c 2022 7365  ": provider, "se
+0001ab70: 6372 6574 223a 2073 6563 7265 7473 7d0a  cret": secrets}.
+0001ab80: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+0001ab90: 7373 6167 6520 3d20 6622 4661 696c 6564  ssage = f"Failed
+0001aba0: 2064 656c 6574 696e 6720 7365 6372 6574   deleting secret
+0001abb0: 7320 7b70 726f 6a65 6374 7d2f 7b70 726f  s {project}/{pro
+0001abc0: 7669 6465 727d 220a 2020 2020 2020 2020  vider}".        
+0001abd0: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+0001abe0: 2020 2020 2020 2020 2020 2022 4445 4c45             "DELE
+0001abf0: 5445 222c 0a20 2020 2020 2020 2020 2020  TE",.           
+0001ac00: 2070 6174 682c 0a20 2020 2020 2020 2020   path,.         
+0001ac10: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+0001ac20: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+0001ac30: 7261 6d73 3d70 6172 616d 732c 0a20 2020  rams=params,.   
+0001ac40: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+0001ac50: 6372 6561 7465 5f75 7365 725f 7365 6372  create_user_secr
+0001ac60: 6574 7328 0a20 2020 2020 2020 2073 656c  ets(.        sel
+0001ac70: 662c 0a20 2020 2020 2020 2075 7365 723a  f,.        user:
+0001ac80: 2073 7472 2c0a 2020 2020 2020 2020 7072   str,.        pr
+0001ac90: 6f76 6964 6572 3a20 556e 696f 6e5b 0a20  ovider: Union[. 
+0001aca0: 2020 2020 2020 2020 2020 2073 7472 2c20             str, 
+0001acb0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001acc0: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
+0001acd0: 6465 724e 616d 650a 2020 2020 2020 2020  derName.        
+0001ace0: 5d20 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e  ] = mlrun.common
+0001acf0: 2e73 6368 656d 6173 2e53 6563 7265 7450  .schemas.SecretP
+0001ad00: 726f 7669 6465 724e 616d 652e 7661 756c  roviderName.vaul
+0001ad10: 742c 0a20 2020 2020 2020 2073 6563 7265  t,.        secre
+0001ad20: 7473 3a20 6469 6374 203d 204e 6f6e 652c  ts: dict = None,
+0001ad30: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+0001ad40: 2222 2243 7265 6174 6520 7573 6572 2d63  """Create user-c
+0001ad50: 6f6e 7465 7874 2073 6563 7265 7420 696e  ontext secret in
+0001ad60: 2056 6175 6c74 2e20 506c 6561 7365 2072   Vault. Please r
+0001ad70: 6566 6572 2074 6f20 3a70 793a 6675 6e63  efer to :py:func
+0001ad80: 3a60 6372 6561 7465 5f70 726f 6a65 6374  :`create_project
+0001ad90: 5f73 6563 7265 7473 6020 666f 7220 6d6f  _secrets` for mo
+0001ada0: 7265 2064 6574 6169 6c73 0a20 2020 2020  re details.     
+0001adb0: 2020 2061 6e64 2073 7461 7475 7320 6f66     and status of
+0001adc0: 2074 6869 7320 6675 6e63 7469 6f6e 616c   this functional
+0001add0: 6974 792e 0a0a 2020 2020 2020 2020 4e6f  ity...        No
+0001ade0: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
+0001adf0: 2020 2020 5468 6973 206d 6574 686f 6420      This method 
+0001ae00: 6973 2063 7572 7265 6e74 6c79 2069 6e20  is currently in 
+0001ae10: 7465 6368 6e69 6361 6c20 7072 6576 6965  technical previe
+0001ae20: 772c 2061 6e64 2072 6571 7569 7265 7320  w, and requires 
+0001ae30: 6120 4861 7368 6943 6f72 7020 5661 756c  a HashiCorp Vaul
+0001ae40: 7420 696e 6672 6173 7472 7563 7475 7265  t infrastructure
+0001ae50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ae60: 2070 726f 7065 726c 7920 7365 7420 7570   properly set up
+0001ae70: 2061 6e64 2063 6f6e 6e65 6374 6564 2074   and connected t
+0001ae80: 6f20 7468 6520 4d4c 5275 6e20 4150 4920  o the MLRun API 
+0001ae90: 7365 7276 6572 2e0a 0a20 2020 2020 2020  server...       
+0001aea0: 203a 7061 7261 6d20 7573 6572 3a20 5468   :param user: Th
+0001aeb0: 6520 7573 6572 2063 6f6e 7465 7874 2066  e user context f
+0001aec0: 6f72 2077 6869 6368 2074 6f20 6765 6e65  or which to gene
+0001aed0: 7261 7465 2074 6865 2069 6e66 7261 2061  rate the infra a
+0001aee0: 6e64 2073 746f 7265 2073 6563 7265 7473  nd store secrets
+0001aef0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001af00: 2070 726f 7669 6465 723a 2054 6865 206e   provider: The n
+0001af10: 616d 6520 6f66 2074 6865 2073 6563 7265  ame of the secre
+0001af20: 7473 2d70 726f 7669 6465 7220 746f 2077  ts-provider to w
+0001af30: 6f72 6b20 7769 7468 2e20 4375 7272 656e  ork with. Curren
+0001af40: 746c 7920 6f6e 6c79 2060 6076 6175 6c74  tly only ``vault
+0001af50: 6060 2069 7320 7375 7070 6f72 7465 642e  `` is supported.
+0001af60: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001af70: 7365 6372 6574 733a 2041 2073 6574 206f  secrets: A set o
+0001af80: 6620 7365 6372 6574 2076 616c 7565 7320  f secret values 
+0001af90: 746f 2073 746f 7265 2077 6974 6869 6e20  to store within 
+0001afa0: 7468 6520 5661 756c 742e 0a20 2020 2020  the Vault..     
+0001afb0: 2020 2022 2222 0a20 2020 2020 2020 2070     """.        p
+0001afc0: 6174 6820 3d20 2275 7365 722d 7365 6372  ath = "user-secr
+0001afd0: 6574 7322 0a20 2020 2020 2020 2073 6563  ets".        sec
+0001afe0: 7265 7473 5f63 7265 6174 696f 6e5f 7265  rets_creation_re
+0001aff0: 7175 6573 7420 3d20 6d6c 7275 6e2e 636f  quest = mlrun.co
+0001b000: 6d6d 6f6e 2e73 6368 656d 6173 2e55 7365  mmon.schemas.Use
+0001b010: 7253 6563 7265 7443 7265 6174 696f 6e52  rSecretCreationR
+0001b020: 6571 7565 7374 280a 2020 2020 2020 2020  equest(.        
+0001b030: 2020 2020 7573 6572 3d75 7365 722c 0a20      user=user,. 
+0001b040: 2020 2020 2020 2020 2020 2070 726f 7669             provi
+0001b050: 6465 723d 7072 6f76 6964 6572 2c0a 2020  der=provider,.  
+0001b060: 2020 2020 2020 2020 2020 7365 6372 6574            secret
+0001b070: 733d 7365 6372 6574 732c 0a20 2020 2020  s=secrets,.     
+0001b080: 2020 2029 0a20 2020 2020 2020 2062 6f64     ).        bod
+0001b090: 7920 3d20 7365 6372 6574 735f 6372 6561  y = secrets_crea
+0001b0a0: 7469 6f6e 5f72 6571 7565 7374 2e64 6963  tion_request.dic
+0001b0b0: 7428 290a 2020 2020 2020 2020 6572 726f  t().        erro
+0001b0c0: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+0001b0d0: 696c 6564 2063 7265 6174 696e 6720 7573  iled creating us
+0001b0e0: 6572 2073 6563 7265 7473 202d 207b 7573  er secrets - {us
+0001b0f0: 6572 7d22 0a20 2020 2020 2020 2073 656c  er}".        sel
+0001b100: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
+0001b110: 2020 2020 2020 2020 2250 4f53 5422 2c0a          "POST",.
+0001b120: 2020 2020 2020 2020 2020 2020 7061 7468              path
+0001b130: 2c0a 2020 2020 2020 2020 2020 2020 6572  ,.            er
+0001b140: 726f 725f 6d65 7373 6167 652c 0a20 2020  ror_message,.   
+0001b150: 2020 2020 2020 2020 2062 6f64 793d 6469           body=di
+0001b160: 6374 5f74 6f5f 6a73 6f6e 2862 6f64 7929  ct_to_json(body)
+0001b170: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0001b180: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+0001b190: 2020 2064 6566 205f 7661 6c69 6461 7465     def _validate
+0001b1a0: 5f76 6572 7369 6f6e 5f63 6f6d 7061 7469  _version_compati
+0001b1b0: 6269 6c69 7479 2873 6572 7665 725f 7665  bility(server_ve
+0001b1c0: 7273 696f 6e2c 2063 6c69 656e 745f 7665  rsion, client_ve
+0001b1d0: 7273 696f 6e29 202d 3e20 626f 6f6c 3a0a  rsion) -> bool:.
+0001b1e0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+0001b1f0: 2020 2020 2020 2020 2070 6172 7365 645f           parsed_
+0001b200: 7365 7276 6572 5f76 6572 7369 6f6e 203d  server_version =
+0001b210: 2073 656d 7665 722e 5665 7273 696f 6e49   semver.VersionI
+0001b220: 6e66 6f2e 7061 7273 6528 7365 7276 6572  nfo.parse(server
+0001b230: 5f76 6572 7369 6f6e 290a 2020 2020 2020  _version).      
+0001b240: 2020 2020 2020 7061 7273 6564 5f63 6c69        parsed_cli
+0001b250: 656e 745f 7665 7273 696f 6e20 3d20 7365  ent_version = se
+0001b260: 6d76 6572 2e56 6572 7369 6f6e 496e 666f  mver.VersionInfo
+0001b270: 2e70 6172 7365 2863 6c69 656e 745f 7665  .parse(client_ve
+0001b280: 7273 696f 6e29 0a20 2020 2020 2020 2065  rsion).        e
+0001b290: 7863 6570 7420 5661 6c75 6545 7272 6f72  xcept ValueError
+0001b2a0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+0001b2b0: 5468 6973 2077 696c 6c20 6d6f 7374 6c79  This will mostly
+0001b2c0: 2068 6170 7065 6e20 696e 2064 6576 2073   happen in dev s
+0001b2d0: 6365 6e61 7269 6f73 2077 6865 6e20 7468  cenarios when th
+0001b2e0: 6520 7665 7273 696f 6e20 6973 2075 6e73  e version is uns
+0001b2f0: 7461 626c 6520 616e 6420 7375 6368 202d  table and such -
+0001b300: 2074 6865 7265 666f 7265 2077 6527 7265   therefore we're
+0001b310: 2069 676e 6f72 696e 670a 2020 2020 2020   ignoring.      
+0001b320: 2020 2020 2020 6c6f 6767 6572 2e77 6172        logger.war
+0001b330: 6e69 6e67 280a 2020 2020 2020 2020 2020  ning(.          
+0001b340: 2020 2020 2020 2255 6e61 626c 6520 746f        "Unable to
+0001b350: 2070 6172 7365 2073 6572 7665 7220 6f72   parse server or
+0001b360: 2063 6c69 656e 7420 7665 7273 696f 6e2e   client version.
+0001b370: 2041 7373 756d 696e 6720 636f 6d70 6174   Assuming compat
+0001b380: 6962 6c65 222c 0a20 2020 2020 2020 2020  ible",.         
+0001b390: 2020 2020 2020 2073 6572 7665 725f 7665         server_ve
+0001b3a0: 7273 696f 6e3d 7365 7276 6572 5f76 6572  rsion=server_ver
+0001b3b0: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
+0001b3c0: 2020 2020 2020 636c 6965 6e74 5f76 6572        client_ver
+0001b3d0: 7369 6f6e 3d63 6c69 656e 745f 7665 7273  sion=client_vers
+0001b3e0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0001b3f0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+0001b400: 6574 7572 6e20 5472 7565 0a20 2020 2020  eturn True.     
+0001b410: 2020 2069 6620 2870 6172 7365 645f 7365     if (parsed_se
+0001b420: 7276 6572 5f76 6572 7369 6f6e 2e6d 616a  rver_version.maj
+0001b430: 6f72 203d 3d20 3020 616e 6420 7061 7273  or == 0 and pars
+0001b440: 6564 5f73 6572 7665 725f 7665 7273 696f  ed_server_versio
+0001b450: 6e2e 6d69 6e6f 7220 3d3d 2030 2920 6f72  n.minor == 0) or
+0001b460: 2028 0a20 2020 2020 2020 2020 2020 2070   (.            p
+0001b470: 6172 7365 645f 636c 6965 6e74 5f76 6572  arsed_client_ver
+0001b480: 7369 6f6e 2e6d 616a 6f72 203d 3d20 3020  sion.major == 0 
+0001b490: 616e 6420 7061 7273 6564 5f63 6c69 656e  and parsed_clien
+0001b4a0: 745f 7665 7273 696f 6e2e 6d69 6e6f 7220  t_version.minor 
+0001b4b0: 3d3d 2030 0a20 2020 2020 2020 2029 3a0a  == 0.        ):.
+0001b4c0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
+0001b4d0: 6572 2e77 6172 6e69 6e67 280a 2020 2020  er.warning(.    
+0001b4e0: 2020 2020 2020 2020 2020 2020 2253 6572              "Ser
+0001b4f0: 7665 7220 6f72 2063 6c69 656e 7420 7665  ver or client ve
+0001b500: 7273 696f 6e20 6973 2075 6e73 7461 626c  rsion is unstabl
+0001b510: 652e 2041 7373 756d 696e 6720 636f 6d70  e. Assuming comp
+0001b520: 6174 6962 6c65 222c 0a20 2020 2020 2020  atible",.       
+0001b530: 2020 2020 2020 2020 2073 6572 7665 725f           server_
+0001b540: 7665 7273 696f 6e3d 7365 7276 6572 5f76  version=server_v
+0001b550: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
+0001b560: 2020 2020 2020 2020 636c 6965 6e74 5f76          client_v
+0001b570: 6572 7369 6f6e 3d63 6c69 656e 745f 7665  ersion=client_ve
+0001b580: 7273 696f 6e2c 0a20 2020 2020 2020 2020  rsion,.         
+0001b590: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0001b5a0: 2072 6574 7572 6e20 5472 7565 0a20 2020   return True.   
+0001b5b0: 2020 2020 2069 6620 7061 7273 6564 5f73       if parsed_s
+0001b5c0: 6572 7665 725f 7665 7273 696f 6e2e 6d61  erver_version.ma
+0001b5d0: 6a6f 7220 213d 2070 6172 7365 645f 636c  jor != parsed_cl
+0001b5e0: 6965 6e74 5f76 6572 7369 6f6e 2e6d 616a  ient_version.maj
+0001b5f0: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+0001b600: 6c6f 6767 6572 2e77 6172 6e69 6e67 280a  logger.warning(.
+0001b610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b620: 2253 6572 7665 7220 616e 6420 636c 6965  "Server and clie
+0001b630: 6e74 2076 6572 7369 6f6e 7320 6172 6520  nt versions are 
+0001b640: 696e 636f 6d70 6174 6962 6c65 222c 0a20  incompatible",. 
+0001b650: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0001b660: 6172 7365 645f 7365 7276 6572 5f76 6572  arsed_server_ver
+0001b670: 7369 6f6e 3d70 6172 7365 645f 7365 7276  sion=parsed_serv
+0001b680: 6572 5f76 6572 7369 6f6e 2c0a 2020 2020  er_version,.    
+0001b690: 2020 2020 2020 2020 2020 2020 7061 7273              pars
+0001b6a0: 6564 5f63 6c69 656e 745f 7665 7273 696f  ed_client_versio
+0001b6b0: 6e3d 7061 7273 6564 5f63 6c69 656e 745f  n=parsed_client_
+0001b6c0: 7665 7273 696f 6e2c 0a20 2020 2020 2020  version,.       
+0001b6d0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0001b6e0: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
+0001b6f0: 2020 2020 2020 2020 6966 2070 6172 7365          if parse
+0001b700: 645f 7365 7276 6572 5f76 6572 7369 6f6e  d_server_version
+0001b710: 2e6d 696e 6f72 203e 2070 6172 7365 645f  .minor > parsed_
+0001b720: 636c 6965 6e74 5f76 6572 7369 6f6e 2e6d  client_version.m
+0001b730: 696e 6f72 202b 2032 3a0a 2020 2020 2020  inor + 2:.      
+0001b740: 2020 2020 2020 6c6f 6767 6572 2e69 6e66        logger.inf
+0001b750: 6f28 0a20 2020 2020 2020 2020 2020 2020  o(.             
+0001b760: 2020 2022 4261 636b 7761 7264 7320 636f     "Backwards co
+0001b770: 6d70 6174 6962 696c 6974 7920 6d69 6768  mpatibility migh
+0001b780: 7420 6e6f 7420 6170 706c 7920 6265 7477  t not apply betw
+0001b790: 6565 6e20 7468 6520 7365 7276 6572 2061  een the server a
+0001b7a0: 6e64 2063 6c69 656e 7420 7665 7273 696f  nd client versio
+0001b7b0: 6e22 2c0a 2020 2020 2020 2020 2020 2020  n",.            
+0001b7c0: 2020 2020 7061 7273 6564 5f73 6572 7665      parsed_serve
+0001b7d0: 725f 7665 7273 696f 6e3d 7061 7273 6564  r_version=parsed
+0001b7e0: 5f73 6572 7665 725f 7665 7273 696f 6e2c  _server_version,
+0001b7f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b800: 2070 6172 7365 645f 636c 6965 6e74 5f76   parsed_client_v
+0001b810: 6572 7369 6f6e 3d70 6172 7365 645f 636c  ersion=parsed_cl
+0001b820: 6965 6e74 5f76 6572 7369 6f6e 2c0a 2020  ient_version,.  
+0001b830: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001b840: 2020 2020 2020 2020 7265 7475 726e 2046          return F
+0001b850: 616c 7365 0a20 2020 2020 2020 2069 6620  alse.        if 
+0001b860: 7061 7273 6564 5f63 6c69 656e 745f 7665  parsed_client_ve
+0001b870: 7273 696f 6e2e 6d69 6e6f 7220 3e20 7061  rsion.minor > pa
+0001b880: 7273 6564 5f73 6572 7665 725f 7665 7273  rsed_server_vers
+0001b890: 696f 6e2e 6d69 6e6f 723a 0a20 2020 2020  ion.minor:.     
+0001b8a0: 2020 2020 2020 206c 6f67 6765 722e 7761         logger.wa
+0001b8b0: 726e 696e 6728 0a20 2020 2020 2020 2020  rning(.         
+0001b8c0: 2020 2020 2020 2022 436c 6965 6e74 2076         "Client v
+0001b8d0: 6572 7369 6f6e 2077 6974 6820 6869 6768  ersion with high
+0001b8e0: 6572 2076 6572 7369 6f6e 2074 6861 6e20  er version than 
+0001b8f0: 7365 7276 6572 2076 6572 7369 6f6e 2069  server version i
+0001b900: 736e 2774 2073 7570 706f 7274 6564 2c22  sn't supported,"
+0001b910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b920: 2022 2061 6c69 676e 2079 6f75 7220 636c   " align your cl
+0001b930: 6965 6e74 2074 6f20 7468 6520 7365 7276  ient to the serv
+0001b940: 6572 2076 6572 7369 6f6e 222c 0a20 2020  er version",.   
+0001b950: 2020 2020 2020 2020 2020 2020 2070 6172               par
+0001b960: 7365 645f 7365 7276 6572 5f76 6572 7369  sed_server_versi
+0001b970: 6f6e 3d70 6172 7365 645f 7365 7276 6572  on=parsed_server
+0001b980: 5f76 6572 7369 6f6e 2c0a 2020 2020 2020  _version,.      
+0001b990: 2020 2020 2020 2020 2020 7061 7273 6564            parsed
+0001b9a0: 5f63 6c69 656e 745f 7665 7273 696f 6e3d  _client_version=
+0001b9b0: 7061 7273 6564 5f63 6c69 656e 745f 7665  parsed_client_ve
+0001b9c0: 7273 696f 6e2c 0a20 2020 2020 2020 2020  rsion,.         
+0001b9d0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0001b9e0: 2072 6574 7572 6e20 4661 6c73 650a 2020   return False.  
+0001b9f0: 2020 2020 2020 6966 2070 6172 7365 645f        if parsed_
+0001ba00: 7365 7276 6572 5f76 6572 7369 6f6e 2e6d  server_version.m
+0001ba10: 696e 6f72 2021 3d20 7061 7273 6564 5f63  inor != parsed_c
+0001ba20: 6c69 656e 745f 7665 7273 696f 6e2e 6d69  lient_version.mi
+0001ba30: 6e6f 723a 0a20 2020 2020 2020 2020 2020  nor:.           
+0001ba40: 206c 6f67 6765 722e 696e 666f 280a 2020   logger.info(.  
+0001ba50: 2020 2020 2020 2020 2020 2020 2020 2253                "S
+0001ba60: 6572 7665 7220 616e 6420 636c 6965 6e74  erver and client
+0001ba70: 2076 6572 7369 6f6e 7320 6172 6520 6e6f   versions are no
+0001ba80: 7420 7468 6520 7361 6d65 2062 7574 2063  t the same but c
+0001ba90: 6f6d 7061 7469 626c 6522 2c0a 2020 2020  ompatible",.    
+0001baa0: 2020 2020 2020 2020 2020 2020 7061 7273              pars
+0001bab0: 6564 5f73 6572 7665 725f 7665 7273 696f  ed_server_versio
+0001bac0: 6e3d 7061 7273 6564 5f73 6572 7665 725f  n=parsed_server_
+0001bad0: 7665 7273 696f 6e2c 0a20 2020 2020 2020  version,.       
+0001bae0: 2020 2020 2020 2020 2070 6172 7365 645f           parsed_
+0001baf0: 636c 6965 6e74 5f76 6572 7369 6f6e 3d70  client_version=p
+0001bb00: 6172 7365 645f 636c 6965 6e74 5f76 6572  arsed_client_ver
+0001bb10: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
+0001bb20: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
+0001bb30: 726e 2054 7275 650a 0a20 2020 2064 6566  rn True..    def
+0001bb40: 2063 7265 6174 655f 6d6f 6465 6c5f 656e   create_model_en
+0001bb50: 6470 6f69 6e74 280a 2020 2020 2020 2020  dpoint(.        
+0001bb60: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
+0001bb70: 6f6a 6563 743a 2073 7472 2c0a 2020 2020  oject: str,.    
+0001bb80: 2020 2020 656e 6470 6f69 6e74 5f69 643a      endpoint_id:
+0001bb90: 2073 7472 2c0a 2020 2020 2020 2020 6d6f   str,.        mo
+0001bba0: 6465 6c5f 656e 6470 6f69 6e74 3a20 556e  del_endpoint: Un
+0001bbb0: 696f 6e5b 0a20 2020 2020 2020 2020 2020  ion[.           
+0001bbc0: 206d 6c72 756e 2e6d 6f64 656c 5f6d 6f6e   mlrun.model_mon
+0001bbd0: 6974 6f72 696e 672e 6d6f 6465 6c5f 656e  itoring.model_en
+0001bbe0: 6470 6f69 6e74 2e4d 6f64 656c 456e 6470  dpoint.ModelEndp
+0001bbf0: 6f69 6e74 2c20 6469 6374 0a20 2020 2020  oint, dict.     
+0001bc00: 2020 205d 2c0a 2020 2020 293a 0a20 2020     ],.    ):.   
+0001bc10: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001bc20: 2043 7265 6174 6573 2061 2044 4220 7265   Creates a DB re
+0001bc30: 636f 7264 2077 6974 6820 7468 6520 6769  cord with the gi
+0001bc40: 7665 6e20 6d6f 6465 6c5f 656e 6470 6f69  ven model_endpoi
+0001bc50: 6e74 2072 6563 6f72 642e 0a0a 2020 2020  nt record...    
+0001bc60: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+0001bc70: 6374 3a20 5468 6520 6e61 6d65 206f 6620  ct: The name of 
+0001bc80: 7468 6520 7072 6f6a 6563 742e 0a20 2020  the project..   
+0001bc90: 2020 2020 203a 7061 7261 6d20 656e 6470       :param endp
+0001bca0: 6f69 6e74 5f69 643a 2054 6865 2069 6420  oint_id: The id 
+0001bcb0: 6f66 2074 6865 2065 6e64 706f 696e 742e  of the endpoint.
+0001bcc0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001bcd0: 6d6f 6465 6c5f 656e 6470 6f69 6e74 3a20  model_endpoint: 
+0001bce0: 416e 206f 626a 6563 7420 7265 7072 6573  An object repres
+0001bcf0: 656e 7469 6e67 2074 6865 206d 6f64 656c  enting the model
+0001bd00: 2065 6e64 706f 696e 742e 0a20 2020 2020   endpoint..     
+0001bd10: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+0001bd20: 6966 2069 7369 6e73 7461 6e63 6528 0a20  if isinstance(. 
+0001bd30: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+0001bd40: 5f65 6e64 706f 696e 742c 206d 6c72 756e  _endpoint, mlrun
+0001bd50: 2e6d 6f64 656c 5f6d 6f6e 6974 6f72 696e  .model_monitorin
+0001bd60: 672e 6d6f 6465 6c5f 656e 6470 6f69 6e74  g.model_endpoint
+0001bd70: 2e4d 6f64 656c 456e 6470 6f69 6e74 0a20  .ModelEndpoint. 
+0001bd80: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+0001bd90: 2020 2020 2020 6d6f 6465 6c5f 656e 6470        model_endp
+0001bda0: 6f69 6e74 203d 206d 6f64 656c 5f65 6e64  oint = model_end
+0001bdb0: 706f 696e 742e 746f 5f64 6963 7428 290a  point.to_dict().
+0001bdc0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+0001bdd0: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+0001bde0: 6563 747d 2f6d 6f64 656c 2d65 6e64 706f  ect}/model-endpo
+0001bdf0: 696e 7473 2f7b 656e 6470 6f69 6e74 5f69  ints/{endpoint_i
+0001be00: 647d 220a 2020 2020 2020 2020 7365 6c66  d}".        self
+0001be10: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
+0001be20: 2020 2020 2020 206d 6574 686f 643d 2250         method="P
+0001be30: 4f53 5422 2c0a 2020 2020 2020 2020 2020  OST",.          
+0001be40: 2020 7061 7468 3d70 6174 682c 0a20 2020    path=path,.   
+0001be50: 2020 2020 2020 2020 2062 6f64 793d 6469           body=di
+0001be60: 6374 5f74 6f5f 6a73 6f6e 286d 6f64 656c  ct_to_json(model
+0001be70: 5f65 6e64 706f 696e 7429 2c0a 2020 2020  _endpoint),.    
+0001be80: 2020 2020 290a 0a20 2020 2064 6566 2064      )..    def d
+0001be90: 656c 6574 655f 6d6f 6465 6c5f 656e 6470  elete_model_endp
+0001bea0: 6f69 6e74 280a 2020 2020 2020 2020 7365  oint(.        se
+0001beb0: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
+0001bec0: 6563 743a 2073 7472 2c0a 2020 2020 2020  ect: str,.      
+0001bed0: 2020 656e 6470 6f69 6e74 5f69 643a 2073    endpoint_id: s
+0001bee0: 7472 2c0a 2020 2020 293a 0a20 2020 2020  tr,.    ):.     
+0001bef0: 2020 2022 2222 0a20 2020 2020 2020 2044     """.        D
+0001bf00: 656c 6574 6573 2074 6865 2044 4220 7265  eletes the DB re
+0001bf10: 636f 7264 206f 6620 6120 6769 7665 6e20  cord of a given 
+0001bf20: 6d6f 6465 6c20 656e 6470 6f69 6e74 2c20  model endpoint, 
+0001bf30: 7072 6f6a 6563 7420 616e 6420 656e 6470  project and endp
+0001bf40: 6f69 6e74 5f69 6420 6172 6520 7573 6564  oint_id are used
+0001bf50: 2066 6f72 206c 6f6f 6b75 700a 0a20 2020   for lookup..   
+0001bf60: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+0001bf70: 6563 743a 2054 6865 206e 616d 6520 6f66  ect: The name of
+0001bf80: 2074 6865 2070 726f 6a65 6374 0a20 2020   the project.   
+0001bf90: 2020 2020 203a 7061 7261 6d20 656e 6470       :param endp
+0001bfa0: 6f69 6e74 5f69 643a 2054 6865 2069 6420  oint_id: The id 
+0001bfb0: 6f66 2074 6865 2065 6e64 706f 696e 740a  of the endpoint.
+0001bfc0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+0001bfd0: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
+0001bfe0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
+0001bff0: 2f6d 6f64 656c 2d65 6e64 706f 696e 7473  /model-endpoints
+0001c000: 2f7b 656e 6470 6f69 6e74 5f69 647d 220a  /{endpoint_id}".
+0001c010: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
+0001c020: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+0001c030: 2020 206d 6574 686f 643d 2244 454c 4554     method="DELET
+0001c040: 4522 2c0a 2020 2020 2020 2020 2020 2020  E",.            
+0001c050: 7061 7468 3d70 6174 682c 0a20 2020 2020  path=path,.     
+0001c060: 2020 2029 0a0a 2020 2020 6465 6620 6c69     )..    def li
+0001c070: 7374 5f6d 6f64 656c 5f65 6e64 706f 696e  st_model_endpoin
+0001c080: 7473 280a 2020 2020 2020 2020 7365 6c66  ts(.        self
+0001c090: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+0001c0a0: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
+0001c0b0: 6d6f 6465 6c3a 204f 7074 696f 6e61 6c5b  model: Optional[
+0001c0c0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+0001c0d0: 2020 2020 2066 756e 6374 696f 6e3a 204f       function: O
+0001c0e0: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+0001c0f0: 6f6e 652c 0a20 2020 2020 2020 206c 6162  one,.        lab
+0001c100: 656c 733a 204c 6973 745b 7374 725d 203d  els: List[str] =
+0001c110: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
+0001c120: 7461 7274 3a20 7374 7220 3d20 226e 6f77  tart: str = "now
+0001c130: 2d31 6822 2c0a 2020 2020 2020 2020 656e  -1h",.        en
+0001c140: 643a 2073 7472 203d 2022 6e6f 7722 2c0a  d: str = "now",.
+0001c150: 2020 2020 2020 2020 6d65 7472 6963 733a          metrics:
+0001c160: 204f 7074 696f 6e61 6c5b 4c69 7374 5b73   Optional[List[s
+0001c170: 7472 5d5d 203d 204e 6f6e 652c 0a20 2020  tr]] = None,.   
+0001c180: 2020 2020 2074 6f70 5f6c 6576 656c 3a20       top_level: 
+0001c190: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+0001c1a0: 2020 2020 2020 7569 6473 3a20 4f70 7469        uids: Opti
+0001c1b0: 6f6e 616c 5b4c 6973 745b 7374 725d 5d20  onal[List[str]] 
+0001c1c0: 3d20 4e6f 6e65 2c0a 2020 2020 2920 2d3e  = None,.    ) ->
+0001c1d0: 204c 6973 745b 6d6c 7275 6e2e 6d6f 6465   List[mlrun.mode
+0001c1e0: 6c5f 6d6f 6e69 746f 7269 6e67 2e6d 6f64  l_monitoring.mod
+0001c1f0: 656c 5f65 6e64 706f 696e 742e 4d6f 6465  el_endpoint.Mode
+0001c200: 6c45 6e64 706f 696e 745d 3a0a 2020 2020  lEndpoint]:.    
+0001c210: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001c220: 5265 7475 726e 7320 6120 6c69 7374 206f  Returns a list o
+0001c230: 6620 604d 6f64 656c 456e 6470 6f69 6e74  f `ModelEndpoint
+0001c240: 6020 6f62 6a65 6374 732e 2045 6163 6820  ` objects. Each 
+0001c250: 604d 6f64 656c 456e 6470 6f69 6e74 6020  `ModelEndpoint` 
+0001c260: 6f62 6a65 6374 2072 6570 7265 7365 6e74  object represent
+0001c270: 7320 7468 6520 6375 7272 656e 7420 7374  s the current st
+0001c280: 6174 6520 6f66 2061 0a20 2020 2020 2020  ate of a.       
+0001c290: 206d 6f64 656c 2065 6e64 706f 696e 742e   model endpoint.
+0001c2a0: 2054 6869 7320 6675 6e63 7469 6f6e 7320   This functions 
+0001c2b0: 7375 7070 6f72 7473 2066 696c 7465 7269  supports filteri
+0001c2c0: 6e67 2062 7920 7468 6520 666f 6c6c 6f77  ng by the follow
+0001c2d0: 696e 6720 7061 7261 6d65 7465 7273 3a0a  ing parameters:.
+0001c2e0: 2020 2020 2020 2020 3129 206d 6f64 656c          1) model
+0001c2f0: 0a20 2020 2020 2020 2032 2920 6675 6e63  .        2) func
+0001c300: 7469 6f6e 0a20 2020 2020 2020 2033 2920  tion.        3) 
+0001c310: 6c61 6265 6c73 0a20 2020 2020 2020 2034  labels.        4
+0001c320: 2920 746f 7020 6c65 7665 6c0a 2020 2020  ) top level.    
+0001c330: 2020 2020 3529 2075 6964 730a 2020 2020      5) uids.    
+0001c340: 2020 2020 4279 2064 6566 6175 6c74 2c20      By default, 
+0001c350: 7768 656e 206e 6f20 6669 6c74 6572 7320  when no filters 
+0001c360: 6172 6520 6170 706c 6965 642c 2061 6c6c  are applied, all
+0001c370: 2061 7661 696c 6162 6c65 2065 6e64 706f   available endpo
+0001c380: 696e 7473 2066 6f72 2074 6865 2067 6976  ints for the giv
+0001c390: 656e 2070 726f 6a65 6374 2077 696c 6c20  en project will 
+0001c3a0: 6265 206c 6973 7465 642e 0a0a 2020 2020  be listed...    
+0001c3b0: 2020 2020 496e 2061 6464 6974 696f 6e2c      In addition,
+0001c3c0: 2074 6869 7320 6675 6e63 7469 6f6e 7320   this functions 
+0001c3d0: 7072 6f76 6964 6573 2061 2066 6163 6164  provides a facad
+0001c3e0: 6520 666f 7220 6c69 7374 696e 6720 656e  e for listing en
+0001c3f0: 6470 6f69 6e74 2072 656c 6174 6564 206d  dpoint related m
+0001c400: 6574 7269 6373 2e20 5468 6973 2066 6163  etrics. This fac
+0001c410: 6164 6520 6973 2074 696d 652d 6261 7365  ade is time-base
+0001c420: 640a 2020 2020 2020 2020 616e 6420 6465  d.        and de
+0001c430: 7065 6e64 7320 6f6e 2074 6865 2027 7374  pends on the 'st
+0001c440: 6172 7427 2061 6e64 2027 656e 6427 2070  art' and 'end' p
+0001c450: 6172 616d 6574 6572 732e 2042 7920 6465  arameters. By de
+0001c460: 6661 756c 742c 2077 6865 6e20 7468 6520  fault, when the 
+0001c470: 6d65 7472 6963 7320 7061 7261 6d65 7465  metrics paramete
+0001c480: 7220 6973 204e 6f6e 652c 206e 6f20 6d65  r is None, no me
+0001c490: 7472 6963 7320 6172 650a 2020 2020 2020  trics are.      
+0001c4a0: 2020 6164 6465 6420 746f 2074 6865 206f    added to the o
+0001c4b0: 7574 7075 7420 6f66 2074 6869 7320 6675  utput of this fu
+0001c4c0: 6e63 7469 6f6e 2e0a 0a20 2020 2020 2020  nction...       
+0001c4d0: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
+0001c4e0: 2054 6865 206e 616d 6520 6f66 2074 6865   The name of the
+0001c4f0: 2070 726f 6a65 6374 0a20 2020 2020 2020   project.       
+0001c500: 203a 7061 7261 6d20 6d6f 6465 6c3a 2054   :param model: T
+0001c510: 6865 206e 616d 6520 6f66 2074 6865 206d  he name of the m
+0001c520: 6f64 656c 2074 6f20 6669 6c74 6572 2062  odel to filter b
+0001c530: 790a 2020 2020 2020 2020 3a70 6172 616d  y.        :param
+0001c540: 2066 756e 6374 696f 6e3a 2054 6865 206e   function: The n
+0001c550: 616d 6520 6f66 2074 6865 2066 756e 6374  ame of the funct
+0001c560: 696f 6e20 746f 2066 696c 7465 7220 6279  ion to filter by
+0001c570: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001c580: 6c61 6265 6c73 3a20 4120 6c69 7374 206f  labels: A list o
+0001c590: 6620 6c61 6265 6c73 2074 6f20 6669 6c74  f labels to filt
+0001c5a0: 6572 2062 792e 204c 6162 656c 2066 696c  er by. Label fil
+0001c5b0: 7465 7273 2077 6f72 6b20 6279 2065 6974  ters work by eit
+0001c5c0: 6865 7220 6669 6c74 6572 696e 6720 6120  her filtering a 
+0001c5d0: 7370 6563 6966 6963 2076 616c 7565 206f  specific value o
+0001c5e0: 6620 610a 2020 2020 2020 2020 206c 6162  f a.         lab
+0001c5f0: 656c 2028 692e 652e 206c 6973 7428 226b  el (i.e. list("k
+0001c600: 6579 3d76 616c 7565 2229 2920 6f72 2062  ey=value")) or b
+0001c610: 7920 6c6f 6f6b 696e 6720 666f 7220 7468  y looking for th
+0001c620: 6520 6578 6973 7465 6e63 6520 6f66 2061  e existence of a
+0001c630: 2067 6976 656e 206b 6579 2028 692e 652e   given key (i.e.
+0001c640: 2022 6b65 7922 290a 2020 2020 2020 2020   "key").        
+0001c650: 3a70 6172 616d 206d 6574 7269 6373 3a20  :param metrics: 
+0001c660: 4120 6c69 7374 206f 6620 6d65 7472 6963  A list of metric
+0001c670: 7320 746f 2072 6574 7572 6e20 666f 7220  s to return for 
+0001c680: 6561 6368 2065 6e64 706f 696e 742c 2072  each endpoint, r
+0001c690: 6561 6420 6d6f 7265 2069 6e20 2754 696d  ead more in 'Tim
+0001c6a0: 654d 6574 7269 6327 0a20 2020 2020 2020  eMetric'.       
+0001c6b0: 203a 7061 7261 6d20 7374 6172 743a 2054   :param start: T
+0001c6c0: 6865 2073 7461 7274 2074 696d 6520 6f66  he start time of
+0001c6d0: 2074 6865 206d 6574 7269 6373 2e20 4361   the metrics. Ca
+0001c6e0: 6e20 6265 2072 6570 7265 7365 6e74 6564  n be represented
+0001c6f0: 2062 7920 6120 7374 7269 6e67 2063 6f6e   by a string con
+0001c700: 7461 696e 696e 6720 616e 2052 4643 2033  taining an RFC 3
+0001c710: 3333 390a 2020 2020 2020 2020 2020 2020  339.            
+0001c720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c730: 2020 2020 2074 696d 652c 2061 2055 6e69       time, a Uni
+0001c740: 7820 7469 6d65 7374 616d 7020 696e 206d  x timestamp in m
+0001c750: 696c 6c69 7365 636f 6e64 732c 2061 2072  illiseconds, a r
+0001c760: 656c 6174 6976 6520 7469 6d65 2028 6027  elative time (`'
+0001c770: 6e6f 7727 6020 6f72 0a20 2020 2020 2020  now'` or.       
 0001c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c790: 6461 7973 292c 206f 7220 3020 666f 7220  days), or 0 for 
-0001c7a0: 7468 6520 6561 726c 6965 7374 2074 696d  the earliest tim
-0001c7b0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-0001c7c0: 6d20 746f 705f 6c65 7665 6c3a 2069 6620  m top_level: if 
-0001c7d0: 7472 7565 2077 696c 6c20 7265 7475 726e  true will return
-0001c7e0: 206f 6e6c 7920 726f 7574 6572 7320 616e   only routers an
-0001c7f0: 6420 656e 6470 6f69 6e74 2074 6861 7420  d endpoint that 
-0001c800: 6172 6520 4e4f 5420 6368 696c 6472 656e  are NOT children
-0001c810: 206f 6620 616e 7920 726f 7574 6572 0a20   of any router. 
-0001c820: 2020 2020 2020 203a 7061 7261 6d20 7569         :param ui
-0001c830: 6473 3a20 6966 2070 6173 7365 6420 7769  ds: if passed wi
-0001c840: 6c6c 2072 6574 7572 6e20 6120 6c69 7374  ll return a list
-0001c850: 2060 4d6f 6465 6c45 6e64 706f 696e 7460   `ModelEndpoint`
-0001c860: 206f 626a 6563 7420 7769 7468 2075 6964   object with uid
-0001c870: 2069 6e20 7569 6473 0a20 2020 2020 2020   in uids.       
-0001c880: 2022 2222 0a0a 2020 2020 2020 2020 7061   """..        pa
-0001c890: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-0001c8a0: 7b70 726f 6a65 6374 7d2f 6d6f 6465 6c2d  {project}/model-
-0001c8b0: 656e 6470 6f69 6e74 7322 0a0a 2020 2020  endpoints"..    
-0001c8c0: 2020 2020 6966 206c 6162 656c 7320 616e      if labels an
-0001c8d0: 6420 6973 696e 7374 616e 6365 286c 6162  d isinstance(lab
-0001c8e0: 656c 732c 2064 6963 7429 3a0a 2020 2020  els, dict):.    
-0001c8f0: 2020 2020 2020 2020 6c61 6265 6c73 203d          labels =
-0001c900: 205b 6622 7b6b 6579 7d3d 7b76 616c 7565   [f"{key}={value
-0001c910: 7d22 2066 6f72 206b 6579 2c20 7661 6c75  }" for key, valu
-0001c920: 6520 696e 206c 6162 656c 732e 6974 656d  e in labels.item
-0001c930: 7328 295d 0a0a 2020 2020 2020 2020 7265  s()]..        re
-0001c940: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
-0001c950: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
-0001c960: 2020 2020 6d65 7468 6f64 3d22 4745 5422      method="GET"
-0001c970: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-0001c980: 7468 3d70 6174 682c 0a20 2020 2020 2020  th=path,.       
-0001c990: 2020 2020 2070 6172 616d 733d 7b0a 2020       params={.  
-0001c9a0: 2020 2020 2020 2020 2020 2020 2020 226d                "m
-0001c9b0: 6f64 656c 223a 206d 6f64 656c 2c0a 2020  odel": model,.  
-0001c9c0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-0001c9d0: 756e 6374 696f 6e22 3a20 6675 6e63 7469  unction": functi
-0001c9e0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-0001c9f0: 2020 2020 226c 6162 656c 223a 206c 6162      "label": lab
-0001ca00: 656c 7320 6f72 205b 5d2c 0a20 2020 2020  els or [],.     
-0001ca10: 2020 2020 2020 2020 2020 2022 7374 6172             "star
-0001ca20: 7422 3a20 7374 6172 742c 0a20 2020 2020  t": start,.     
-0001ca30: 2020 2020 2020 2020 2020 2022 656e 6422             "end"
-0001ca40: 3a20 656e 642c 0a20 2020 2020 2020 2020  : end,.         
-0001ca50: 2020 2020 2020 2022 6d65 7472 6963 223a         "metric":
-0001ca60: 206d 6574 7269 6373 206f 7220 5b5d 2c0a   metrics or [],.
-0001ca70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca80: 2274 6f70 2d6c 6576 656c 223a 2074 6f70  "top-level": top
-0001ca90: 5f6c 6576 656c 2c0a 2020 2020 2020 2020  _level,.        
-0001caa0: 2020 2020 2020 2020 2275 6964 223a 2075          "uid": u
-0001cab0: 6964 732c 0a20 2020 2020 2020 2020 2020  ids,.           
-0001cac0: 207d 2c0a 2020 2020 2020 2020 290a 0a20   },.        ).. 
-0001cad0: 2020 2020 2020 2023 2047 656e 6572 6174         # Generat
-0001cae0: 6520 6120 6c69 7374 206f 6620 6120 6d6f  e a list of a mo
-0001caf0: 6465 6c20 656e 6470 6f69 6e74 2064 6963  del endpoint dic
-0001cb00: 7469 6f6e 6172 6965 730a 2020 2020 2020  tionaries.      
-0001cb10: 2020 6d6f 6465 6c5f 656e 6470 6f69 6e74    model_endpoint
-0001cb20: 7320 3d20 7265 7370 6f6e 7365 2e6a 736f  s = response.jso
-0001cb30: 6e28 295b 2265 6e64 706f 696e 7473 225d  n()["endpoints"]
-0001cb40: 0a20 2020 2020 2020 2069 6620 6d6f 6465  .        if mode
-0001cb50: 6c5f 656e 6470 6f69 6e74 733a 0a20 2020  l_endpoints:.   
-0001cb60: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001cb70: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0001cb80: 2020 6d6c 7275 6e2e 6d6f 6465 6c5f 6d6f    mlrun.model_mo
-0001cb90: 6e69 746f 7269 6e67 2e6d 6f64 656c 5f65  nitoring.model_e
-0001cba0: 6e64 706f 696e 742e 4d6f 6465 6c45 6e64  ndpoint.ModelEnd
-0001cbb0: 706f 696e 742e 6672 6f6d 5f64 6963 7428  point.from_dict(
-0001cbc0: 6f62 6a29 0a20 2020 2020 2020 2020 2020  obj).           
-0001cbd0: 2020 2020 2066 6f72 206f 626a 2069 6e20       for obj in 
-0001cbe0: 6d6f 6465 6c5f 656e 6470 6f69 6e74 730a  model_endpoints.
-0001cbf0: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
-0001cc00: 2020 2020 2020 7265 7475 726e 205b 5d0a        return [].
-0001cc10: 0a20 2020 2064 6566 2067 6574 5f6d 6f64  .    def get_mod
-0001cc20: 656c 5f65 6e64 706f 696e 7428 0a20 2020  el_endpoint(.   
-0001cc30: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0001cc40: 2020 2070 726f 6a65 6374 3a20 7374 722c     project: str,
-0001cc50: 0a20 2020 2020 2020 2065 6e64 706f 696e  .        endpoin
-0001cc60: 745f 6964 3a20 7374 722c 0a20 2020 2020  t_id: str,.     
-0001cc70: 2020 2073 7461 7274 3a20 4f70 7469 6f6e     start: Option
-0001cc80: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-0001cc90: 2020 2020 2020 2020 656e 643a 204f 7074          end: Opt
-0001cca0: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-0001ccb0: 652c 0a20 2020 2020 2020 206d 6574 7269  e,.        metri
-0001ccc0: 6373 3a20 4f70 7469 6f6e 616c 5b4c 6973  cs: Optional[Lis
-0001ccd0: 745b 7374 725d 5d20 3d20 4e6f 6e65 2c0a  t[str]] = None,.
-0001cce0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-0001ccf0: 616e 616c 7973 6973 3a20 626f 6f6c 203d  analysis: bool =
-0001cd00: 2046 616c 7365 2c0a 2020 2020 2920 2d3e   False,.    ) ->
-0001cd10: 206d 6c72 756e 2e6d 6f64 656c 5f6d 6f6e   mlrun.model_mon
-0001cd20: 6974 6f72 696e 672e 6d6f 6465 6c5f 656e  itoring.model_en
-0001cd30: 6470 6f69 6e74 2e4d 6f64 656c 456e 6470  dpoint.ModelEndp
-0001cd40: 6f69 6e74 3a0a 2020 2020 2020 2020 2222  oint:.        ""
-0001cd50: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-0001cd60: 7320 6120 7369 6e67 6c65 2060 4d6f 6465  s a single `Mode
-0001cd70: 6c45 6e64 706f 696e 7460 206f 626a 6563  lEndpoint` objec
-0001cd80: 7420 7769 7468 2061 6464 6974 696f 6e61  t with additiona
-0001cd90: 6c20 6d65 7472 6963 7320 616e 6420 6665  l metrics and fe
-0001cda0: 6174 7572 6520 7265 6c61 7465 6420 6461  ature related da
-0001cdb0: 7461 2e0a 0a20 2020 2020 2020 203a 7061  ta...        :pa
-0001cdc0: 7261 6d20 7072 6f6a 6563 743a 2020 2020  ram project:    
-0001cdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cde0: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
-0001cdf0: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
-0001ce00: 3a70 6172 616d 2065 6e64 706f 696e 745f  :param endpoint_
-0001ce10: 6964 3a20 2020 2020 2020 2020 2020 2020  id:             
-0001ce20: 2020 2054 6865 2075 6e69 7175 6520 6964     The unique id
-0001ce30: 206f 6620 7468 6520 6d6f 6465 6c20 656e   of the model en
-0001ce40: 6470 6f69 6e74 2e0a 2020 2020 2020 2020  dpoint..        
-0001ce50: 3a70 6172 616d 2073 7461 7274 3a20 2020  :param start:   
-0001ce60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ce70: 2020 2054 6865 2073 7461 7274 2074 696d     The start tim
-0001ce80: 6520 6f66 2074 6865 206d 6574 7269 6373  e of the metrics
-0001ce90: 2e20 4361 6e20 6265 2072 6570 7265 7365  . Can be represe
-0001cea0: 6e74 6564 2062 7920 6120 7374 7269 6e67  nted by a string
-0001ceb0: 2063 6f6e 7461 696e 696e 6720 616e 0a20   containing an. 
-0001cec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ced0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cee0: 2020 2020 2020 2020 2020 5246 4320 3333            RFC 33
-0001cef0: 3339 2074 696d 652c 2061 2055 6e69 7820  39 time, a Unix 
-0001cf00: 7469 6d65 7374 616d 7020 696e 206d 696c  timestamp in mil
-0001cf10: 6c69 7365 636f 6e64 732c 2061 2072 656c  liseconds, a rel
-0001cf20: 6174 6976 6520 7469 6d65 2028 6027 6e6f  ative time (`'no
-0001cf30: 7727 6020 6f72 0a20 2020 2020 2020 2020  w'` or.         
-0001cf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cf60: 2020 6027 6e6f 772d 5b30 2d39 5d2b 5b6d    `'now-[0-9]+[m
-0001cf70: 6864 5d27 602c 2077 6865 7265 2060 6d60  hd]'`, where `m`
-0001cf80: 203d 206d 696e 7574 6573 2c20 6068 6020   = minutes, `h` 
-0001cf90: 3d20 686f 7572 732c 2061 6e64 2060 2764  = hours, and `'d
-0001cfa0: 2760 203d 2064 6179 7329 2c20 6f72 0a20  '` = days), or. 
+0001c790: 2020 2020 2020 2020 2020 6027 6e6f 772d            `'now-
+0001c7a0: 5b30 2d39 5d2b 5b6d 6864 5d27 602c 2077  [0-9]+[mhd]'`, w
+0001c7b0: 6865 7265 2060 6d60 203d 206d 696e 7574  here `m` = minut
+0001c7c0: 6573 2c20 6068 6020 3d20 686f 7572 732c  es, `h` = hours,
+0001c7d0: 2061 6e64 2060 2764 2760 203d 0a20 2020   and `'d'` =.   
+0001c7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c7f0: 2020 2020 2020 2020 2020 2020 2020 6461                da
+0001c800: 7973 292c 206f 7220 3020 666f 7220 7468  ys), or 0 for th
+0001c810: 6520 6561 726c 6965 7374 2074 696d 652e  e earliest time.
+0001c820: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001c830: 656e 643a 2054 6865 2065 6e64 2074 696d  end: The end tim
+0001c840: 6520 6f66 2074 6865 206d 6574 7269 6373  e of the metrics
+0001c850: 2e20 4361 6e20 6265 2072 6570 7265 7365  . Can be represe
+0001c860: 6e74 6564 2062 7920 6120 7374 7269 6e67  nted by a string
+0001c870: 2063 6f6e 7461 696e 696e 6720 616e 2052   containing an R
+0001c880: 4643 2033 3333 390a 2020 2020 2020 2020  FC 3339.        
+0001c890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c8a0: 2020 2020 2020 2020 2074 696d 652c 2061           time, a
+0001c8b0: 2055 6e69 7820 7469 6d65 7374 616d 7020   Unix timestamp 
+0001c8c0: 696e 206d 696c 6c69 7365 636f 6e64 732c  in milliseconds,
+0001c8d0: 2061 2072 656c 6174 6976 6520 7469 6d65   a relative time
+0001c8e0: 2028 6027 6e6f 7727 6020 6f72 0a20 2020   (`'now'` or.   
+0001c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c900: 2020 2020 2020 2020 2020 2020 2020 6027                `'
+0001c910: 6e6f 772d 5b30 2d39 5d2b 5b6d 6864 5d27  now-[0-9]+[mhd]'
+0001c920: 602c 2077 6865 7265 2060 6d60 203d 206d  `, where `m` = m
+0001c930: 696e 7574 6573 2c20 6068 6020 3d20 686f  inutes, `h` = ho
+0001c940: 7572 732c 2061 6e64 2060 2764 2760 203d  urs, and `'d'` =
+0001c950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c970: 2020 6461 7973 292c 206f 7220 3020 666f    days), or 0 fo
+0001c980: 7220 7468 6520 6561 726c 6965 7374 2074  r the earliest t
+0001c990: 696d 652e 0a20 2020 2020 2020 203a 7061  ime..        :pa
+0001c9a0: 7261 6d20 746f 705f 6c65 7665 6c3a 2069  ram top_level: i
+0001c9b0: 6620 7472 7565 2077 696c 6c20 7265 7475  f true will retu
+0001c9c0: 726e 206f 6e6c 7920 726f 7574 6572 7320  rn only routers 
+0001c9d0: 616e 6420 656e 6470 6f69 6e74 2074 6861  and endpoint tha
+0001c9e0: 7420 6172 6520 4e4f 5420 6368 696c 6472  t are NOT childr
+0001c9f0: 656e 206f 6620 616e 7920 726f 7574 6572  en of any router
+0001ca00: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001ca10: 7569 6473 3a20 6966 2070 6173 7365 6420  uids: if passed 
+0001ca20: 7769 6c6c 2072 6574 7572 6e20 6120 6c69  will return a li
+0001ca30: 7374 2060 4d6f 6465 6c45 6e64 706f 696e  st `ModelEndpoin
+0001ca40: 7460 206f 626a 6563 7420 7769 7468 2075  t` object with u
+0001ca50: 6964 2069 6e20 7569 6473 0a20 2020 2020  id in uids.     
+0001ca60: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+0001ca70: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+0001ca80: 732f 7b70 726f 6a65 6374 7d2f 6d6f 6465  s/{project}/mode
+0001ca90: 6c2d 656e 6470 6f69 6e74 7322 0a0a 2020  l-endpoints"..  
+0001caa0: 2020 2020 2020 6966 206c 6162 656c 7320        if labels 
+0001cab0: 616e 6420 6973 696e 7374 616e 6365 286c  and isinstance(l
+0001cac0: 6162 656c 732c 2064 6963 7429 3a0a 2020  abels, dict):.  
+0001cad0: 2020 2020 2020 2020 2020 6c61 6265 6c73            labels
+0001cae0: 203d 205b 6622 7b6b 6579 7d3d 7b76 616c   = [f"{key}={val
+0001caf0: 7565 7d22 2066 6f72 206b 6579 2c20 7661  ue}" for key, va
+0001cb00: 6c75 6520 696e 206c 6162 656c 732e 6974  lue in labels.it
+0001cb10: 656d 7328 295d 0a0a 2020 2020 2020 2020  ems()]..        
+0001cb20: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
+0001cb30: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
+0001cb40: 2020 2020 2020 6d65 7468 6f64 3d22 4745        method="GE
+0001cb50: 5422 2c0a 2020 2020 2020 2020 2020 2020  T",.            
+0001cb60: 7061 7468 3d70 6174 682c 0a20 2020 2020  path=path,.     
+0001cb70: 2020 2020 2020 2070 6172 616d 733d 7b0a         params={.
+0001cb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb90: 226d 6f64 656c 223a 206d 6f64 656c 2c0a  "model": model,.
+0001cba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cbb0: 2266 756e 6374 696f 6e22 3a20 6675 6e63  "function": func
+0001cbc0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+0001cbd0: 2020 2020 2020 226c 6162 656c 223a 206c        "label": l
+0001cbe0: 6162 656c 7320 6f72 205b 5d2c 0a20 2020  abels or [],.   
+0001cbf0: 2020 2020 2020 2020 2020 2020 2022 7374               "st
+0001cc00: 6172 7422 3a20 7374 6172 742c 0a20 2020  art": start,.   
+0001cc10: 2020 2020 2020 2020 2020 2020 2022 656e               "en
+0001cc20: 6422 3a20 656e 642c 0a20 2020 2020 2020  d": end,.       
+0001cc30: 2020 2020 2020 2020 2022 6d65 7472 6963           "metric
+0001cc40: 223a 206d 6574 7269 6373 206f 7220 5b5d  ": metrics or []
+0001cc50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001cc60: 2020 2274 6f70 2d6c 6576 656c 223a 2074    "top-level": t
+0001cc70: 6f70 5f6c 6576 656c 2c0a 2020 2020 2020  op_level,.      
+0001cc80: 2020 2020 2020 2020 2020 2275 6964 223a            "uid":
+0001cc90: 2075 6964 732c 0a20 2020 2020 2020 2020   uids,.         
+0001cca0: 2020 207d 2c0a 2020 2020 2020 2020 290a     },.        ).
+0001ccb0: 0a20 2020 2020 2020 2023 2047 656e 6572  .        # Gener
+0001ccc0: 6174 6520 6120 6c69 7374 206f 6620 6120  ate a list of a 
+0001ccd0: 6d6f 6465 6c20 656e 6470 6f69 6e74 2064  model endpoint d
+0001cce0: 6963 7469 6f6e 6172 6965 730a 2020 2020  ictionaries.    
+0001ccf0: 2020 2020 6d6f 6465 6c5f 656e 6470 6f69      model_endpoi
+0001cd00: 6e74 7320 3d20 7265 7370 6f6e 7365 2e6a  nts = response.j
+0001cd10: 736f 6e28 295b 2265 6e64 706f 696e 7473  son()["endpoints
+0001cd20: 225d 0a20 2020 2020 2020 2069 6620 6d6f  "].        if mo
+0001cd30: 6465 6c5f 656e 6470 6f69 6e74 733a 0a20  del_endpoints:. 
+0001cd40: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001cd50: 6e20 5b0a 2020 2020 2020 2020 2020 2020  n [.            
+0001cd60: 2020 2020 6d6c 7275 6e2e 6d6f 6465 6c5f      mlrun.model_
+0001cd70: 6d6f 6e69 746f 7269 6e67 2e6d 6f64 656c  monitoring.model
+0001cd80: 5f65 6e64 706f 696e 742e 4d6f 6465 6c45  _endpoint.ModelE
+0001cd90: 6e64 706f 696e 742e 6672 6f6d 5f64 6963  ndpoint.from_dic
+0001cda0: 7428 6f62 6a29 0a20 2020 2020 2020 2020  t(obj).         
+0001cdb0: 2020 2020 2020 2066 6f72 206f 626a 2069         for obj i
+0001cdc0: 6e20 6d6f 6465 6c5f 656e 6470 6f69 6e74  n model_endpoint
+0001cdd0: 730a 2020 2020 2020 2020 2020 2020 5d0a  s.            ].
+0001cde0: 2020 2020 2020 2020 7265 7475 726e 205b          return [
+0001cdf0: 5d0a 0a20 2020 2064 6566 2067 6574 5f6d  ]..    def get_m
+0001ce00: 6f64 656c 5f65 6e64 706f 696e 7428 0a20  odel_endpoint(. 
+0001ce10: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0001ce20: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
+0001ce30: 722c 0a20 2020 2020 2020 2065 6e64 706f  r,.        endpo
+0001ce40: 696e 745f 6964 3a20 7374 722c 0a20 2020  int_id: str,.   
+0001ce50: 2020 2020 2073 7461 7274 3a20 4f70 7469       start: Opti
+0001ce60: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+0001ce70: 2c0a 2020 2020 2020 2020 656e 643a 204f  ,.        end: O
+0001ce80: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+0001ce90: 6f6e 652c 0a20 2020 2020 2020 206d 6574  one,.        met
+0001cea0: 7269 6373 3a20 4f70 7469 6f6e 616c 5b4c  rics: Optional[L
+0001ceb0: 6973 745b 7374 725d 5d20 3d20 4e6f 6e65  ist[str]] = None
+0001cec0: 2c0a 2020 2020 2020 2020 6665 6174 7572  ,.        featur
+0001ced0: 655f 616e 616c 7973 6973 3a20 626f 6f6c  e_analysis: bool
+0001cee0: 203d 2046 616c 7365 2c0a 2020 2020 2920   = False,.    ) 
+0001cef0: 2d3e 206d 6c72 756e 2e6d 6f64 656c 5f6d  -> mlrun.model_m
+0001cf00: 6f6e 6974 6f72 696e 672e 6d6f 6465 6c5f  onitoring.model_
+0001cf10: 656e 6470 6f69 6e74 2e4d 6f64 656c 456e  endpoint.ModelEn
+0001cf20: 6470 6f69 6e74 3a0a 2020 2020 2020 2020  dpoint:.        
+0001cf30: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
+0001cf40: 726e 7320 6120 7369 6e67 6c65 2060 4d6f  rns a single `Mo
+0001cf50: 6465 6c45 6e64 706f 696e 7460 206f 626a  delEndpoint` obj
+0001cf60: 6563 7420 7769 7468 2061 6464 6974 696f  ect with additio
+0001cf70: 6e61 6c20 6d65 7472 6963 7320 616e 6420  nal metrics and 
+0001cf80: 6665 6174 7572 6520 7265 6c61 7465 6420  feature related 
+0001cf90: 6461 7461 2e0a 0a20 2020 2020 2020 203a  data...        :
+0001cfa0: 7061 7261 6d20 7072 6f6a 6563 743a 2020  param project:  
 0001cfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cfd0: 2020 2020 2020 2020 2020 3020 666f 7220            0 for 
-0001cfe0: 7468 6520 6561 726c 6965 7374 2074 696d  the earliest tim
-0001cff0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-0001d000: 6d20 656e 643a 2020 2020 2020 2020 2020  m end:          
-0001d010: 2020 2020 2020 2020 2020 2020 2020 5468                Th
-0001d020: 6520 656e 6420 7469 6d65 206f 6620 7468  e end time of th
-0001d030: 6520 6d65 7472 6963 732e 2043 616e 2062  e metrics. Can b
-0001d040: 6520 7265 7072 6573 656e 7465 6420 6279  e represented by
-0001d050: 2061 2073 7472 696e 6720 636f 6e74 6169   a string contai
-0001d060: 6e69 6e67 2061 6e0a 2020 2020 2020 2020  ning an.        
-0001d070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d090: 2020 2052 4643 2033 3333 3920 7469 6d65     RFC 3339 time
-0001d0a0: 2c20 6120 556e 6978 2074 696d 6573 7461  , a Unix timesta
-0001d0b0: 6d70 2069 6e20 6d69 6c6c 6973 6563 6f6e  mp in millisecon
-0001d0c0: 6473 2c20 6120 7265 6c61 7469 7665 2074  ds, a relative t
-0001d0d0: 696d 6520 2860 276e 6f77 2760 206f 720a  ime (`'now'` or.
-0001d0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d100: 2020 2020 2020 2020 2020 2060 276e 6f77             `'now
-0001d110: 2d5b 302d 395d 2b5b 6d68 645d 2760 2c20  -[0-9]+[mhd]'`, 
-0001d120: 7768 6572 6520 606d 6020 3d20 6d69 6e75  where `m` = minu
-0001d130: 7465 732c 2060 6860 203d 2068 6f75 7273  tes, `h` = hours
-0001d140: 2c20 616e 6420 6027 6427 6020 3d20 6461  , and `'d'` = da
-0001d150: 7973 292c 206f 720a 2020 2020 2020 2020  ys), or.        
-0001d160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d180: 2020 2030 2066 6f72 2074 6865 2065 6172     0 for the ear
-0001d190: 6c69 6573 7420 7469 6d65 2e0a 2020 2020  liest time..    
-0001d1a0: 2020 2020 3a70 6172 616d 206d 6574 7269      :param metri
-0001d1b0: 6373 3a20 2020 2020 2020 2020 2020 2020  cs:             
-0001d1c0: 2020 2020 2020 2041 206c 6973 7420 6f66         A list of
-0001d1d0: 206d 6574 7269 6373 2074 6f20 7265 7475   metrics to retu
-0001d1e0: 726e 2066 6f72 2074 6865 206d 6f64 656c  rn for the model
-0001d1f0: 2065 6e64 706f 696e 742e 2054 6865 7265   endpoint. There
-0001d200: 2061 7265 2070 7265 2d64 6566 696e 6564   are pre-defined
-0001d210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d230: 2020 2020 2020 2020 2020 2020 6d65 7472              metr
-0001d240: 6963 7320 666f 7220 6d6f 6465 6c20 656e  ics for model en
-0001d250: 6470 6f69 6e74 7320 7375 6368 2061 7320  dpoints such as 
-0001d260: 7072 6564 6963 7469 6f6e 735f 7065 725f  predictions_per_
-0001d270: 7365 636f 6e64 2061 6e64 0a20 2020 2020  second and.     
-0001d280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d2a0: 2020 2020 2020 6c61 7465 6e63 795f 6176        latency_av
-0001d2b0: 675f 356d 2062 7574 2061 6c73 6f20 6375  g_5m but also cu
-0001d2c0: 7374 6f6d 206d 6574 7269 6373 2064 6566  stom metrics def
-0001d2d0: 696e 6564 2062 7920 7468 6520 7573 6572  ined by the user
-0001d2e0: 2e20 506c 6561 7365 206e 6f74 6520 7468  . Please note th
-0001d2f0: 6174 0a20 2020 2020 2020 2020 2020 2020  at.             
-0001d300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d310: 2020 2020 2020 2020 2020 2020 2020 7468                th
-0001d320: 6573 6520 6d65 7472 6963 7320 6172 6520  ese metrics are 
-0001d330: 7374 6f72 6564 2069 6e20 7468 6520 7469  stored in the ti
-0001d340: 6d65 2073 6572 6965 7320 4442 2061 6e64  me series DB and
-0001d350: 2074 6865 2072 6573 756c 7473 2077 696c   the results wil
-0001d360: 6c20 6265 0a20 2020 2020 2020 2020 2020  l be.           
-0001d370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d390: 6170 7065 6172 6564 2075 6e64 6572 206d  appeared under m
-0001d3a0: 6f64 656c 5f65 6e64 706f 696e 742e 7370  odel_endpoint.sp
-0001d3b0: 6563 2e6d 6574 7269 6373 2e0a 2020 2020  ec.metrics..    
-0001d3c0: 2020 2020 3a70 6172 616d 2066 6561 7475      :param featu
-0001d3d0: 7265 5f61 6e61 6c79 7369 733a 2020 2020  re_analysis:    
-0001d3e0: 2020 2020 2020 2057 6865 6e20 5472 7565         When True
-0001d3f0: 2c20 7468 6520 6261 7365 2066 6561 7475  , the base featu
-0001d400: 7265 2073 7461 7469 7374 6963 7320 616e  re statistics an
-0001d410: 6420 6375 7272 656e 7420 6665 6174 7572  d current featur
-0001d420: 6520 7374 6174 6973 7469 6373 2077 696c  e statistics wil
-0001d430: 6c0a 2020 2020 2020 2020 2020 2020 2020  l.              
-0001d440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d450: 2020 2020 2020 2020 2020 2020 2062 6520               be 
-0001d460: 6164 6465 6420 746f 2074 6865 206f 7574  added to the out
-0001d470: 7075 7420 6f66 2074 6865 2072 6573 756c  put of the resul
-0001d480: 7469 6e67 206f 626a 6563 742e 0a0a 2020  ting object...  
-0001d490: 2020 2020 2020 3a72 6574 7572 6e3a 2041        :return: A
-0001d4a0: 2060 4d6f 6465 6c45 6e64 706f 696e 7460   `ModelEndpoint`
-0001d4b0: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
-0001d4c0: 2022 2222 0a0a 2020 2020 2020 2020 7061   """..        pa
-0001d4d0: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-0001d4e0: 7b70 726f 6a65 6374 7d2f 6d6f 6465 6c2d  {project}/model-
-0001d4f0: 656e 6470 6f69 6e74 732f 7b65 6e64 706f  endpoints/{endpo
-0001d500: 696e 745f 6964 7d22 0a20 2020 2020 2020  int_id}".       
-0001d510: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
-0001d520: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
-0001d530: 2020 2020 2020 206d 6574 686f 643d 2247         method="G
-0001d540: 4554 222c 0a20 2020 2020 2020 2020 2020  ET",.           
-0001d550: 2070 6174 683d 7061 7468 2c0a 2020 2020   path=path,.    
-0001d560: 2020 2020 2020 2020 7061 7261 6d73 3d7b          params={
-0001d570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d580: 2022 7374 6172 7422 3a20 7374 6172 742c   "start": start,
-0001d590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d5a0: 2022 656e 6422 3a20 656e 642c 0a20 2020   "end": end,.   
-0001d5b0: 2020 2020 2020 2020 2020 2020 2022 6d65               "me
-0001d5c0: 7472 6963 223a 206d 6574 7269 6373 206f  tric": metrics o
-0001d5d0: 7220 5b5d 2c0a 2020 2020 2020 2020 2020  r [],.          
-0001d5e0: 2020 2020 2020 2266 6561 7475 7265 5f61        "feature_a
-0001d5f0: 6e61 6c79 7369 7322 3a20 6665 6174 7572  nalysis": featur
-0001d600: 655f 616e 616c 7973 6973 2c0a 2020 2020  e_analysis,.    
-0001d610: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-0001d620: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
-0001d630: 7475 726e 206d 6c72 756e 2e6d 6f64 656c  turn mlrun.model
-0001d640: 5f6d 6f6e 6974 6f72 696e 672e 6d6f 6465  _monitoring.mode
-0001d650: 6c5f 656e 6470 6f69 6e74 2e4d 6f64 656c  l_endpoint.Model
-0001d660: 456e 6470 6f69 6e74 2e66 726f 6d5f 6469  Endpoint.from_di
-0001d670: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
-0001d680: 7265 7370 6f6e 7365 2e6a 736f 6e28 290a  response.json().
-0001d690: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-0001d6a0: 6566 2070 6174 6368 5f6d 6f64 656c 5f65  ef patch_model_e
-0001d6b0: 6e64 706f 696e 7428 0a20 2020 2020 2020  ndpoint(.       
-0001d6c0: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
-0001d6d0: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
-0001d6e0: 2020 2020 2065 6e64 706f 696e 745f 6964       endpoint_id
-0001d6f0: 3a20 7374 722c 0a20 2020 2020 2020 2061  : str,.        a
-0001d700: 7474 7269 6275 7465 733a 2064 6963 742c  ttributes: dict,
-0001d710: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0001d720: 2222 220a 2020 2020 2020 2020 5570 6461  """.        Upda
-0001d730: 7465 7320 6d6f 6465 6c20 656e 6470 6f69  tes model endpoi
-0001d740: 6e74 2077 6974 6820 7072 6f76 6964 6564  nt with provided
-0001d750: 2061 7474 7269 6275 7465 732e 0a0a 2020   attributes...  
-0001d760: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
-0001d770: 6a65 6374 3a20 5468 6520 6e61 6d65 206f  ject: The name o
-0001d780: 6620 7468 6520 7072 6f6a 6563 742e 0a20  f the project.. 
-0001d790: 2020 2020 2020 203a 7061 7261 6d20 656e         :param en
-0001d7a0: 6470 6f69 6e74 5f69 643a 2054 6865 2069  dpoint_id: The i
-0001d7b0: 6420 6f66 2074 6865 2065 6e64 706f 696e  d of the endpoin
-0001d7c0: 742e 0a20 2020 2020 2020 203a 7061 7261  t..        :para
-0001d7d0: 6d20 6174 7472 6962 7574 6573 3a20 4469  m attributes: Di
-0001d7e0: 6374 696f 6e61 7279 206f 6620 6174 7472  ctionary of attr
-0001d7f0: 6962 7574 6573 2074 6861 7420 7769 6c6c  ibutes that will
-0001d800: 2062 6520 7573 6564 2066 6f72 2075 7064   be used for upd
-0001d810: 6174 6520 7468 6520 6d6f 6465 6c20 656e  ate the model en
-0001d820: 6470 6f69 6e74 2e20 5468 6520 6b65 7973  dpoint. The keys
-0001d830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d840: 2020 2020 2020 2020 2020 2020 6f66 2074              of t
-0001d850: 6869 7320 6469 6374 696f 6e61 7279 2073  his dictionary s
-0001d860: 686f 756c 6420 6578 6973 7420 696e 2074  hould exist in t
-0001d870: 6865 2074 6172 6765 7420 7461 626c 652e  he target table.
-0001d880: 204e 6f74 6520 7468 6174 2074 6865 2076   Note that the v
-0001d890: 616c 7565 7320 7368 6f75 6c64 2062 650a  alues should be.
-0001d8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d8b0: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
-0001d8c0: 7479 7065 2073 7472 696e 6720 6f72 2066  type string or f
-0001d8d0: 726f 6d20 6120 7661 6c69 6420 6e75 6d65  rom a valid nume
-0001d8e0: 7269 6361 6c20 7479 7065 2073 7563 6820  rical type such 
-0001d8f0: 6173 2069 6e74 206f 7220 666c 6f61 742e  as int or float.
-0001d900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d910: 2020 2020 2020 2020 2020 2020 204d 6f72               Mor
-0001d920: 6520 6465 7461 696c 7320 6162 6f75 7420  e details about 
-0001d930: 7468 6520 6d6f 6465 6c20 656e 6470 6f69  the model endpoi
-0001d940: 6e74 2061 7661 696c 6162 6c65 2061 7474  nt available att
-0001d950: 7269 6275 7465 7320 6361 6e20 6265 2066  ributes can be f
-0001d960: 6f75 6e64 2075 6e64 6572 0a20 2020 2020  ound under.     
-0001d970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d980: 2020 2020 2020 3a70 793a 636c 6173 733a        :py:class:
-0001d990: 607e 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  `~mlrun.common.s
-0001d9a0: 6368 656d 6173 2e4d 6f64 656c 456e 6470  chemas.ModelEndp
-0001d9b0: 6f69 6e74 602e 0a0a 2020 2020 2020 2020  oint`...        
-0001d9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d9d0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-0001d9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d9f0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0001da00: 4765 6e65 7261 7465 2063 7572 7265 6e74  Generate current
-0001da10: 2073 7461 7473 2066 6f72 2074 776f 2066   stats for two f
-0001da20: 6561 7475 7265 730a 2020 2020 2020 2020  eatures.        
-0001da30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da40: 2020 2020 2020 2020 6375 7272 656e 745f          current_
-0001da50: 7374 6174 7320 3d20 7b27 7476 645f 7375  stats = {'tvd_su
-0001da60: 6d27 3a20 322e 322c 0a20 2020 2020 2020  m': 2.2,.       
-0001da70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da90: 2020 2020 2020 2020 2020 2774 7664 5f6d            'tvd_m
-0001daa0: 6561 6e27 3a20 302e 352c 0a20 2020 2020  ean': 0.5,.     
-0001dab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dad0: 2020 2020 2020 2020 2020 2020 2768 656c              'hel
-0001dae0: 6c69 6e67 6572 5f73 756d 273a 2033 2e36  linger_sum': 3.6
-0001daf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001db00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001db10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001db20: 2020 2027 6865 6c6c 696e 6765 725f 6d65     'hellinger_me
-0001db30: 616e 273a 2030 2e39 2c0a 2020 2020 2020  an': 0.9,.      
-0001db40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cfc0: 2020 5468 6520 6e61 6d65 206f 6620 7468    The name of th
+0001cfd0: 6520 7072 6f6a 6563 740a 2020 2020 2020  e project.      
+0001cfe0: 2020 3a70 6172 616d 2065 6e64 706f 696e    :param endpoin
+0001cff0: 745f 6964 3a20 2020 2020 2020 2020 2020  t_id:           
+0001d000: 2020 2020 2054 6865 2075 6e69 7175 6520       The unique 
+0001d010: 6964 206f 6620 7468 6520 6d6f 6465 6c20  id of the model 
+0001d020: 656e 6470 6f69 6e74 2e0a 2020 2020 2020  endpoint..      
+0001d030: 2020 3a70 6172 616d 2073 7461 7274 3a20    :param start: 
+0001d040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d050: 2020 2020 2054 6865 2073 7461 7274 2074       The start t
+0001d060: 696d 6520 6f66 2074 6865 206d 6574 7269  ime of the metri
+0001d070: 6373 2e20 4361 6e20 6265 2072 6570 7265  cs. Can be repre
+0001d080: 7365 6e74 6564 2062 7920 6120 7374 7269  sented by a stri
+0001d090: 6e67 2063 6f6e 7461 696e 696e 6720 616e  ng containing an
+0001d0a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d0c0: 2020 2020 2020 2020 2020 2020 5246 4320              RFC 
+0001d0d0: 3333 3339 2074 696d 652c 2061 2055 6e69  3339 time, a Uni
+0001d0e0: 7820 7469 6d65 7374 616d 7020 696e 206d  x timestamp in m
+0001d0f0: 696c 6c69 7365 636f 6e64 732c 2061 2072  illiseconds, a r
+0001d100: 656c 6174 6976 6520 7469 6d65 2028 6027  elative time (`'
+0001d110: 6e6f 7727 6020 6f72 0a20 2020 2020 2020  now'` or.       
+0001d120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d140: 2020 2020 6027 6e6f 772d 5b30 2d39 5d2b      `'now-[0-9]+
+0001d150: 5b6d 6864 5d27 602c 2077 6865 7265 2060  [mhd]'`, where `
+0001d160: 6d60 203d 206d 696e 7574 6573 2c20 6068  m` = minutes, `h
+0001d170: 6020 3d20 686f 7572 732c 2061 6e64 2060  ` = hours, and `
+0001d180: 2764 2760 203d 2064 6179 7329 2c20 6f72  'd'` = days), or
+0001d190: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d1b0: 2020 2020 2020 2020 2020 2020 3020 666f              0 fo
+0001d1c0: 7220 7468 6520 6561 726c 6965 7374 2074  r the earliest t
+0001d1d0: 696d 652e 0a20 2020 2020 2020 203a 7061  ime..        :pa
+0001d1e0: 7261 6d20 656e 643a 2020 2020 2020 2020  ram end:        
+0001d1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d200: 5468 6520 656e 6420 7469 6d65 206f 6620  The end time of 
+0001d210: 7468 6520 6d65 7472 6963 732e 2043 616e  the metrics. Can
+0001d220: 2062 6520 7265 7072 6573 656e 7465 6420   be represented 
+0001d230: 6279 2061 2073 7472 696e 6720 636f 6e74  by a string cont
+0001d240: 6169 6e69 6e67 2061 6e0a 2020 2020 2020  aining an.      
+0001d250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d270: 2020 2020 2052 4643 2033 3333 3920 7469       RFC 3339 ti
+0001d280: 6d65 2c20 6120 556e 6978 2074 696d 6573  me, a Unix times
+0001d290: 7461 6d70 2069 6e20 6d69 6c6c 6973 6563  tamp in millisec
+0001d2a0: 6f6e 6473 2c20 6120 7265 6c61 7469 7665  onds, a relative
+0001d2b0: 2074 696d 6520 2860 276e 6f77 2760 206f   time (`'now'` o
+0001d2c0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+0001d2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d2e0: 2020 2020 2020 2020 2020 2020 2060 276e               `'n
+0001d2f0: 6f77 2d5b 302d 395d 2b5b 6d68 645d 2760  ow-[0-9]+[mhd]'`
+0001d300: 2c20 7768 6572 6520 606d 6020 3d20 6d69  , where `m` = mi
+0001d310: 6e75 7465 732c 2060 6860 203d 2068 6f75  nutes, `h` = hou
+0001d320: 7273 2c20 616e 6420 6027 6427 6020 3d20  rs, and `'d'` = 
+0001d330: 6461 7973 292c 206f 720a 2020 2020 2020  days), or.      
+0001d340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d360: 2020 2020 2030 2066 6f72 2074 6865 2065       0 for the e
+0001d370: 6172 6c69 6573 7420 7469 6d65 2e0a 2020  arliest time..  
+0001d380: 2020 2020 2020 3a70 6172 616d 206d 6574        :param met
+0001d390: 7269 6373 3a20 2020 2020 2020 2020 2020  rics:           
+0001d3a0: 2020 2020 2020 2020 2041 206c 6973 7420           A list 
+0001d3b0: 6f66 206d 6574 7269 6373 2074 6f20 7265  of metrics to re
+0001d3c0: 7475 726e 2066 6f72 2074 6865 206d 6f64  turn for the mod
+0001d3d0: 656c 2065 6e64 706f 696e 742e 2054 6865  el endpoint. The
+0001d3e0: 7265 2061 7265 2070 7265 2d64 6566 696e  re are pre-defin
+0001d3f0: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
+0001d400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d410: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+0001d420: 7472 6963 7320 666f 7220 6d6f 6465 6c20  trics for model 
+0001d430: 656e 6470 6f69 6e74 7320 7375 6368 2061  endpoints such a
+0001d440: 7320 7072 6564 6963 7469 6f6e 735f 7065  s predictions_pe
+0001d450: 725f 7365 636f 6e64 2061 6e64 0a20 2020  r_second and.   
+0001d460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d480: 2020 2020 2020 2020 6c61 7465 6e63 795f          latency_
+0001d490: 6176 675f 356d 2062 7574 2061 6c73 6f20  avg_5m but also 
+0001d4a0: 6375 7374 6f6d 206d 6574 7269 6373 2064  custom metrics d
+0001d4b0: 6566 696e 6564 2062 7920 7468 6520 7573  efined by the us
+0001d4c0: 6572 2e20 506c 6561 7365 206e 6f74 6520  er. Please note 
+0001d4d0: 7468 6174 0a20 2020 2020 2020 2020 2020  that.           
+0001d4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d500: 7468 6573 6520 6d65 7472 6963 7320 6172  these metrics ar
+0001d510: 6520 7374 6f72 6564 2069 6e20 7468 6520  e stored in the 
+0001d520: 7469 6d65 2073 6572 6965 7320 4442 2061  time series DB a
+0001d530: 6e64 2074 6865 2072 6573 756c 7473 2077  nd the results w
+0001d540: 696c 6c20 6265 0a20 2020 2020 2020 2020  ill be.         
+0001d550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d570: 2020 6170 7065 6172 6564 2075 6e64 6572    appeared under
+0001d580: 206d 6f64 656c 5f65 6e64 706f 696e 742e   model_endpoint.
+0001d590: 7370 6563 2e6d 6574 7269 6373 2e0a 2020  spec.metrics..  
+0001d5a0: 2020 2020 2020 3a70 6172 616d 2066 6561        :param fea
+0001d5b0: 7475 7265 5f61 6e61 6c79 7369 733a 2020  ture_analysis:  
+0001d5c0: 2020 2020 2020 2020 2057 6865 6e20 5472           When Tr
+0001d5d0: 7565 2c20 7468 6520 6261 7365 2066 6561  ue, the base fea
+0001d5e0: 7475 7265 2073 7461 7469 7374 6963 7320  ture statistics 
+0001d5f0: 616e 6420 6375 7272 656e 7420 6665 6174  and current feat
+0001d600: 7572 6520 7374 6174 6973 7469 6373 2077  ure statistics w
+0001d610: 696c 6c0a 2020 2020 2020 2020 2020 2020  ill.            
+0001d620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d630: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0001d640: 6520 6164 6465 6420 746f 2074 6865 206f  e added to the o
+0001d650: 7574 7075 7420 6f66 2074 6865 2072 6573  utput of the res
+0001d660: 756c 7469 6e67 206f 626a 6563 742e 0a0a  ulting object...
+0001d670: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+0001d680: 2041 2060 4d6f 6465 6c45 6e64 706f 696e   A `ModelEndpoin
+0001d690: 7460 206f 626a 6563 742e 0a20 2020 2020  t` object..     
+0001d6a0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+0001d6b0: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+0001d6c0: 732f 7b70 726f 6a65 6374 7d2f 6d6f 6465  s/{project}/mode
+0001d6d0: 6c2d 656e 6470 6f69 6e74 732f 7b65 6e64  l-endpoints/{end
+0001d6e0: 706f 696e 745f 6964 7d22 0a20 2020 2020  point_id}".     
+0001d6f0: 2020 2072 6573 706f 6e73 6520 3d20 7365     response = se
+0001d700: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
+0001d710: 2020 2020 2020 2020 206d 6574 686f 643d           method=
+0001d720: 2247 4554 222c 0a20 2020 2020 2020 2020  "GET",.         
+0001d730: 2020 2070 6174 683d 7061 7468 2c0a 2020     path=path,.  
+0001d740: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+0001d750: 3d7b 0a20 2020 2020 2020 2020 2020 2020  ={.             
+0001d760: 2020 2022 7374 6172 7422 3a20 7374 6172     "start": star
+0001d770: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+0001d780: 2020 2022 656e 6422 3a20 656e 642c 0a20     "end": end,. 
+0001d790: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001d7a0: 6d65 7472 6963 223a 206d 6574 7269 6373  metric": metrics
+0001d7b0: 206f 7220 5b5d 2c0a 2020 2020 2020 2020   or [],.        
+0001d7c0: 2020 2020 2020 2020 2266 6561 7475 7265          "feature
+0001d7d0: 5f61 6e61 6c79 7369 7322 3a20 6665 6174  _analysis": feat
+0001d7e0: 7572 655f 616e 616c 7973 6973 2c0a 2020  ure_analysis,.  
+0001d7f0: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+0001d800: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0001d810: 7265 7475 726e 206d 6c72 756e 2e6d 6f64  return mlrun.mod
+0001d820: 656c 5f6d 6f6e 6974 6f72 696e 672e 6d6f  el_monitoring.mo
+0001d830: 6465 6c5f 656e 6470 6f69 6e74 2e4d 6f64  del_endpoint.Mod
+0001d840: 656c 456e 6470 6f69 6e74 2e66 726f 6d5f  elEndpoint.from_
+0001d850: 6469 6374 280a 2020 2020 2020 2020 2020  dict(.          
+0001d860: 2020 7265 7370 6f6e 7365 2e6a 736f 6e28    response.json(
+0001d870: 290a 2020 2020 2020 2020 290a 0a20 2020  ).        )..   
+0001d880: 2064 6566 2070 6174 6368 5f6d 6f64 656c   def patch_model
+0001d890: 5f65 6e64 706f 696e 7428 0a20 2020 2020  _endpoint(.     
+0001d8a0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0001d8b0: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
+0001d8c0: 2020 2020 2020 2065 6e64 706f 696e 745f         endpoint_
+0001d8d0: 6964 3a20 7374 722c 0a20 2020 2020 2020  id: str,.       
+0001d8e0: 2061 7474 7269 6275 7465 733a 2064 6963   attributes: dic
+0001d8f0: 742c 0a20 2020 2029 3a0a 2020 2020 2020  t,.    ):.      
+0001d900: 2020 2222 220a 2020 2020 2020 2020 5570    """.        Up
+0001d910: 6461 7465 7320 6d6f 6465 6c20 656e 6470  dates model endp
+0001d920: 6f69 6e74 2077 6974 6820 7072 6f76 6964  oint with provid
+0001d930: 6564 2061 7474 7269 6275 7465 732e 0a0a  ed attributes...
+0001d940: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+0001d950: 726f 6a65 6374 3a20 5468 6520 6e61 6d65  roject: The name
+0001d960: 206f 6620 7468 6520 7072 6f6a 6563 742e   of the project.
+0001d970: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001d980: 656e 6470 6f69 6e74 5f69 643a 2054 6865  endpoint_id: The
+0001d990: 2069 6420 6f66 2074 6865 2065 6e64 706f   id of the endpo
+0001d9a0: 696e 742e 0a20 2020 2020 2020 203a 7061  int..        :pa
+0001d9b0: 7261 6d20 6174 7472 6962 7574 6573 3a20  ram attributes: 
+0001d9c0: 4469 6374 696f 6e61 7279 206f 6620 6174  Dictionary of at
+0001d9d0: 7472 6962 7574 6573 2074 6861 7420 7769  tributes that wi
+0001d9e0: 6c6c 2062 6520 7573 6564 2066 6f72 2075  ll be used for u
+0001d9f0: 7064 6174 6520 7468 6520 6d6f 6465 6c20  pdate the model 
+0001da00: 656e 6470 6f69 6e74 2e20 5468 6520 6b65  endpoint. The ke
+0001da10: 7973 0a20 2020 2020 2020 2020 2020 2020  ys.             
+0001da20: 2020 2020 2020 2020 2020 2020 2020 6f66                of
+0001da30: 2074 6869 7320 6469 6374 696f 6e61 7279   this dictionary
+0001da40: 2073 686f 756c 6420 6578 6973 7420 696e   should exist in
+0001da50: 2074 6865 2074 6172 6765 7420 7461 626c   the target tabl
+0001da60: 652e 204e 6f74 6520 7468 6174 2074 6865  e. Note that the
+0001da70: 2076 616c 7565 7320 7368 6f75 6c64 2062   values should b
+0001da80: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0001da90: 2020 2020 2020 2020 2020 2020 2066 726f               fro
+0001daa0: 6d20 7479 7065 2073 7472 696e 6720 6f72  m type string or
+0001dab0: 2066 726f 6d20 6120 7661 6c69 6420 6e75   from a valid nu
+0001dac0: 6d65 7269 6361 6c20 7479 7065 2073 7563  merical type suc
+0001dad0: 6820 6173 2069 6e74 206f 7220 666c 6f61  h as int or floa
+0001dae0: 742e 0a20 2020 2020 2020 2020 2020 2020  t..             
+0001daf0: 2020 2020 2020 2020 2020 2020 2020 204d                 M
+0001db00: 6f72 6520 6465 7461 696c 7320 6162 6f75  ore details abou
+0001db10: 7420 7468 6520 6d6f 6465 6c20 656e 6470  t the model endp
+0001db20: 6f69 6e74 2061 7661 696c 6162 6c65 2061  oint available a
+0001db30: 7474 7269 6275 7465 7320 6361 6e20 6265  ttributes can be
+0001db40: 2066 6f75 6e64 2075 6e64 6572 0a20 2020   found under.   
 0001db50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001db60: 2020 2020 2020 2020 2020 2027 6b6c 645f             'kld_
-0001db70: 7375 6d27 3a20 3234 2e32 2c0a 2020 2020  sum': 24.2,.    
-0001db80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001db90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dba0: 2020 2020 2020 2020 2020 2020 2027 6b6c               'kl
-0001dbb0: 645f 6d65 616e 273a 2036 2e30 2c0a 2020  d_mean': 6.0,.  
+0001db60: 2020 2020 2020 2020 3a70 793a 636c 6173          :py:clas
+0001db70: 733a 607e 6d6c 7275 6e2e 636f 6d6d 6f6e  s:`~mlrun.common
+0001db80: 2e73 6368 656d 6173 2e4d 6f64 656c 456e  .schemas.ModelEn
+0001db90: 6470 6f69 6e74 602e 0a0a 2020 2020 2020  dpoint`...      
+0001dba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dbb0: 2020 2020 2045 7861 6d70 6c65 3a3a 0a0a       Example::..
 0001dbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001dbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dbe0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0001dbf0: 6631 273a 207b 2774 7664 273a 2030 2e35  f1': {'tvd': 0.5
-0001dc00: 2c20 2768 656c 6c69 6e67 6572 273a 2031  , 'hellinger': 1
-0001dc10: 2e30 2c20 276b 6c64 273a 2036 2e34 7d2c  .0, 'kld': 6.4},
-0001dc20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001dc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc50: 2020 2766 3227 3a20 7b27 7476 6427 3a20    'f2': {'tvd': 
-0001dc60: 302e 352c 2027 6865 6c6c 696e 6765 7227  0.5, 'hellinger'
-0001dc70: 3a20 312e 302c 2027 6b6c 6427 3a20 362e  : 1.0, 'kld': 6.
-0001dc80: 357d 7d0a 0a20 2020 2020 2020 2020 2020  5}}..           
+0001dbe0: 2320 4765 6e65 7261 7465 2063 7572 7265  # Generate curre
+0001dbf0: 6e74 2073 7461 7473 2066 6f72 2074 776f  nt stats for two
+0001dc00: 2066 6561 7475 7265 730a 2020 2020 2020   features.      
+0001dc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dc20: 2020 2020 2020 2020 2020 6375 7272 656e            curren
+0001dc30: 745f 7374 6174 7320 3d20 7b27 7476 645f  t_stats = {'tvd_
+0001dc40: 7375 6d27 3a20 322e 322c 0a20 2020 2020  sum': 2.2,.     
+0001dc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dc70: 2020 2020 2020 2020 2020 2020 2774 7664              'tvd
+0001dc80: 5f6d 6561 6e27 3a20 302e 352c 0a20 2020  _mean': 0.5,.   
 0001dc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dca0: 2020 2020 2023 2043 7265 6174 6520 6174       # Create at
-0001dcb0: 7472 6962 7574 6573 2064 6963 7469 6f6e  tributes diction
-0001dcc0: 6172 7920 6163 636f 7264 696e 6720 746f  ary according to
-0001dcd0: 2074 6865 2072 6571 7569 7265 6420 666f   the required fo
-0001dce0: 726d 6174 0a20 2020 2020 2020 2020 2020  rmat.           
+0001dca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dcb0: 2020 2020 2020 2020 2020 2020 2020 2768                'h
+0001dcc0: 656c 6c69 6e67 6572 5f73 756d 273a 2033  ellinger_sum': 3
+0001dcd0: 2e36 2c0a 2020 2020 2020 2020 2020 2020  .6,.            
+0001dce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001dcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dd00: 2020 2020 2061 7474 7269 6275 7465 7320       attributes 
-0001dd10: 3d20 7b60 6375 7272 656e 745f 7374 6174  = {`current_stat
-0001dd20: 7360 3a20 6a73 6f6e 2e64 756d 7073 2863  s`: json.dumps(c
-0001dd30: 7572 7265 6e74 5f73 7461 7473 292c 0a20  urrent_stats),. 
-0001dd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dd60: 2020 2020 2020 2020 2020 2020 2060 6472               `dr
-0001dd70: 6966 745f 7374 6174 7573 603a 2022 4452  ift_status`: "DR
-0001dd80: 4946 545f 4445 5445 4354 4544 227d 0a0a  IFT_DETECTED"}..
-0001dd90: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-0001dda0: 2020 2020 2061 7474 7269 6275 7465 7320       attributes 
-0001ddb0: 3d20 7b22 6174 7472 6962 7574 6573 223a  = {"attributes":
-0001ddc0: 205f 6173 5f6a 736f 6e28 6174 7472 6962   _as_json(attrib
-0001ddd0: 7574 6573 297d 0a20 2020 2020 2020 2070  utes)}.        p
-0001dde0: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
-0001ddf0: 2f7b 7072 6f6a 6563 747d 2f6d 6f64 656c  /{project}/model
-0001de00: 2d65 6e64 706f 696e 7473 2f7b 656e 6470  -endpoints/{endp
-0001de10: 6f69 6e74 5f69 647d 220a 2020 2020 2020  oint_id}".      
-0001de20: 2020 7365 6c66 2e61 7069 5f63 616c 6c28    self.api_call(
-0001de30: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-0001de40: 686f 643d 2250 4154 4348 222c 0a20 2020  hod="PATCH",.   
-0001de50: 2020 2020 2020 2020 2070 6174 683d 7061           path=pa
-0001de60: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
-0001de70: 7061 7261 6d73 3d61 7474 7269 6275 7465  params=attribute
-0001de80: 732c 0a20 2020 2020 2020 2029 0a0a 2020  s,.        )..  
-0001de90: 2020 6465 6620 6372 6561 7465 5f68 7562    def create_hub
-0001dea0: 5f73 6f75 7263 6528 0a20 2020 2020 2020  _source(.       
-0001deb0: 2073 656c 662c 2073 6f75 7263 653a 2055   self, source: U
-0001dec0: 6e69 6f6e 5b64 6963 742c 206d 6c72 756e  nion[dict, mlrun
-0001ded0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-0001dee0: 496e 6465 7865 6448 7562 536f 7572 6365  IndexedHubSource
-0001def0: 5d0a 2020 2020 293a 0a20 2020 2020 2020  ].    ):.       
-0001df00: 2022 2222 0a20 2020 2020 2020 2041 6464   """.        Add
-0001df10: 2061 206e 6577 2068 7562 2073 6f75 7263   a new hub sourc
-0001df20: 652e 0a0a 2020 2020 2020 2020 4d4c 5275  e...        MLRu
-0001df30: 6e20 6d61 696e 7461 696e 7320 616e 206f  n maintains an o
-0001df40: 7264 6572 6564 206c 6973 7420 6f66 2068  rdered list of h
-0001df50: 7562 2073 6f75 7263 6573 2028 e280 9c73  ub sources (...s
-0001df60: 6f75 7263 6573 e280 9d29 2045 6163 6820  ources...) Each 
-0001df70: 736f 7572 6365 2068 6173 0a20 2020 2020  source has.     
-0001df80: 2020 2069 7473 2064 6574 6169 6c73 2072     its details r
-0001df90: 6567 6973 7465 7265 6420 616e 6420 6974  egistered and it
-0001dfa0: 7320 6f72 6465 7220 7769 7468 696e 2074  s order within t
-0001dfb0: 6865 206c 6973 742e 2057 6865 6e20 6372  he list. When cr
-0001dfc0: 6561 7469 6e67 2061 206e 6577 2073 6f75  eating a new sou
-0001dfd0: 7263 652c 2074 6865 2073 7065 6369 616c  rce, the special
-0001dfe0: 206f 7264 6572 2060 602d 3160 600a 2020   order ``-1``.  
-0001dff0: 2020 2020 2020 6361 6e20 6265 2075 7365        can be use
-0001e000: 6420 746f 206d 6172 6b20 7468 6973 2073  d to mark this s
-0001e010: 6f75 7263 6520 6173 206c 6173 7420 696e  ource as last in
-0001e020: 2074 6865 206c 6973 742e 2048 6f77 6576   the list. Howev
-0001e030: 6572 2c20 6f6e 6365 2074 6865 2073 6f75  er, once the sou
-0001e040: 7263 6520 6973 2069 6e20 7468 6520 4d4c  rce is in the ML
-0001e050: 5275 6e20 6c69 7374 2c0a 2020 2020 2020  Run list,.      
-0001e060: 2020 6974 7320 6f72 6465 7220 7769 6c6c    its order will
-0001e070: 2061 6c77 6179 7320 6265 2060 603e 3060   always be ``>0`
-0001e080: 602e 0a0a 2020 2020 2020 2020 5468 6520  `...        The 
-0001e090: 676c 6f62 616c 2068 7562 2073 6f75 7263  global hub sourc
-0001e0a0: 6520 616c 7761 7973 2065 7869 7374 7320  e always exists 
-0001e0b0: 696e 2074 6865 206c 6973 742c 2061 6e64  in the list, and
-0001e0c0: 2069 7320 616c 7761 7973 2074 6865 206c   is always the l
-0001e0d0: 6173 7420 736f 7572 6365 0a20 2020 2020  ast source.     
-0001e0e0: 2020 2028 6060 6f72 6465 7220 3d20 2d31     (``order = -1
-0001e0f0: 6060 292e 2049 7420 6361 6e6e 6f74 2062  ``). It cannot b
-0001e100: 6520 6d6f 6469 6669 6564 206e 6f72 2063  e modified nor c
-0001e110: 616e 2069 7420 6265 206d 6f76 6564 2074  an it be moved t
-0001e120: 6f20 616e 6f74 6865 7220 6f72 6465 7220  o another order 
-0001e130: 696e 2074 6865 206c 6973 742e 0a0a 2020  in the list...  
-0001e140: 2020 2020 2020 5468 6520 736f 7572 6365        The source
-0001e150: 206f 626a 6563 7420 6d61 7920 636f 6e74   object may cont
-0001e160: 6169 6e20 6372 6564 656e 7469 616c 7320  ain credentials 
-0001e170: 7768 6963 6820 6172 6520 6e65 6564 6564  which are needed
-0001e180: 2074 6f20 6163 6365 7373 2074 6865 2064   to access the d
-0001e190: 6174 6173 746f 7265 2077 6865 7265 2074  atastore where t
-0001e1a0: 6865 2073 6f75 7263 6520 6973 2073 746f  he source is sto
-0001e1b0: 7265 642e 0a20 2020 2020 2020 2054 6865  red..        The
-0001e1c0: 7365 2063 7265 6465 6e74 6961 6c73 2061  se credentials a
-0001e1d0: 7265 206e 6f74 206b 6570 7420 696e 2074  re not kept in t
-0001e1e0: 6865 204d 4c52 756e 2044 422c 2062 7574  he MLRun DB, but
-0001e1f0: 2061 7265 2073 746f 7265 6420 696e 7369   are stored insi
-0001e200: 6465 2061 206b 7562 6572 6e65 7465 7320  de a kubernetes 
-0001e210: 7365 6372 6574 206f 626a 6563 7420 6d61  secret object ma
-0001e220: 696e 7461 696e 6564 2062 790a 2020 2020  intained by.    
-0001e230: 2020 2020 4d4c 5275 6e2e 2054 6865 7920      MLRun. They 
-0001e240: 6172 6520 6e6f 7420 7265 7475 726e 6564  are not returned
-0001e250: 2074 6872 6f75 6768 2061 6e79 2041 5049   through any API
-0001e260: 2066 726f 6d20 4d4c 5275 6e2e 0a0a 2020   from MLRun...  
-0001e270: 2020 2020 2020 4578 616d 706c 653a 3a0a        Example::.
-0001e280: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
-0001e290: 6f72 7420 6d6c 7275 6e2e 636f 6d6d 6f6e  ort mlrun.common
-0001e2a0: 2e73 6368 656d 6173 0a0a 2020 2020 2020  .schemas..      
-0001e2b0: 2020 2020 2020 2320 4164 6420 6120 7072        # Add a pr
-0001e2c0: 6976 6174 6520 736f 7572 6365 2061 7320  ivate source as 
-0001e2d0: 7468 6520 6c61 7374 206f 6e65 2028 7769  the last one (wi
-0001e2e0: 6c6c 2062 6520 2331 2069 6e20 7468 6520  ll be #1 in the 
-0001e2f0: 6c69 7374 290a 2020 2020 2020 2020 2020  list).          
-0001e300: 2020 7072 6976 6174 655f 736f 7572 6365    private_source
-0001e310: 203d 206d 6c72 756e 2e63 6f6d 6d6f 6e2e   = mlrun.common.
-0001e320: 7363 6865 6d61 732e 496e 6465 7865 6448  schemas.IndexedH
-0001e330: 7562 6553 6f75 7263 6528 0a20 2020 2020  ubeSource(.     
-0001e340: 2020 2020 2020 2020 2020 206f 7264 6572             order
-0001e350: 3d2d 312c 0a20 2020 2020 2020 2020 2020  =-1,.           
-0001e360: 2020 2020 2073 6f75 7263 653d 6d6c 7275       source=mlru
-0001e370: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0001e380: 2e48 7562 536f 7572 6365 280a 2020 2020  .HubSource(.    
-0001e390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e3a0: 6d65 7461 6461 7461 3d6d 6c72 756e 2e63  metadata=mlrun.c
-0001e3b0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4875  ommon.schemas.Hu
-0001e3c0: 624f 626a 6563 744d 6574 6164 6174 6128  bObjectMetadata(
-0001e3d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e3e0: 2020 2020 2020 2020 206e 616d 653d 2270           name="p
-0001e3f0: 7269 7622 2c20 6465 7363 7269 7074 696f  riv", descriptio
-0001e400: 6e3d 2261 2070 7269 7661 7465 2073 6f75  n="a private sou
-0001e410: 7263 6522 0a20 2020 2020 2020 2020 2020  rce".           
-0001e420: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
-0001e430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e440: 7370 6563 3d6d 6c72 756e 2e63 6f6d 6d6f  spec=mlrun.commo
-0001e450: 6e2e 7363 6865 6d61 732e 4875 6253 6f75  n.schemas.HubSou
-0001e460: 7263 6553 7065 6328 7061 7468 3d22 2f6c  rceSpec(path="/l
-0001e470: 6f63 616c 2f70 6174 682f 746f 2f73 6f75  ocal/path/to/sou
-0001e480: 7263 6522 2c20 6368 616e 6e65 6c3d 2264  rce", channel="d
-0001e490: 6576 656c 6f70 6d65 6e74 2229 0a20 2020  evelopment").   
-0001e4a0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0001e4b0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001e4c0: 2020 2020 2020 2020 2064 622e 6372 6561           db.crea
-0001e4d0: 7465 5f68 7562 5f73 6f75 7263 6528 7072  te_hub_source(pr
-0001e4e0: 6976 6174 655f 736f 7572 6365 290a 0a20  ivate_source).. 
-0001e4f0: 2020 2020 2020 2020 2020 2023 2041 6464             # Add
-0001e500: 2061 6e6f 7468 6572 2073 6f75 7263 6520   another source 
-0001e510: 6173 2031 7374 2069 6e20 7468 6520 6c69  as 1st in the li
-0001e520: 7374 202d 2077 696c 6c20 7075 7368 2070  st - will push p
-0001e530: 7265 7669 6f75 7320 6f6e 6520 746f 2062  revious one to b
-0001e540: 6520 2332 0a20 2020 2020 2020 2020 2020  e #2.           
-0001e550: 2061 6e6f 7468 6572 5f73 6f75 7263 6520   another_source 
-0001e560: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
-0001e570: 6368 656d 6173 2e49 6e64 6578 6564 4875  chemas.IndexedHu
-0001e580: 6253 6f75 7263 6528 0a20 2020 2020 2020  bSource(.       
-0001e590: 2020 2020 2020 2020 206f 7264 6572 3d31           order=1
-0001e5a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001e5b0: 2020 736f 7572 6365 3d6d 6c72 756e 2e63    source=mlrun.c
-0001e5c0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4875  ommon.schemas.Hu
-0001e5d0: 6253 6f75 7263 6528 0a20 2020 2020 2020  bSource(.       
-0001e5e0: 2020 2020 2020 2020 2020 2020 206d 6574               met
-0001e5f0: 6164 6174 613d 6d6c 7275 6e2e 636f 6d6d  adata=mlrun.comm
-0001e600: 6f6e 2e73 6368 656d 6173 2e48 7562 4f62  on.schemas.HubOb
-0001e610: 6a65 6374 4d65 7461 6461 7461 280a 2020  jectMetadata(.  
-0001e620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e630: 2020 2020 2020 6e61 6d65 3d22 7072 6976        name="priv
-0001e640: 2d32 222c 2064 6573 6372 6970 7469 6f6e  -2", description
-0001e650: 3d22 616e 6f74 6865 7220 736f 7572 6365  ="another source
-0001e660: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0001e670: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-0001e680: 2020 2020 2020 2020 2020 2020 2073 7065               spe
-0001e690: 633d 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  c=mlrun.common.s
-0001e6a0: 6368 656d 6173 2e48 7562 536f 7572 6365  chemas.HubSource
-0001e6b0: 5370 6563 280a 2020 2020 2020 2020 2020  Spec(.          
-0001e6c0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-0001e6d0: 7468 3d22 2f6c 6f63 616c 2f70 6174 682f  th="/local/path/
-0001e6e0: 746f 2f73 6f75 7263 652f 3222 2c0a 2020  to/source/2",.  
-0001e6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e700: 2020 2020 2020 6368 616e 6e65 6c3d 2264        channel="d
-0001e710: 6576 656c 6f70 6d65 6e74 222c 0a20 2020  evelopment",.   
-0001e720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e730: 2020 2020 2063 7265 6465 6e74 6961 6c73       credentials
-0001e740: 3d7b 2e2e 2e7d 0a20 2020 2020 2020 2020  ={...}.         
-0001e750: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001e760: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0001e770: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001e780: 2020 2020 2020 2020 2064 622e 6372 6561           db.crea
-0001e790: 7465 5f68 7562 5f73 6f75 7263 6528 616e  te_hub_source(an
-0001e7a0: 6f74 6865 725f 736f 7572 6365 290a 0a20  other_source).. 
-0001e7b0: 2020 2020 2020 203a 7061 7261 6d20 736f         :param so
-0001e7c0: 7572 6365 3a20 5468 6520 736f 7572 6365  urce: The source
-0001e7d0: 2061 6e64 2069 7473 206f 7264 6572 2c20   and its order, 
-0001e7e0: 6f66 2074 7970 650a 2020 2020 2020 2020  of type.        
-0001e7f0: 2020 2020 3a70 793a 636c 6173 733a 607e      :py:class:`~
-0001e800: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0001e810: 656d 6173 2e68 7562 2e49 6e64 6578 6564  emas.hub.Indexed
-0001e820: 4875 6253 6f75 7263 6560 2c20 6f72 2069  HubSource`, or i
-0001e830: 6e20 6469 6374 696f 6e61 7279 2066 6f72  n dictionary for
-0001e840: 6d2e 0a20 2020 2020 2020 203a 7265 7475  m..        :retu
-0001e850: 726e 733a 2054 6865 2073 6f75 7263 6520  rns: The source 
-0001e860: 6f62 6a65 6374 2061 7320 696e 7365 7274  object as insert
-0001e870: 6564 2069 6e74 6f20 7468 6520 6461 7461  ed into the data
-0001e880: 6261 7365 2c20 7769 7468 2063 7265 6465  base, with crede
-0001e890: 6e74 6961 6c73 2073 7472 6970 7065 642e  ntials stripped.
-0001e8a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001e8b0: 2020 2020 2070 6174 6820 3d20 2268 7562       path = "hub
-0001e8c0: 2f73 6f75 7263 6573 220a 2020 2020 2020  /sources".      
-0001e8d0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0001e8e0: 736f 7572 6365 2c20 6d6c 7275 6e2e 636f  source, mlrun.co
-0001e8f0: 6d6d 6f6e 2e73 6368 656d 6173 2e49 6e64  mmon.schemas.Ind
-0001e900: 6578 6564 4875 6253 6f75 7263 6529 3a0a  exedHubSource):.
-0001e910: 2020 2020 2020 2020 2020 2020 736f 7572              sour
-0001e920: 6365 203d 2073 6f75 7263 652e 6469 6374  ce = source.dict
-0001e930: 2829 0a20 2020 2020 2020 2072 6573 706f  ().        respo
-0001e940: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
-0001e950: 616c 6c28 6d65 7468 6f64 3d22 504f 5354  all(method="POST
-0001e960: 222c 2070 6174 683d 7061 7468 2c20 6a73  ", path=path, js
-0001e970: 6f6e 3d73 6f75 7263 6529 0a20 2020 2020  on=source).     
-0001e980: 2020 2072 6574 7572 6e20 6d6c 7275 6e2e     return mlrun.
+0001dd00: 2020 2020 2027 6865 6c6c 696e 6765 725f       'hellinger_
+0001dd10: 6d65 616e 273a 2030 2e39 2c0a 2020 2020  mean': 0.9,.    
+0001dd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dd40: 2020 2020 2020 2020 2020 2020 2027 6b6c               'kl
+0001dd50: 645f 7375 6d27 3a20 3234 2e32 2c0a 2020  d_sum': 24.2,.  
+0001dd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dd80: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0001dd90: 6b6c 645f 6d65 616e 273a 2036 2e30 2c0a  kld_mean': 6.0,.
+0001dda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ddb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ddc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ddd0: 2027 6631 273a 207b 2774 7664 273a 2030   'f1': {'tvd': 0
+0001dde0: 2e35 2c20 2768 656c 6c69 6e67 6572 273a  .5, 'hellinger':
+0001ddf0: 2031 2e30 2c20 276b 6c64 273a 2036 2e34   1.0, 'kld': 6.4
+0001de00: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+0001de10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001de20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001de30: 2020 2020 2766 3227 3a20 7b27 7476 6427      'f2': {'tvd'
+0001de40: 3a20 302e 352c 2027 6865 6c6c 696e 6765  : 0.5, 'hellinge
+0001de50: 7227 3a20 312e 302c 2027 6b6c 6427 3a20  r': 1.0, 'kld': 
+0001de60: 362e 357d 7d0a 0a20 2020 2020 2020 2020  6.5}}..         
+0001de70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001de80: 2020 2020 2020 2023 2043 7265 6174 6520         # Create 
+0001de90: 6174 7472 6962 7574 6573 2064 6963 7469  attributes dicti
+0001dea0: 6f6e 6172 7920 6163 636f 7264 696e 6720  onary according 
+0001deb0: 746f 2074 6865 2072 6571 7569 7265 6420  to the required 
+0001dec0: 666f 726d 6174 0a20 2020 2020 2020 2020  format.         
+0001ded0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dee0: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
+0001def0: 7320 3d20 7b60 6375 7272 656e 745f 7374  s = {`current_st
+0001df00: 6174 7360 3a20 6a73 6f6e 2e64 756d 7073  ats`: json.dumps
+0001df10: 2863 7572 7265 6e74 5f73 7461 7473 292c  (current_stats),
+0001df20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001df30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001df40: 2020 2020 2020 2020 2020 2020 2020 2060                 `
+0001df50: 6472 6966 745f 7374 6174 7573 603a 2022  drift_status`: "
+0001df60: 4452 4946 545f 4445 5445 4354 4544 227d  DRIFT_DETECTED"}
+0001df70: 0a0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+0001df80: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
+0001df90: 7320 3d20 7b22 6174 7472 6962 7574 6573  s = {"attributes
+0001dfa0: 223a 205f 6173 5f6a 736f 6e28 6174 7472  ": _as_json(attr
+0001dfb0: 6962 7574 6573 297d 0a20 2020 2020 2020  ibutes)}.       
+0001dfc0: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
+0001dfd0: 7473 2f7b 7072 6f6a 6563 747d 2f6d 6f64  ts/{project}/mod
+0001dfe0: 656c 2d65 6e64 706f 696e 7473 2f7b 656e  el-endpoints/{en
+0001dff0: 6470 6f69 6e74 5f69 647d 220a 2020 2020  dpoint_id}".    
+0001e000: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
+0001e010: 6c28 0a20 2020 2020 2020 2020 2020 206d  l(.            m
+0001e020: 6574 686f 643d 2250 4154 4348 222c 0a20  ethod="PATCH",. 
+0001e030: 2020 2020 2020 2020 2020 2070 6174 683d             path=
+0001e040: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
+0001e050: 2020 7061 7261 6d73 3d61 7474 7269 6275    params=attribu
+0001e060: 7465 732c 0a20 2020 2020 2020 2029 0a0a  tes,.        )..
+0001e070: 2020 2020 6465 6620 6465 706c 6f79 5f6d      def deploy_m
+0001e080: 6f6e 6974 6f72 696e 675f 6261 7463 685f  onitoring_batch_
+0001e090: 6a6f 6228 0a20 2020 2020 2020 2073 656c  job(.        sel
+0001e0a0: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
+0001e0b0: 6374 3a20 7374 7220 3d20 2222 2c0a 2020  ct: str = "",.  
+0001e0c0: 2020 2020 2020 6465 6661 756c 745f 6261        default_ba
+0001e0d0: 7463 685f 696d 6167 653a 2073 7472 203d  tch_image: str =
+0001e0e0: 2022 6d6c 7275 6e2f 6d6c 7275 6e22 2c0a   "mlrun/mlrun",.
+0001e0f0: 2020 2020 2020 2020 7769 7468 5f73 6368          with_sch
+0001e100: 6564 756c 653a 2062 6f6f 6c20 3d20 4661  edule: bool = Fa
+0001e110: 6c73 652c 0a20 2020 2029 3a0a 2020 2020  lse,.    ):.    
+0001e120: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001e130: 5375 626d 6974 206d 6f64 656c 206d 6f6e  Submit model mon
+0001e140: 6974 6f72 696e 6720 6261 7463 6820 6a6f  itoring batch jo
+0001e150: 622e 2042 7920 6465 6661 756c 742c 2073  b. By default, s
+0001e160: 7562 6d69 7420 6f6e 6c79 2074 6865 2062  ubmit only the b
+0001e170: 6174 6368 206a 6f62 2061 7320 4d4c 2066  atch job as ML f
+0001e180: 756e 6374 696f 6e20 7769 7468 6f75 7420  unction without 
+0001e190: 7363 6865 6475 6c69 6e67 2e0a 2020 2020  scheduling..    
+0001e1a0: 2020 2020 546f 2073 7562 6d69 7420 6120      To submit a 
+0001e1b0: 7363 6865 6475 6c65 6420 6a6f 6220 6173  scheduled job as
+0001e1c0: 2077 656c 6c2c 2070 6c65 6173 6520 7365   well, please se
+0001e1d0: 7420 7769 7468 5f73 6368 6564 756c 6520  t with_schedule 
+0001e1e0: 3d20 5472 7565 2e0a 0a20 2020 2020 2020  = True...       
+0001e1f0: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
+0001e200: 2020 2020 2020 2020 2020 2020 2050 726f               Pro
+0001e210: 6a65 6374 206e 616d 652e 0a20 2020 2020  ject name..     
+0001e220: 2020 203a 7061 7261 6d20 6465 6661 756c     :param defaul
+0001e230: 745f 6261 7463 685f 696d 6167 653a 2054  t_batch_image: T
+0001e240: 6865 2064 6566 6175 6c74 2069 6d61 6765  he default image
+0001e250: 206f 6620 7468 6520 6d6f 6465 6c20 6d6f   of the model mo
+0001e260: 6e69 746f 7269 6e67 2062 6174 6368 206a  nitoring batch j
+0001e270: 6f62 2e20 4279 2064 6566 6175 6c74 2c20  ob. By default, 
+0001e280: 7468 6520 696d 6167 650a 2020 2020 2020  the image.      
+0001e290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e2a0: 2020 2020 2020 2020 2020 2020 2020 6973                is
+0001e2b0: 206d 6c72 756e 2f6d 6c72 756e 2e0a 2020   mlrun/mlrun..  
+0001e2c0: 2020 2020 2020 3a70 6172 616d 2077 6974        :param wit
+0001e2d0: 685f 7363 6865 6475 6c65 3a20 2020 2020  h_schedule:     
+0001e2e0: 2020 4966 2074 7275 652c 2073 7562 6d69    If true, submi
+0001e2f0: 7420 7468 6520 6d6f 6465 6c20 6d6f 6e69  t the model moni
+0001e300: 746f 7269 6e67 2073 6368 6564 756c 6564  toring scheduled
+0001e310: 206a 6f62 2061 7320 7765 6c6c 2e0a 0a0a   job as well....
+0001e320: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+0001e330: 206d 6f64 656c 206d 6f6e 6974 6f72 696e   model monitorin
+0001e340: 6720 6261 7463 6820 6a6f 6220 6173 2061  g batch job as a
+0001e350: 2064 6963 7469 6f6e 6172 792e 2059 6f75   dictionary. You
+0001e360: 2063 616e 2065 6173 696c 7920 636f 6e76   can easily conv
+0001e370: 6572 7420 7468 6520 7265 7375 6c74 6564  ert the resulted
+0001e380: 2066 756e 6374 696f 6e20 696e 746f 2061   function into a
+0001e390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e3a0: 2020 7275 6e74 696d 6520 6f62 6a65 6374    runtime object
+0001e3b0: 2062 7920 6361 6c6c 696e 6720 7e6d 6c72   by calling ~mlr
+0001e3c0: 756e 2e6e 6577 5f66 756e 6374 696f 6e2e  un.new_function.
+0001e3d0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+0001e3e0: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
+0001e3f0: 0a20 2020 2020 2020 2020 2020 2022 6465  .            "de
+0001e400: 6661 756c 745f 6261 7463 685f 696d 6167  fault_batch_imag
+0001e410: 6522 3a20 6465 6661 756c 745f 6261 7463  e": default_batc
+0001e420: 685f 696d 6167 652c 0a20 2020 2020 2020  h_image,.       
+0001e430: 2020 2020 2022 7769 7468 5f73 6368 6564       "with_sched
+0001e440: 756c 6522 3a20 7769 7468 5f73 6368 6564  ule": with_sched
+0001e450: 756c 652c 0a20 2020 2020 2020 207d 0a20  ule,.        }. 
+0001e460: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+0001e470: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+0001e480: 747d 2f6a 6f62 732f 6261 7463 682d 6d6f  t}/jobs/batch-mo
+0001e490: 6e69 746f 7269 6e67 220a 0a20 2020 2020  nitoring"..     
+0001e4a0: 2020 2072 6573 7020 3d20 7365 6c66 2e61     resp = self.a
+0001e4b0: 7069 5f63 616c 6c28 6d65 7468 6f64 3d22  pi_call(method="
+0001e4c0: 504f 5354 222c 2070 6174 683d 7061 7468  POST", path=path
+0001e4d0: 2c20 7061 7261 6d73 3d70 6172 616d 7329  , params=params)
+0001e4e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001e4f0: 7265 7370 2e6a 736f 6e28 295b 2266 756e  resp.json()["fun
+0001e500: 6322 5d0a 0a20 2020 2064 6566 2063 7265  c"]..    def cre
+0001e510: 6174 655f 6875 625f 736f 7572 6365 280a  ate_hub_source(.
+0001e520: 2020 2020 2020 2020 7365 6c66 2c20 736f          self, so
+0001e530: 7572 6365 3a20 556e 696f 6e5b 6469 6374  urce: Union[dict
+0001e540: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
+0001e550: 6368 656d 6173 2e49 6e64 6578 6564 4875  chemas.IndexedHu
+0001e560: 6253 6f75 7263 655d 0a20 2020 2029 3a0a  bSource].    ):.
+0001e570: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001e580: 2020 2020 4164 6420 6120 6e65 7720 6875      Add a new hu
+0001e590: 6220 736f 7572 6365 2e0a 0a20 2020 2020  b source...     
+0001e5a0: 2020 204d 4c52 756e 206d 6169 6e74 6169     MLRun maintai
+0001e5b0: 6e73 2061 6e20 6f72 6465 7265 6420 6c69  ns an ordered li
+0001e5c0: 7374 206f 6620 6875 6220 736f 7572 6365  st of hub source
+0001e5d0: 7320 28e2 809c 736f 7572 6365 73e2 809d  s (...sources...
+0001e5e0: 2920 4561 6368 2073 6f75 7263 6520 6861  ) Each source ha
+0001e5f0: 730a 2020 2020 2020 2020 6974 7320 6465  s.        its de
+0001e600: 7461 696c 7320 7265 6769 7374 6572 6564  tails registered
+0001e610: 2061 6e64 2069 7473 206f 7264 6572 2077   and its order w
+0001e620: 6974 6869 6e20 7468 6520 6c69 7374 2e20  ithin the list. 
+0001e630: 5768 656e 2063 7265 6174 696e 6720 6120  When creating a 
+0001e640: 6e65 7720 736f 7572 6365 2c20 7468 6520  new source, the 
+0001e650: 7370 6563 6961 6c20 6f72 6465 7220 6060  special order ``
+0001e660: 2d31 6060 0a20 2020 2020 2020 2063 616e  -1``.        can
+0001e670: 2062 6520 7573 6564 2074 6f20 6d61 726b   be used to mark
+0001e680: 2074 6869 7320 736f 7572 6365 2061 7320   this source as 
+0001e690: 6c61 7374 2069 6e20 7468 6520 6c69 7374  last in the list
+0001e6a0: 2e20 486f 7765 7665 722c 206f 6e63 6520  . However, once 
+0001e6b0: 7468 6520 736f 7572 6365 2069 7320 696e  the source is in
+0001e6c0: 2074 6865 204d 4c52 756e 206c 6973 742c   the MLRun list,
+0001e6d0: 0a20 2020 2020 2020 2069 7473 206f 7264  .        its ord
+0001e6e0: 6572 2077 696c 6c20 616c 7761 7973 2062  er will always b
+0001e6f0: 6520 6060 3e30 6060 2e0a 0a20 2020 2020  e ``>0``...     
+0001e700: 2020 2054 6865 2067 6c6f 6261 6c20 6875     The global hu
+0001e710: 6220 736f 7572 6365 2061 6c77 6179 7320  b source always 
+0001e720: 6578 6973 7473 2069 6e20 7468 6520 6c69  exists in the li
+0001e730: 7374 2c20 616e 6420 6973 2061 6c77 6179  st, and is alway
+0001e740: 7320 7468 6520 6c61 7374 2073 6f75 7263  s the last sourc
+0001e750: 650a 2020 2020 2020 2020 2860 606f 7264  e.        (``ord
+0001e760: 6572 203d 202d 3160 6029 2e20 4974 2063  er = -1``). It c
+0001e770: 616e 6e6f 7420 6265 206d 6f64 6966 6965  annot be modifie
+0001e780: 6420 6e6f 7220 6361 6e20 6974 2062 6520  d nor can it be 
+0001e790: 6d6f 7665 6420 746f 2061 6e6f 7468 6572  moved to another
+0001e7a0: 206f 7264 6572 2069 6e20 7468 6520 6c69   order in the li
+0001e7b0: 7374 2e0a 0a20 2020 2020 2020 2054 6865  st...        The
+0001e7c0: 2073 6f75 7263 6520 6f62 6a65 6374 206d   source object m
+0001e7d0: 6179 2063 6f6e 7461 696e 2063 7265 6465  ay contain crede
+0001e7e0: 6e74 6961 6c73 2077 6869 6368 2061 7265  ntials which are
+0001e7f0: 206e 6565 6465 6420 746f 2061 6363 6573   needed to acces
+0001e800: 7320 7468 6520 6461 7461 7374 6f72 6520  s the datastore 
+0001e810: 7768 6572 6520 7468 6520 736f 7572 6365  where the source
+0001e820: 2069 7320 7374 6f72 6564 2e0a 2020 2020   is stored..    
+0001e830: 2020 2020 5468 6573 6520 6372 6564 656e      These creden
+0001e840: 7469 616c 7320 6172 6520 6e6f 7420 6b65  tials are not ke
+0001e850: 7074 2069 6e20 7468 6520 4d4c 5275 6e20  pt in the MLRun 
+0001e860: 4442 2c20 6275 7420 6172 6520 7374 6f72  DB, but are stor
+0001e870: 6564 2069 6e73 6964 6520 6120 6b75 6265  ed inside a kube
+0001e880: 726e 6574 6573 2073 6563 7265 7420 6f62  rnetes secret ob
+0001e890: 6a65 6374 206d 6169 6e74 6169 6e65 6420  ject maintained 
+0001e8a0: 6279 0a20 2020 2020 2020 204d 4c52 756e  by.        MLRun
+0001e8b0: 2e20 5468 6579 2061 7265 206e 6f74 2072  . They are not r
+0001e8c0: 6574 7572 6e65 6420 7468 726f 7567 6820  eturned through 
+0001e8d0: 616e 7920 4150 4920 6672 6f6d 204d 4c52  any API from MLR
+0001e8e0: 756e 2e0a 0a20 2020 2020 2020 2045 7861  un...        Exa
+0001e8f0: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+0001e900: 2020 2020 696d 706f 7274 206d 6c72 756e      import mlrun
+0001e910: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 730a  .common.schemas.
+0001e920: 0a20 2020 2020 2020 2020 2020 2023 2041  .            # A
+0001e930: 6464 2061 2070 7269 7661 7465 2073 6f75  dd a private sou
+0001e940: 7263 6520 6173 2074 6865 206c 6173 7420  rce as the last 
+0001e950: 6f6e 6520 2877 696c 6c20 6265 2023 3120  one (will be #1 
+0001e960: 696e 2074 6865 206c 6973 7429 0a20 2020  in the list).   
+0001e970: 2020 2020 2020 2020 2070 7269 7661 7465           private
+0001e980: 5f73 6f75 7263 6520 3d20 6d6c 7275 6e2e  _source = mlrun.
 0001e990: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e49  common.schemas.I
 0001e9a0: 6e64 6578 6564 4875 6253 6f75 7263 6528  ndexedHubSource(
-0001e9b0: 2a2a 7265 7370 6f6e 7365 2e6a 736f 6e28  **response.json(
-0001e9c0: 2929 0a0a 2020 2020 6465 6620 7374 6f72  ))..    def stor
-0001e9d0: 655f 6875 625f 736f 7572 6365 280a 2020  e_hub_source(.  
-0001e9e0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0001e9f0: 2020 2020 736f 7572 6365 5f6e 616d 653a      source_name:
-0001ea00: 2073 7472 2c0a 2020 2020 2020 2020 736f   str,.        so
-0001ea10: 7572 6365 3a20 556e 696f 6e5b 6469 6374  urce: Union[dict
-0001ea20: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
-0001ea30: 6368 656d 6173 2e49 6e64 6578 6564 4875  chemas.IndexedHu
-0001ea40: 6253 6f75 7263 655d 2c0a 2020 2020 293a  bSource],.    ):
-0001ea50: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001ea60: 2020 2020 2043 7265 6174 6520 6f72 2072       Create or r
-0001ea70: 6570 6c61 6365 2061 2068 7562 2073 6f75  eplace a hub sou
-0001ea80: 7263 652e 0a20 2020 2020 2020 2046 6f72  rce..        For
-0001ea90: 2061 6e20 6578 616d 706c 6520 6f66 2074   an example of t
-0001eaa0: 6865 2073 6f75 7263 6520 666f 726d 6174  he source format
-0001eab0: 2061 6e64 2065 7870 6c61 6e61 7469 6f6e   and explanation
-0001eac0: 206f 6620 7468 6520 736f 7572 6365 206f   of the source o
-0001ead0: 7264 6572 206c 6f67 6963 2c0a 2020 2020  rder logic,.    
-0001eae0: 2020 2020 706c 6561 7365 2073 6565 203a      please see :
-0001eaf0: 7079 3a66 756e 633a 607e 6372 6561 7465  py:func:`~create
-0001eb00: 5f68 7562 5f73 6f75 7263 6560 2e20 5468  _hub_source`. Th
-0001eb10: 6973 206d 6574 686f 6420 6361 6e20 6265  is method can be
-0001eb20: 2075 7365 6420 746f 206d 6f64 6966 7920   used to modify 
-0001eb30: 7468 6520 736f 7572 6365 2069 7473 656c  the source itsel
-0001eb40: 6620 6f72 2069 7473 0a20 2020 2020 2020  f or its.       
-0001eb50: 206f 7264 6572 2069 6e20 7468 6520 6c69   order in the li
-0001eb60: 7374 206f 6620 736f 7572 6365 732e 0a0a  st of sources...
-0001eb70: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
-0001eb80: 6f75 7263 655f 6e61 6d65 3a20 4e61 6d65  ource_name: Name
-0001eb90: 206f 6620 7468 6520 736f 7572 6365 206f   of the source o
-0001eba0: 626a 6563 7420 746f 206d 6f64 6966 792f  bject to modify/
-0001ebb0: 6372 6561 7465 2e20 4974 206d 7573 7420  create. It must 
-0001ebc0: 6d61 7463 6820 7468 6520 6060 736f 7572  match the ``sour
-0001ebd0: 6365 2e6d 6574 6164 6174 612e 6e61 6d65  ce.metadata.name
-0001ebe0: 6060 0a20 2020 2020 2020 2020 2020 2070  ``.            p
-0001ebf0: 6172 616d 6574 6572 2069 6e20 7468 6520  arameter in the 
-0001ec00: 736f 7572 6365 2069 7473 656c 662e 0a20  source itself.. 
-0001ec10: 2020 2020 2020 203a 7061 7261 6d20 736f         :param so
-0001ec20: 7572 6365 3a20 536f 7572 6365 206f 626a  urce: Source obj
-0001ec30: 6563 7420 746f 2073 746f 7265 2069 6e20  ect to store in 
-0001ec40: 7468 6520 6461 7461 6261 7365 2e0a 2020  the database..  
-0001ec50: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
-0001ec60: 5468 6520 736f 7572 6365 206f 626a 6563  The source objec
-0001ec70: 7420 6173 2073 746f 7265 6420 696e 2074  t as stored in t
-0001ec80: 6865 2044 422e 0a20 2020 2020 2020 2022  he DB..        "
-0001ec90: 2222 0a20 2020 2020 2020 2070 6174 6820  "".        path 
-0001eca0: 3d20 6622 6875 622f 736f 7572 6365 732f  = f"hub/sources/
-0001ecb0: 7b73 6f75 7263 655f 6e61 6d65 7d22 0a20  {source_name}". 
-0001ecc0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0001ecd0: 616e 6365 2873 6f75 7263 652c 206d 6c72  ance(source, mlr
-0001ece0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0001ecf0: 732e 496e 6465 7865 6448 7562 536f 7572  s.IndexedHubSour
-0001ed00: 6365 293a 0a20 2020 2020 2020 2020 2020  ce):.           
-0001ed10: 2073 6f75 7263 6520 3d20 736f 7572 6365   source = source
-0001ed20: 2e64 6963 7428 290a 0a20 2020 2020 2020  .dict()..       
-0001ed30: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
-0001ed40: 2e61 7069 5f63 616c 6c28 6d65 7468 6f64  .api_call(method
-0001ed50: 3d22 5055 5422 2c20 7061 7468 3d70 6174  ="PUT", path=pat
-0001ed60: 682c 206a 736f 6e3d 736f 7572 6365 290a  h, json=source).
-0001ed70: 2020 2020 2020 2020 7265 7475 726e 206d          return m
-0001ed80: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0001ed90: 6d61 732e 496e 6465 7865 6448 7562 536f  mas.IndexedHubSo
-0001eda0: 7572 6365 282a 2a72 6573 706f 6e73 652e  urce(**response.
-0001edb0: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
-0001edc0: 206c 6973 745f 6875 625f 736f 7572 6365   list_hub_source
-0001edd0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
-0001ede0: 2022 2222 0a20 2020 2020 2020 204c 6973   """.        Lis
-0001edf0: 7420 6875 6220 736f 7572 6365 7320 696e  t hub sources in
-0001ee00: 2074 6865 204d 4c52 756e 2044 422e 0a20   the MLRun DB.. 
-0001ee10: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001ee20: 2020 2070 6174 6820 3d20 2268 7562 2f73     path = "hub/s
-0001ee30: 6f75 7263 6573 220a 2020 2020 2020 2020  ources".        
-0001ee40: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
-0001ee50: 6170 695f 6361 6c6c 286d 6574 686f 643d  api_call(method=
-0001ee60: 2247 4554 222c 2070 6174 683d 7061 7468  "GET", path=path
-0001ee70: 292e 6a73 6f6e 2829 0a20 2020 2020 2020  ).json().       
-0001ee80: 2072 6573 756c 7473 203d 205b 5d0a 2020   results = [].  
-0001ee90: 2020 2020 2020 666f 7220 6974 656d 2069        for item i
-0001eea0: 6e20 7265 7370 6f6e 7365 3a0a 2020 2020  n response:.    
-0001eeb0: 2020 2020 2020 2020 7265 7375 6c74 732e          results.
-0001eec0: 6170 7065 6e64 286d 6c72 756e 2e63 6f6d  append(mlrun.com
-0001eed0: 6d6f 6e2e 7363 6865 6d61 732e 496e 6465  mon.schemas.Inde
-0001eee0: 7865 6448 7562 536f 7572 6365 282a 2a69  xedHubSource(**i
-0001eef0: 7465 6d29 290a 2020 2020 2020 2020 7265  tem)).        re
-0001ef00: 7475 726e 2072 6573 756c 7473 0a0a 2020  turn results..  
-0001ef10: 2020 6465 6620 6765 745f 6875 625f 736f    def get_hub_so
-0001ef20: 7572 6365 2873 656c 662c 2073 6f75 7263  urce(self, sourc
-0001ef30: 655f 6e61 6d65 3a20 7374 7229 3a0a 2020  e_name: str):.  
-0001ef40: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001ef50: 2020 5265 7472 6965 7665 2061 2068 7562    Retrieve a hub
-0001ef60: 2073 6f75 7263 6520 6672 6f6d 2074 6865   source from the
-0001ef70: 2044 422e 0a0a 2020 2020 2020 2020 3a70   DB...        :p
-0001ef80: 6172 616d 2073 6f75 7263 655f 6e61 6d65  aram source_name
-0001ef90: 3a20 4e61 6d65 206f 6620 7468 6520 6875  : Name of the hu
-0001efa0: 6220 736f 7572 6365 2074 6f20 7265 7472  b source to retr
-0001efb0: 6965 7665 2e0a 2020 2020 2020 2020 2222  ieve..        ""
-0001efc0: 220a 2020 2020 2020 2020 7061 7468 203d  ".        path =
-0001efd0: 2066 2268 7562 2f73 6f75 7263 6573 2f7b   f"hub/sources/{
-0001efe0: 736f 7572 6365 5f6e 616d 657d 220a 2020  source_name}".  
-0001eff0: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
-0001f000: 2073 656c 662e 6170 695f 6361 6c6c 286d   self.api_call(m
-0001f010: 6574 686f 643d 2247 4554 222c 2070 6174  ethod="GET", pat
-0001f020: 683d 7061 7468 290a 2020 2020 2020 2020  h=path).        
-0001f030: 7265 7475 726e 206d 6c72 756e 2e63 6f6d  return mlrun.com
-0001f040: 6d6f 6e2e 7363 6865 6d61 732e 496e 6465  mon.schemas.Inde
-0001f050: 7865 6448 7562 536f 7572 6365 282a 2a72  xedHubSource(**r
-0001f060: 6573 706f 6e73 652e 6a73 6f6e 2829 290a  esponse.json()).
-0001f070: 0a20 2020 2064 6566 2064 656c 6574 655f  .    def delete_
-0001f080: 6875 625f 736f 7572 6365 2873 656c 662c  hub_source(self,
-0001f090: 2073 6f75 7263 655f 6e61 6d65 3a20 7374   source_name: st
-0001f0a0: 7229 3a0a 2020 2020 2020 2020 2222 220a  r):.        """.
-0001f0b0: 2020 2020 2020 2020 4465 6c65 7465 2061          Delete a
-0001f0c0: 2068 7562 2073 6f75 7263 6520 6672 6f6d   hub source from
-0001f0d0: 2074 6865 2044 422e 0a20 2020 2020 2020   the DB..       
-0001f0e0: 2054 6865 2073 6f75 7263 6520 7769 6c6c   The source will
-0001f0f0: 2062 6520 6465 6c65 7465 6420 6672 6f6d   be deleted from
-0001f100: 2074 6865 206c 6973 742c 2061 6e64 2061   the list, and a
-0001f110: 6e79 2066 6f6c 6c6f 7769 6e67 2073 6f75  ny following sou
-0001f120: 7263 6573 2077 696c 6c20 6265 2070 726f  rces will be pro
-0001f130: 6d6f 7465 6420 2d20 666f 7220 6578 616d  moted - for exam
-0001f140: 706c 652c 2069 6620 7468 650a 2020 2020  ple, if the.    
-0001f150: 2020 2020 3173 7420 736f 7572 6365 2069      1st source i
-0001f160: 7320 6465 6c65 7465 642c 2074 6865 2032  s deleted, the 2
-0001f170: 6e64 2073 6f75 7263 6520 7769 6c6c 2062  nd source will b
-0001f180: 6563 6f6d 6520 2331 2069 6e20 7468 6520  ecome #1 in the 
-0001f190: 6c69 7374 2e0a 2020 2020 2020 2020 5468  list..        Th
-0001f1a0: 6520 676c 6f62 616c 2068 7562 2073 6f75  e global hub sou
-0001f1b0: 7263 6520 6361 6e6e 6f74 2062 6520 6465  rce cannot be de
-0001f1c0: 6c65 7465 642e 0a0a 2020 2020 2020 2020  leted...        
-0001f1d0: 3a70 6172 616d 2073 6f75 7263 655f 6e61  :param source_na
-0001f1e0: 6d65 3a20 4e61 6d65 206f 6620 7468 6520  me: Name of the 
-0001f1f0: 6875 6220 736f 7572 6365 2074 6f20 6465  hub source to de
-0001f200: 6c65 7465 2e0a 2020 2020 2020 2020 2222  lete..        ""
-0001f210: 220a 2020 2020 2020 2020 7061 7468 203d  ".        path =
-0001f220: 2066 2268 7562 2f73 6f75 7263 6573 2f7b   f"hub/sources/{
-0001f230: 736f 7572 6365 5f6e 616d 657d 220a 2020  source_name}".  
-0001f240: 2020 2020 2020 7365 6c66 2e61 7069 5f63        self.api_c
-0001f250: 616c 6c28 6d65 7468 6f64 3d22 4445 4c45  all(method="DELE
-0001f260: 5445 222c 2070 6174 683d 7061 7468 290a  TE", path=path).
-0001f270: 0a20 2020 2064 6566 2067 6574 5f68 7562  .    def get_hub
-0001f280: 5f63 6174 616c 6f67 280a 2020 2020 2020  _catalog(.      
-0001f290: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0001f2a0: 736f 7572 6365 5f6e 616d 653a 2073 7472  source_name: str
-0001f2b0: 2c0a 2020 2020 2020 2020 7665 7273 696f  ,.        versio
-0001f2c0: 6e3a 2073 7472 203d 204e 6f6e 652c 0a20  n: str = None,. 
-0001f2d0: 2020 2020 2020 2074 6167 3a20 7374 7220         tag: str 
-0001f2e0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0001f2f0: 666f 7263 655f 7265 6672 6573 683a 2062  force_refresh: b
-0001f300: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-0001f310: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
-0001f320: 2020 2020 2020 2020 5265 7472 6965 7665          Retrieve
-0001f330: 2074 6865 2069 7465 6d20 6361 7461 6c6f   the item catalo
-0001f340: 6720 666f 7220 6120 7370 6563 6966 6965  g for a specifie
-0001f350: 6420 6875 6220 736f 7572 6365 2e0a 2020  d hub source..  
-0001f360: 2020 2020 2020 5468 6520 6c69 7374 206f        The list o
-0001f370: 6620 6974 656d 7320 6361 6e20 6265 2066  f items can be f
-0001f380: 696c 7465 7265 6420 6163 636f 7264 696e  iltered accordin
-0001f390: 6720 746f 2076 6172 696f 7573 2066 696c  g to various fil
-0001f3a0: 7465 7273 2c20 7573 696e 6720 6974 656d  ters, using item
-0001f3b0: 2773 206d 6574 6164 6174 6120 746f 2066  's metadata to f
-0001f3c0: 696c 7465 722e 0a0a 2020 2020 2020 2020  ilter...        
-0001f3d0: 3a70 6172 616d 2073 6f75 7263 655f 6e61  :param source_na
-0001f3e0: 6d65 3a20 4e61 6d65 206f 6620 7468 6520  me: Name of the 
-0001f3f0: 736f 7572 6365 2e0a 2020 2020 2020 2020  source..        
-0001f400: 3a70 6172 616d 2076 6572 7369 6f6e 3a20  :param version: 
-0001f410: 4669 6c74 6572 2069 7465 6d73 2061 6363  Filter items acc
-0001f420: 6f72 6469 6e67 2074 6f20 7468 6569 7220  ording to their 
-0001f430: 7665 7273 696f 6e2e 0a20 2020 2020 2020  version..       
-0001f440: 203a 7061 7261 6d20 7461 673a 2046 696c   :param tag: Fil
-0001f450: 7465 7220 6974 656d 7320 6261 7365 6420  ter items based 
-0001f460: 6f6e 2074 6167 2e0a 2020 2020 2020 2020  on tag..        
-0001f470: 3a70 6172 616d 2066 6f72 6365 5f72 6566  :param force_ref
-0001f480: 7265 7368 3a20 4d61 6b65 2074 6865 2073  resh: Make the s
-0001f490: 6572 7665 7220 6665 7463 6820 7468 6520  erver fetch the 
-0001f4a0: 6361 7461 6c6f 6720 6672 6f6d 2074 6865  catalog from the
-0001f4b0: 2061 6374 7561 6c20 6875 6220 736f 7572   actual hub sour
-0001f4c0: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
-0001f4d0: 7261 7468 6572 2074 6861 6e20 7265 6c79  rather than rely
-0001f4e0: 206f 6e20 6361 6368 6564 2069 6e66 6f72   on cached infor
-0001f4f0: 6d61 7469 6f6e 2077 6869 6368 206d 6179  mation which may
-0001f500: 2065 7869 7374 2066 726f 6d20 7072 6576   exist from prev
-0001f510: 696f 7573 2067 6574 2072 6571 7565 7374  ious get request
-0001f520: 732e 2046 6f72 2065 7861 6d70 6c65 2c0a  s. For example,.
-0001f530: 2020 2020 2020 2020 2020 2020 6966 2074              if t
-0001f540: 6865 2073 6f75 7263 6520 7761 7320 7265  he source was re
-0001f550: 2d62 7569 6c74 2c0a 2020 2020 2020 2020  -built,.        
-0001f560: 2020 2020 7468 6973 2077 696c 6c20 6d61      this will ma
-0001f570: 6b65 2074 6865 2073 6572 7665 7220 6765  ke the server ge
-0001f580: 7420 7468 6520 7570 6461 7465 6420 696e  t the updated in
-0001f590: 666f 726d 6174 696f 6e2e 2044 6566 6175  formation. Defau
-0001f5a0: 6c74 2069 7320 6060 4661 6c73 6560 602e  lt is ``False``.
-0001f5b0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-0001f5c0: 733a 203a 7079 3a63 6c61 7373 3a60 7e6d  s: :py:class:`~m
-0001f5d0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0001f5e0: 6d61 732e 6875 622e 4875 6243 6174 616c  mas.hub.HubCatal
-0001f5f0: 6f67 6020 6f62 6a65 6374 2c20 7768 6963  og` object, whic
-0001f600: 6820 6973 2065 7373 656e 7469 616c 6c79  h is essentially
-0001f610: 2061 206c 6973 740a 2020 2020 2020 2020   a list.        
-0001f620: 2020 2020 6f66 203a 7079 3a63 6c61 7373      of :py:class
-0001f630: 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e  :`~mlrun.common.
-0001f640: 7363 6865 6d61 732e 6875 622e 4875 6249  schemas.hub.HubI
-0001f650: 7465 6d60 2065 6e74 7269 6573 2e0a 2020  tem` entries..  
-0001f660: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001f670: 2020 7061 7468 203d 2028 6622 6875 622f    path = (f"hub/
-0001f680: 736f 7572 6365 732f 7b73 6f75 7263 655f  sources/{source_
-0001f690: 6e61 6d65 7d2f 6974 656d 7322 2c29 0a20  name}/items",). 
-0001f6a0: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
-0001f6b0: 7b0a 2020 2020 2020 2020 2020 2020 2276  {.            "v
-0001f6c0: 6572 7369 6f6e 223a 2076 6572 7369 6f6e  ersion": version
-0001f6d0: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-0001f6e0: 6167 223a 2074 6167 2c0a 2020 2020 2020  ag": tag,.      
-0001f6f0: 2020 2020 2020 2266 6f72 6365 2d72 6566        "force-ref
-0001f700: 7265 7368 223a 2066 6f72 6365 5f72 6566  resh": force_ref
-0001f710: 7265 7368 2c0a 2020 2020 2020 2020 7d0a  resh,.        }.
-0001f720: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
-0001f730: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-0001f740: 286d 6574 686f 643d 2247 4554 222c 2070  (method="GET", p
-0001f750: 6174 683d 7061 7468 2c20 7061 7261 6d73  ath=path, params
-0001f760: 3d70 6172 616d 7329 0a20 2020 2020 2020  =params).       
-0001f770: 2072 6574 7572 6e20 6d6c 7275 6e2e 636f   return mlrun.co
-0001f780: 6d6d 6f6e 2e73 6368 656d 6173 2e48 7562  mmon.schemas.Hub
-0001f790: 4361 7461 6c6f 6728 2a2a 7265 7370 6f6e  Catalog(**respon
-0001f7a0: 7365 2e6a 736f 6e28 2929 0a0a 2020 2020  se.json())..    
-0001f7b0: 6465 6620 6765 745f 6875 625f 6974 656d  def get_hub_item
-0001f7c0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0001f7d0: 2020 2020 2020 2020 736f 7572 6365 5f6e          source_n
-0001f7e0: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
-0001f7f0: 2020 6974 656d 5f6e 616d 653a 2073 7472    item_name: str
-0001f800: 2c0a 2020 2020 2020 2020 7665 7273 696f  ,.        versio
-0001f810: 6e3a 2073 7472 203d 204e 6f6e 652c 0a20  n: str = None,. 
-0001f820: 2020 2020 2020 2074 6167 3a20 7374 7220         tag: str 
-0001f830: 3d20 226c 6174 6573 7422 2c0a 2020 2020  = "latest",.    
-0001f840: 2020 2020 666f 7263 655f 7265 6672 6573      force_refres
-0001f850: 683a 2062 6f6f 6c20 3d20 4661 6c73 652c  h: bool = False,
-0001f860: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0001f870: 2222 220a 2020 2020 2020 2020 5265 7472  """.        Retr
-0001f880: 6965 7665 2061 2073 7065 6369 6669 6320  ieve a specific 
-0001f890: 6875 6220 6974 656d 2e0a 0a20 2020 2020  hub item...     
-0001f8a0: 2020 203a 7061 7261 6d20 736f 7572 6365     :param source
-0001f8b0: 5f6e 616d 653a 204e 616d 6520 6f66 2073  _name: Name of s
-0001f8c0: 6f75 7263 652e 0a20 2020 2020 2020 203a  ource..        :
-0001f8d0: 7061 7261 6d20 6974 656d 5f6e 616d 653a  param item_name:
-0001f8e0: 204e 616d 6520 6f66 2074 6865 2069 7465   Name of the ite
-0001f8f0: 6d20 746f 2072 6574 7269 6576 652c 2061  m to retrieve, a
-0001f900: 7320 6974 2061 7070 6561 7273 2069 6e20  s it appears in 
-0001f910: 7468 6520 6361 7461 6c6f 672e 0a20 2020  the catalog..   
-0001f920: 2020 2020 203a 7061 7261 6d20 7665 7273       :param vers
-0001f930: 696f 6e3a 2047 6574 2061 2073 7065 6369  ion: Get a speci
-0001f940: 6669 6320 7665 7273 696f 6e20 6f66 2074  fic version of t
-0001f950: 6865 2069 7465 6d2e 2044 6566 6175 6c74  he item. Default
-0001f960: 2069 7320 6060 4e6f 6e65 6060 2e0a 2020   is ``None``..  
-0001f970: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
-0001f980: 3a20 4765 7420 6120 7370 6563 6966 6963  : Get a specific
-0001f990: 2076 6572 7369 6f6e 206f 6620 7468 6520   version of the 
-0001f9a0: 6974 656d 2069 6465 6e74 6966 6965 6420  item identified 
-0001f9b0: 6279 2074 6167 2e20 4465 6661 756c 7420  by tag. Default 
-0001f9c0: 6973 2060 606c 6174 6573 7460 602e 0a20  is ``latest``.. 
-0001f9d0: 2020 2020 2020 203a 7061 7261 6d20 666f         :param fo
-0001f9e0: 7263 655f 7265 6672 6573 683a 204d 616b  rce_refresh: Mak
-0001f9f0: 6520 7468 6520 7365 7276 6572 2066 6574  e the server fet
-0001fa00: 6368 2074 6865 2069 6e66 6f72 6d61 7469  ch the informati
-0001fa10: 6f6e 2066 726f 6d20 7468 6520 6163 7475  on from the actu
-0001fa20: 616c 2068 7562 0a20 2020 2020 2020 2020  al hub.         
-0001fa30: 2020 2073 6f75 7263 652c 2072 6174 6865     source, rathe
-0001fa40: 7220 7468 616e 0a20 2020 2020 2020 2020  r than.         
-0001fa50: 2020 2072 656c 7920 6f6e 2063 6163 6865     rely on cache
-0001fa60: 6420 696e 666f 726d 6174 696f 6e2e 2044  d information. D
-0001fa70: 6566 6175 6c74 2069 7320 6060 4661 6c73  efault is ``Fals
-0001fa80: 6560 602e 0a20 2020 2020 2020 203a 7265  e``..        :re
-0001fa90: 7475 726e 733a 203a 7079 3a63 6c61 7373  turns: :py:class
-0001faa0: 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e  :`~mlrun.common.
-0001fab0: 7363 6865 6d61 732e 6875 622e 4875 6249  schemas.hub.HubI
-0001fac0: 7465 6d60 2e0a 2020 2020 2020 2020 2222  tem`..        ""
-0001fad0: 220a 2020 2020 2020 2020 7061 7468 203d  ".        path =
-0001fae0: 2028 6622 6875 622f 736f 7572 6365 732f   (f"hub/sources/
-0001faf0: 7b73 6f75 7263 655f 6e61 6d65 7d2f 6974  {source_name}/it
-0001fb00: 656d 732f 7b69 7465 6d5f 6e61 6d65 7d22  ems/{item_name}"
-0001fb10: 2c29 0a20 2020 2020 2020 2070 6172 616d  ,).        param
-0001fb20: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-0001fb30: 2020 2276 6572 7369 6f6e 223a 2076 6572    "version": ver
-0001fb40: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
-0001fb50: 2020 2274 6167 223a 2074 6167 2c0a 2020    "tag": tag,.  
-0001fb60: 2020 2020 2020 2020 2020 2266 6f72 6365            "force
-0001fb70: 2d72 6566 7265 7368 223a 2066 6f72 6365  -refresh": force
-0001fb80: 5f72 6566 7265 7368 2c0a 2020 2020 2020  _refresh,.      
-0001fb90: 2020 7d0a 2020 2020 2020 2020 7265 7370    }.        resp
-0001fba0: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
-0001fbb0: 6361 6c6c 286d 6574 686f 643d 2247 4554  call(method="GET
-0001fbc0: 222c 2070 6174 683d 7061 7468 2c20 7061  ", path=path, pa
-0001fbd0: 7261 6d73 3d70 6172 616d 7329 0a20 2020  rams=params).   
-0001fbe0: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
-0001fbf0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0001fc00: 2e48 7562 4974 656d 282a 2a72 6573 706f  .HubItem(**respo
-0001fc10: 6e73 652e 6a73 6f6e 2829 290a 0a20 2020  nse.json())..   
-0001fc20: 2064 6566 2067 6574 5f68 7562 5f61 7373   def get_hub_ass
-0001fc30: 6574 280a 2020 2020 2020 2020 7365 6c66  et(.        self
-0001fc40: 2c0a 2020 2020 2020 2020 736f 7572 6365  ,.        source
-0001fc50: 5f6e 616d 653a 2073 7472 2c0a 2020 2020  _name: str,.    
-0001fc60: 2020 2020 6974 656d 5f6e 616d 653a 2073      item_name: s
-0001fc70: 7472 2c0a 2020 2020 2020 2020 6173 7365  tr,.        asse
-0001fc80: 745f 6e61 6d65 3a20 7374 722c 0a20 2020  t_name: str,.   
-0001fc90: 2020 2020 2076 6572 7369 6f6e 3a20 7374       version: st
-0001fca0: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
-0001fcb0: 2020 7461 673a 2073 7472 203d 2022 6c61    tag: str = "la
-0001fcc0: 7465 7374 222c 0a20 2020 2029 3a0a 2020  test",.    ):.  
-0001fcd0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001fce0: 2020 4765 7420 6875 6220 6173 7365 7420    Get hub asset 
-0001fcf0: 6672 6f6d 2069 7465 6d2e 0a0a 2020 2020  from item...    
-0001fd00: 2020 2020 3a70 6172 616d 2073 6f75 7263      :param sourc
-0001fd10: 655f 6e61 6d65 3a20 4e61 6d65 206f 6620  e_name: Name of 
-0001fd20: 736f 7572 6365 2e0a 2020 2020 2020 2020  source..        
-0001fd30: 3a70 6172 616d 2069 7465 6d5f 6e61 6d65  :param item_name
-0001fd40: 3a20 2020 4e61 6d65 206f 6620 7468 6520  :   Name of the 
-0001fd50: 6974 656d 2077 6869 6368 2068 6f6c 6473  item which holds
-0001fd60: 2074 6865 2061 7373 6574 2e0a 2020 2020   the asset..    
-0001fd70: 2020 2020 3a70 6172 616d 2061 7373 6574      :param asset
-0001fd80: 5f6e 616d 653a 2020 4e61 6d65 206f 6620  _name:  Name of 
-0001fd90: 7468 6520 6173 7365 7420 746f 2072 6574  the asset to ret
-0001fda0: 7269 6576 652e 0a20 2020 2020 2020 203a  rieve..        :
-0001fdb0: 7061 7261 6d20 7665 7273 696f 6e3a 2047  param version: G
-0001fdc0: 6574 2061 2073 7065 6369 6669 6320 7665  et a specific ve
-0001fdd0: 7273 696f 6e20 6f66 2074 6865 2069 7465  rsion of the ite
-0001fde0: 6d2e 2044 6566 6175 6c74 2069 7320 6060  m. Default is ``
-0001fdf0: 4e6f 6e65 6060 2e0a 2020 2020 2020 2020  None``..        
-0001fe00: 3a70 6172 616d 2074 6167 3a20 4765 7420  :param tag: Get 
-0001fe10: 6120 7370 6563 6966 6963 2076 6572 7369  a specific versi
-0001fe20: 6f6e 206f 6620 7468 6520 6974 656d 2069  on of the item i
-0001fe30: 6465 6e74 6966 6965 6420 6279 2074 6167  dentified by tag
-0001fe40: 2e20 4465 6661 756c 7420 6973 2060 606c  . Default is ``l
-0001fe50: 6174 6573 7460 602e 0a0a 2020 2020 2020  atest``...      
-0001fe60: 2020 3a72 6574 7572 6e3a 2068 7474 7020    :return: http 
-0001fe70: 7265 7370 6f6e 7365 2077 6974 6820 7468  response with th
-0001fe80: 6520 6173 7365 7420 696e 2074 6865 2063  e asset in the c
-0001fe90: 6f6e 7465 6e74 2061 7474 7269 6275 7465  ontent attribute
-0001fea0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001feb0: 2020 2020 2070 6174 6820 3d20 2866 2268       path = (f"h
-0001fec0: 7562 2f73 6f75 7263 6573 2f7b 736f 7572  ub/sources/{sour
-0001fed0: 6365 5f6e 616d 657d 2f69 7465 6d73 2f7b  ce_name}/items/{
-0001fee0: 6974 656d 5f6e 616d 657d 2f61 7373 6574  item_name}/asset
-0001fef0: 732f 7b61 7373 6574 5f6e 616d 657d 222c  s/{asset_name}",
-0001ff00: 290a 2020 2020 2020 2020 7061 7261 6d73  ).        params
-0001ff10: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0001ff20: 2022 7665 7273 696f 6e22 3a20 7665 7273   "version": vers
-0001ff30: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-0001ff40: 2022 7461 6722 3a20 7461 672c 0a20 2020   "tag": tag,.   
-0001ff50: 2020 2020 207d 0a20 2020 2020 2020 2072       }.        r
-0001ff60: 6573 706f 6e73 6520 3d20 7365 6c66 2e61  esponse = self.a
-0001ff70: 7069 5f63 616c 6c28 6d65 7468 6f64 3d22  pi_call(method="
-0001ff80: 4745 5422 2c20 7061 7468 3d70 6174 682c  GET", path=path,
-0001ff90: 2070 6172 616d 733d 7061 7261 6d73 290a   params=params).
-0001ffa0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-0001ffb0: 6573 706f 6e73 650a 0a20 2020 2064 6566  esponse..    def
-0001ffc0: 2076 6572 6966 795f 6175 7468 6f72 697a   verify_authoriz
-0001ffd0: 6174 696f 6e28 0a20 2020 2020 2020 2073  ation(.        s
-0001ffe0: 656c 662c 0a20 2020 2020 2020 2061 7574  elf,.        aut
-0001fff0: 686f 7269 7a61 7469 6f6e 5f76 6572 6966  horization_verif
-00020000: 6963 6174 696f 6e5f 696e 7075 743a 206d  ication_input: m
-00020010: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00020020: 6d61 732e 4175 7468 6f72 697a 6174 696f  mas.Authorizatio
-00020030: 6e56 6572 6966 6963 6174 696f 6e49 6e70  nVerificationInp
-00020040: 7574 2c0a 2020 2020 293a 0a20 2020 2020  ut,.    ):.     
-00020050: 2020 2022 2222 5665 7269 6669 6573 2061     """Verifies a
-00020060: 7574 686f 7269 7a61 7469 6f6e 2066 6f72  uthorization for
-00020070: 2074 6865 2070 726f 7669 6465 6420 6163   the provided ac
-00020080: 7469 6f6e 206f 6e20 7468 6520 7072 6f76  tion on the prov
-00020090: 6964 6564 2072 6573 6f75 7263 652e 0a0a  ided resource...
-000200a0: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
-000200b0: 7574 686f 7269 7a61 7469 6f6e 5f76 6572  uthorization_ver
-000200c0: 6966 6963 6174 696f 6e5f 696e 7075 743a  ification_input:
-000200d0: 2049 6e73 7461 6e63 6520 6f66 0a20 2020   Instance of.   
-000200e0: 2020 2020 2020 2020 203a 7079 3a63 6c61           :py:cla
-000200f0: 7373 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f  ss:`~mlrun.commo
-00020100: 6e2e 7363 6865 6d61 732e 4175 7468 6f72  n.schemas.Author
-00020110: 697a 6174 696f 6e56 6572 6966 6963 6174  izationVerificat
-00020120: 696f 6e49 6e70 7574 6020 7468 6174 2069  ionInput` that i
-00020130: 6e63 6c75 6465 7320 616c 6c20 7468 6520  ncludes all the 
-00020140: 6e65 6564 6564 2070 6172 616d 6574 6572  needed parameter
-00020150: 7320 666f 720a 2020 2020 2020 2020 2020  s for.          
-00020160: 2020 7468 6520 6175 7468 2076 6572 6966    the auth verif
-00020170: 6963 6174 696f 6e0a 2020 2020 2020 2020  ication.        
-00020180: 2222 220a 2020 2020 2020 2020 6572 726f  """.        erro
-00020190: 725f 6d65 7373 6167 6520 3d20 2241 7574  r_message = "Aut
-000201a0: 686f 7269 7a61 7469 6f6e 2063 6865 636b  horization check
-000201b0: 2066 6169 6c65 6422 0a20 2020 2020 2020   failed".       
-000201c0: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
-000201d0: 2020 2020 2020 2020 2020 2020 2250 4f53              "POS
-000201e0: 5422 2c0a 2020 2020 2020 2020 2020 2020  T",.            
-000201f0: 2261 7574 686f 7269 7a61 7469 6f6e 2f76  "authorization/v
-00020200: 6572 6966 6963 6174 696f 6e73 222c 0a20  erifications",. 
-00020210: 2020 2020 2020 2020 2020 2065 7272 6f72             error
-00020220: 5f6d 6573 7361 6765 2c0a 2020 2020 2020  _message,.      
-00020230: 2020 2020 2020 626f 6479 3d64 6963 745f        body=dict_
-00020240: 746f 5f6a 736f 6e28 6175 7468 6f72 697a  to_json(authoriz
-00020250: 6174 696f 6e5f 7665 7269 6669 6361 7469  ation_verificati
-00020260: 6f6e 5f69 6e70 7574 2e64 6963 7428 2929  on_input.dict())
-00020270: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00020280: 2064 6566 2074 7269 6767 6572 5f6d 6967   def trigger_mig
-00020290: 7261 7469 6f6e 7328 7365 6c66 2920 2d3e  rations(self) ->
-000202a0: 204f 7074 696f 6e61 6c5b 6d6c 7275 6e2e   Optional[mlrun.
-000202b0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e42  common.schemas.B
-000202c0: 6163 6b67 726f 756e 6454 6173 6b5d 3a0a  ackgroundTask]:.
-000202d0: 2020 2020 2020 2020 2222 2254 7269 6767          """Trigg
-000202e0: 6572 206d 6967 7261 7469 6f6e 7320 2877  er migrations (w
-000202f0: 696c 6c20 646f 206e 6f74 6869 6e67 2069  ill do nothing i
-00020300: 6620 6e6f 206d 6967 7261 7469 6f6e 7320  f no migrations 
-00020310: 6172 6520 6e65 6564 6564 2920 616e 6420  are needed) and 
-00020320: 7761 6974 2066 6f72 2074 6865 6d20 746f  wait for them to
-00020330: 2066 696e 6973 6820 6966 2061 6374 7561   finish if actua
-00020340: 6c6c 790a 2020 2020 2020 2020 7472 6967  lly.        trig
-00020350: 6765 7265 640a 2020 2020 2020 2020 3a72  gered.        :r
-00020360: 6574 7572 6e73 3a20 3a70 793a 636c 6173  eturns: :py:clas
-00020370: 733a 607e 6d6c 7275 6e2e 636f 6d6d 6f6e  s:`~mlrun.common
-00020380: 2e73 6368 656d 6173 2e42 6163 6b67 726f  .schemas.Backgro
-00020390: 756e 6454 6173 6b60 2e0a 2020 2020 2020  undTask`..      
-000203a0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-000203b0: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
-000203c0: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
-000203d0: 2020 2020 2250 4f53 5422 2c0a 2020 2020      "POST",.    
-000203e0: 2020 2020 2020 2020 226f 7065 7261 7469          "operati
-000203f0: 6f6e 732f 6d69 6772 6174 696f 6e73 222c  ons/migrations",
-00020400: 0a20 2020 2020 2020 2020 2020 2022 4661  .            "Fa
-00020410: 696c 6564 2074 7269 6767 6572 696e 6720  iled triggering 
-00020420: 6d69 6772 6174 696f 6e73 222c 0a20 2020  migrations",.   
-00020430: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
-00020440: 6620 7265 7370 6f6e 7365 2e73 7461 7475  f response.statu
-00020450: 735f 636f 6465 203d 3d20 6874 7470 2e48  s_code == http.H
-00020460: 5454 5053 7461 7475 732e 4143 4345 5054  TTPStatus.ACCEPT
-00020470: 4544 3a0a 2020 2020 2020 2020 2020 2020  ED:.            
-00020480: 6261 636b 6772 6f75 6e64 5f74 6173 6b20  background_task 
-00020490: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
-000204a0: 6368 656d 6173 2e42 6163 6b67 726f 756e  chemas.Backgroun
-000204b0: 6454 6173 6b28 2a2a 7265 7370 6f6e 7365  dTask(**response
-000204c0: 2e6a 736f 6e28 2929 0a20 2020 2020 2020  .json()).       
-000204d0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000204e0: 2e5f 7761 6974 5f66 6f72 5f62 6163 6b67  ._wait_for_backg
-000204f0: 726f 756e 645f 7461 736b 5f74 6f5f 7265  round_task_to_re
-00020500: 6163 685f 7465 726d 696e 616c 5f73 7461  ach_terminal_sta
-00020510: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
-00020520: 2020 2020 6261 636b 6772 6f75 6e64 5f74      background_t
-00020530: 6173 6b2e 6d65 7461 6461 7461 2e6e 616d  ask.metadata.nam
-00020540: 650a 2020 2020 2020 2020 2020 2020 290a  e.            ).
-00020550: 2020 2020 2020 2020 7265 7475 726e 204e          return N
-00020560: 6f6e 650a 0a20 2020 2064 6566 2073 6574  one..    def set
-00020570: 5f72 756e 5f6e 6f74 6966 6963 6174 696f  _run_notificatio
-00020580: 6e73 280a 2020 2020 2020 2020 7365 6c66  ns(.        self
-00020590: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
-000205a0: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
-000205b0: 7275 6e5f 7569 643a 2073 7472 2c0a 2020  run_uid: str,.  
-000205c0: 2020 2020 2020 6e6f 7469 6669 6361 7469        notificati
-000205d0: 6f6e 733a 2074 7970 696e 672e 4c69 7374  ons: typing.List
-000205e0: 5b6d 6c72 756e 2e6d 6f64 656c 2e4e 6f74  [mlrun.model.Not
-000205f0: 6966 6963 6174 696f 6e5d 203d 204e 6f6e  ification] = Non
-00020600: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00020610: 2020 2222 220a 2020 2020 2020 2020 5365    """.        Se
-00020620: 7420 6e6f 7469 6669 6361 7469 6f6e 7320  t notifications 
-00020630: 6f6e 2061 2072 756e 2e20 5468 6973 2077  on a run. This w
-00020640: 696c 6c20 6f76 6572 7269 6465 2061 6e79  ill override any
-00020650: 2065 7869 7374 696e 6720 6e6f 7469 6669   existing notifi
-00020660: 6361 7469 6f6e 7320 6f6e 2074 6865 2072  cations on the r
-00020670: 756e 2e0a 2020 2020 2020 2020 3a70 6172  un..        :par
-00020680: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
-00020690: 6563 7420 636f 6e74 6169 6e69 6e67 2074  ect containing t
-000206a0: 6865 2072 756e 2e0a 2020 2020 2020 2020  he run..        
-000206b0: 3a70 6172 616d 2072 756e 5f75 6964 3a20  :param run_uid: 
-000206c0: 5549 4420 6f66 2074 6865 2072 756e 2e0a  UID of the run..
-000206d0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-000206e0: 6f74 6966 6963 6174 696f 6e73 3a20 4c69  otifications: Li
-000206f0: 7374 206f 6620 6e6f 7469 6669 6361 7469  st of notificati
-00020700: 6f6e 7320 746f 2073 6574 206f 6e20 7468  ons to set on th
-00020710: 6520 7275 6e2e 2044 6566 6175 6c74 2069  e run. Default i
-00020720: 7320 616e 2065 6d70 7479 206c 6973 742e  s an empty list.
-00020730: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00020740: 2020 2020 206e 6f74 6966 6963 6174 696f       notificatio
-00020750: 6e73 203d 206e 6f74 6966 6963 6174 696f  ns = notificatio
-00020760: 6e73 206f 7220 5b5d 0a0a 2020 2020 2020  ns or []..      
-00020770: 2020 7365 6c66 2e61 7069 5f63 616c 6c28    self.api_call(
-00020780: 0a20 2020 2020 2020 2020 2020 2022 5055  .            "PU
-00020790: 5422 2c0a 2020 2020 2020 2020 2020 2020  T",.            
-000207a0: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
-000207b0: 6563 747d 2f72 756e 732f 7b72 756e 5f75  ect}/runs/{run_u
-000207c0: 6964 7d2f 6e6f 7469 6669 6361 7469 6f6e  id}/notification
-000207d0: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
-000207e0: 6622 4661 696c 6564 2074 6f20 7365 7420  f"Failed to set 
-000207f0: 6e6f 7469 6669 6361 7469 6f6e 7320 6f6e  notifications on
-00020800: 2072 756e 2e20 7569 643d 7b72 756e 5f75   run. uid={run_u
-00020810: 6964 7d2c 2070 726f 6a65 6374 3d7b 7072  id}, project={pr
-00020820: 6f6a 6563 747d 222c 0a20 2020 2020 2020  oject}",.       
-00020830: 2020 2020 206a 736f 6e3d 7b0a 2020 2020       json={.    
-00020840: 2020 2020 2020 2020 2020 2020 226e 6f74              "not
-00020850: 6966 6963 6174 696f 6e73 223a 205b 0a20  ifications": [. 
-00020860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020870: 2020 206e 6f74 6966 6963 6174 696f 6e2e     notification.
-00020880: 746f 5f64 6963 7428 2920 666f 7220 6e6f  to_dict() for no
-00020890: 7469 6669 6361 7469 6f6e 2069 6e20 6e6f  tification in no
-000208a0: 7469 6669 6361 7469 6f6e 730a 2020 2020  tifications.    
-000208b0: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
-000208c0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
-000208d0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-000208e0: 2073 6574 5f73 6368 6564 756c 655f 6e6f   set_schedule_no
-000208f0: 7469 6669 6361 7469 6f6e 7328 0a20 2020  tifications(.   
-00020900: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00020910: 2020 2070 726f 6a65 6374 3a20 7374 722c     project: str,
-00020920: 0a20 2020 2020 2020 2073 6368 6564 756c  .        schedul
-00020930: 655f 6e61 6d65 3a20 7374 722c 0a20 2020  e_name: str,.   
-00020940: 2020 2020 206e 6f74 6966 6963 6174 696f       notificatio
-00020950: 6e73 3a20 7479 7069 6e67 2e4c 6973 745b  ns: typing.List[
-00020960: 6d6c 7275 6e2e 6d6f 6465 6c2e 4e6f 7469  mlrun.model.Noti
-00020970: 6669 6361 7469 6f6e 5d20 3d20 4e6f 6e65  fication] = None
-00020980: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00020990: 2022 2222 0a20 2020 2020 2020 2053 6574   """.        Set
-000209a0: 206e 6f74 6966 6963 6174 696f 6e73 206f   notifications o
-000209b0: 6e20 6120 7363 6865 6475 6c65 2e20 5468  n a schedule. Th
-000209c0: 6973 2077 696c 6c20 6f76 6572 7269 6465  is will override
-000209d0: 2061 6e79 2065 7869 7374 696e 6720 6e6f   any existing no
-000209e0: 7469 6669 6361 7469 6f6e 7320 6f6e 2074  tifications on t
-000209f0: 6865 2073 6368 6564 756c 652e 0a20 2020  he schedule..   
-00020a00: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-00020a10: 6563 743a 2050 726f 6a65 6374 2063 6f6e  ect: Project con
-00020a20: 7461 696e 696e 6720 7468 6520 7363 6865  taining the sche
-00020a30: 6475 6c65 2e0a 2020 2020 2020 2020 3a70  dule..        :p
-00020a40: 6172 616d 2073 6368 6564 756c 655f 6e61  aram schedule_na
-00020a50: 6d65 3a20 4e61 6d65 206f 6620 7468 6520  me: Name of the 
-00020a60: 7363 6865 6475 6c65 2e0a 2020 2020 2020  schedule..      
-00020a70: 2020 3a70 6172 616d 206e 6f74 6966 6963    :param notific
-00020a80: 6174 696f 6e73 3a20 4c69 7374 206f 6620  ations: List of 
-00020a90: 6e6f 7469 6669 6361 7469 6f6e 7320 746f  notifications to
-00020aa0: 2073 6574 206f 6e20 7468 6520 7363 6865   set on the sche
-00020ab0: 6475 6c65 2e20 4465 6661 756c 7420 6973  dule. Default is
-00020ac0: 2061 6e20 656d 7074 7920 6c69 7374 2e0a   an empty list..
-00020ad0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00020ae0: 2020 2020 6e6f 7469 6669 6361 7469 6f6e      notification
-00020af0: 7320 3d20 6e6f 7469 6669 6361 7469 6f6e  s = notification
-00020b00: 7320 6f72 205b 5d0a 0a20 2020 2020 2020  s or []..       
-00020b10: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
-00020b20: 2020 2020 2020 2020 2020 2020 2250 5554              "PUT
-00020b30: 222c 0a20 2020 2020 2020 2020 2020 2066  ",.            f
-00020b40: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-00020b50: 6374 7d2f 7363 6865 6475 6c65 732f 7b73  ct}/schedules/{s
-00020b60: 6368 6564 756c 655f 6e61 6d65 7d2f 6e6f  chedule_name}/no
-00020b70: 7469 6669 6361 7469 6f6e 7322 2c0a 2020  tifications",.  
-00020b80: 2020 2020 2020 2020 2020 6622 4661 696c            f"Fail
-00020b90: 6564 2074 6f20 7365 7420 6e6f 7469 6669  ed to set notifi
-00020ba0: 6361 7469 6f6e 7320 6f6e 2073 6368 6564  cations on sched
-00020bb0: 756c 652e 2073 6368 6564 756c 653d 7b73  ule. schedule={s
-00020bc0: 6368 6564 756c 655f 6e61 6d65 7d2c 2070  chedule_name}, p
-00020bd0: 726f 6a65 6374 3d7b 7072 6f6a 6563 747d  roject={project}
-00020be0: 222c 0a20 2020 2020 2020 2020 2020 206a  ",.            j
-00020bf0: 736f 6e3d 7b0a 2020 2020 2020 2020 2020  son={.          
-00020c00: 2020 2020 2020 226e 6f74 6966 6963 6174        "notificat
-00020c10: 696f 6e73 223a 205b 0a20 2020 2020 2020  ions": [.       
-00020c20: 2020 2020 2020 2020 2020 2020 206e 6f74               not
-00020c30: 6966 6963 6174 696f 6e2e 746f 5f64 6963  ification.to_dic
-00020c40: 7428 2920 666f 7220 6e6f 7469 6669 6361  t() for notifica
-00020c50: 7469 6f6e 2069 6e20 6e6f 7469 6669 6361  tion in notifica
-00020c60: 7469 6f6e 730a 2020 2020 2020 2020 2020  tions.          
-00020c70: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-00020c80: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-00020c90: 290a 0a20 2020 2064 6566 2073 746f 7265  )..    def store
-00020ca0: 5f72 756e 5f6e 6f74 6966 6963 6174 696f  _run_notificatio
-00020cb0: 6e73 280a 2020 2020 2020 2020 7365 6c66  ns(.        self
-00020cc0: 2c0a 2020 2020 2020 2020 6e6f 7469 6669  ,.        notifi
-00020cd0: 6361 7469 6f6e 5f6f 626a 6563 7473 3a20  cation_objects: 
-00020ce0: 7479 7069 6e67 2e4c 6973 745b 6d6c 7275  typing.List[mlru
-00020cf0: 6e2e 6d6f 6465 6c2e 4e6f 7469 6669 6361  n.model.Notifica
-00020d00: 7469 6f6e 5d2c 0a20 2020 2020 2020 2072  tion],.        r
-00020d10: 756e 5f75 6964 3a20 7374 722c 0a20 2020  un_uid: str,.   
-00020d20: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
-00020d30: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
-00020d40: 2020 6d61 736b 5f70 6172 616d 733a 2062    mask_params: b
-00020d50: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
-00020d60: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00020d70: 2020 2020 2020 2046 6f72 2069 6e74 6572         For inter
-00020d80: 6e61 6c20 7573 652e 0a20 2020 2020 2020  nal use..       
-00020d90: 2054 6865 206e 6f74 6966 6963 6174 696f   The notificatio
-00020da0: 6e20 6d65 6368 616e 6973 6d20 6d61 7920  n mechanism may 
-00020db0: 7275 6e20 226c 6f63 616c 6c79 2220 666f  run "locally" fo
-00020dc0: 7220 6365 7274 6169 6e20 7275 6e74 696d  r certain runtim
-00020dd0: 6573 2e0a 2020 2020 2020 2020 486f 7765  es..        Howe
-00020de0: 7665 722c 2074 6865 2075 7064 6174 6573  ver, the updates
-00020df0: 206f 6363 7572 2069 6e20 7468 6520 4150   occur in the AP
-00020e00: 4920 736f 206e 6f74 6869 6e67 2074 6f20  I so nothing to 
-00020e10: 646f 2068 6572 652e 0a20 2020 2020 2020  do here..       
-00020e20: 2022 2222 0a20 2020 2020 2020 2070 6173   """.        pas
-00020e30: 730a 0a20 2020 2064 6566 2073 7562 6d69  s..    def submi
-00020e40: 745f 776f 726b 666c 6f77 280a 2020 2020  t_workflow(.    
-00020e50: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00020e60: 2020 7072 6f6a 6563 743a 2073 7472 2c0a    project: str,.
-00020e70: 2020 2020 2020 2020 6e61 6d65 3a20 7374          name: st
-00020e80: 722c 0a20 2020 2020 2020 2077 6f72 6b66  r,.        workf
-00020e90: 6c6f 775f 7370 6563 3a20 556e 696f 6e5b  low_spec: Union[
-00020ea0: 0a20 2020 2020 2020 2020 2020 206d 6c72  .            mlr
-00020eb0: 756e 2e70 726f 6a65 6374 732e 7069 7065  un.projects.pipe
-00020ec0: 6c69 6e65 732e 576f 726b 666c 6f77 5370  lines.WorkflowSp
-00020ed0: 6563 2c0a 2020 2020 2020 2020 2020 2020  ec,.            
-00020ee0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00020ef0: 656d 6173 2e57 6f72 6b66 6c6f 7753 7065  emas.WorkflowSpe
-00020f00: 632c 0a20 2020 2020 2020 2020 2020 2064  c,.            d
-00020f10: 6963 742c 0a20 2020 2020 2020 205d 2c0a  ict,.        ],.
-00020f20: 2020 2020 2020 2020 6172 6775 6d65 6e74          argument
-00020f30: 733a 204f 7074 696f 6e61 6c5b 4469 6374  s: Optional[Dict
-00020f40: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00020f50: 2020 6172 7469 6661 6374 5f70 6174 683a    artifact_path:
-00020f60: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-00020f70: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
-00020f80: 6f75 7263 653a 204f 7074 696f 6e61 6c5b  ource: Optional[
-00020f90: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-00020fa0: 2020 2020 2072 756e 5f6e 616d 653a 204f       run_name: O
-00020fb0: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
-00020fc0: 6f6e 652c 0a20 2020 2020 2020 206e 616d  one,.        nam
-00020fd0: 6573 7061 6365 3a20 4f70 7469 6f6e 616c  espace: Optional
-00020fe0: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-00020ff0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-00021000: 0a20 2020 2020 2020 2053 7562 6d69 7474  .        Submitt
-00021010: 696e 6720 776f 726b 666c 6f77 2066 6f72  ing workflow for
-00021020: 2061 2072 656d 6f74 6520 6578 6563 7574   a remote execut
-00021030: 696f 6e2e 0a0a 2020 2020 2020 2020 3a70  ion...        :p
-00021040: 6172 616d 2070 726f 6a65 6374 3a20 2020  aram project:   
-00021050: 2020 2020 2020 7072 6f6a 6563 7420 6e61        project na
-00021060: 6d65 0a20 2020 2020 2020 203a 7061 7261  me.        :para
-00021070: 6d20 6e61 6d65 3a20 2020 2020 2020 2020  m name:         
-00021080: 2020 2077 6f72 6b66 6c6f 7720 6e61 6d65     workflow name
-00021090: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000210a0: 776f 726b 666c 6f77 5f73 7065 633a 2020  workflow_spec:  
-000210b0: 2074 6865 2077 6f72 6b66 6c6f 7720 7370   the workflow sp
-000210c0: 6563 2074 6f20 6578 6563 7574 650a 2020  ec to execute.  
-000210d0: 2020 2020 2020 3a70 6172 616d 2061 7267        :param arg
-000210e0: 756d 656e 7473 3a20 2020 2020 2020 6172  uments:       ar
-000210f0: 6775 6d65 6e74 7320 666f 7220 7468 6520  guments for the 
-00021100: 776f 726b 666c 6f77 0a20 2020 2020 2020  workflow.       
-00021110: 203a 7061 7261 6d20 6172 7469 6661 6374   :param artifact
-00021120: 5f70 6174 683a 2020 2061 7274 6966 6163  _path:   artifac
-00021130: 7420 7461 7267 6574 2070 6174 6820 6f66  t target path of
-00021140: 2074 6865 2077 6f72 6b66 6c6f 770a 2020   the workflow.  
-00021150: 2020 2020 2020 3a70 6172 616d 2073 6f75        :param sou
-00021160: 7263 653a 2020 2020 2020 2020 2020 736f  rce:          so
-00021170: 7572 6365 2075 726c 206f 6620 7468 6520  urce url of the 
-00021180: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
-00021190: 3a70 6172 616d 2072 756e 5f6e 616d 653a  :param run_name:
-000211a0: 2020 2020 2020 2020 7275 6e20 6e61 6d65          run name
-000211b0: 2074 6f20 6f76 6572 7269 6465 2074 6865   to override the
-000211c0: 2064 6566 6175 6c74 3a20 2777 6f72 6b66   default: 'workf
-000211d0: 6c6f 772d 7275 6e6e 6572 2d3c 776f 726b  low-runner-<work
-000211e0: 666c 6f77 206e 616d 653e 270a 2020 2020  flow name>'.    
-000211f0: 2020 2020 3a70 6172 616d 206e 616d 6573      :param names
-00021200: 7061 6365 3a20 2020 2020 2020 6b75 6265  pace:       kube
-00021210: 726e 6574 6573 206e 616d 6573 7061 6365  rnetes namespace
-00021220: 2069 6620 6f74 6865 7220 7468 616e 2064   if other than d
-00021230: 6566 6175 6c74 0a0a 2020 2020 2020 2020  efault..        
-00021240: 3a72 6574 7572 6e73 3a20 2020 203a 7079  :returns:    :py
-00021250: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e63  :class:`~mlrun.c
-00021260: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 576f  ommon.schemas.Wo
-00021270: 726b 666c 6f77 5265 7370 6f6e 7365 602e  rkflowResponse`.
-00021280: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00021290: 2020 2020 2069 6d61 6765 203d 2028 0a20       image = (. 
-000212a0: 2020 2020 2020 2020 2020 2077 6f72 6b66             workf
-000212b0: 6c6f 775f 7370 6563 2e69 6d61 6765 0a20  low_spec.image. 
-000212c0: 2020 2020 2020 2020 2020 2069 6620 6861             if ha
-000212d0: 7361 7474 7228 776f 726b 666c 6f77 5f73  sattr(workflow_s
-000212e0: 7065 632c 2022 696d 6167 6522 290a 2020  pec, "image").  
-000212f0: 2020 2020 2020 2020 2020 656c 7365 2077            else w
-00021300: 6f72 6b66 6c6f 775f 7370 6563 2e67 6574  orkflow_spec.get
-00021310: 2822 696d 6167 6522 2c20 4e6f 6e65 290a  ("image", None).
-00021320: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00021330: 2020 7265 7120 3d20 7b0a 2020 2020 2020    req = {.      
-00021340: 2020 2020 2020 2261 7267 756d 656e 7473        "arguments
-00021350: 223a 2061 7267 756d 656e 7473 2c0a 2020  ": arguments,.  
-00021360: 2020 2020 2020 2020 2020 2261 7274 6966            "artif
-00021370: 6163 745f 7061 7468 223a 2061 7274 6966  act_path": artif
-00021380: 6163 745f 7061 7468 2c0a 2020 2020 2020  act_path,.      
-00021390: 2020 2020 2020 2273 6f75 7263 6522 3a20        "source": 
-000213a0: 736f 7572 6365 2c0a 2020 2020 2020 2020  source,.        
-000213b0: 2020 2020 2272 756e 5f6e 616d 6522 3a20      "run_name": 
-000213c0: 7275 6e5f 6e61 6d65 2c0a 2020 2020 2020  run_name,.      
-000213d0: 2020 2020 2020 226e 616d 6573 7061 6365        "namespace
-000213e0: 223a 206e 616d 6573 7061 6365 2c0a 2020  ": namespace,.  
-000213f0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00021400: 6966 2069 7369 6e73 7461 6e63 6528 776f  if isinstance(wo
-00021410: 726b 666c 6f77 5f73 7065 632c 206d 6c72  rkflow_spec, mlr
-00021420: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00021430: 732e 576f 726b 666c 6f77 5370 6563 293a  s.WorkflowSpec):
-00021440: 0a20 2020 2020 2020 2020 2020 2072 6571  .            req
-00021450: 5b22 7370 6563 225d 203d 2077 6f72 6b66  ["spec"] = workf
-00021460: 6c6f 775f 7370 6563 2e64 6963 7428 290a  low_spec.dict().
-00021470: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-00021480: 6e73 7461 6e63 6528 776f 726b 666c 6f77  nstance(workflow
-00021490: 5f73 7065 632c 206d 6c72 756e 2e70 726f  _spec, mlrun.pro
-000214a0: 6a65 6374 732e 7069 7065 6c69 6e65 732e  jects.pipelines.
-000214b0: 576f 726b 666c 6f77 5370 6563 293a 0a20  WorkflowSpec):. 
-000214c0: 2020 2020 2020 2020 2020 2072 6571 5b22             req["
-000214d0: 7370 6563 225d 203d 2077 6f72 6b66 6c6f  spec"] = workflo
-000214e0: 775f 7370 6563 2e74 6f5f 6469 6374 2829  w_spec.to_dict()
-000214f0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00021500: 2020 2020 2020 2020 2020 2072 6571 5b22             req["
-00021510: 7370 6563 225d 203d 2077 6f72 6b66 6c6f  spec"] = workflo
-00021520: 775f 7370 6563 0a20 2020 2020 2020 2072  w_spec.        r
-00021530: 6571 5b22 7370 6563 225d 5b22 696d 6167  eq["spec"]["imag
-00021540: 6522 5d20 3d20 696d 6167 650a 2020 2020  e"] = image.    
-00021550: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
-00021560: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-00021570: 2020 2020 2020 2020 2020 2250 4f53 5422            "POST"
-00021580: 2c0a 2020 2020 2020 2020 2020 2020 6622  ,.            f"
-00021590: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-000215a0: 747d 2f77 6f72 6b66 6c6f 7773 2f7b 6e61  t}/workflows/{na
-000215b0: 6d65 7d2f 7375 626d 6974 222c 0a20 2020  me}/submit",.   
-000215c0: 2020 2020 2020 2020 206a 736f 6e3d 7265           json=re
-000215d0: 712c 0a20 2020 2020 2020 2029 0a20 2020  q,.        ).   
-000215e0: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
-000215f0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00021600: 2e57 6f72 6b66 6c6f 7752 6573 706f 6e73  .WorkflowRespons
-00021610: 6528 2a2a 7265 7370 6f6e 7365 2e6a 736f  e(**response.jso
-00021620: 6e28 2929 0a0a 2020 2020 6465 6620 6765  n())..    def ge
-00021630: 745f 776f 726b 666c 6f77 5f69 6428 0a20  t_workflow_id(. 
-00021640: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00021650: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
-00021660: 722c 0a20 2020 2020 2020 206e 616d 653a  r,.        name:
-00021670: 2073 7472 2c0a 2020 2020 2020 2020 7275   str,.        ru
-00021680: 6e5f 6964 3a20 7374 722c 0a20 2020 2020  n_id: str,.     
-00021690: 2020 2065 6e67 696e 653a 2073 7472 203d     engine: str =
-000216a0: 2022 222c 0a20 2020 2029 3a0a 2020 2020   "",.    ):.    
-000216b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000216c0: 5265 7472 6965 7665 2077 6f72 6b66 6c6f  Retrieve workflo
-000216d0: 7720 6964 2066 726f 6d20 7468 6520 7569  w id from the ui
-000216e0: 6420 6f66 2074 6865 2077 6f72 6b66 6c6f  d of the workflo
-000216f0: 7720 7275 6e6e 6572 2e0a 0a20 2020 2020  w runner...     
-00021700: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-00021710: 743a 2070 726f 6a65 6374 206e 616d 650a  t: project name.
-00021720: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-00021730: 616d 653a 2020 2020 776f 726b 666c 6f77  ame:    workflow
-00021740: 206e 616d 650a 2020 2020 2020 2020 3a70   name.        :p
-00021750: 6172 616d 2072 756e 5f69 643a 2020 7468  aram run_id:  th
-00021760: 6520 6964 206f 6620 7468 6520 776f 726b  e id of the work
-00021770: 666c 6f77 2072 756e 6e65 7220 2d20 7468  flow runner - th
-00021780: 6520 6a6f 6220 7468 6174 2072 756e 7320  e job that runs 
-00021790: 7468 6520 776f 726b 666c 6f77 0a20 2020  the workflow.   
-000217a0: 2020 2020 203a 7061 7261 6d20 656e 6769       :param engi
-000217b0: 6e65 3a20 2070 6970 656c 696e 6520 7275  ne:  pipeline ru
-000217c0: 6e6e 6572 0a0a 2020 2020 2020 2020 3a72  nner..        :r
-000217d0: 6574 7572 6e73 3a20 2020 3a70 793a 636c  eturns:   :py:cl
-000217e0: 6173 733a 607e 6d6c 7275 6e2e 636f 6d6d  ass:`~mlrun.comm
-000217f0: 6f6e 2e73 6368 656d 6173 2e47 6574 576f  on.schemas.GetWo
-00021800: 726b 666c 6f77 5265 7370 6f6e 7365 602e  rkflowResponse`.
-00021810: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00021820: 2020 2020 2070 6172 616d 7320 3d20 7b7d       params = {}
-00021830: 0a20 2020 2020 2020 2069 6620 656e 6769  .        if engi
-00021840: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00021850: 7061 7261 6d73 5b22 656e 6769 6e65 225d  params["engine"]
-00021860: 203d 2065 6e67 696e 650a 2020 2020 2020   = engine.      
-00021870: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
-00021880: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
-00021890: 2020 2020 2020 2020 2247 4554 222c 0a20          "GET",. 
-000218a0: 2020 2020 2020 2020 2020 2066 2270 726f             f"pro
-000218b0: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
-000218c0: 776f 726b 666c 6f77 732f 7b6e 616d 657d  workflows/{name}
-000218d0: 2f72 756e 732f 7b72 756e 5f69 647d 222c  /runs/{run_id}",
-000218e0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-000218f0: 616d 733d 7061 7261 6d73 2c0a 2020 2020  ams=params,.    
-00021900: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-00021910: 7475 726e 206d 6c72 756e 2e63 6f6d 6d6f  turn mlrun.commo
-00021920: 6e2e 7363 6865 6d61 732e 4765 7457 6f72  n.schemas.GetWor
-00021930: 6b66 6c6f 7752 6573 706f 6e73 6528 2a2a  kflowResponse(**
-00021940: 7265 7370 6f6e 7365 2e6a 736f 6e28 2929  response.json())
-00021950: 0a0a 2020 2020 6465 6620 6c6f 6164 5f70  ..    def load_p
-00021960: 726f 6a65 6374 280a 2020 2020 2020 2020  roject(.        
-00021970: 7365 6c66 2c0a 2020 2020 2020 2020 6e61  self,.        na
-00021980: 6d65 3a20 7374 722c 0a20 2020 2020 2020  me: str,.       
-00021990: 2075 726c 3a20 7374 722c 0a20 2020 2020   url: str,.     
-000219a0: 2020 2073 6563 7265 7473 3a20 4f70 7469     secrets: Opti
-000219b0: 6f6e 616c 5b44 6963 745d 203d 204e 6f6e  onal[Dict] = Non
-000219c0: 652c 0a20 2020 2020 2020 2073 6176 655f  e,.        save_
-000219d0: 7365 6372 6574 733a 2062 6f6f 6c20 3d20  secrets: bool = 
-000219e0: 5472 7565 2c0a 2020 2020 2920 2d3e 2073  True,.    ) -> s
-000219f0: 7472 3a0a 2020 2020 2020 2020 2222 220a  tr:.        """.
-00021a00: 2020 2020 2020 2020 4c6f 6164 696e 6720          Loading 
-00021a10: 6120 7072 6f6a 6563 7420 7265 6d6f 7465  a project remote
-00021a20: 6c79 2066 726f 6d20 7468 6520 6769 7665  ly from the give
-00021a30: 6e20 736f 7572 6365 2e0a 2020 2020 2020  n source..      
-00021a40: 2020 3a70 6172 616d 206e 616d 653a 2020    :param name:  
-00021a50: 2020 2020 2020 2020 2020 7072 6f6a 6563            projec
-00021a60: 7420 6e61 6d65 0a20 2020 2020 2020 203a  t name.        :
-00021a70: 7061 7261 6d20 7572 6c3a 2020 2020 2020  param url:      
-00021a80: 2020 2020 2020 2067 6974 206f 7220 7461         git or ta
-00021a90: 722e 677a 206f 7220 2e7a 6970 2073 6f75  r.gz or .zip sou
-00021aa0: 7263 6573 2061 7263 6869 7665 2070 6174  rces archive pat
-00021ab0: 6820 652e 672e 3a0a 2020 2020 2020 2020  h e.g.:.        
-00021ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ad0: 2020 2020 2020 2020 6769 743a 2f2f 6769          git://gi
-00021ae0: 7468 7562 2e63 6f6d 2f6d 6c72 756e 2f64  thub.com/mlrun/d
-00021af0: 656d 6f2d 7867 622d 7072 6f6a 6563 742e  emo-xgb-project.
-00021b00: 6769 740a 2020 2020 2020 2020 2020 2020  git.            
-00021b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b20: 2020 2020 6874 7470 3a2f 2f6d 7973 6974      http://mysit
-00021b30: 652f 6172 6368 6976 6564 2d70 726f 6a65  e/archived-proje
-00021b40: 6374 2e7a 6970 0a20 2020 2020 2020 2020  ct.zip.         
-00021b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b60: 2020 2020 2020 2054 6865 2067 6974 2070         The git p
-00021b70: 726f 6a65 6374 2073 686f 756c 6420 696e  roject should in
-00021b80: 636c 7564 6520 7468 6520 7072 6f6a 6563  clude the projec
-00021b90: 7420 7961 6d6c 2066 696c 652e 0a20 2020  t yaml file..   
-00021ba0: 2020 2020 203a 7061 7261 6d20 7365 6372       :param secr
-00021bb0: 6574 733a 2020 2020 2020 2020 2053 6563  ets:         Sec
-00021bc0: 7265 7473 2074 6f20 7374 6f72 6520 696e  rets to store in
-00021bd0: 2070 726f 6a65 6374 2069 6e20 6f72 6465   project in orde
-00021be0: 7220 746f 206c 6f61 6420 6974 2066 726f  r to load it fro
-00021bf0: 6d20 7468 6520 7072 6f76 6964 6564 2075  m the provided u
-00021c00: 726c 2e0a 2020 2020 2020 2020 2020 2020  rl..            
-00021c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c20: 2020 2020 466f 7220 6d6f 7265 2069 6e66      For more inf
-00021c30: 6f72 6d61 7469 6f6e 2073 6565 203a 7079  ormation see :py
-00021c40: 3a66 756e 633a 606d 6c72 756e 2e6c 6f61  :func:`mlrun.loa
-00021c50: 645f 7072 6f6a 6563 7460 2066 756e 6374  d_project` funct
-00021c60: 696f 6e2e 0a20 2020 2020 2020 203a 7061  ion..        :pa
-00021c70: 7261 6d20 7361 7665 5f73 6563 7265 7473  ram save_secrets
-00021c80: 3a20 2020 2057 6865 7468 6572 2074 6f20  :    Whether to 
-00021c90: 7374 6f72 6520 7365 6372 6574 7320 696e  store secrets in
-00021ca0: 2074 6865 206c 6f61 6465 6420 7072 6f6a   the loaded proj
-00021cb0: 6563 742e 0a20 2020 2020 2020 2020 2020  ect..           
-00021cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021cd0: 2020 2020 2053 6574 7469 6e67 2074 6f20       Setting to 
-00021ce0: 4661 6c73 6520 7769 6c6c 2063 6175 7365  False will cause
-00021cf0: 2077 6169 7469 6e67 2066 6f72 2074 6865   waiting for the
-00021d00: 2070 726f 6365 7373 2063 6f6d 706c 6574   process complet
-00021d10: 696f 6e2e 0a0a 2020 2020 2020 2020 3a72  ion...        :r
-00021d20: 6574 7572 6e73 3a20 2020 2020 2020 2020  eturns:         
-00021d30: 2020 2020 2020 5468 6520 7465 726d 696e        The termin
-00021d40: 616c 2073 7461 7465 206f 6620 6c6f 6164  al state of load
-00021d50: 2070 726f 6a65 6374 2070 726f 6365 7373   project process
-00021d60: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00021d70: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
-00021d80: 2275 726c 223a 2075 726c 7d0a 2020 2020  "url": url}.    
-00021d90: 2020 2020 626f 6479 203d 204e 6f6e 650a      body = None.
-00021da0: 2020 2020 2020 2020 6966 2073 6563 7265          if secre
-00021db0: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-00021dc0: 7072 6f76 6964 6572 203d 206d 6c72 756e  provider = mlrun
-00021dd0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00021de0: 5365 6372 6574 5072 6f76 6964 6572 4e61  SecretProviderNa
-00021df0: 6d65 2e6b 7562 6572 6e65 7465 730a 2020  me.kubernetes.  
-00021e00: 2020 2020 2020 2020 2020 7365 6372 6574            secret
-00021e10: 735f 696e 7075 7420 3d20 6d6c 7275 6e2e  s_input = mlrun.
-00021e20: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
-00021e30: 6563 7265 7473 4461 7461 280a 2020 2020  ecretsData(.    
-00021e40: 2020 2020 2020 2020 2020 2020 7072 6f76              prov
-00021e50: 6964 6572 3d70 726f 7669 6465 722c 2073  ider=provider, s
-00021e60: 6563 7265 7473 3d73 6563 7265 7473 0a20  ecrets=secrets. 
-00021e70: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00021e80: 2020 2020 2020 2020 2062 6f64 7920 3d20           body = 
-00021e90: 7365 6372 6574 735f 696e 7075 742e 6469  secrets_input.di
-00021ea0: 6374 2829 0a20 2020 2020 2020 2072 6573  ct().        res
-00021eb0: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
-00021ec0: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-00021ed0: 2020 2022 504f 5354 222c 2066 2270 726f     "POST", f"pro
-00021ee0: 6a65 6374 732f 7b6e 616d 657d 2f6c 6f61  jects/{name}/loa
-00021ef0: 6422 2c20 7061 7261 6d73 3d70 6172 616d  d", params=param
-00021f00: 732c 2062 6f64 793d 6469 6374 5f74 6f5f  s, body=dict_to_
-00021f10: 6a73 6f6e 2862 6f64 7929 0a20 2020 2020  json(body).     
-00021f20: 2020 2029 0a20 2020 2020 2020 2072 6573     ).        res
-00021f30: 706f 6e73 6520 3d20 7265 7370 6f6e 7365  ponse = response
-00021f40: 2e6a 736f 6e28 290a 2020 2020 2020 2020  .json().        
-00021f50: 7275 6e20 3d20 6d6c 7275 6e2e 5275 6e4f  run = mlrun.RunO
-00021f60: 626a 6563 742e 6672 6f6d 5f64 6963 7428  bject.from_dict(
-00021f70: 7265 7370 6f6e 7365 5b22 6461 7461 225d  response["data"]
-00021f80: 290a 2020 2020 2020 2020 7374 6174 652c  ).        state,
-00021f90: 205f 203d 2072 756e 2e6c 6f67 7328 290a   _ = run.logs().
-00021fa0: 0a20 2020 2020 2020 2069 6620 7365 6372  .        if secr
-00021fb0: 6574 7320 616e 6420 6e6f 7420 7361 7665  ets and not save
-00021fc0: 5f73 6563 7265 7473 3a0a 2020 2020 2020  _secrets:.      
-00021fd0: 2020 2020 2020 7365 6c66 2e64 656c 6574        self.delet
-00021fe0: 655f 7072 6f6a 6563 745f 7365 6372 6574  e_project_secret
-00021ff0: 7328 7072 6f6a 6563 743d 6e61 6d65 2c20  s(project=name, 
-00022000: 7365 6372 6574 733d 6c69 7374 2873 6563  secrets=list(sec
-00022010: 7265 7473 2e6b 6579 7328 2929 290a 2020  rets.keys())).  
-00022020: 2020 2020 2020 2020 2020 6966 2073 7461            if sta
-00022030: 7465 2021 3d20 2263 6f6d 706c 6574 6564  te != "completed
-00022040: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
-00022050: 2020 206c 6f67 6765 722e 6572 726f 7228     logger.error(
-00022060: 224c 6f61 6420 7072 6f6a 6563 7420 7461  "Load project ta
-00022070: 736b 2066 6169 6c65 642c 2064 656c 6574  sk failed, delet
-00022080: 696e 6720 7072 6f6a 6563 7422 290a 2020  ing project").  
-00022090: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000220a0: 6c66 2e64 656c 6574 655f 7072 6f6a 6563  lf.delete_projec
-000220b0: 7428 6e61 6d65 2c20 6d6c 7275 6e2e 636f  t(name, mlrun.co
-000220c0: 6d6d 6f6e 2e73 6368 656d 6173 2e44 656c  mmon.schemas.Del
-000220d0: 6574 696f 6e53 7472 6174 6567 792e 6361  etionStrategy.ca
-000220e0: 7363 6164 6529 0a0a 2020 2020 2020 2020  scade)..        
-000220f0: 7265 7475 726e 2073 7461 7465 0a0a 0a64  return state...d
-00022100: 6566 205f 6173 5f6a 736f 6e28 6f62 6a29  ef _as_json(obj)
-00022110: 3a0a 2020 2020 666e 203d 2067 6574 6174  :.    fn = getat
-00022120: 7472 286f 626a 2c20 2274 6f5f 6a73 6f6e  tr(obj, "to_json
-00022130: 222c 204e 6f6e 6529 0a20 2020 2069 6620  ", None).    if 
-00022140: 666e 3a0a 2020 2020 2020 2020 7265 7475  fn:.        retu
-00022150: 726e 2066 6e28 290a 2020 2020 7265 7475  rn fn().    retu
-00022160: 726e 2064 6963 745f 746f 5f6a 736f 6e28  rn dict_to_json(
-00022170: 6f62 6a29 0a                             obj).
+0001e9b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e9c0: 206f 7264 6572 3d2d 312c 0a20 2020 2020   order=-1,.     
+0001e9d0: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
+0001e9e0: 653d 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  e=mlrun.common.s
+0001e9f0: 6368 656d 6173 2e48 7562 536f 7572 6365  chemas.HubSource
+0001ea00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001ea10: 2020 2020 2020 6d65 7461 6461 7461 3d6d        metadata=m
+0001ea20: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0001ea30: 6d61 732e 4875 624f 626a 6563 744d 6574  mas.HubObjectMet
+0001ea40: 6164 6174 6128 0a20 2020 2020 2020 2020  adata(.         
+0001ea50: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0001ea60: 616d 653d 2270 7269 7622 2c20 6465 7363  ame="priv", desc
+0001ea70: 7269 7074 696f 6e3d 2261 2070 7269 7661  ription="a priva
+0001ea80: 7465 2073 6f75 7263 6522 0a20 2020 2020  te source".     
+0001ea90: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001eaa0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001eab0: 2020 2020 2020 7370 6563 3d6d 6c72 756e        spec=mlrun
+0001eac0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+0001ead0: 4875 6253 6f75 7263 6553 7065 6328 7061  HubSourceSpec(pa
+0001eae0: 7468 3d22 2f6c 6f63 616c 2f70 6174 682f  th="/local/path/
+0001eaf0: 746f 2f73 6f75 7263 6522 2c20 6368 616e  to/source", chan
+0001eb00: 6e65 6c3d 2264 6576 656c 6f70 6d65 6e74  nel="development
+0001eb10: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+0001eb20: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0001eb30: 2029 0a20 2020 2020 2020 2020 2020 2064   ).            d
+0001eb40: 622e 6372 6561 7465 5f68 7562 5f73 6f75  b.create_hub_sou
+0001eb50: 7263 6528 7072 6976 6174 655f 736f 7572  rce(private_sour
+0001eb60: 6365 290a 0a20 2020 2020 2020 2020 2020  ce)..           
+0001eb70: 2023 2041 6464 2061 6e6f 7468 6572 2073   # Add another s
+0001eb80: 6f75 7263 6520 6173 2031 7374 2069 6e20  ource as 1st in 
+0001eb90: 7468 6520 6c69 7374 202d 2077 696c 6c20  the list - will 
+0001eba0: 7075 7368 2070 7265 7669 6f75 7320 6f6e  push previous on
+0001ebb0: 6520 746f 2062 6520 2332 0a20 2020 2020  e to be #2.     
+0001ebc0: 2020 2020 2020 2061 6e6f 7468 6572 5f73         another_s
+0001ebd0: 6f75 7263 6520 3d20 6d6c 7275 6e2e 636f  ource = mlrun.co
+0001ebe0: 6d6d 6f6e 2e73 6368 656d 6173 2e49 6e64  mmon.schemas.Ind
+0001ebf0: 6578 6564 4875 6253 6f75 7263 6528 0a20  exedHubSource(. 
+0001ec00: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0001ec10: 7264 6572 3d31 2c0a 2020 2020 2020 2020  rder=1,.        
+0001ec20: 2020 2020 2020 2020 736f 7572 6365 3d6d          source=m
+0001ec30: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0001ec40: 6d61 732e 4875 6253 6f75 7263 6528 0a20  mas.HubSource(. 
+0001ec50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ec60: 2020 206d 6574 6164 6174 613d 6d6c 7275     metadata=mlru
+0001ec70: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0001ec80: 2e48 7562 4f62 6a65 6374 4d65 7461 6461  .HubObjectMetada
+0001ec90: 7461 280a 2020 2020 2020 2020 2020 2020  ta(.            
+0001eca0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+0001ecb0: 3d22 7072 6976 2d32 222c 2064 6573 6372  ="priv-2", descr
+0001ecc0: 6970 7469 6f6e 3d22 616e 6f74 6865 7220  iption="another 
+0001ecd0: 736f 7572 6365 220a 2020 2020 2020 2020  source".        
+0001ece0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+0001ecf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ed00: 2020 2073 7065 633d 6d6c 7275 6e2e 636f     spec=mlrun.co
+0001ed10: 6d6d 6f6e 2e73 6368 656d 6173 2e48 7562  mmon.schemas.Hub
+0001ed20: 536f 7572 6365 5370 6563 280a 2020 2020  SourceSpec(.    
+0001ed30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ed40: 2020 2020 7061 7468 3d22 2f6c 6f63 616c      path="/local
+0001ed50: 2f70 6174 682f 746f 2f73 6f75 7263 652f  /path/to/source/
+0001ed60: 3222 2c0a 2020 2020 2020 2020 2020 2020  2",.            
+0001ed70: 2020 2020 2020 2020 2020 2020 6368 616e              chan
+0001ed80: 6e65 6c3d 2264 6576 656c 6f70 6d65 6e74  nel="development
+0001ed90: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0001eda0: 2020 2020 2020 2020 2020 2063 7265 6465             crede
+0001edb0: 6e74 6961 6c73 3d7b 2e2e 2e7d 0a20 2020  ntials={...}.   
+0001edc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001edd0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+0001ede0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0001edf0: 2029 0a20 2020 2020 2020 2020 2020 2064   ).            d
+0001ee00: 622e 6372 6561 7465 5f68 7562 5f73 6f75  b.create_hub_sou
+0001ee10: 7263 6528 616e 6f74 6865 725f 736f 7572  rce(another_sour
+0001ee20: 6365 290a 0a20 2020 2020 2020 203a 7061  ce)..        :pa
+0001ee30: 7261 6d20 736f 7572 6365 3a20 5468 6520  ram source: The 
+0001ee40: 736f 7572 6365 2061 6e64 2069 7473 206f  source and its o
+0001ee50: 7264 6572 2c20 6f66 2074 7970 650a 2020  rder, of type.  
+0001ee60: 2020 2020 2020 2020 2020 3a70 793a 636c            :py:cl
+0001ee70: 6173 733a 607e 6d6c 7275 6e2e 636f 6d6d  ass:`~mlrun.comm
+0001ee80: 6f6e 2e73 6368 656d 6173 2e68 7562 2e49  on.schemas.hub.I
+0001ee90: 6e64 6578 6564 4875 6253 6f75 7263 6560  ndexedHubSource`
+0001eea0: 2c20 6f72 2069 6e20 6469 6374 696f 6e61  , or in dictiona
+0001eeb0: 7279 2066 6f72 6d2e 0a20 2020 2020 2020  ry form..       
+0001eec0: 203a 7265 7475 726e 733a 2054 6865 2073   :returns: The s
+0001eed0: 6f75 7263 6520 6f62 6a65 6374 2061 7320  ource object as 
+0001eee0: 696e 7365 7274 6564 2069 6e74 6f20 7468  inserted into th
+0001eef0: 6520 6461 7461 6261 7365 2c20 7769 7468  e database, with
+0001ef00: 2063 7265 6465 6e74 6961 6c73 2073 7472   credentials str
+0001ef10: 6970 7065 642e 0a20 2020 2020 2020 2022  ipped..        "
+0001ef20: 2222 0a20 2020 2020 2020 2070 6174 6820  "".        path 
+0001ef30: 3d20 2268 7562 2f73 6f75 7263 6573 220a  = "hub/sources".
+0001ef40: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0001ef50: 7461 6e63 6528 736f 7572 6365 2c20 6d6c  tance(source, ml
+0001ef60: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+0001ef70: 6173 2e49 6e64 6578 6564 4875 6253 6f75  as.IndexedHubSou
+0001ef80: 7263 6529 3a0a 2020 2020 2020 2020 2020  rce):.          
+0001ef90: 2020 736f 7572 6365 203d 2073 6f75 7263    source = sourc
+0001efa0: 652e 6469 6374 2829 0a20 2020 2020 2020  e.dict().       
+0001efb0: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
+0001efc0: 2e61 7069 5f63 616c 6c28 6d65 7468 6f64  .api_call(method
+0001efd0: 3d22 504f 5354 222c 2070 6174 683d 7061  ="POST", path=pa
+0001efe0: 7468 2c20 6a73 6f6e 3d73 6f75 7263 6529  th, json=source)
+0001eff0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001f000: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001f010: 656d 6173 2e49 6e64 6578 6564 4875 6253  emas.IndexedHubS
+0001f020: 6f75 7263 6528 2a2a 7265 7370 6f6e 7365  ource(**response
+0001f030: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
+0001f040: 6620 7374 6f72 655f 6875 625f 736f 7572  f store_hub_sour
+0001f050: 6365 280a 2020 2020 2020 2020 7365 6c66  ce(.        self
+0001f060: 2c0a 2020 2020 2020 2020 736f 7572 6365  ,.        source
+0001f070: 5f6e 616d 653a 2073 7472 2c0a 2020 2020  _name: str,.    
+0001f080: 2020 2020 736f 7572 6365 3a20 556e 696f      source: Unio
+0001f090: 6e5b 6469 6374 2c20 6d6c 7275 6e2e 636f  n[dict, mlrun.co
+0001f0a0: 6d6d 6f6e 2e73 6368 656d 6173 2e49 6e64  mmon.schemas.Ind
+0001f0b0: 6578 6564 4875 6253 6f75 7263 655d 2c0a  exedHubSource],.
+0001f0c0: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+0001f0d0: 2222 0a20 2020 2020 2020 2043 7265 6174  "".        Creat
+0001f0e0: 6520 6f72 2072 6570 6c61 6365 2061 2068  e or replace a h
+0001f0f0: 7562 2073 6f75 7263 652e 0a20 2020 2020  ub source..     
+0001f100: 2020 2046 6f72 2061 6e20 6578 616d 706c     For an exampl
+0001f110: 6520 6f66 2074 6865 2073 6f75 7263 6520  e of the source 
+0001f120: 666f 726d 6174 2061 6e64 2065 7870 6c61  format and expla
+0001f130: 6e61 7469 6f6e 206f 6620 7468 6520 736f  nation of the so
+0001f140: 7572 6365 206f 7264 6572 206c 6f67 6963  urce order logic
+0001f150: 2c0a 2020 2020 2020 2020 706c 6561 7365  ,.        please
+0001f160: 2073 6565 203a 7079 3a66 756e 633a 607e   see :py:func:`~
+0001f170: 6372 6561 7465 5f68 7562 5f73 6f75 7263  create_hub_sourc
+0001f180: 6560 2e20 5468 6973 206d 6574 686f 6420  e`. This method 
+0001f190: 6361 6e20 6265 2075 7365 6420 746f 206d  can be used to m
+0001f1a0: 6f64 6966 7920 7468 6520 736f 7572 6365  odify the source
+0001f1b0: 2069 7473 656c 6620 6f72 2069 7473 0a20   itself or its. 
+0001f1c0: 2020 2020 2020 206f 7264 6572 2069 6e20         order in 
+0001f1d0: 7468 6520 6c69 7374 206f 6620 736f 7572  the list of sour
+0001f1e0: 6365 732e 0a0a 2020 2020 2020 2020 3a70  ces...        :p
+0001f1f0: 6172 616d 2073 6f75 7263 655f 6e61 6d65  aram source_name
+0001f200: 3a20 4e61 6d65 206f 6620 7468 6520 736f  : Name of the so
+0001f210: 7572 6365 206f 626a 6563 7420 746f 206d  urce object to m
+0001f220: 6f64 6966 792f 6372 6561 7465 2e20 4974  odify/create. It
+0001f230: 206d 7573 7420 6d61 7463 6820 7468 6520   must match the 
+0001f240: 6060 736f 7572 6365 2e6d 6574 6164 6174  ``source.metadat
+0001f250: 612e 6e61 6d65 6060 0a20 2020 2020 2020  a.name``.       
+0001f260: 2020 2020 2070 6172 616d 6574 6572 2069       parameter i
+0001f270: 6e20 7468 6520 736f 7572 6365 2069 7473  n the source its
+0001f280: 656c 662e 0a20 2020 2020 2020 203a 7061  elf..        :pa
+0001f290: 7261 6d20 736f 7572 6365 3a20 536f 7572  ram source: Sour
+0001f2a0: 6365 206f 626a 6563 7420 746f 2073 746f  ce object to sto
+0001f2b0: 7265 2069 6e20 7468 6520 6461 7461 6261  re in the databa
+0001f2c0: 7365 2e0a 2020 2020 2020 2020 3a72 6574  se..        :ret
+0001f2d0: 7572 6e73 3a20 5468 6520 736f 7572 6365  urns: The source
+0001f2e0: 206f 626a 6563 7420 6173 2073 746f 7265   object as store
+0001f2f0: 6420 696e 2074 6865 2044 422e 0a20 2020  d in the DB..   
+0001f300: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001f310: 2070 6174 6820 3d20 6622 6875 622f 736f   path = f"hub/so
+0001f320: 7572 6365 732f 7b73 6f75 7263 655f 6e61  urces/{source_na
+0001f330: 6d65 7d22 0a20 2020 2020 2020 2069 6620  me}".        if 
+0001f340: 6973 696e 7374 616e 6365 2873 6f75 7263  isinstance(sourc
+0001f350: 652c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  e, mlrun.common.
+0001f360: 7363 6865 6d61 732e 496e 6465 7865 6448  schemas.IndexedH
+0001f370: 7562 536f 7572 6365 293a 0a20 2020 2020  ubSource):.     
+0001f380: 2020 2020 2020 2073 6f75 7263 6520 3d20         source = 
+0001f390: 736f 7572 6365 2e64 6963 7428 290a 0a20  source.dict().. 
+0001f3a0: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
+0001f3b0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+0001f3c0: 6d65 7468 6f64 3d22 5055 5422 2c20 7061  method="PUT", pa
+0001f3d0: 7468 3d70 6174 682c 206a 736f 6e3d 736f  th=path, json=so
+0001f3e0: 7572 6365 290a 2020 2020 2020 2020 7265  urce).        re
+0001f3f0: 7475 726e 206d 6c72 756e 2e63 6f6d 6d6f  turn mlrun.commo
+0001f400: 6e2e 7363 6865 6d61 732e 496e 6465 7865  n.schemas.Indexe
+0001f410: 6448 7562 536f 7572 6365 282a 2a72 6573  dHubSource(**res
+0001f420: 706f 6e73 652e 6a73 6f6e 2829 290a 0a20  ponse.json()).. 
+0001f430: 2020 2064 6566 206c 6973 745f 6875 625f     def list_hub_
+0001f440: 736f 7572 6365 7328 0a20 2020 2020 2020  sources(.       
+0001f450: 2073 656c 662c 0a20 2020 2020 2020 2069   self,.        i
+0001f460: 7465 6d5f 6e61 6d65 3a20 4f70 7469 6f6e  tem_name: Option
+0001f470: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
+0001f480: 2020 2020 2020 2020 7461 673a 204f 7074          tag: Opt
+0001f490: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
+0001f4a0: 652c 0a20 2020 2020 2020 2076 6572 7369  e,.        versi
+0001f4b0: 6f6e 3a20 4f70 7469 6f6e 616c 5b73 7472  on: Optional[str
+0001f4c0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2920  ] = None,.    ) 
+0001f4d0: 2d3e 204c 6973 745b 6d6c 7275 6e2e 636f  -> List[mlrun.co
+0001f4e0: 6d6d 6f6e 2e73 6368 656d 6173 2e68 7562  mmon.schemas.hub
+0001f4f0: 2e49 6e64 6578 6564 4875 6253 6f75 7263  .IndexedHubSourc
+0001f500: 655d 3a0a 2020 2020 2020 2020 2222 220a  e]:.        """.
+0001f510: 2020 2020 2020 2020 4c69 7374 2068 7562          List hub
+0001f520: 2073 6f75 7263 6573 2069 6e20 7468 6520   sources in the 
+0001f530: 4d4c 5275 6e20 4442 2e0a 0a20 2020 2020  MLRun DB...     
+0001f540: 2020 203a 7061 7261 6d20 6974 656d 5f6e     :param item_n
+0001f550: 616d 653a 2020 2053 6f75 7263 6573 2063  ame:   Sources c
+0001f560: 6f6e 7461 696e 2074 6869 7320 6974 656d  ontain this item
+0001f570: 2077 696c 6c20 6265 2072 6574 7572 6e65   will be returne
+0001f580: 642c 2049 6620 6e6f 7420 7072 6f76 6964  d, If not provid
+0001f590: 6564 2061 6c6c 2073 6f75 7263 6573 2077  ed all sources w
+0001f5a0: 696c 6c20 6265 2072 6574 7572 6e65 642e  ill be returned.
+0001f5b0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001f5c0: 7461 673a 2020 2020 2020 2020 2049 7465  tag:         Ite
+0001f5d0: 6d20 7461 6720 746f 2066 696c 7465 7220  m tag to filter 
+0001f5e0: 6279 2c20 7375 7070 6f72 7465 6420 6f6e  by, supported on
+0001f5f0: 6c79 2069 6620 6974 656d 206e 616d 6520  ly if item name 
+0001f600: 6973 2070 726f 7669 6465 642e 0a20 2020  is provided..   
+0001f610: 2020 2020 203a 7061 7261 6d20 7665 7273       :param vers
+0001f620: 696f 6e3a 2020 2020 2049 7465 6d20 7665  ion:     Item ve
+0001f630: 7273 696f 6e20 746f 2066 696c 7465 7220  rsion to filter 
+0001f640: 6279 2c20 7375 7070 6f72 7465 6420 6f6e  by, supported on
+0001f650: 6c79 2069 6620 6974 656d 206e 616d 6520  ly if item name 
+0001f660: 6973 2070 726f 7669 6465 6420 616e 6420  is provided and 
+0001f670: 7461 6720 6973 206e 6f74 2e0a 0a20 2020  tag is not...   
+0001f680: 2020 2020 203a 7265 7475 726e 733a 204c       :returns: L
+0001f690: 6973 7420 6f66 2069 6e64 6578 6564 2068  ist of indexed h
+0001f6a0: 7562 2073 6f75 7263 6573 2e0a 2020 2020  ub sources..    
+0001f6b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001f6c0: 7061 7468 203d 2022 6875 622f 736f 7572  path = "hub/sour
+0001f6d0: 6365 7322 0a20 2020 2020 2020 2070 6172  ces".        par
+0001f6e0: 616d 7320 3d20 7b7d 0a20 2020 2020 2020  ams = {}.       
+0001f6f0: 2069 6620 6974 656d 5f6e 616d 653a 0a20   if item_name:. 
+0001f700: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0001f710: 735b 2269 7465 6d2d 6e61 6d65 225d 203d  s["item-name"] =
+0001f720: 206e 6f72 6d61 6c69 7a65 5f6e 616d 6528   normalize_name(
+0001f730: 6974 656d 5f6e 616d 6529 0a20 2020 2020  item_name).     
+0001f740: 2020 2069 6620 7461 673a 0a20 2020 2020     if tag:.     
+0001f750: 2020 2020 2020 2070 6172 616d 735b 2274         params["t
+0001f760: 6167 225d 203d 2074 6167 0a20 2020 2020  ag"] = tag.     
+0001f770: 2020 2069 6620 7665 7273 696f 6e3a 0a20     if version:. 
+0001f780: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0001f790: 735b 2276 6572 7369 6f6e 225d 203d 2076  s["version"] = v
+0001f7a0: 6572 7369 6f6e 0a20 2020 2020 2020 2072  ersion.        r
+0001f7b0: 6573 706f 6e73 6520 3d20 7365 6c66 2e61  esponse = self.a
+0001f7c0: 7069 5f63 616c 6c28 6d65 7468 6f64 3d22  pi_call(method="
+0001f7d0: 4745 5422 2c20 7061 7468 3d70 6174 682c  GET", path=path,
+0001f7e0: 2070 6172 616d 733d 7061 7261 6d73 292e   params=params).
+0001f7f0: 6a73 6f6e 2829 0a20 2020 2020 2020 2072  json().        r
+0001f800: 6573 756c 7473 203d 205b 5d0a 2020 2020  esults = [].    
+0001f810: 2020 2020 666f 7220 6974 656d 2069 6e20      for item in 
+0001f820: 7265 7370 6f6e 7365 3a0a 2020 2020 2020  response:.      
+0001f830: 2020 2020 2020 7265 7375 6c74 732e 6170        results.ap
+0001f840: 7065 6e64 286d 6c72 756e 2e63 6f6d 6d6f  pend(mlrun.commo
+0001f850: 6e2e 7363 6865 6d61 732e 496e 6465 7865  n.schemas.Indexe
+0001f860: 6448 7562 536f 7572 6365 282a 2a69 7465  dHubSource(**ite
+0001f870: 6d29 290a 2020 2020 2020 2020 7265 7475  m)).        retu
+0001f880: 726e 2072 6573 756c 7473 0a0a 2020 2020  rn results..    
+0001f890: 6465 6620 6765 745f 6875 625f 736f 7572  def get_hub_sour
+0001f8a0: 6365 2873 656c 662c 2073 6f75 7263 655f  ce(self, source_
+0001f8b0: 6e61 6d65 3a20 7374 7229 3a0a 2020 2020  name: str):.    
+0001f8c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001f8d0: 5265 7472 6965 7665 2061 2068 7562 2073  Retrieve a hub s
+0001f8e0: 6f75 7263 6520 6672 6f6d 2074 6865 2044  ource from the D
+0001f8f0: 422e 0a0a 2020 2020 2020 2020 3a70 6172  B...        :par
+0001f900: 616d 2073 6f75 7263 655f 6e61 6d65 3a20  am source_name: 
+0001f910: 4e61 6d65 206f 6620 7468 6520 6875 6220  Name of the hub 
+0001f920: 736f 7572 6365 2074 6f20 7265 7472 6965  source to retrie
+0001f930: 7665 2e0a 2020 2020 2020 2020 2222 220a  ve..        """.
+0001f940: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+0001f950: 2268 7562 2f73 6f75 7263 6573 2f7b 736f  "hub/sources/{so
+0001f960: 7572 6365 5f6e 616d 657d 220a 2020 2020  urce_name}".    
+0001f970: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
+0001f980: 656c 662e 6170 695f 6361 6c6c 286d 6574  elf.api_call(met
+0001f990: 686f 643d 2247 4554 222c 2070 6174 683d  hod="GET", path=
+0001f9a0: 7061 7468 290a 2020 2020 2020 2020 7265  path).        re
+0001f9b0: 7475 726e 206d 6c72 756e 2e63 6f6d 6d6f  turn mlrun.commo
+0001f9c0: 6e2e 7363 6865 6d61 732e 496e 6465 7865  n.schemas.Indexe
+0001f9d0: 6448 7562 536f 7572 6365 282a 2a72 6573  dHubSource(**res
+0001f9e0: 706f 6e73 652e 6a73 6f6e 2829 290a 0a20  ponse.json()).. 
+0001f9f0: 2020 2064 6566 2064 656c 6574 655f 6875     def delete_hu
+0001fa00: 625f 736f 7572 6365 2873 656c 662c 2073  b_source(self, s
+0001fa10: 6f75 7263 655f 6e61 6d65 3a20 7374 7229  ource_name: str)
+0001fa20: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0001fa30: 2020 2020 2020 4465 6c65 7465 2061 2068        Delete a h
+0001fa40: 7562 2073 6f75 7263 6520 6672 6f6d 2074  ub source from t
+0001fa50: 6865 2044 422e 0a20 2020 2020 2020 2054  he DB..        T
+0001fa60: 6865 2073 6f75 7263 6520 7769 6c6c 2062  he source will b
+0001fa70: 6520 6465 6c65 7465 6420 6672 6f6d 2074  e deleted from t
+0001fa80: 6865 206c 6973 742c 2061 6e64 2061 6e79  he list, and any
+0001fa90: 2066 6f6c 6c6f 7769 6e67 2073 6f75 7263   following sourc
+0001faa0: 6573 2077 696c 6c20 6265 2070 726f 6d6f  es will be promo
+0001fab0: 7465 6420 2d20 666f 7220 6578 616d 706c  ted - for exampl
+0001fac0: 652c 2069 6620 7468 650a 2020 2020 2020  e, if the.      
+0001fad0: 2020 3173 7420 736f 7572 6365 2069 7320    1st source is 
+0001fae0: 6465 6c65 7465 642c 2074 6865 2032 6e64  deleted, the 2nd
+0001faf0: 2073 6f75 7263 6520 7769 6c6c 2062 6563   source will bec
+0001fb00: 6f6d 6520 2331 2069 6e20 7468 6520 6c69  ome #1 in the li
+0001fb10: 7374 2e0a 2020 2020 2020 2020 5468 6520  st..        The 
+0001fb20: 676c 6f62 616c 2068 7562 2073 6f75 7263  global hub sourc
+0001fb30: 6520 6361 6e6e 6f74 2062 6520 6465 6c65  e cannot be dele
+0001fb40: 7465 642e 0a0a 2020 2020 2020 2020 3a70  ted...        :p
+0001fb50: 6172 616d 2073 6f75 7263 655f 6e61 6d65  aram source_name
+0001fb60: 3a20 4e61 6d65 206f 6620 7468 6520 6875  : Name of the hu
+0001fb70: 6220 736f 7572 6365 2074 6f20 6465 6c65  b source to dele
+0001fb80: 7465 2e0a 2020 2020 2020 2020 2222 220a  te..        """.
+0001fb90: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+0001fba0: 2268 7562 2f73 6f75 7263 6573 2f7b 736f  "hub/sources/{so
+0001fbb0: 7572 6365 5f6e 616d 657d 220a 2020 2020  urce_name}".    
+0001fbc0: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
+0001fbd0: 6c28 6d65 7468 6f64 3d22 4445 4c45 5445  l(method="DELETE
+0001fbe0: 222c 2070 6174 683d 7061 7468 290a 0a20  ", path=path).. 
+0001fbf0: 2020 2064 6566 2067 6574 5f68 7562 5f63     def get_hub_c
+0001fc00: 6174 616c 6f67 280a 2020 2020 2020 2020  atalog(.        
+0001fc10: 7365 6c66 2c0a 2020 2020 2020 2020 736f  self,.        so
+0001fc20: 7572 6365 5f6e 616d 653a 2073 7472 2c0a  urce_name: str,.
+0001fc30: 2020 2020 2020 2020 7665 7273 696f 6e3a          version:
+0001fc40: 2073 7472 203d 204e 6f6e 652c 0a20 2020   str = None,.   
+0001fc50: 2020 2020 2074 6167 3a20 7374 7220 3d20       tag: str = 
+0001fc60: 4e6f 6e65 2c0a 2020 2020 2020 2020 666f  None,.        fo
+0001fc70: 7263 655f 7265 6672 6573 683a 2062 6f6f  rce_refresh: boo
+0001fc80: 6c20 3d20 4661 6c73 652c 0a20 2020 2029  l = False,.    )
+0001fc90: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0001fca0: 2020 2020 2020 5265 7472 6965 7665 2074        Retrieve t
+0001fcb0: 6865 2069 7465 6d20 6361 7461 6c6f 6720  he item catalog 
+0001fcc0: 666f 7220 6120 7370 6563 6966 6965 6420  for a specified 
+0001fcd0: 6875 6220 736f 7572 6365 2e0a 2020 2020  hub source..    
+0001fce0: 2020 2020 5468 6520 6c69 7374 206f 6620      The list of 
+0001fcf0: 6974 656d 7320 6361 6e20 6265 2066 696c  items can be fil
+0001fd00: 7465 7265 6420 6163 636f 7264 696e 6720  tered according 
+0001fd10: 746f 2076 6172 696f 7573 2066 696c 7465  to various filte
+0001fd20: 7273 2c20 7573 696e 6720 6974 656d 2773  rs, using item's
+0001fd30: 206d 6574 6164 6174 6120 746f 2066 696c   metadata to fil
+0001fd40: 7465 722e 0a0a 2020 2020 2020 2020 3a70  ter...        :p
+0001fd50: 6172 616d 2073 6f75 7263 655f 6e61 6d65  aram source_name
+0001fd60: 3a20 4e61 6d65 206f 6620 7468 6520 736f  : Name of the so
+0001fd70: 7572 6365 2e0a 2020 2020 2020 2020 3a70  urce..        :p
+0001fd80: 6172 616d 2076 6572 7369 6f6e 3a20 4669  aram version: Fi
+0001fd90: 6c74 6572 2069 7465 6d73 2061 6363 6f72  lter items accor
+0001fda0: 6469 6e67 2074 6f20 7468 6569 7220 7665  ding to their ve
+0001fdb0: 7273 696f 6e2e 0a20 2020 2020 2020 203a  rsion..        :
+0001fdc0: 7061 7261 6d20 7461 673a 2046 696c 7465  param tag: Filte
+0001fdd0: 7220 6974 656d 7320 6261 7365 6420 6f6e  r items based on
+0001fde0: 2074 6167 2e0a 2020 2020 2020 2020 3a70   tag..        :p
+0001fdf0: 6172 616d 2066 6f72 6365 5f72 6566 7265  aram force_refre
+0001fe00: 7368 3a20 4d61 6b65 2074 6865 2073 6572  sh: Make the ser
+0001fe10: 7665 7220 6665 7463 6820 7468 6520 6361  ver fetch the ca
+0001fe20: 7461 6c6f 6720 6672 6f6d 2074 6865 2061  talog from the a
+0001fe30: 6374 7561 6c20 6875 6220 736f 7572 6365  ctual hub source
+0001fe40: 2c0a 2020 2020 2020 2020 2020 2020 7261  ,.            ra
+0001fe50: 7468 6572 2074 6861 6e20 7265 6c79 206f  ther than rely o
+0001fe60: 6e20 6361 6368 6564 2069 6e66 6f72 6d61  n cached informa
+0001fe70: 7469 6f6e 2077 6869 6368 206d 6179 2065  tion which may e
+0001fe80: 7869 7374 2066 726f 6d20 7072 6576 696f  xist from previo
+0001fe90: 7573 2067 6574 2072 6571 7565 7374 732e  us get requests.
+0001fea0: 2046 6f72 2065 7861 6d70 6c65 2c0a 2020   For example,.  
+0001feb0: 2020 2020 2020 2020 2020 6966 2074 6865            if the
+0001fec0: 2073 6f75 7263 6520 7761 7320 7265 2d62   source was re-b
+0001fed0: 7569 6c74 2c0a 2020 2020 2020 2020 2020  uilt,.          
+0001fee0: 2020 7468 6973 2077 696c 6c20 6d61 6b65    this will make
+0001fef0: 2074 6865 2073 6572 7665 7220 6765 7420   the server get 
+0001ff00: 7468 6520 7570 6461 7465 6420 696e 666f  the updated info
+0001ff10: 726d 6174 696f 6e2e 2044 6566 6175 6c74  rmation. Default
+0001ff20: 2069 7320 6060 4661 6c73 6560 602e 0a20   is ``False``.. 
+0001ff30: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
+0001ff40: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
+0001ff50: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0001ff60: 732e 6875 622e 4875 6243 6174 616c 6f67  s.hub.HubCatalog
+0001ff70: 6020 6f62 6a65 6374 2c20 7768 6963 6820  ` object, which 
+0001ff80: 6973 2065 7373 656e 7469 616c 6c79 2061  is essentially a
+0001ff90: 206c 6973 740a 2020 2020 2020 2020 2020   list.          
+0001ffa0: 2020 6f66 203a 7079 3a63 6c61 7373 3a60    of :py:class:`
+0001ffb0: 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  ~mlrun.common.sc
+0001ffc0: 6865 6d61 732e 6875 622e 4875 6249 7465  hemas.hub.HubIte
+0001ffd0: 6d60 2065 6e74 7269 6573 2e0a 2020 2020  m` entries..    
+0001ffe0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001fff0: 7061 7468 203d 2066 2268 7562 2f73 6f75  path = f"hub/sou
+00020000: 7263 6573 2f7b 736f 7572 6365 5f6e 616d  rces/{source_nam
+00020010: 657d 2f69 7465 6d73 220a 2020 2020 2020  e}/items".      
+00020020: 2020 7061 7261 6d73 203d 207b 0a20 2020    params = {.   
+00020030: 2020 2020 2020 2020 2022 7665 7273 696f           "versio
+00020040: 6e22 3a20 7665 7273 696f 6e2c 0a20 2020  n": version,.   
+00020050: 2020 2020 2020 2020 2022 7461 6722 3a20           "tag": 
+00020060: 7461 672c 0a20 2020 2020 2020 2020 2020  tag,.           
+00020070: 2022 666f 7263 652d 7265 6672 6573 6822   "force-refresh"
+00020080: 3a20 666f 7263 655f 7265 6672 6573 682c  : force_refresh,
+00020090: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+000200a0: 2020 2072 6573 706f 6e73 6520 3d20 7365     response = se
+000200b0: 6c66 2e61 7069 5f63 616c 6c28 6d65 7468  lf.api_call(meth
+000200c0: 6f64 3d22 4745 5422 2c20 7061 7468 3d70  od="GET", path=p
+000200d0: 6174 682c 2070 6172 616d 733d 7061 7261  ath, params=para
+000200e0: 6d73 290a 2020 2020 2020 2020 7265 7475  ms).        retu
+000200f0: 726e 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  rn mlrun.common.
+00020100: 7363 6865 6d61 732e 4875 6243 6174 616c  schemas.HubCatal
+00020110: 6f67 282a 2a72 6573 706f 6e73 652e 6a73  og(**response.js
+00020120: 6f6e 2829 290a 0a20 2020 2064 6566 2067  on())..    def g
+00020130: 6574 5f68 7562 5f69 7465 6d28 0a20 2020  et_hub_item(.   
+00020140: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00020150: 2020 2073 6f75 7263 655f 6e61 6d65 3a20     source_name: 
+00020160: 7374 722c 0a20 2020 2020 2020 2069 7465  str,.        ite
+00020170: 6d5f 6e61 6d65 3a20 7374 722c 0a20 2020  m_name: str,.   
+00020180: 2020 2020 2076 6572 7369 6f6e 3a20 7374       version: st
+00020190: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
+000201a0: 2020 7461 673a 2073 7472 203d 2022 6c61    tag: str = "la
+000201b0: 7465 7374 222c 0a20 2020 2020 2020 2066  test",.        f
+000201c0: 6f72 6365 5f72 6566 7265 7368 3a20 626f  orce_refresh: bo
+000201d0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+000201e0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+000201f0: 2020 2020 2020 2052 6574 7269 6576 6520         Retrieve 
+00020200: 6120 7370 6563 6966 6963 2068 7562 2069  a specific hub i
+00020210: 7465 6d2e 0a0a 2020 2020 2020 2020 3a70  tem...        :p
+00020220: 6172 616d 2073 6f75 7263 655f 6e61 6d65  aram source_name
+00020230: 3a20 4e61 6d65 206f 6620 736f 7572 6365  : Name of source
+00020240: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00020250: 2069 7465 6d5f 6e61 6d65 3a20 4e61 6d65   item_name: Name
+00020260: 206f 6620 7468 6520 6974 656d 2074 6f20   of the item to 
+00020270: 7265 7472 6965 7665 2c20 6173 2069 7420  retrieve, as it 
+00020280: 6170 7065 6172 7320 696e 2074 6865 2063  appears in the c
+00020290: 6174 616c 6f67 2e0a 2020 2020 2020 2020  atalog..        
+000202a0: 3a70 6172 616d 2076 6572 7369 6f6e 3a20  :param version: 
+000202b0: 4765 7420 6120 7370 6563 6966 6963 2076  Get a specific v
+000202c0: 6572 7369 6f6e 206f 6620 7468 6520 6974  ersion of the it
+000202d0: 656d 2e20 4465 6661 756c 7420 6973 2060  em. Default is `
+000202e0: 604e 6f6e 6560 602e 0a20 2020 2020 2020  `None``..       
+000202f0: 203a 7061 7261 6d20 7461 673a 2047 6574   :param tag: Get
+00020300: 2061 2073 7065 6369 6669 6320 7665 7273   a specific vers
+00020310: 696f 6e20 6f66 2074 6865 2069 7465 6d20  ion of the item 
+00020320: 6964 656e 7469 6669 6564 2062 7920 7461  identified by ta
+00020330: 672e 2044 6566 6175 6c74 2069 7320 6060  g. Default is ``
+00020340: 6c61 7465 7374 6060 2e0a 2020 2020 2020  latest``..      
+00020350: 2020 3a70 6172 616d 2066 6f72 6365 5f72    :param force_r
+00020360: 6566 7265 7368 3a20 4d61 6b65 2074 6865  efresh: Make the
+00020370: 2073 6572 7665 7220 6665 7463 6820 7468   server fetch th
+00020380: 6520 696e 666f 726d 6174 696f 6e20 6672  e information fr
+00020390: 6f6d 2074 6865 2061 6374 7561 6c20 6875  om the actual hu
+000203a0: 620a 2020 2020 2020 2020 2020 2020 736f  b.            so
+000203b0: 7572 6365 2c20 7261 7468 6572 2074 6861  urce, rather tha
+000203c0: 6e0a 2020 2020 2020 2020 2020 2020 7265  n.            re
+000203d0: 6c79 206f 6e20 6361 6368 6564 2069 6e66  ly on cached inf
+000203e0: 6f72 6d61 7469 6f6e 2e20 4465 6661 756c  ormation. Defaul
+000203f0: 7420 6973 2060 6046 616c 7365 6060 2e0a  t is ``False``..
+00020400: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
+00020410: 3a20 3a70 793a 636c 6173 733a 607e 6d6c  : :py:class:`~ml
+00020420: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00020430: 6173 2e68 7562 2e48 7562 4974 656d 602e  as.hub.HubItem`.
+00020440: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00020450: 2020 2020 2070 6174 6820 3d20 2866 2268       path = (f"h
+00020460: 7562 2f73 6f75 7263 6573 2f7b 736f 7572  ub/sources/{sour
+00020470: 6365 5f6e 616d 657d 2f69 7465 6d73 2f7b  ce_name}/items/{
+00020480: 6974 656d 5f6e 616d 657d 222c 290a 2020  item_name}",).  
+00020490: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
+000204a0: 0a20 2020 2020 2020 2020 2020 2022 7665  .            "ve
+000204b0: 7273 696f 6e22 3a20 7665 7273 696f 6e2c  rsion": version,
+000204c0: 0a20 2020 2020 2020 2020 2020 2022 7461  .            "ta
+000204d0: 6722 3a20 7461 672c 0a20 2020 2020 2020  g": tag,.       
+000204e0: 2020 2020 2022 666f 7263 652d 7265 6672       "force-refr
+000204f0: 6573 6822 3a20 666f 7263 655f 7265 6672  esh": force_refr
+00020500: 6573 682c 0a20 2020 2020 2020 207d 0a20  esh,.        }. 
+00020510: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
+00020520: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+00020530: 6d65 7468 6f64 3d22 4745 5422 2c20 7061  method="GET", pa
+00020540: 7468 3d70 6174 682c 2070 6172 616d 733d  th=path, params=
+00020550: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+00020560: 7265 7475 726e 206d 6c72 756e 2e63 6f6d  return mlrun.com
+00020570: 6d6f 6e2e 7363 6865 6d61 732e 4875 6249  mon.schemas.HubI
+00020580: 7465 6d28 2a2a 7265 7370 6f6e 7365 2e6a  tem(**response.j
+00020590: 736f 6e28 2929 0a0a 2020 2020 6465 6620  son())..    def 
+000205a0: 6765 745f 6875 625f 6173 7365 7428 0a20  get_hub_asset(. 
+000205b0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+000205c0: 2020 2020 2073 6f75 7263 655f 6e61 6d65       source_name
+000205d0: 3a20 7374 722c 0a20 2020 2020 2020 2069  : str,.        i
+000205e0: 7465 6d5f 6e61 6d65 3a20 7374 722c 0a20  tem_name: str,. 
+000205f0: 2020 2020 2020 2061 7373 6574 5f6e 616d         asset_nam
+00020600: 653a 2073 7472 2c0a 2020 2020 2020 2020  e: str,.        
+00020610: 7665 7273 696f 6e3a 2073 7472 203d 204e  version: str = N
+00020620: 6f6e 652c 0a20 2020 2020 2020 2074 6167  one,.        tag
+00020630: 3a20 7374 7220 3d20 226c 6174 6573 7422  : str = "latest"
+00020640: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+00020650: 2022 2222 0a20 2020 2020 2020 2047 6574   """.        Get
+00020660: 2068 7562 2061 7373 6574 2066 726f 6d20   hub asset from 
+00020670: 6974 656d 2e0a 0a20 2020 2020 2020 203a  item...        :
+00020680: 7061 7261 6d20 736f 7572 6365 5f6e 616d  param source_nam
+00020690: 653a 204e 616d 6520 6f66 2073 6f75 7263  e: Name of sourc
+000206a0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+000206b0: 6d20 6974 656d 5f6e 616d 653a 2020 204e  m item_name:   N
+000206c0: 616d 6520 6f66 2074 6865 2069 7465 6d20  ame of the item 
+000206d0: 7768 6963 6820 686f 6c64 7320 7468 6520  which holds the 
+000206e0: 6173 7365 742e 0a20 2020 2020 2020 203a  asset..        :
+000206f0: 7061 7261 6d20 6173 7365 745f 6e61 6d65  param asset_name
+00020700: 3a20 204e 616d 6520 6f66 2074 6865 2061  :  Name of the a
+00020710: 7373 6574 2074 6f20 7265 7472 6965 7665  sset to retrieve
+00020720: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00020730: 2076 6572 7369 6f6e 3a20 4765 7420 6120   version: Get a 
+00020740: 7370 6563 6966 6963 2076 6572 7369 6f6e  specific version
+00020750: 206f 6620 7468 6520 6974 656d 2e20 4465   of the item. De
+00020760: 6661 756c 7420 6973 2060 604e 6f6e 6560  fault is ``None`
+00020770: 602e 0a20 2020 2020 2020 203a 7061 7261  `..        :para
+00020780: 6d20 7461 673a 2047 6574 2061 2073 7065  m tag: Get a spe
+00020790: 6369 6669 6320 7665 7273 696f 6e20 6f66  cific version of
+000207a0: 2074 6865 2069 7465 6d20 6964 656e 7469   the item identi
+000207b0: 6669 6564 2062 7920 7461 672e 2044 6566  fied by tag. Def
+000207c0: 6175 6c74 2069 7320 6060 6c61 7465 7374  ault is ``latest
+000207d0: 6060 2e0a 0a20 2020 2020 2020 203a 7265  ``...        :re
+000207e0: 7475 726e 3a20 6874 7470 2072 6573 706f  turn: http respo
+000207f0: 6e73 6520 7769 7468 2074 6865 2061 7373  nse with the ass
+00020800: 6574 2069 6e20 7468 6520 636f 6e74 656e  et in the conten
+00020810: 7420 6174 7472 6962 7574 650a 2020 2020  t attribute.    
+00020820: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00020830: 7061 7468 203d 2066 2268 7562 2f73 6f75  path = f"hub/sou
+00020840: 7263 6573 2f7b 736f 7572 6365 5f6e 616d  rces/{source_nam
+00020850: 657d 2f69 7465 6d73 2f7b 6974 656d 5f6e  e}/items/{item_n
+00020860: 616d 657d 2f61 7373 6574 732f 7b61 7373  ame}/assets/{ass
+00020870: 6574 5f6e 616d 657d 220a 2020 2020 2020  et_name}".      
+00020880: 2020 7061 7261 6d73 203d 207b 0a20 2020    params = {.   
+00020890: 2020 2020 2020 2020 2022 7665 7273 696f           "versio
+000208a0: 6e22 3a20 7665 7273 696f 6e2c 0a20 2020  n": version,.   
+000208b0: 2020 2020 2020 2020 2022 7461 6722 3a20           "tag": 
+000208c0: 7461 672c 0a20 2020 2020 2020 207d 0a20  tag,.        }. 
+000208d0: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
+000208e0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+000208f0: 6d65 7468 6f64 3d22 4745 5422 2c20 7061  method="GET", pa
+00020900: 7468 3d70 6174 682c 2070 6172 616d 733d  th=path, params=
+00020910: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+00020920: 7265 7475 726e 2072 6573 706f 6e73 650a  return response.
+00020930: 0a20 2020 2064 6566 2076 6572 6966 795f  .    def verify_
+00020940: 6175 7468 6f72 697a 6174 696f 6e28 0a20  authorization(. 
+00020950: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00020960: 2020 2020 2061 7574 686f 7269 7a61 7469       authorizati
+00020970: 6f6e 5f76 6572 6966 6963 6174 696f 6e5f  on_verification_
+00020980: 696e 7075 743a 206d 6c72 756e 2e63 6f6d  input: mlrun.com
+00020990: 6d6f 6e2e 7363 6865 6d61 732e 4175 7468  mon.schemas.Auth
+000209a0: 6f72 697a 6174 696f 6e56 6572 6966 6963  orizationVerific
+000209b0: 6174 696f 6e49 6e70 7574 2c0a 2020 2020  ationInput,.    
+000209c0: 293a 0a20 2020 2020 2020 2022 2222 5665  ):.        """Ve
+000209d0: 7269 6669 6573 2061 7574 686f 7269 7a61  rifies authoriza
+000209e0: 7469 6f6e 2066 6f72 2074 6865 2070 726f  tion for the pro
+000209f0: 7669 6465 6420 6163 7469 6f6e 206f 6e20  vided action on 
+00020a00: 7468 6520 7072 6f76 6964 6564 2072 6573  the provided res
+00020a10: 6f75 7263 652e 0a0a 2020 2020 2020 2020  ource...        
+00020a20: 3a70 6172 616d 2061 7574 686f 7269 7a61  :param authoriza
+00020a30: 7469 6f6e 5f76 6572 6966 6963 6174 696f  tion_verificatio
+00020a40: 6e5f 696e 7075 743a 2049 6e73 7461 6e63  n_input: Instanc
+00020a50: 6520 6f66 0a20 2020 2020 2020 2020 2020  e of.           
+00020a60: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
+00020a70: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00020a80: 732e 4175 7468 6f72 697a 6174 696f 6e56  s.AuthorizationV
+00020a90: 6572 6966 6963 6174 696f 6e49 6e70 7574  erificationInput
+00020aa0: 6020 7468 6174 2069 6e63 6c75 6465 7320  ` that includes 
+00020ab0: 616c 6c20 7468 6520 6e65 6564 6564 2070  all the needed p
+00020ac0: 6172 616d 6574 6572 7320 666f 720a 2020  arameters for.  
+00020ad0: 2020 2020 2020 2020 2020 7468 6520 6175            the au
+00020ae0: 7468 2076 6572 6966 6963 6174 696f 6e0a  th verification.
+00020af0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00020b00: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+00020b10: 6520 3d20 2241 7574 686f 7269 7a61 7469  e = "Authorizati
+00020b20: 6f6e 2063 6865 636b 2066 6169 6c65 6422  on check failed"
+00020b30: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
+00020b40: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
+00020b50: 2020 2020 2250 4f53 5422 2c0a 2020 2020      "POST",.    
+00020b60: 2020 2020 2020 2020 2261 7574 686f 7269          "authori
+00020b70: 7a61 7469 6f6e 2f76 6572 6966 6963 6174  zation/verificat
+00020b80: 696f 6e73 222c 0a20 2020 2020 2020 2020  ions",.         
+00020b90: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+00020ba0: 2c0a 2020 2020 2020 2020 2020 2020 626f  ,.            bo
+00020bb0: 6479 3d64 6963 745f 746f 5f6a 736f 6e28  dy=dict_to_json(
+00020bc0: 6175 7468 6f72 697a 6174 696f 6e5f 7665  authorization_ve
+00020bd0: 7269 6669 6361 7469 6f6e 5f69 6e70 7574  rification_input
+00020be0: 2e64 6963 7428 2929 2c0a 2020 2020 2020  .dict()),.      
+00020bf0: 2020 290a 0a20 2020 2064 6566 2074 7269    )..    def tri
+00020c00: 6767 6572 5f6d 6967 7261 7469 6f6e 7328  gger_migrations(
+00020c10: 7365 6c66 2920 2d3e 204f 7074 696f 6e61  self) -> Optiona
+00020c20: 6c5b 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  l[mlrun.common.s
+00020c30: 6368 656d 6173 2e42 6163 6b67 726f 756e  chemas.Backgroun
+00020c40: 6454 6173 6b5d 3a0a 2020 2020 2020 2020  dTask]:.        
+00020c50: 2222 2254 7269 6767 6572 206d 6967 7261  """Trigger migra
+00020c60: 7469 6f6e 7320 2877 696c 6c20 646f 206e  tions (will do n
+00020c70: 6f74 6869 6e67 2069 6620 6e6f 206d 6967  othing if no mig
+00020c80: 7261 7469 6f6e 7320 6172 6520 6e65 6564  rations are need
+00020c90: 6564 2920 616e 6420 7761 6974 2066 6f72  ed) and wait for
+00020ca0: 2074 6865 6d20 746f 2066 696e 6973 6820   them to finish 
+00020cb0: 6966 2061 6374 7561 6c6c 790a 2020 2020  if actually.    
+00020cc0: 2020 2020 7472 6967 6765 7265 640a 2020      triggered.  
+00020cd0: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
+00020ce0: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
+00020cf0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+00020d00: 2e42 6163 6b67 726f 756e 6454 6173 6b60  .BackgroundTask`
+00020d10: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00020d20: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
+00020d30: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
+00020d40: 2020 2020 2020 2020 2020 2020 2250 4f53              "POS
+00020d50: 5422 2c0a 2020 2020 2020 2020 2020 2020  T",.            
+00020d60: 226f 7065 7261 7469 6f6e 732f 6d69 6772  "operations/migr
+00020d70: 6174 696f 6e73 222c 0a20 2020 2020 2020  ations",.       
+00020d80: 2020 2020 2022 4661 696c 6564 2074 7269       "Failed tri
+00020d90: 6767 6572 696e 6720 6d69 6772 6174 696f  ggering migratio
+00020da0: 6e73 222c 0a20 2020 2020 2020 2029 0a20  ns",.        ). 
+00020db0: 2020 2020 2020 2069 6620 7265 7370 6f6e         if respon
+00020dc0: 7365 2e73 7461 7475 735f 636f 6465 203d  se.status_code =
+00020dd0: 3d20 6874 7470 2e48 5454 5053 7461 7475  = http.HTTPStatu
+00020de0: 732e 4143 4345 5054 4544 3a0a 2020 2020  s.ACCEPTED:.    
+00020df0: 2020 2020 2020 2020 6261 636b 6772 6f75          backgrou
+00020e00: 6e64 5f74 6173 6b20 3d20 6d6c 7275 6e2e  nd_task = mlrun.
+00020e10: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e42  common.schemas.B
+00020e20: 6163 6b67 726f 756e 6454 6173 6b28 2a2a  ackgroundTask(**
+00020e30: 7265 7370 6f6e 7365 2e6a 736f 6e28 2929  response.json())
+00020e40: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00020e50: 7572 6e20 7365 6c66 2e5f 7761 6974 5f66  urn self._wait_f
+00020e60: 6f72 5f62 6163 6b67 726f 756e 645f 7461  or_background_ta
+00020e70: 736b 5f74 6f5f 7265 6163 685f 7465 726d  sk_to_reach_term
+00020e80: 696e 616c 5f73 7461 7465 280a 2020 2020  inal_state(.    
+00020e90: 2020 2020 2020 2020 2020 2020 6261 636b              back
+00020ea0: 6772 6f75 6e64 5f74 6173 6b2e 6d65 7461  ground_task.meta
+00020eb0: 6461 7461 2e6e 616d 650a 2020 2020 2020  data.name.      
+00020ec0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00020ed0: 7265 7475 726e 204e 6f6e 650a 0a20 2020  return None..   
+00020ee0: 2064 6566 2073 6574 5f72 756e 5f6e 6f74   def set_run_not
+00020ef0: 6966 6963 6174 696f 6e73 280a 2020 2020  ifications(.    
+00020f00: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00020f10: 2020 7072 6f6a 6563 743a 2073 7472 2c0a    project: str,.
+00020f20: 2020 2020 2020 2020 7275 6e5f 7569 643a          run_uid:
+00020f30: 2073 7472 2c0a 2020 2020 2020 2020 6e6f   str,.        no
+00020f40: 7469 6669 6361 7469 6f6e 733a 2074 7970  tifications: typ
+00020f50: 696e 672e 4c69 7374 5b6d 6c72 756e 2e6d  ing.List[mlrun.m
+00020f60: 6f64 656c 2e4e 6f74 6966 6963 6174 696f  odel.Notificatio
+00020f70: 6e5d 203d 204e 6f6e 652c 0a20 2020 2029  n] = None,.    )
+00020f80: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00020f90: 2020 2020 2020 5365 7420 6e6f 7469 6669        Set notifi
+00020fa0: 6361 7469 6f6e 7320 6f6e 2061 2072 756e  cations on a run
+00020fb0: 2e20 5468 6973 2077 696c 6c20 6f76 6572  . This will over
+00020fc0: 7269 6465 2061 6e79 2065 7869 7374 696e  ride any existin
+00020fd0: 6720 6e6f 7469 6669 6361 7469 6f6e 7320  g notifications 
+00020fe0: 6f6e 2074 6865 2072 756e 2e0a 2020 2020  on the run..    
+00020ff0: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+00021000: 6374 3a20 5072 6f6a 6563 7420 636f 6e74  ct: Project cont
+00021010: 6169 6e69 6e67 2074 6865 2072 756e 2e0a  aining the run..
+00021020: 2020 2020 2020 2020 3a70 6172 616d 2072          :param r
+00021030: 756e 5f75 6964 3a20 5549 4420 6f66 2074  un_uid: UID of t
+00021040: 6865 2072 756e 2e0a 2020 2020 2020 2020  he run..        
+00021050: 3a70 6172 616d 206e 6f74 6966 6963 6174  :param notificat
+00021060: 696f 6e73 3a20 4c69 7374 206f 6620 6e6f  ions: List of no
+00021070: 7469 6669 6361 7469 6f6e 7320 746f 2073  tifications to s
+00021080: 6574 206f 6e20 7468 6520 7275 6e2e 2044  et on the run. D
+00021090: 6566 6175 6c74 2069 7320 616e 2065 6d70  efault is an emp
+000210a0: 7479 206c 6973 742e 0a20 2020 2020 2020  ty list..       
+000210b0: 2022 2222 0a20 2020 2020 2020 206e 6f74   """.        not
+000210c0: 6966 6963 6174 696f 6e73 203d 206e 6f74  ifications = not
+000210d0: 6966 6963 6174 696f 6e73 206f 7220 5b5d  ifications or []
+000210e0: 0a0a 2020 2020 2020 2020 7365 6c66 2e61  ..        self.a
+000210f0: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
+00021100: 2020 2020 2022 5055 5422 2c0a 2020 2020       "PUT",.    
+00021110: 2020 2020 2020 2020 6622 7072 6f6a 6563          f"projec
+00021120: 7473 2f7b 7072 6f6a 6563 747d 2f72 756e  ts/{project}/run
+00021130: 732f 7b72 756e 5f75 6964 7d2f 6e6f 7469  s/{run_uid}/noti
+00021140: 6669 6361 7469 6f6e 7322 2c0a 2020 2020  fications",.    
+00021150: 2020 2020 2020 2020 6622 4661 696c 6564          f"Failed
+00021160: 2074 6f20 7365 7420 6e6f 7469 6669 6361   to set notifica
+00021170: 7469 6f6e 7320 6f6e 2072 756e 2e20 7569  tions on run. ui
+00021180: 643d 7b72 756e 5f75 6964 7d2c 2070 726f  d={run_uid}, pro
+00021190: 6a65 6374 3d7b 7072 6f6a 6563 747d 222c  ject={project}",
+000211a0: 0a20 2020 2020 2020 2020 2020 206a 736f  .            jso
+000211b0: 6e3d 7b0a 2020 2020 2020 2020 2020 2020  n={.            
+000211c0: 2020 2020 226e 6f74 6966 6963 6174 696f      "notificatio
+000211d0: 6e73 223a 205b 0a20 2020 2020 2020 2020  ns": [.         
+000211e0: 2020 2020 2020 2020 2020 206e 6f74 6966             notif
+000211f0: 6963 6174 696f 6e2e 746f 5f64 6963 7428  ication.to_dict(
+00021200: 2920 666f 7220 6e6f 7469 6669 6361 7469  ) for notificati
+00021210: 6f6e 2069 6e20 6e6f 7469 6669 6361 7469  on in notificati
+00021220: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
+00021230: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
+00021240: 2020 207d 2c0a 2020 2020 2020 2020 290a     },.        ).
+00021250: 0a20 2020 2064 6566 2073 6574 5f73 6368  .    def set_sch
+00021260: 6564 756c 655f 6e6f 7469 6669 6361 7469  edule_notificati
+00021270: 6f6e 7328 0a20 2020 2020 2020 2073 656c  ons(.        sel
+00021280: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
+00021290: 6374 3a20 7374 722c 0a20 2020 2020 2020  ct: str,.       
+000212a0: 2073 6368 6564 756c 655f 6e61 6d65 3a20   schedule_name: 
+000212b0: 7374 722c 0a20 2020 2020 2020 206e 6f74  str,.        not
+000212c0: 6966 6963 6174 696f 6e73 3a20 7479 7069  ifications: typi
+000212d0: 6e67 2e4c 6973 745b 6d6c 7275 6e2e 6d6f  ng.List[mlrun.mo
+000212e0: 6465 6c2e 4e6f 7469 6669 6361 7469 6f6e  del.Notification
+000212f0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 293a  ] = None,.    ):
+00021300: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00021310: 2020 2020 2053 6574 206e 6f74 6966 6963       Set notific
+00021320: 6174 696f 6e73 206f 6e20 6120 7363 6865  ations on a sche
+00021330: 6475 6c65 2e20 5468 6973 2077 696c 6c20  dule. This will 
+00021340: 6f76 6572 7269 6465 2061 6e79 2065 7869  override any exi
+00021350: 7374 696e 6720 6e6f 7469 6669 6361 7469  sting notificati
+00021360: 6f6e 7320 6f6e 2074 6865 2073 6368 6564  ons on the sched
+00021370: 756c 652e 0a20 2020 2020 2020 203a 7061  ule..        :pa
+00021380: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
+00021390: 6a65 6374 2063 6f6e 7461 696e 696e 6720  ject containing 
+000213a0: 7468 6520 7363 6865 6475 6c65 2e0a 2020  the schedule..  
+000213b0: 2020 2020 2020 3a70 6172 616d 2073 6368        :param sch
+000213c0: 6564 756c 655f 6e61 6d65 3a20 4e61 6d65  edule_name: Name
+000213d0: 206f 6620 7468 6520 7363 6865 6475 6c65   of the schedule
+000213e0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000213f0: 206e 6f74 6966 6963 6174 696f 6e73 3a20   notifications: 
+00021400: 4c69 7374 206f 6620 6e6f 7469 6669 6361  List of notifica
+00021410: 7469 6f6e 7320 746f 2073 6574 206f 6e20  tions to set on 
+00021420: 7468 6520 7363 6865 6475 6c65 2e20 4465  the schedule. De
+00021430: 6661 756c 7420 6973 2061 6e20 656d 7074  fault is an empt
+00021440: 7920 6c69 7374 2e0a 2020 2020 2020 2020  y list..        
+00021450: 2222 220a 2020 2020 2020 2020 6e6f 7469  """.        noti
+00021460: 6669 6361 7469 6f6e 7320 3d20 6e6f 7469  fications = noti
+00021470: 6669 6361 7469 6f6e 7320 6f72 205b 5d0a  fications or [].
+00021480: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
+00021490: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
+000214a0: 2020 2020 2250 5554 222c 0a20 2020 2020      "PUT",.     
+000214b0: 2020 2020 2020 2066 2270 726f 6a65 6374         f"project
+000214c0: 732f 7b70 726f 6a65 6374 7d2f 7363 6865  s/{project}/sche
+000214d0: 6475 6c65 732f 7b73 6368 6564 756c 655f  dules/{schedule_
+000214e0: 6e61 6d65 7d2f 6e6f 7469 6669 6361 7469  name}/notificati
+000214f0: 6f6e 7322 2c0a 2020 2020 2020 2020 2020  ons",.          
+00021500: 2020 6622 4661 696c 6564 2074 6f20 7365    f"Failed to se
+00021510: 7420 6e6f 7469 6669 6361 7469 6f6e 7320  t notifications 
+00021520: 6f6e 2073 6368 6564 756c 652e 2073 6368  on schedule. sch
+00021530: 6564 756c 653d 7b73 6368 6564 756c 655f  edule={schedule_
+00021540: 6e61 6d65 7d2c 2070 726f 6a65 6374 3d7b  name}, project={
+00021550: 7072 6f6a 6563 747d 222c 0a20 2020 2020  project}",.     
+00021560: 2020 2020 2020 206a 736f 6e3d 7b0a 2020         json={.  
+00021570: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+00021580: 6f74 6966 6963 6174 696f 6e73 223a 205b  otifications": [
+00021590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000215a0: 2020 2020 206e 6f74 6966 6963 6174 696f       notificatio
+000215b0: 6e2e 746f 5f64 6963 7428 2920 666f 7220  n.to_dict() for 
+000215c0: 6e6f 7469 6669 6361 7469 6f6e 2069 6e20  notification in 
+000215d0: 6e6f 7469 6669 6361 7469 6f6e 730a 2020  notifications.  
+000215e0: 2020 2020 2020 2020 2020 2020 2020 5d2c                ],
+000215f0: 0a20 2020 2020 2020 2020 2020 207d 2c0a  .            },.
+00021600: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00021610: 6566 2073 746f 7265 5f72 756e 5f6e 6f74  ef store_run_not
+00021620: 6966 6963 6174 696f 6e73 280a 2020 2020  ifications(.    
+00021630: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00021640: 2020 6e6f 7469 6669 6361 7469 6f6e 5f6f    notification_o
+00021650: 626a 6563 7473 3a20 7479 7069 6e67 2e4c  bjects: typing.L
+00021660: 6973 745b 6d6c 7275 6e2e 6d6f 6465 6c2e  ist[mlrun.model.
+00021670: 4e6f 7469 6669 6361 7469 6f6e 5d2c 0a20  Notification],. 
+00021680: 2020 2020 2020 2072 756e 5f75 6964 3a20         run_uid: 
+00021690: 7374 722c 0a20 2020 2020 2020 2070 726f  str,.        pro
+000216a0: 6a65 6374 3a20 7374 7220 3d20 4e6f 6e65  ject: str = None
+000216b0: 2c0a 2020 2020 2020 2020 6d61 736b 5f70  ,.        mask_p
+000216c0: 6172 616d 733a 2062 6f6f 6c20 3d20 5472  arams: bool = Tr
+000216d0: 7565 2c0a 2020 2020 293a 0a20 2020 2020  ue,.    ):.     
+000216e0: 2020 2022 2222 0a20 2020 2020 2020 2046     """.        F
+000216f0: 6f72 2069 6e74 6572 6e61 6c20 7573 652e  or internal use.
+00021700: 0a20 2020 2020 2020 2054 6865 206e 6f74  .        The not
+00021710: 6966 6963 6174 696f 6e20 6d65 6368 616e  ification mechan
+00021720: 6973 6d20 6d61 7920 7275 6e20 226c 6f63  ism may run "loc
+00021730: 616c 6c79 2220 666f 7220 6365 7274 6169  ally" for certai
+00021740: 6e20 7275 6e74 696d 6573 2e0a 2020 2020  n runtimes..    
+00021750: 2020 2020 486f 7765 7665 722c 2074 6865      However, the
+00021760: 2075 7064 6174 6573 206f 6363 7572 2069   updates occur i
+00021770: 6e20 7468 6520 4150 4920 736f 206e 6f74  n the API so not
+00021780: 6869 6e67 2074 6f20 646f 2068 6572 652e  hing to do here.
+00021790: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000217a0: 2020 2020 2070 6173 730a 0a20 2020 2064       pass..    d
+000217b0: 6566 2073 7562 6d69 745f 776f 726b 666c  ef submit_workfl
+000217c0: 6f77 280a 2020 2020 2020 2020 7365 6c66  ow(.        self
+000217d0: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+000217e0: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
+000217f0: 6e61 6d65 3a20 7374 722c 0a20 2020 2020  name: str,.     
+00021800: 2020 2077 6f72 6b66 6c6f 775f 7370 6563     workflow_spec
+00021810: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
+00021820: 2020 2020 206d 6c72 756e 2e70 726f 6a65       mlrun.proje
+00021830: 6374 732e 7069 7065 6c69 6e65 732e 576f  cts.pipelines.Wo
+00021840: 726b 666c 6f77 5370 6563 2c0a 2020 2020  rkflowSpec,.    
+00021850: 2020 2020 2020 2020 6d6c 7275 6e2e 636f          mlrun.co
+00021860: 6d6d 6f6e 2e73 6368 656d 6173 2e57 6f72  mmon.schemas.Wor
+00021870: 6b66 6c6f 7753 7065 632c 0a20 2020 2020  kflowSpec,.     
+00021880: 2020 2020 2020 2064 6963 742c 0a20 2020         dict,.   
+00021890: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+000218a0: 6172 6775 6d65 6e74 733a 204f 7074 696f  arguments: Optio
+000218b0: 6e61 6c5b 4469 6374 5d20 3d20 4e6f 6e65  nal[Dict] = None
+000218c0: 2c0a 2020 2020 2020 2020 6172 7469 6661  ,.        artifa
+000218d0: 6374 5f70 6174 683a 204f 7074 696f 6e61  ct_path: Optiona
+000218e0: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
+000218f0: 2020 2020 2020 2073 6f75 7263 653a 204f         source: O
+00021900: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+00021910: 6f6e 652c 0a20 2020 2020 2020 2072 756e  one,.        run
+00021920: 5f6e 616d 653a 204f 7074 696f 6e61 6c5b  _name: Optional[
+00021930: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+00021940: 2020 2020 206e 616d 6573 7061 6365 3a20       namespace: 
+00021950: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+00021960: 4e6f 6e65 2c0a 2020 2020 293a 0a20 2020  None,.    ):.   
+00021970: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00021980: 2053 7562 6d69 7474 696e 6720 776f 726b   Submitting work
+00021990: 666c 6f77 2066 6f72 2061 2072 656d 6f74  flow for a remot
+000219a0: 6520 6578 6563 7574 696f 6e2e 0a0a 2020  e execution...  
+000219b0: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
+000219c0: 6a65 6374 3a20 2020 2020 2020 2020 7072  ject:         pr
+000219d0: 6f6a 6563 7420 6e61 6d65 0a20 2020 2020  oject name.     
+000219e0: 2020 203a 7061 7261 6d20 6e61 6d65 3a20     :param name: 
+000219f0: 2020 2020 2020 2020 2020 2077 6f72 6b66             workf
+00021a00: 6c6f 7720 6e61 6d65 0a20 2020 2020 2020  low name.       
+00021a10: 203a 7061 7261 6d20 776f 726b 666c 6f77   :param workflow
+00021a20: 5f73 7065 633a 2020 2074 6865 2077 6f72  _spec:   the wor
+00021a30: 6b66 6c6f 7720 7370 6563 2074 6f20 6578  kflow spec to ex
+00021a40: 6563 7574 650a 2020 2020 2020 2020 3a70  ecute.        :p
+00021a50: 6172 616d 2061 7267 756d 656e 7473 3a20  aram arguments: 
+00021a60: 2020 2020 2020 6172 6775 6d65 6e74 7320        arguments 
+00021a70: 666f 7220 7468 6520 776f 726b 666c 6f77  for the workflow
+00021a80: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00021a90: 6172 7469 6661 6374 5f70 6174 683a 2020  artifact_path:  
+00021aa0: 2061 7274 6966 6163 7420 7461 7267 6574   artifact target
+00021ab0: 2070 6174 6820 6f66 2074 6865 2077 6f72   path of the wor
+00021ac0: 6b66 6c6f 770a 2020 2020 2020 2020 3a70  kflow.        :p
+00021ad0: 6172 616d 2073 6f75 7263 653a 2020 2020  aram source:    
+00021ae0: 2020 2020 2020 736f 7572 6365 2075 726c        source url
+00021af0: 206f 6620 7468 6520 7072 6f6a 6563 740a   of the project.
+00021b00: 2020 2020 2020 2020 3a70 6172 616d 2072          :param r
+00021b10: 756e 5f6e 616d 653a 2020 2020 2020 2020  un_name:        
+00021b20: 7275 6e20 6e61 6d65 2074 6f20 6f76 6572  run name to over
+00021b30: 7269 6465 2074 6865 2064 6566 6175 6c74  ride the default
+00021b40: 3a20 2777 6f72 6b66 6c6f 772d 7275 6e6e  : 'workflow-runn
+00021b50: 6572 2d3c 776f 726b 666c 6f77 206e 616d  er-<workflow nam
+00021b60: 653e 270a 2020 2020 2020 2020 3a70 6172  e>'.        :par
+00021b70: 616d 206e 616d 6573 7061 6365 3a20 2020  am namespace:   
+00021b80: 2020 2020 6b75 6265 726e 6574 6573 206e      kubernetes n
+00021b90: 616d 6573 7061 6365 2069 6620 6f74 6865  amespace if othe
+00021ba0: 7220 7468 616e 2064 6566 6175 6c74 0a0a  r than default..
+00021bb0: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
+00021bc0: 3a20 2020 203a 7079 3a63 6c61 7373 3a60  :    :py:class:`
+00021bd0: 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  ~mlrun.common.sc
+00021be0: 6865 6d61 732e 576f 726b 666c 6f77 5265  hemas.WorkflowRe
+00021bf0: 7370 6f6e 7365 602e 0a20 2020 2020 2020  sponse`..       
+00021c00: 2022 2222 0a20 2020 2020 2020 2069 6d61   """.        ima
+00021c10: 6765 203d 2028 0a20 2020 2020 2020 2020  ge = (.         
+00021c20: 2020 2077 6f72 6b66 6c6f 775f 7370 6563     workflow_spec
+00021c30: 2e69 6d61 6765 0a20 2020 2020 2020 2020  .image.         
+00021c40: 2020 2069 6620 6861 7361 7474 7228 776f     if hasattr(wo
+00021c50: 726b 666c 6f77 5f73 7065 632c 2022 696d  rkflow_spec, "im
+00021c60: 6167 6522 290a 2020 2020 2020 2020 2020  age").          
+00021c70: 2020 656c 7365 2077 6f72 6b66 6c6f 775f    else workflow_
+00021c80: 7370 6563 2e67 6574 2822 696d 6167 6522  spec.get("image"
+00021c90: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+00021ca0: 290a 2020 2020 2020 2020 7265 7120 3d20  ).        req = 
+00021cb0: 7b0a 2020 2020 2020 2020 2020 2020 2261  {.            "a
+00021cc0: 7267 756d 656e 7473 223a 2061 7267 756d  rguments": argum
+00021cd0: 656e 7473 2c0a 2020 2020 2020 2020 2020  ents,.          
+00021ce0: 2020 2261 7274 6966 6163 745f 7061 7468    "artifact_path
+00021cf0: 223a 2061 7274 6966 6163 745f 7061 7468  ": artifact_path
+00021d00: 2c0a 2020 2020 2020 2020 2020 2020 2273  ,.            "s
+00021d10: 6f75 7263 6522 3a20 736f 7572 6365 2c0a  ource": source,.
+00021d20: 2020 2020 2020 2020 2020 2020 2272 756e              "run
+00021d30: 5f6e 616d 6522 3a20 7275 6e5f 6e61 6d65  _name": run_name
+00021d40: 2c0a 2020 2020 2020 2020 2020 2020 226e  ,.            "n
+00021d50: 616d 6573 7061 6365 223a 206e 616d 6573  amespace": names
+00021d60: 7061 6365 2c0a 2020 2020 2020 2020 7d0a  pace,.        }.
+00021d70: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00021d80: 7461 6e63 6528 776f 726b 666c 6f77 5f73  tance(workflow_s
+00021d90: 7065 632c 206d 6c72 756e 2e63 6f6d 6d6f  pec, mlrun.commo
+00021da0: 6e2e 7363 6865 6d61 732e 576f 726b 666c  n.schemas.Workfl
+00021db0: 6f77 5370 6563 293a 0a20 2020 2020 2020  owSpec):.       
+00021dc0: 2020 2020 2072 6571 5b22 7370 6563 225d       req["spec"]
+00021dd0: 203d 2077 6f72 6b66 6c6f 775f 7370 6563   = workflow_spec
+00021de0: 2e64 6963 7428 290a 2020 2020 2020 2020  .dict().        
+00021df0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+00021e00: 776f 726b 666c 6f77 5f73 7065 632c 206d  workflow_spec, m
+00021e10: 6c72 756e 2e70 726f 6a65 6374 732e 7069  lrun.projects.pi
+00021e20: 7065 6c69 6e65 732e 576f 726b 666c 6f77  pelines.Workflow
+00021e30: 5370 6563 293a 0a20 2020 2020 2020 2020  Spec):.         
+00021e40: 2020 2072 6571 5b22 7370 6563 225d 203d     req["spec"] =
+00021e50: 2077 6f72 6b66 6c6f 775f 7370 6563 2e74   workflow_spec.t
+00021e60: 6f5f 6469 6374 2829 0a20 2020 2020 2020  o_dict().       
+00021e70: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00021e80: 2020 2072 6571 5b22 7370 6563 225d 203d     req["spec"] =
+00021e90: 2077 6f72 6b66 6c6f 775f 7370 6563 0a20   workflow_spec. 
+00021ea0: 2020 2020 2020 2072 6571 5b22 7370 6563         req["spec
+00021eb0: 225d 5b22 696d 6167 6522 5d20 3d20 696d  "]["image"] = im
+00021ec0: 6167 650a 2020 2020 2020 2020 7265 7370  age.        resp
+00021ed0: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
+00021ee0: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+00021ef0: 2020 2250 4f53 5422 2c0a 2020 2020 2020    "POST",.      
+00021f00: 2020 2020 2020 6622 7072 6f6a 6563 7473        f"projects
+00021f10: 2f7b 7072 6f6a 6563 747d 2f77 6f72 6b66  /{project}/workf
+00021f20: 6c6f 7773 2f7b 6e61 6d65 7d2f 7375 626d  lows/{name}/subm
+00021f30: 6974 222c 0a20 2020 2020 2020 2020 2020  it",.           
+00021f40: 206a 736f 6e3d 7265 712c 0a20 2020 2020   json=req,.     
+00021f50: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+00021f60: 7572 6e20 6d6c 7275 6e2e 636f 6d6d 6f6e  urn mlrun.common
+00021f70: 2e73 6368 656d 6173 2e57 6f72 6b66 6c6f  .schemas.Workflo
+00021f80: 7752 6573 706f 6e73 6528 2a2a 7265 7370  wResponse(**resp
+00021f90: 6f6e 7365 2e6a 736f 6e28 2929 0a0a 2020  onse.json())..  
+00021fa0: 2020 6465 6620 6765 745f 776f 726b 666c    def get_workfl
+00021fb0: 6f77 5f69 6428 0a20 2020 2020 2020 2073  ow_id(.        s
+00021fc0: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
+00021fd0: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
+00021fe0: 2020 206e 616d 653a 2073 7472 2c0a 2020     name: str,.  
+00021ff0: 2020 2020 2020 7275 6e5f 6964 3a20 7374        run_id: st
+00022000: 722c 0a20 2020 2020 2020 2065 6e67 696e  r,.        engin
+00022010: 653a 2073 7472 203d 2022 222c 0a20 2020  e: str = "",.   
+00022020: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
+00022030: 2020 2020 2020 2020 5265 7472 6965 7665          Retrieve
+00022040: 2077 6f72 6b66 6c6f 7720 6964 2066 726f   workflow id fro
+00022050: 6d20 7468 6520 7569 6420 6f66 2074 6865  m the uid of the
+00022060: 2077 6f72 6b66 6c6f 7720 7275 6e6e 6572   workflow runner
+00022070: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00022080: 6d20 7072 6f6a 6563 743a 2070 726f 6a65  m project: proje
+00022090: 6374 206e 616d 650a 2020 2020 2020 2020  ct name.        
+000220a0: 3a70 6172 616d 206e 616d 653a 2020 2020  :param name:    
+000220b0: 776f 726b 666c 6f77 206e 616d 650a 2020  workflow name.  
+000220c0: 2020 2020 2020 3a70 6172 616d 2072 756e        :param run
+000220d0: 5f69 643a 2020 7468 6520 6964 206f 6620  _id:  the id of 
+000220e0: 7468 6520 776f 726b 666c 6f77 2072 756e  the workflow run
+000220f0: 6e65 7220 2d20 7468 6520 6a6f 6220 7468  ner - the job th
+00022100: 6174 2072 756e 7320 7468 6520 776f 726b  at runs the work
+00022110: 666c 6f77 0a20 2020 2020 2020 203a 7061  flow.        :pa
+00022120: 7261 6d20 656e 6769 6e65 3a20 2070 6970  ram engine:  pip
+00022130: 656c 696e 6520 7275 6e6e 6572 0a0a 2020  eline runner..  
+00022140: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
+00022150: 2020 3a70 793a 636c 6173 733a 607e 6d6c    :py:class:`~ml
+00022160: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00022170: 6173 2e47 6574 576f 726b 666c 6f77 5265  as.GetWorkflowRe
+00022180: 7370 6f6e 7365 602e 0a20 2020 2020 2020  sponse`..       
+00022190: 2022 2222 0a20 2020 2020 2020 2070 6172   """.        par
+000221a0: 616d 7320 3d20 7b7d 0a20 2020 2020 2020  ams = {}.       
+000221b0: 2069 6620 656e 6769 6e65 3a0a 2020 2020   if engine:.    
+000221c0: 2020 2020 2020 2020 7061 7261 6d73 5b22          params["
+000221d0: 656e 6769 6e65 225d 203d 2065 6e67 696e  engine"] = engin
+000221e0: 650a 2020 2020 2020 2020 7265 7370 6f6e  e.        respon
+000221f0: 7365 203d 2073 656c 662e 6170 695f 6361  se = self.api_ca
+00022200: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
+00022210: 2247 4554 222c 0a20 2020 2020 2020 2020  "GET",.         
+00022220: 2020 2066 2270 726f 6a65 6374 732f 7b70     f"projects/{p
+00022230: 726f 6a65 6374 7d2f 776f 726b 666c 6f77  roject}/workflow
+00022240: 732f 7b6e 616d 657d 2f72 756e 732f 7b72  s/{name}/runs/{r
+00022250: 756e 5f69 647d 222c 0a20 2020 2020 2020  un_id}",.       
+00022260: 2020 2020 2070 6172 616d 733d 7061 7261       params=para
+00022270: 6d73 2c0a 2020 2020 2020 2020 290a 2020  ms,.        ).  
+00022280: 2020 2020 2020 7265 7475 726e 206d 6c72        return mlr
+00022290: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+000222a0: 732e 4765 7457 6f72 6b66 6c6f 7752 6573  s.GetWorkflowRes
+000222b0: 706f 6e73 6528 2a2a 7265 7370 6f6e 7365  ponse(**response
+000222c0: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
+000222d0: 6620 6c6f 6164 5f70 726f 6a65 6374 280a  f load_project(.
+000222e0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+000222f0: 2020 2020 2020 6e61 6d65 3a20 7374 722c        name: str,
+00022300: 0a20 2020 2020 2020 2075 726c 3a20 7374  .        url: st
+00022310: 722c 0a20 2020 2020 2020 2073 6563 7265  r,.        secre
+00022320: 7473 3a20 4f70 7469 6f6e 616c 5b44 6963  ts: Optional[Dic
+00022330: 745d 203d 204e 6f6e 652c 0a20 2020 2020  t] = None,.     
+00022340: 2020 2073 6176 655f 7365 6372 6574 733a     save_secrets:
+00022350: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
+00022360: 2020 2920 2d3e 2073 7472 3a0a 2020 2020    ) -> str:.    
+00022370: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00022380: 4c6f 6164 696e 6720 6120 7072 6f6a 6563  Loading a projec
+00022390: 7420 7265 6d6f 7465 6c79 2066 726f 6d20  t remotely from 
+000223a0: 7468 6520 6769 7665 6e20 736f 7572 6365  the given source
+000223b0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000223c0: 206e 616d 653a 2020 2020 2020 2020 2020   name:          
+000223d0: 2020 7072 6f6a 6563 7420 6e61 6d65 0a20    project name. 
+000223e0: 2020 2020 2020 203a 7061 7261 6d20 7572         :param ur
+000223f0: 6c3a 2020 2020 2020 2020 2020 2020 2067  l:             g
+00022400: 6974 206f 7220 7461 722e 677a 206f 7220  it or tar.gz or 
+00022410: 2e7a 6970 2073 6f75 7263 6573 2061 7263  .zip sources arc
+00022420: 6869 7665 2070 6174 6820 652e 672e 3a0a  hive path e.g.:.
+00022430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022450: 6769 743a 2f2f 6769 7468 7562 2e63 6f6d  git://github.com
+00022460: 2f6d 6c72 756e 2f64 656d 6f2d 7867 622d  /mlrun/demo-xgb-
+00022470: 7072 6f6a 6563 742e 6769 740a 2020 2020  project.git.    
+00022480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022490: 2020 2020 2020 2020 2020 2020 6874 7470              http
+000224a0: 3a2f 2f6d 7973 6974 652f 6172 6368 6976  ://mysite/archiv
+000224b0: 6564 2d70 726f 6a65 6374 2e7a 6970 0a20  ed-project.zip. 
+000224c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000224d0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+000224e0: 6865 2067 6974 2070 726f 6a65 6374 2073  he git project s
+000224f0: 686f 756c 6420 696e 636c 7564 6520 7468  hould include th
+00022500: 6520 7072 6f6a 6563 7420 7961 6d6c 2066  e project yaml f
+00022510: 696c 652e 0a20 2020 2020 2020 203a 7061  ile..        :pa
+00022520: 7261 6d20 7365 6372 6574 733a 2020 2020  ram secrets:    
+00022530: 2020 2020 2053 6563 7265 7473 2074 6f20       Secrets to 
+00022540: 7374 6f72 6520 696e 2070 726f 6a65 6374  store in project
+00022550: 2069 6e20 6f72 6465 7220 746f 206c 6f61   in order to loa
+00022560: 6420 6974 2066 726f 6d20 7468 6520 7072  d it from the pr
+00022570: 6f76 6964 6564 2075 726c 2e0a 2020 2020  ovided url..    
+00022580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022590: 2020 2020 2020 2020 2020 2020 466f 7220              For 
+000225a0: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
+000225b0: 2073 6565 203a 7079 3a66 756e 633a 606d   see :py:func:`m
+000225c0: 6c72 756e 2e6c 6f61 645f 7072 6f6a 6563  lrun.load_projec
+000225d0: 7460 2066 756e 6374 696f 6e2e 0a20 2020  t` function..   
+000225e0: 2020 2020 203a 7061 7261 6d20 7361 7665       :param save
+000225f0: 5f73 6563 7265 7473 3a20 2020 2057 6865  _secrets:    Whe
+00022600: 7468 6572 2074 6f20 7374 6f72 6520 7365  ther to store se
+00022610: 6372 6574 7320 696e 2074 6865 206c 6f61  crets in the loa
+00022620: 6465 6420 7072 6f6a 6563 742e 0a20 2020  ded project..   
+00022630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022640: 2020 2020 2020 2020 2020 2020 2053 6574               Set
+00022650: 7469 6e67 2074 6f20 4661 6c73 6520 7769  ting to False wi
+00022660: 6c6c 2063 6175 7365 2077 6169 7469 6e67  ll cause waiting
+00022670: 2066 6f72 2074 6865 2070 726f 6365 7373   for the process
+00022680: 2063 6f6d 706c 6574 696f 6e2e 0a0a 2020   completion...  
+00022690: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
+000226a0: 2020 2020 2020 2020 2020 2020 2020 5468                Th
+000226b0: 6520 7465 726d 696e 616c 2073 7461 7465  e terminal state
+000226c0: 206f 6620 6c6f 6164 2070 726f 6a65 6374   of load project
+000226d0: 2070 726f 6365 7373 2e0a 2020 2020 2020   process..      
+000226e0: 2020 2222 220a 2020 2020 2020 2020 7061    """.        pa
+000226f0: 7261 6d73 203d 207b 2275 726c 223a 2075  rams = {"url": u
+00022700: 726c 7d0a 2020 2020 2020 2020 626f 6479  rl}.        body
+00022710: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+00022720: 6966 2073 6563 7265 7473 3a0a 2020 2020  if secrets:.    
+00022730: 2020 2020 2020 2020 7072 6f76 6964 6572          provider
+00022740: 203d 206d 6c72 756e 2e63 6f6d 6d6f 6e2e   = mlrun.common.
+00022750: 7363 6865 6d61 732e 5365 6372 6574 5072  schemas.SecretPr
+00022760: 6f76 6964 6572 4e61 6d65 2e6b 7562 6572  oviderName.kuber
+00022770: 6e65 7465 730a 2020 2020 2020 2020 2020  netes.          
+00022780: 2020 7365 6372 6574 735f 696e 7075 7420    secrets_input 
+00022790: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
+000227a0: 6368 656d 6173 2e53 6563 7265 7473 4461  chemas.SecretsDa
+000227b0: 7461 280a 2020 2020 2020 2020 2020 2020  ta(.            
+000227c0: 2020 2020 7072 6f76 6964 6572 3d70 726f      provider=pro
+000227d0: 7669 6465 722c 2073 6563 7265 7473 3d73  vider, secrets=s
+000227e0: 6563 7265 7473 0a20 2020 2020 2020 2020  ecrets.         
+000227f0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00022800: 2062 6f64 7920 3d20 7365 6372 6574 735f   body = secrets_
+00022810: 696e 7075 742e 6469 6374 2829 0a20 2020  input.dict().   
+00022820: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
+00022830: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+00022840: 2020 2020 2020 2020 2020 2022 504f 5354             "POST
+00022850: 222c 2066 2270 726f 6a65 6374 732f 7b6e  ", f"projects/{n
+00022860: 616d 657d 2f6c 6f61 6422 2c20 7061 7261  ame}/load", para
+00022870: 6d73 3d70 6172 616d 732c 2062 6f64 793d  ms=params, body=
+00022880: 6469 6374 5f74 6f5f 6a73 6f6e 2862 6f64  dict_to_json(bod
+00022890: 7929 0a20 2020 2020 2020 2029 0a20 2020  y).        ).   
+000228a0: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
+000228b0: 7265 7370 6f6e 7365 2e6a 736f 6e28 290a  response.json().
+000228c0: 2020 2020 2020 2020 7275 6e20 3d20 6d6c          run = ml
+000228d0: 7275 6e2e 5275 6e4f 626a 6563 742e 6672  run.RunObject.fr
+000228e0: 6f6d 5f64 6963 7428 7265 7370 6f6e 7365  om_dict(response
+000228f0: 5b22 6461 7461 225d 290a 2020 2020 2020  ["data"]).      
+00022900: 2020 7374 6174 652c 205f 203d 2072 756e    state, _ = run
+00022910: 2e6c 6f67 7328 290a 0a20 2020 2020 2020  .logs()..       
+00022920: 2069 6620 7365 6372 6574 7320 616e 6420   if secrets and 
+00022930: 6e6f 7420 7361 7665 5f73 6563 7265 7473  not save_secrets
+00022940: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00022950: 6c66 2e64 656c 6574 655f 7072 6f6a 6563  lf.delete_projec
+00022960: 745f 7365 6372 6574 7328 7072 6f6a 6563  t_secrets(projec
+00022970: 743d 6e61 6d65 2c20 7365 6372 6574 733d  t=name, secrets=
+00022980: 6c69 7374 2873 6563 7265 7473 2e6b 6579  list(secrets.key
+00022990: 7328 2929 290a 2020 2020 2020 2020 2020  s())).          
+000229a0: 2020 6966 2073 7461 7465 2021 3d20 2263    if state != "c
+000229b0: 6f6d 706c 6574 6564 223a 0a20 2020 2020  ompleted":.     
+000229c0: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
+000229d0: 722e 6572 726f 7228 224c 6f61 6420 7072  r.error("Load pr
+000229e0: 6f6a 6563 7420 7461 736b 2066 6169 6c65  oject task faile
+000229f0: 642c 2064 656c 6574 696e 6720 7072 6f6a  d, deleting proj
+00022a00: 6563 7422 290a 2020 2020 2020 2020 2020  ect").          
+00022a10: 2020 2020 2020 7365 6c66 2e64 656c 6574        self.delet
+00022a20: 655f 7072 6f6a 6563 7428 6e61 6d65 2c20  e_project(name, 
+00022a30: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00022a40: 656d 6173 2e44 656c 6574 696f 6e53 7472  emas.DeletionStr
+00022a50: 6174 6567 792e 6361 7363 6164 6529 0a0a  ategy.cascade)..
+00022a60: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00022a70: 7461 7465 0a0a 2020 2020 6465 6620 6765  tate..    def ge
+00022a80: 745f 6461 7461 7374 6f72 655f 7072 6f66  t_datastore_prof
+00022a90: 696c 6528 0a20 2020 2020 2020 2073 656c  ile(.        sel
+00022aa0: 662c 206e 616d 653a 2073 7472 2c20 7072  f, name: str, pr
+00022ab0: 6f6a 6563 743a 2073 7472 0a20 2020 2029  oject: str.    )
+00022ac0: 202d 3e20 4f70 7469 6f6e 616c 5b6d 6c72   -> Optional[mlr
+00022ad0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00022ae0: 732e 4461 7461 7374 6f72 6550 726f 6669  s.DatastoreProfi
+00022af0: 6c65 5d3a 0a20 2020 2020 2020 2070 726f  le]:.        pro
+00022b00: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
+00022b10: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
+00022b20: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
+00022b30: 2070 6174 6820 3d20 7365 6c66 2e5f 7061   path = self._pa
+00022b40: 7468 5f6f 6628 2270 726f 6a65 6374 7322  th_of("projects"
+00022b50: 2c20 7072 6f6a 6563 742c 2022 6461 7461  , project, "data
+00022b60: 7374 6f72 655f 7072 6f66 696c 6573 2229  store_profiles")
+00022b70: 202b 2066 222f 7b6e 616d 657d 220a 0a20   + f"/{name}".. 
+00022b80: 2020 2020 2020 2072 6573 203d 2073 656c         res = sel
+00022b90: 662e 6170 695f 6361 6c6c 286d 6574 686f  f.api_call(metho
+00022ba0: 643d 2247 4554 222c 2070 6174 683d 7061  d="GET", path=pa
+00022bb0: 7468 290a 2020 2020 2020 2020 6966 2072  th).        if r
+00022bc0: 6573 2061 6e64 2072 6573 2e5f 636f 6e74  es and res._cont
+00022bd0: 656e 743a 0a20 2020 2020 2020 2020 2020  ent:.           
+00022be0: 2070 7562 6c69 635f 7772 6170 7065 7220   public_wrapper 
+00022bf0: 3d20 6a73 6f6e 2e6c 6f61 6473 2872 6573  = json.loads(res
+00022c00: 2e5f 636f 6e74 656e 7429 0a20 2020 2020  ._content).     
+00022c10: 2020 2020 2020 2064 6174 6173 746f 7265         datastore
+00022c20: 203d 2044 6174 6173 746f 7265 5072 6f66   = DatastoreProf
+00022c30: 696c 6532 4a73 6f6e 2e63 7265 6174 655f  ile2Json.create_
+00022c40: 6672 6f6d 5f6a 736f 6e28 0a20 2020 2020  from_json(.     
+00022c50: 2020 2020 2020 2020 2020 2070 7562 6c69             publi
+00022c60: 635f 6a73 6f6e 3d70 7562 6c69 635f 7772  c_json=public_wr
+00022c70: 6170 7065 725b 2262 6f64 7922 5d0a 2020  apper["body"].  
+00022c80: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00022c90: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+00022ca0: 6174 6173 746f 7265 0a20 2020 2020 2020  atastore.       
+00022cb0: 2072 6574 7572 6e20 4e6f 6e65 0a0a 2020   return None..  
+00022cc0: 2020 6465 6620 6465 6c65 7465 5f64 6174    def delete_dat
+00022cd0: 6173 746f 7265 5f70 726f 6669 6c65 2873  astore_profile(s
+00022ce0: 656c 662c 206e 616d 653a 2073 7472 2c20  elf, name: str, 
+00022cf0: 7072 6f6a 6563 743a 2073 7472 293a 0a20  project: str):. 
+00022d00: 2020 2020 2020 2070 6173 730a 0a20 2020         pass..   
+00022d10: 2064 6566 206c 6973 745f 6461 7461 7374   def list_datast
+00022d20: 6f72 655f 7072 6f66 696c 6528 0a20 2020  ore_profile(.   
+00022d30: 2020 2020 2073 656c 662c 2070 726f 6a65       self, proje
+00022d40: 6374 3a20 7374 720a 2020 2020 2920 2d3e  ct: str.    ) ->
+00022d50: 204c 6973 745b 6d6c 7275 6e2e 636f 6d6d   List[mlrun.comm
+00022d60: 6f6e 2e73 6368 656d 6173 2e44 6174 6173  on.schemas.Datas
+00022d70: 746f 7265 5072 6f66 696c 655d 3a0a 2020  toreProfile]:.  
+00022d80: 2020 2020 2020 7061 7373 0a0a 2020 2020        pass..    
+00022d90: 6465 6620 7374 6f72 655f 6461 7461 7374  def store_datast
+00022da0: 6f72 655f 7072 6f66 696c 6528 0a20 2020  ore_profile(.   
+00022db0: 2020 2020 2073 656c 662c 2070 726f 6669       self, profi
+00022dc0: 6c65 3a20 6d6c 7275 6e2e 636f 6d6d 6f6e  le: mlrun.common
+00022dd0: 2e73 6368 656d 6173 2e44 6174 6173 746f  .schemas.Datasto
+00022de0: 7265 5072 6f66 696c 652c 2070 726f 6a65  reProfile, proje
+00022df0: 6374 3a20 7374 720a 2020 2020 293a 0a20  ct: str.    ):. 
+00022e00: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00022e10: 2020 2043 7265 6174 6520 6f72 2072 6570     Create or rep
+00022e20: 6c61 6365 2061 2064 6174 6173 746f 7265  lace a datastore
+00022e30: 2070 726f 6669 6c65 2e0a 2020 2020 2020   profile..      
+00022e40: 2020 3a72 6574 7572 6e73 3a20 4e6f 6e65    :returns: None
+00022e50: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00022e60: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
+00022e70: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
+00022e80: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
+00022e90: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+00022ea0: 7365 6c66 2e5f 7061 7468 5f6f 6628 2270  self._path_of("p
+00022eb0: 726f 6a65 6374 7322 2c20 7072 6f6a 6563  rojects", projec
+00022ec0: 742c 2022 6461 7461 7374 6f72 655f 7072  t, "datastore_pr
+00022ed0: 6f66 696c 6573 2229 0a0a 2020 2020 2020  ofiles")..      
+00022ee0: 2020 7365 6c66 2e61 7069 5f63 616c 6c28    self.api_call(
+00022ef0: 6d65 7468 6f64 3d22 5055 5422 2c20 7061  method="PUT", pa
+00022f00: 7468 3d70 6174 682c 2062 6f64 793d 6a73  th=path, body=js
+00022f10: 6f6e 2e64 756d 7073 2870 726f 6669 6c65  on.dumps(profile
+00022f20: 2e64 6963 7428 2929 290a 0a0a 6465 6620  .dict()))...def 
+00022f30: 5f61 735f 6a73 6f6e 286f 626a 293a 0a20  _as_json(obj):. 
+00022f40: 2020 2066 6e20 3d20 6765 7461 7474 7228     fn = getattr(
+00022f50: 6f62 6a2c 2022 746f 5f6a 736f 6e22 2c20  obj, "to_json", 
+00022f60: 4e6f 6e65 290a 2020 2020 6966 2066 6e3a  None).    if fn:
+00022f70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00022f80: 666e 2829 0a20 2020 2072 6574 7572 6e20  fn().    return 
+00022f90: 6469 6374 5f74 6f5f 6a73 6f6e 286f 626a  dict_to_json(obj
+00022fa0: 290a                                     ).
```

## mlrun/db/nopdb.py

```diff
@@ -452,15 +452,20 @@
     def store_hub_source(
         self,
         source_name: str,
         source: Union[dict, mlrun.common.schemas.IndexedHubSource],
     ):
         pass
 
-    def list_hub_sources(self):
+    def list_hub_sources(
+        self,
+        item_name: Optional[str] = None,
+        tag: Optional[str] = None,
+        version: Optional[str] = None,
+    ):
         pass
 
     def get_hub_source(self, source_name: str):
         pass
 
     def delete_hub_source(self, source_name: str):
         pass
@@ -487,7 +492,25 @@
         pass
 
     def verify_authorization(
         self,
         authorization_verification_input: mlrun.common.schemas.AuthorizationVerificationInput,
     ):
         pass
+
+    def get_datastore_profile(
+        self, name: str, project: str
+    ) -> Optional[mlrun.common.schemas.DatastoreProfile]:
+        pass
+
+    def delete_datastore_profile(self, name: str, project: str):
+        pass
+
+    def list_datastore_profile(
+        self, project: str
+    ) -> List[mlrun.common.schemas.DatastoreProfile]:
+        pass
+
+    def store_datastore_profile(
+        self, profile: mlrun.common.schemas.DatastoreProfile, project: str
+    ):
+        pass
```

## mlrun/feature_store/retrieval/base.py

```diff
@@ -194,17 +194,22 @@
         keys = (
             []
         )  # the struct of key is [[[],[]], ..] So that each record indicates which way the corresponding
         # featureset is connected to the previous one, and within each record the left keys are indicated in index 0
         # and the right keys in index 1, this keys will be the keys that will be used in this join
         join_types = []
 
-        entity_rows_keys = (
-            list(entity_rows.columns) if entity_rows is not None else None
-        )
+        if entity_rows is not None:
+            if entity_rows.index.names[0]:
+                entity_rows.reset_index(
+                    inplace=True,
+                )
+            entity_rows_keys = list(entity_rows.columns)
+        else:
+            entity_rows_keys = None
         join_graph = self._get_graph(
             feature_set_objects, feature_set_fields, entity_rows_keys
         )
         if entity_rows_keys:
             entity_rows = self._convert_entity_rows_to_engine_df(entity_rows)
             dfs.append(entity_rows)
             keys.append([[], []])
```

## mlrun/model_monitoring/__init__.py

```diff
@@ -15,7 +15,8 @@
 # flake8: noqa  - this is until we take care of the F401 violations with respect to __all__ & sphinx
 # for backwards compatibility
 
 
 from .helpers import get_stream_path
 from .model_endpoint import ModelEndpoint
 from .stores import ModelEndpointStore, ModelEndpointStoreType, get_model_endpoint_store
+from .tracking_policy import TrackingPolicy
```

## mlrun/model_monitoring/features_drift_table.py

```diff
@@ -14,15 +14,18 @@
 #
 from typing import Dict, List, Tuple, Union
 
 import numpy as np
 import plotly.graph_objects as go
 from plotly.subplots import make_subplots
 
-from mlrun.model_monitoring.model_monitoring_batch import DriftResultType, DriftStatus
+import mlrun.common.schemas.model_monitoring
+
+# A type for representing a drift result, a tuple of the status and the drift mean:
+DriftResultType = Tuple[mlrun.common.schemas.model_monitoring.DriftStatus, float]
 
 
 class FeaturesDriftTablePlot:
     """
     Class for producing a features drift table. The plot is a table with columns of all the statistics and metrics
     provided with two additional plot columns of the histograms and drift notification. The rows content will be drawn
     per feature.
@@ -52,17 +55,17 @@
 
     # Histograms configurations:
     _SAMPLE_SET_HISTOGRAM_COLOR = "rgb(0,112,192)"  # Blue
     _INPUTS_HISTOGRAM_COLOR = "rgb(208,0,106)"  # Magenta
 
     # Notification configurations:
     _NOTIFICATION_COLORS = {
-        DriftStatus.NO_DRIFT: "rgb(0,176,80)",  # Green
-        DriftStatus.POSSIBLE_DRIFT: "rgb(255,192,0)",  # Orange
-        DriftStatus.DRIFT_DETECTED: "rgb(208,0,106)",  # Magenta
+        mlrun.common.schemas.model_monitoring.DriftStatus.NO_DRIFT: "rgb(0,176,80)",  # Green
+        mlrun.common.schemas.model_monitoring.DriftStatus.POSSIBLE_DRIFT: "rgb(255,192,0)",  # Orange
+        mlrun.common.schemas.model_monitoring.DriftStatus.DRIFT_DETECTED: "rgb(208,0,106)",  # Magenta
     }
 
     # Font configurations:
     _FONT_SIZE = 10
     _FONT_COLOR = "rgb(68,68,68)"  # Dark Grey
 
     # General configurations:
```

## mlrun/model_monitoring/model_monitoring_batch.py

```diff
@@ -14,15 +14,14 @@
 #
 import collections
 import dataclasses
 import datetime
 import json
 import os
 import re
-from enum import Enum
 from typing import Any, ClassVar, Dict, List, Optional, Tuple, Union
 
 import numpy as np
 import pandas as pd
 import v3io
 import v3io.dataplane
 import v3io_frames
@@ -31,27 +30,16 @@
 import mlrun.common.model_monitoring.helpers
 import mlrun.common.schemas.model_monitoring
 import mlrun.data_types.infer
 import mlrun.feature_store as fstore
 import mlrun.utils.v3io_clients
 from mlrun.utils import logger
 
-
-class DriftStatus(Enum):
-    """
-    Enum for the drift status values.
-    """
-
-    NO_DRIFT = "NO_DRIFT"
-    DRIFT_DETECTED = "DRIFT_DETECTED"
-    POSSIBLE_DRIFT = "POSSIBLE_DRIFT"
-
-
 # A type for representing a drift result, a tuple of the status and the drift mean:
-DriftResultType = Tuple[DriftStatus, float]
+DriftResultType = Tuple[mlrun.common.schemas.model_monitoring.DriftStatus, float]
 
 
 @dataclasses.dataclass
 class TotalVarianceDistance:
     """
     Provides a symmetric drift distance between two periods t and u
     Z - vector of random variables
@@ -365,14 +353,16 @@
         for feature, results in metrics_results_dictionary.items():
             # A feature result must be a dictionary, otherwise it's the total mean (float):
             if not isinstance(results, dict):
                 continue
             # Calculate the feature's drift mean:
             tvd = results[TotalVarianceDistance.NAME]
             hellinger = results[HellingerDistance.NAME]
+            if not tvd or not hellinger:
+                continue
             metrics_results_dictionary = (tvd + hellinger) / 2
             # Decision rule for drift detection:
             drift_status = VirtualDrift._get_drift_status(
                 drift_result=metrics_results_dictionary,
                 possible_drift_threshold=possible_drift_threshold,
                 drift_detected_threshold=drift_detected_threshold,
             )
@@ -422,29 +412,33 @@
         return drift_status, drift_result
 
     @staticmethod
     def _get_drift_status(
         drift_result: float,
         possible_drift_threshold: float,
         drift_detected_threshold: float,
-    ) -> DriftStatus:
+    ) -> mlrun.common.schemas.model_monitoring.DriftStatus:
         """
         Get the drift status according to the result and thresholds given.
 
         :param drift_result:             The drift result.
         :param possible_drift_threshold: Threshold for the calculated result to be in a possible drift status.
         :param drift_detected_threshold: Threshold for the calculated result to be in a drift detected status.
 
         :returns: The figured drift status.
         """
-        drift_status = DriftStatus.NO_DRIFT
+        drift_status = mlrun.common.schemas.model_monitoring.DriftStatus.NO_DRIFT
         if drift_result >= drift_detected_threshold:
-            drift_status = DriftStatus.DRIFT_DETECTED
+            drift_status = (
+                mlrun.common.schemas.model_monitoring.DriftStatus.DRIFT_DETECTED
+            )
         elif drift_result >= possible_drift_threshold:
-            drift_status = DriftStatus.POSSIBLE_DRIFT
+            drift_status = (
+                mlrun.common.schemas.model_monitoring.DriftStatus.POSSIBLE_DRIFT
+            )
 
         return drift_status
 
 
 def calculate_inputs_statistics(
     sample_set_statistics: dict, inputs: pd.DataFrame
 ) -> dict:
@@ -535,14 +529,19 @@
         ]
 
         # TODO: This will be removed in 1.5.0 once the job params can be parsed with different types
         # Convert batch dict string into a dictionary
         if isinstance(self.batch_dict, str):
             self._parse_batch_dict_str()
 
+        # If provided, only model endpoints in that that list will be analyzed
+        self.model_endpoints = context.parameters.get(
+            mlrun.common.schemas.model_monitoring.EventFieldType.MODEL_ENDPOINTS, None
+        )
+
     def _initialize_v3io_configurations(self):
         self.v3io_access_key = os.environ.get("V3IO_ACCESS_KEY")
         self.model_monitoring_access_key = (
             os.environ.get("MODEL_MONITORING_ACCESS_KEY") or self.v3io_access_key
         )
 
         # Define the required paths for the project objects
@@ -603,16 +602,18 @@
         pass
 
     def run(self):
         """
         Main method for manage the drift analysis and write the results into tsdb and KV table.
         """
         # Get model endpoints (each deployed project has at least 1 serving model):
+
         try:
-            endpoints = self.db.list_model_endpoints()
+            endpoints = self.db.list_model_endpoints(uids=self.model_endpoints)
+
         except Exception as e:
             logger.error("Failed to list endpoints", exc=e)
             return
 
         for endpoint in endpoints:
             if (
                 endpoint[mlrun.common.schemas.model_monitoring.EventFieldType.ACTIVE]
@@ -635,34 +636,20 @@
                         f"{endpoint[mlrun.common.schemas.model_monitoring.EventFieldType.UID]} is router skipping"
                     )
                     continue
                 self.update_drift_metrics(endpoint=endpoint)
 
     def update_drift_metrics(self, endpoint: dict):
         try:
-            # Convert feature set into dataframe and get the latest dataset
-            (
-                _,
-                serving_function_name,
-                _,
-                _,
-            ) = mlrun.common.helpers.parse_versioned_object_uri(
+            m_fs = fstore.get_feature_set(
                 endpoint[
-                    mlrun.common.schemas.model_monitoring.EventFieldType.FUNCTION_URI
+                    mlrun.common.schemas.model_monitoring.EventFieldType.FEATURE_SET_URI
                 ]
             )
 
-            model_name = endpoint[
-                mlrun.common.schemas.model_monitoring.EventFieldType.MODEL
-            ].replace(":", "-")
-
-            m_fs = fstore.get_feature_set(
-                f"store://feature-sets/{self.project}/monitoring-{serving_function_name}-{model_name}"
-            )
-
             # Getting batch interval start time and end time
             start_time, end_time = self._get_interval_range()
 
             try:
                 df = m_fs.to_dataframe(
                     start_time=start_time,
                     end_time=end_time,
@@ -715,15 +702,17 @@
                 mlrun.common.schemas.model_monitoring.EventFieldType.LABEL_NAMES
             ]:
                 labels = endpoint[
                     mlrun.common.schemas.model_monitoring.EventFieldType.LABEL_NAMES
                 ]
                 if isinstance(labels, str):
                     labels = json.loads(labels)
-                stats_columns.extend(labels)
+                for label in labels:
+                    if label not in stats_columns:
+                        stats_columns.append(label)
             named_features_df = df[stats_columns].copy()
 
             # Infer feature set stats and schema
             fstore.api._infer_from_static_df(
                 named_features_df,
                 m_fs,
                 options=mlrun.data_types.infer.InferOptions.all_stats(),
@@ -862,15 +851,15 @@
         for pair in batch_list:
             pair_list = pair.split(":")
             self.batch_dict[pair_list[0]] = float(pair_list[1])
 
     def _update_drift_in_v3io_tsdb(
         self,
         endpoint_id: str,
-        drift_status: DriftStatus,
+        drift_status: mlrun.common.schemas.model_monitoring.DriftStatus,
         drift_measure: float,
         drift_result: Dict[str, Dict[str, Any]],
         timestamp: pd._libs.tslibs.timestamps.Timestamp,
     ):
         """Update drift results in input stream.
 
         :param endpoint_id:   The unique id of the model endpoint.
@@ -879,16 +868,18 @@
                               Hellinger distance.
         :param drift_result:  A dictionary that includes the drift results for each feature.
         :param timestamp:     Pandas Timestamp value.
 
         """
 
         if (
-            drift_status == DriftStatus.POSSIBLE_DRIFT
-            or drift_status == DriftStatus.DRIFT_DETECTED
+            drift_status
+            == mlrun.common.schemas.model_monitoring.DriftStatus.POSSIBLE_DRIFT
+            or drift_status
+            == mlrun.common.schemas.model_monitoring.DriftStatus.DRIFT_DETECTED
         ):
             self.v3io.stream.put_records(
                 container=self.stream_container,
                 stream_path=self.stream_path,
                 records=[
                     {
                         "data": json.dumps(
@@ -930,15 +921,15 @@
                 tsdb_path=self.tsdb_path,
                 endpoint=endpoint_id,
             )
 
     def _update_drift_in_prometheus(
         self,
         endpoint_id: str,
-        drift_status: DriftStatus,
+        drift_status: mlrun.common.schemas.model_monitoring.DriftStatus,
         drift_result: Dict[str, Dict[str, Any]],
     ):
         """Push drift metrics to Prometheus registry. Please note that the metrics are being pushed through HTTP
         to the monitoring stream pod that writes them into a local registry. Afterwards, Prometheus wil scrape these
         metrics that will be available in the Grafana charts.
 
         :param endpoint_id:   The unique id of the model endpoint.
```

## mlrun/package/context_handler.py

```diff
@@ -13,22 +13,23 @@
 # limitations under the License.
 #
 import inspect
 import os
 from collections import OrderedDict
 from typing import Dict, List, Union
 
+from mlrun import mlconf
 from mlrun.datastore import DataItem
 from mlrun.errors import MLRunInvalidArgumentError
 from mlrun.execution import MLClientCtx
 from mlrun.run import get_or_create_ctx
 
 from .errors import MLRunPackageCollectionError, MLRunPackagePackingError
 from .packagers_manager import PackagersManager
-from .utils import ArtifactType, LogHintKey, LogHintUtils, TypeHintUtils
+from .utils import LogHintUtils, TypeHintUtils
 
 
 class ContextHandler:
     """
     A class for handling a MLRun context of a function that is wrapped in MLRun's `handler` decorator.
 
     The context handler have 3 duties:
@@ -183,69 +184,52 @@
         outputs: list,
         log_hints: List[Union[Dict[str, str], str, None]],
     ):
         """
         Log the given outputs as artifacts (or results) with the stored context. Errors raised during the packing will
         be ignored to not fail a run. A warning with the error wil be printed.
 
+        Only the logging worker will pack and log the outputs.
+
         :param outputs:   List of outputs to log.
         :param log_hints: List of log hints (logging configurations) to use.
         """
-        # Verify the outputs and log hints are the same length:
-        if len(outputs) != len(log_hints):
-            self._context.logger.warn(
-                f"The amount of outputs objects returned from the function ({len(outputs)}) does not match the amount "
-                f"of provided log hints ({len(log_hints)})."
+        # Pack and log only from the logging worker (in case of multi-workers job like OpenMPI):
+        if self._is_logging_worker():
+            # Verify the outputs and log hints are the same length:
+            self._validate_objects_to_log_hints_length(
+                outputs=outputs, log_hints=log_hints
             )
-            if len(outputs) > len(log_hints):
-                ignored_outputs = [str(output) for output in outputs[len(log_hints) :]]
-                self._context.logger.warn(
-                    f"The following outputs will not be logged: {', '.join(ignored_outputs)}"
-                )
-            if len(outputs) < len(log_hints):
-                ignored_log_hints = [
-                    str(log_hint) for log_hint in log_hints[len(outputs) :]
-                ]
-                self._context.logger.warn(
-                    f"The following log hints will be ignored: {', '.join(ignored_log_hints)}"
-                )
-
-        # Go over the outputs and pack them:
-        for obj, log_hint in zip(outputs, log_hints):
-            try:
-                # Check if needed to log (not None):
-                if log_hint is None:
-                    continue
-                # Parse the log hint:
-                log_hint = LogHintUtils.parse_log_hint(log_hint=log_hint)
-                # Check if the object to log is None (None values are only logged if the artifact type is Result):
-                if (
-                    obj is None
-                    and log_hint.get(LogHintKey.ARTIFACT_TYPE, ArtifactType.RESULT)
-                    != ArtifactType.RESULT
-                ):
-                    continue
-                # Pack the object (we don't catch the returned package as we log it after we pack all the outputs to
-                # enable linking extra data of some artifacts):
-                self._packagers_manager.pack(obj=obj, log_hint=log_hint)
-            except (MLRunInvalidArgumentError, MLRunPackagePackingError) as error:
-                self._context.logger.warn(
-                    f"Skipping logging an object with the log hint '{log_hint}' due to the following error:\n{error}"
-                )
-
-        # Link packages:
-        self._packagers_manager.link_packages(
-            additional_artifacts=self._context.artifacts,
-            additional_results=self._context.results,
-        )
-
-        # Log the packed results and artifacts:
-        self._context.log_results(results=self._packagers_manager.results)
-        for artifact in self._packagers_manager.artifacts:
-            self._context.log_artifact(item=artifact)
+            # Go over the outputs and pack them:
+            for obj, log_hint in zip(outputs, log_hints):
+                try:
+                    # Check if needed to log (not None):
+                    if log_hint is None:
+                        continue
+                    # Parse the log hint:
+                    log_hint = LogHintUtils.parse_log_hint(log_hint=log_hint)
+                    # Pack the object (we don't catch the returned package as we log it after we pack all the outputs to
+                    # enable linking extra data of some artifacts):
+                    self._packagers_manager.pack(obj=obj, log_hint=log_hint)
+                except (MLRunInvalidArgumentError, MLRunPackagePackingError) as error:
+                    self._context.logger.warn(
+                        f"Skipping logging an object with the log hint '{log_hint}' "
+                        f"due to the following error:\n{error}"
+                    )
+            # Link packages:
+            self._packagers_manager.link_packages(
+                additional_artifacts=self._context.artifacts,
+                additional_results=self._context.results,
+            )
+            # Log the packed results and artifacts:
+            self._context.log_results(results=self._packagers_manager.results)
+            for artifact in self._packagers_manager.artifacts:
+                self._context.log_artifact(item=artifact)
+        else:
+            self._context.logger.debug("Skipping logging - not the logging worker.")
 
         # Clear packagers outputs:
         self._packagers_manager.clear_packagers_outputs()
 
     def set_labels(self, labels: Dict[str, str]):
         """
         Set the given labels with the stored context.
@@ -319,7 +303,54 @@
         # Add extra packagers from `mlrun.frameworks` package:
         for module_name in self._MLRUN_FRAMEWORKS_PACKAGERS:
             self._collect_packagers(
                 packagers=[f"mlrun.frameworks.{module_name}.packagers.*"],
                 is_mandatory=False,
                 is_custom_packagers=False,
             )
+
+    def _is_logging_worker(self):
+        """
+        Check if the current worker is the logging worker.
+
+        :return: True if the context belongs to the logging worker and False otherwise.
+        """
+        # If it's a OpenMPI job:
+        if self._context.labels.get("kind", "job") == "mpijob":
+            from mpi4py import MPI
+
+            # Get the global and compare to the logging rank (worker) set in MLRun's configuration:
+            comm = MPI.COMM_WORLD
+            return comm.Get_rank() == mlconf.packagers.logging_worker
+
+        # Single worker is always the logging worker:
+        return True
+
+    def _validate_objects_to_log_hints_length(
+        self,
+        outputs: list,
+        log_hints: List[Union[Dict[str, str], str, None]],
+    ):
+        """
+        Validate the outputs and log hints are the same length. If they are not, warnings will be printed on what will
+        be ignored.
+
+        :param outputs:   List of outputs to log.
+        :param log_hints: List of log hints (logging configurations) to use.
+        """
+        if len(outputs) != len(log_hints):
+            self._context.logger.warn(
+                f"The amount of outputs objects returned from the function ({len(outputs)}) does not match the amount "
+                f"of provided log hints ({len(log_hints)})."
+            )
+            if len(outputs) > len(log_hints):
+                ignored_outputs = [str(output) for output in outputs[len(log_hints) :]]
+                self._context.logger.warn(
+                    f"The following outputs will not be logged: {', '.join(ignored_outputs)}"
+                )
+            if len(outputs) < len(log_hints):
+                ignored_log_hints = [
+                    str(log_hint) for log_hint in log_hints[len(outputs) :]
+                ]
+                self._context.logger.warn(
+                    f"The following log hints will be ignored: {', '.join(ignored_log_hints)}"
+                )
```

## mlrun/package/packagers/python_standard_library_packagers.py

```diff
@@ -11,15 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 import os
 import pathlib
 import tempfile
-from typing import Tuple, Union
+from typing import List, Tuple, Union
 
 from mlrun.artifacts import Artifact
 from mlrun.datastore import DataItem
 from mlrun.errors import MLRunInvalidArgumentError
 
 from ..utils import (
     DEFAULT_ARCHIVE_FORMAT,
@@ -31,14 +31,38 @@
 from .default_packager import DefaultPackager
 
 # ----------------------------------------------------------------------------------------------------------------------
 # builtins packagers:
 # ----------------------------------------------------------------------------------------------------------------------
 
 
+class NonePackager(DefaultPackager):
+    """
+    `None` packager.
+    """
+
+    # TODO: From python 3.10 the `PACKABLE_OBJECT_TYPE` should be changed to `types.NoneType`
+    PACKABLE_OBJECT_TYPE = type(None)
+    DEFAULT_PACKING_ARTIFACT_TYPE = ArtifactType.RESULT
+
+    # TODO: `None` as pickle will be available from Python 3.10, so this method can be removed once we move to 3.10.
+    @classmethod
+    def get_supported_artifact_types(cls) -> List[str]:
+        """
+        Get all the supported artifact types on this packager. It will be the same as `DefaultPackager` but without the
+        'object' artifact type support (None cannot be pickled, only from Python 3.10, and it should not be pickled
+        anyway as it is simply None - a result will do).
+
+        :return: A list of all the supported artifact types.
+        """
+        supported_artifacts = super().get_supported_artifact_types()
+        supported_artifacts.remove("object")
+        return supported_artifacts
+
+
 class IntPackager(DefaultPackager):
     """
     ``builtins.int`` packager.
     """
 
     PACKABLE_OBJECT_TYPE = int
     DEFAULT_PACKING_ARTIFACT_TYPE = ArtifactType.RESULT
```

## mlrun/platforms/iguazio.py

```diff
@@ -614,14 +614,16 @@
             prefix = "https"
         elif scheme == "v3io":
             prefix = "http"
         elif scheme == "redis":
             prefix = "redis"
         elif scheme == "rediss":
             prefix = "rediss"
+        elif scheme == "ds":
+            prefix = "ds"
         else:
             raise mlrun.errors.MLRunInvalidArgumentError(
                 "url must start with v3io/v3ios/redis/rediss, got " + url
             )
         endpoint = f"{prefix}://{parsed_url.netloc}"
     else:
         # no netloc is mainly when using v3io (v3io:///) and expecting the url to be resolved automatically from env or
```

## mlrun/projects/operations.py

```diff
@@ -70,14 +70,15 @@
     selector: str = None,
     project_object=None,
     auto_build: bool = None,
     schedule: Union[str, mlrun.common.schemas.ScheduleCronTrigger] = None,
     artifact_path: str = None,
     notifications: List[mlrun.model.Notification] = None,
     returns: Optional[List[Union[str, Dict[str, str]]]] = None,
+    builder_env: Optional[list] = None,
 ) -> Union[mlrun.model.RunObject, kfp.dsl.ContainerOp]:
     """Run a local or remote task as part of a local/kubeflow pipeline
 
     run_function() allow you to execute a function locally, on a remote cluster, or as part of an automated workflow
     function can be specified as an object or by name (str), when the function is specified by name it is looked up
     in the current project eliminating the need to redefine/edit functions.
 
@@ -152,14 +153,15 @@
                             * A string of the key to use to log the returning value as result or as an artifact. To
                               specify The artifact type, it is possible to pass a string in the following structure:
                               "<key> : <type>". Available artifact types can be seen in `mlrun.ArtifactType`. If no
                               artifact type is specified, the object's default artifact type will be used.
                             * A dictionary of configurations to use when logging. Further info per object type and
                               artifact type can be given there. The artifact key must appear in the dictionary as
                               "key": "the_key".
+    :param builder_env:     env vars dict for source archive config/credentials e.g. builder_env={"GIT_TOKEN": token}
     :return: MLRun RunObject or KubeFlow containerOp
     """
     engine, function = _get_engine_and_function(function, project_object)
     task = mlrun.new_task(
         handler=handler,
         params=params,
         hyper_params=hyperparams,
@@ -197,14 +199,15 @@
             # workflow artifact_path has precedence over the project artifact_path equivalent to
             # passing artifact_path to function.run() has precedence over the project.artifact_path and the default one
             or pipeline_context.workflow_artifact_path
             or (project.artifact_path if project else None),
             auto_build=auto_build,
             schedule=schedule,
             notifications=notifications,
+            builder_env=builder_env,
         )
         if run_result:
             run_result._notified = False
             pipeline_context.runs_map[run_result.uid()] = run_result
             run_result.after = (
                 lambda x: run_result
             )  # emulate KFP op, .after() will be ignored
@@ -237,34 +240,37 @@
     secret_name=None,
     requirements: Union[str, List[str]] = None,
     requirements_file: str = None,
     mlrun_version_specifier=None,
     builder_env: dict = None,
     project_object=None,
     overwrite_build_params: bool = False,
+    extra_args: str = None,
 ) -> Union[BuildStatus, kfp.dsl.ContainerOp]:
     """deploy ML function, build container with its dependencies
 
-    :param function:        name of the function (in the project) or function object
-    :param with_mlrun:      add the current mlrun package to the container build
-    :param skip_deployed:   skip the build if we already have an image for the function
-    :param image:           target image name/path
-    :param base_image:      base image name/path (commands and source code will be added to it)
-    :param commands:        list of docker build (RUN) commands e.g. ['pip install pandas']
-    :param secret_name:     k8s secret for accessing the docker registry
-    :param requirements:    list of python packages, defaults to None
+    :param function:        Name of the function (in the project) or function object
+    :param with_mlrun:      Add the current mlrun package to the container build
+    :param skip_deployed:   Skip the build if we already have an image for the function
+    :param image:           Target image name/path
+    :param base_image:      Base image name/path (commands and source code will be added to it)
+    :param commands:        List of docker build (RUN) commands e.g. ['pip install pandas']
+    :param secret_name:     K8s secret for accessing the docker registry
+    :param requirements:    List of python packages, defaults to None
     :param requirements_file:    pip requirements file path, defaults to None
     :param mlrun_version_specifier:  which mlrun package version to include (if not current)
     :param builder_env:     Kaniko builder pod env vars dict (for config/credentials)
-                            e.g. builder_env={"GIT_TOKEN": token}, does not work yet in KFP
-    :param project_object:  override the project object to use, will default to the project set in the runtime context.
-    :param builder_env:     Kaniko builder pod env vars dict (for config/credentials)
-                            e.g. builder_env={"GIT_TOKEN": token}, does not work yet in KFP
-    :param overwrite_build_params:  overwrite the function build parameters with the provided ones, or attempt to add
-     to existing parameters
+        e.g. builder_env={"GIT_TOKEN": token}, does not work yet in KFP
+    :param project_object:  Override the project object to use, will default to the project set in the runtime context.
+    :param overwrite_build_params:  Overwrite existing build configuration (currently applies to
+        requirements and commands)
+        * False: The new params are merged with the existing
+        * True: The existing params are replaced by the new ones
+    :param extra_args:  A string containing additional builder arguments in the format of command-line options,
+        e.g. extra_args="--skip-tls-verify --build-arg A=val"
     """
     engine, function = _get_engine_and_function(function, project_object)
     if function.kind in mlrun.runtimes.RuntimeKinds.nuclio_runtimes():
         raise mlrun.errors.MLRunInvalidArgumentError(
             "cannot build use deploy_function()"
         )
     if engine == "kfp":
@@ -286,14 +292,15 @@
         function.build_config(
             image=image,
             base_image=base_image,
             commands=commands,
             secret=secret_name,
             requirements=requirements,
             overwrite=overwrite_build_params,
+            extra_args=extra_args,
         )
         ready = function.deploy(
             watch=True,
             with_mlrun=with_mlrun,
             skip_deployed=skip_deployed,
             mlrun_version_specifier=mlrun_version_specifier,
             builder_env=builder_env,
```

## mlrun/projects/project.py

```diff
@@ -41,14 +41,15 @@
 import mlrun.common.schemas.model_monitoring
 import mlrun.db
 import mlrun.errors
 import mlrun.runtimes
 import mlrun.runtimes.pod
 import mlrun.runtimes.utils
 import mlrun.utils.regex
+from mlrun.datastore.datastore_profile import DatastoreProfile, DatastoreProfile2Json
 
 from ..artifacts import Artifact, ArtifactProducer, DatasetArtifact, ModelArtifact
 from ..artifacts.manager import ArtifactManager, dict_to_artifact, extend_artifact_path
 from ..datastore import store_manager
 from ..features import Feature
 from ..model import EntrypointParam, ImageBuilder, ModelObj
 from ..run import code_to_function, get_object, import_function, new_function
@@ -2510,14 +2511,15 @@
         verbose: bool = None,
         selector: str = None,
         auto_build: bool = None,
         schedule: typing.Union[str, mlrun.common.schemas.ScheduleCronTrigger] = None,
         artifact_path: str = None,
         notifications: typing.List[mlrun.model.Notification] = None,
         returns: Optional[List[Union[str, Dict[str, str]]]] = None,
+        builder_env: Optional[dict] = None,
     ) -> typing.Union[mlrun.model.RunObject, kfp.dsl.ContainerOp]:
         """Run a local or remote task as part of a local/kubeflow pipeline
 
         example (use with project)::
 
             # create a project with two functions (local and from hub)
             project = mlrun.new_project(project_name, "./proj")
@@ -2562,15 +2564,15 @@
                                 * A string of the key to use to log the returning value as result or as an artifact. To
                                   specify The artifact type, it is possible to pass a string in the following structure:
                                   "<key> : <type>". Available artifact types can be seen in `mlrun.ArtifactType`. If no
                                   artifact type is specified, the object's default artifact type will be used.
                                 * A dictionary of configurations to use when logging. Further info per object type and
                                   artifact type can be given there. The artifact key must appear in the dictionary as
                                   "key": "the_key".
-
+        :param builder_env: env vars dict for source archive config/credentials e.g. builder_env={"GIT_TOKEN": token}
         :return: MLRun RunObject or KubeFlow containerOp
         """
         return run_function(
             function,
             handler=handler,
             name=name,
             params=params,
@@ -2587,14 +2589,15 @@
             selector=selector,
             project_object=self,
             auto_build=auto_build,
             schedule=schedule,
             artifact_path=artifact_path,
             notifications=notifications,
             returns=returns,
+            builder_env=builder_env,
         )
 
     def build_function(
         self,
         function: typing.Union[str, mlrun.runtimes.BaseRuntime],
         with_mlrun: bool = None,
         skip_deployed: bool = False,
@@ -2603,31 +2606,36 @@
         commands: list = None,
         secret_name: str = None,
         requirements: typing.Union[str, typing.List[str]] = None,
         mlrun_version_specifier: str = None,
         builder_env: dict = None,
         overwrite_build_params: bool = False,
         requirements_file: str = None,
+        extra_args: str = None,
     ) -> typing.Union[BuildStatus, kfp.dsl.ContainerOp]:
         """deploy ML function, build container with its dependencies
 
         :param function:            name of the function (in the project) or function object
         :param with_mlrun:          add the current mlrun package to the container build
         :param skip_deployed:       skip the build if we already have an image for the function
         :param image:               target image name/path
         :param base_image:          base image name/path (commands and source code will be added to it)
         :param commands:            list of docker build (RUN) commands e.g. ['pip install pandas']
         :param secret_name:         k8s secret for accessing the docker registry
         :param requirements:        list of python packages, defaults to None
         :param requirements_file:   pip requirements file path, defaults to None
         :param mlrun_version_specifier:  which mlrun package version to include (if not current)
         :param builder_env:         Kaniko builder pod env vars dict (for config/credentials)
-                                    e.g. builder_env={"GIT_TOKEN": token}, does not work yet in KFP
-        :param overwrite_build_params:  overwrite the function build parameters with the provided ones, or attempt to
-         add to existing parameters
+            e.g. builder_env={"GIT_TOKEN": token}, does not work yet in KFP
+        :param overwrite_build_params:  Overwrite existing build configuration (currently applies to
+            requirements and commands)
+            * False: The new params are merged with the existing
+            * True: The existing params are replaced by the new ones
+        :param extra_args:  A string containing additional builder arguments in the format of command-line options,
+            e.g. extra_args="--skip-tls-verify --build-arg A=val"
         """
         return build_function(
             function,
             with_mlrun=with_mlrun,
             skip_deployed=skip_deployed,
             image=image,
             base_image=base_image,
@@ -2635,44 +2643,50 @@
             secret_name=secret_name,
             requirements=requirements,
             requirements_file=requirements_file,
             mlrun_version_specifier=mlrun_version_specifier,
             builder_env=builder_env,
             project_object=self,
             overwrite_build_params=overwrite_build_params,
+            extra_args=extra_args,
         )
 
     def build_config(
         self,
         image: str = None,
         set_as_default: bool = False,
         with_mlrun: bool = None,
         base_image: str = None,
         commands: list = None,
         secret_name: str = None,
         requirements: typing.Union[str, typing.List[str]] = None,
         overwrite_build_params: bool = False,
         requirements_file: str = None,
+        builder_env: dict = None,
+        extra_args: str = None,
     ):
         """specify builder configuration for the project
 
         :param image: target image name/path. If not specified the project's existing `default_image` name will be
             used. If not set, the `mlconf.default_project_image_name` value will be used
         :param set_as_default: set `image` to be the project's default image (default False)
         :param with_mlrun: add the current mlrun package to the container build
         :param base_image: base image name/path
         :param commands:   list of docker build (RUN) commands e.g. ['pip install pandas']
         :param secret_name:     k8s secret for accessing the docker registry
         :param requirements: a list of packages to install on the built image
         :param requirements_file: requirements file to install on the built image
-        :param overwrite_build_params:  overwrite existing build configuration (default False)
-
-           * False: the new params are merged with the existing (currently merge is applied to requirements and
-             commands)
-           * True: the existing params are replaced by the new ones
+        :param overwrite_build_params:  Overwrite existing build configuration (currently applies to
+            requirements and commands)
+            * False: The new params are merged with the existing
+            * True: The existing params are replaced by the new ones
+        :param builder_env: Kaniko builder pod env vars dict (for config/credentials)
+            e.g. builder_env={"GIT_TOKEN": token}, does not work yet in KFP
+        :param extra_args:  A string containing additional builder arguments in the format of command-line options,
+            e.g. extra_args="--skip-tls-verify --build-arg A=val"
         """
         default_image_name = mlrun.mlconf.default_project_image_name.format(
             name=self.name
         )
         image = image or self.default_image or default_image_name
 
         self.spec.build.build_config(
@@ -2680,14 +2694,16 @@
             base_image=base_image,
             commands=commands,
             secret=secret_name,
             with_mlrun=with_mlrun,
             requirements=requirements,
             requirements_file=requirements_file,
             overwrite=overwrite_build_params,
+            builder_env=builder_env,
+            extra_args=extra_args,
         )
 
         if set_as_default and image != self.default_image:
             self.set_default_image(image)
 
     def build_image(
         self,
@@ -2699,14 +2715,15 @@
         commands: list = None,
         secret_name: str = None,
         requirements: typing.Union[str, typing.List[str]] = None,
         mlrun_version_specifier: str = None,
         builder_env: dict = None,
         overwrite_build_params: bool = False,
         requirements_file: str = None,
+        extra_args: str = None,
     ) -> typing.Union[BuildStatus, kfp.dsl.ContainerOp]:
         """Builder docker image for the project, based on the project's build config. Parameters allow to override
         the build config.
 
         :param image: target image name/path. If not specified the project's existing `default_image` name will be
                         used. If not set, the `mlconf.default_project_image_name` value will be used
         :param set_as_default: set `image` to be the project's default image (default False)
@@ -2715,20 +2732,21 @@
         :param base_image:      base image name/path (commands and source code will be added to it)
         :param commands:        list of docker build (RUN) commands e.g. ['pip install pandas']
         :param secret_name:     k8s secret for accessing the docker registry
         :param requirements:    list of python packages, defaults to None
         :param requirements_file:  pip requirements file path, defaults to None
         :param mlrun_version_specifier:  which mlrun package version to include (if not current)
         :param builder_env:     Kaniko builder pod env vars dict (for config/credentials)
-                                e.g. builder_env={"GIT_TOKEN": token}, does not work yet in KFP
-        :param overwrite_build_params:  overwrite existing build configuration (default False)
-
-           * False: the new params are merged with the existing (currently merge is applied to requirements and
-             commands)
-           * True: the existing params are replaced by the new ones
+            e.g. builder_env={"GIT_TOKEN": token}, does not work yet in KFP
+        :param overwrite_build_params:  Overwrite existing build configuration (currently applies to
+            requirements and commands)
+            * False: The new params are merged with the existing
+            * True: The existing params are replaced by the new ones
+        :param extra_args:  A string containing additional builder arguments in the format of command-line options,
+            e.g. extra_args="--skip-tls-verify --build-arg A=val"r
         """
 
         self.build_config(
             image=image,
             set_as_default=set_as_default,
             base_image=base_image,
             commands=commands,
@@ -2750,14 +2768,15 @@
             commands=build.commands,
             secret_name=build.secret,
             requirements=build.requirements,
             skip_deployed=skip_deployed,
             overwrite_build_params=overwrite_build_params,
             mlrun_version_specifier=mlrun_version_specifier,
             builder_env=builder_env,
+            extra_args=extra_args,
         )
 
         try:
             mlrun.db.get_run_db(secrets=self._secrets).delete_function(
                 name=function.metadata.name
             )
         except Exception as exc:
@@ -2996,14 +3015,35 @@
             start_time_from=start_time_from,
             start_time_to=start_time_to,
             last_update_time_from=last_update_time_from,
             last_update_time_to=last_update_time_to,
             **kwargs,
         )
 
+    def register_datastore_profile(self, profile: DatastoreProfile):
+        project_ds_name_private = DatastoreProfile.generate_secret_key(
+            profile.name, self.name
+        )
+        private_body = DatastoreProfile2Json.get_json_private(profile)
+        public_body = DatastoreProfile2Json.get_json_public(profile)
+        # set project public data to DB
+        public_profile = mlrun.common.schemas.DatastoreProfile(
+            name=profile.name, type=profile.type, body=public_body, project=self.name
+        )
+        mlrun.db.get_run_db(secrets=self._secrets).store_datastore_profile(
+            public_profile, self.name
+        )
+        # Set local environment variable
+        environ[project_ds_name_private] = private_body
+        # set project secret
+        self.set_secrets(
+            secrets={project_ds_name_private: private_body},
+            provider=mlrun.common.schemas.SecretProviderName.kubernetes,
+        )
+
     def get_custom_packagers(self) -> typing.List[typing.Tuple[str, bool]]:
         """
         Get the custom packagers registered in the project.
 
         :return: A list of the custom packagers module paths.
         """
         # Return a copy so the user won't be able to edit the list by the reference returned (no need for deep copy as
```

## mlrun/runtimes/__init__.py

```diff
@@ -19,28 +19,27 @@
     "KubejobRuntime",
     "LocalRuntime",
     "HandlerRuntime",
     "RemoteRuntime",
     "ServingRuntime",
     "DaskCluster",
     "RemoteSparkRuntime",
+    "DatabricksRuntime",
 ]
 
-from mlrun.runtimes.utils import (
-    resolve_mpijob_crd_version,
-    resolve_spark_operator_version,
-)
+from mlrun.runtimes.utils import resolve_spark_operator_version
 
 from .base import BaseRuntime, RunError, RuntimeClassMode  # noqa
 from .constants import MPIJobCRDVersions
-from .daskjob import DaskCluster, get_dask_resource  # noqa
+from .daskjob import DaskCluster  # noqa
+from .databricks.databricks import DatabricksRuntime
 from .function import RemoteRuntime
 from .kubejob import KubejobRuntime  # noqa
 from .local import HandlerRuntime, LocalRuntime  # noqa
-from .mpijob import MpiRuntimeV1, MpiRuntimeV1Alpha1  # noqa
+from .mpijob import MpiRuntimeContainer, MpiRuntimeV1, MpiRuntimeV1Alpha1  # noqa
 from .nuclio import nuclio_init_hook
 from .remotesparkjob import RemoteSparkRuntime
 from .serving import ServingRuntime, new_v2_model_server
 from .sparkjob import Spark3Runtime
 
 # for legacy imports (MLModelServer moved from here to /serving)
 from ..serving import MLModelServer, new_v1_model_server  # noqa isort: skip
@@ -92,27 +91,29 @@
     job = "job"
     spark = "spark"
     remotespark = "remote-spark"
     mpijob = "mpijob"
     serving = "serving"
     local = "local"
     handler = "handler"
+    databricks = "databricks"
 
     @staticmethod
     def all():
         return [
             RuntimeKinds.remote,
             RuntimeKinds.nuclio,
             RuntimeKinds.serving,
             RuntimeKinds.dask,
             RuntimeKinds.job,
             RuntimeKinds.spark,
             RuntimeKinds.remotespark,
             RuntimeKinds.mpijob,
             RuntimeKinds.local,
+            RuntimeKinds.databricks,
         ]
 
     @staticmethod
     def runtime_with_handlers():
         return [
             RuntimeKinds.dask,
             RuntimeKinds.job,
@@ -190,48 +191,41 @@
             RuntimeKinds.handler,
             RuntimeKinds.dask,
         ]
 
     @staticmethod
     def requires_absolute_artifacts_path(kind):
         """
-        Returns True if the runtime kind requires absolute artifacts' path (e.i. is local), False otherwise.
+        Returns True if the runtime kind requires absolute artifacts' path (i.e. is local), False otherwise.
         """
         if RuntimeKinds.is_local_runtime(kind):
             return False
 
         if kind not in [
             # logging artifacts is done externally to the dask cluster by a client that can either run locally (in which
             # case the path can be relative) or remotely (in which case the path must be absolute and will be passed
             # to another run)
             RuntimeKinds.dask
         ]:
             return True
         return False
 
 
-runtime_resources_map = {RuntimeKinds.dask: get_dask_resource()}
-
-
 def get_runtime_class(kind: str):
     if kind == RuntimeKinds.mpijob:
-        mpijob_crd_version = resolve_mpijob_crd_version()
-        crd_version_to_runtime = {
-            MPIJobCRDVersions.v1alpha1: MpiRuntimeV1Alpha1,
-            MPIJobCRDVersions.v1: MpiRuntimeV1,
-        }
-        return crd_version_to_runtime[mpijob_crd_version]
+        return MpiRuntimeContainer.selector()
 
     if kind == RuntimeKinds.spark:
         return Spark3Runtime
 
     kind_runtime_map = {
         RuntimeKinds.remote: RemoteRuntime,
         RuntimeKinds.nuclio: RemoteRuntime,
         RuntimeKinds.serving: ServingRuntime,
         RuntimeKinds.dask: DaskCluster,
         RuntimeKinds.job: KubejobRuntime,
         RuntimeKinds.local: LocalRuntime,
         RuntimeKinds.remotespark: RemoteSparkRuntime,
+        RuntimeKinds.databricks: DatabricksRuntime,
     }
 
     return kind_runtime_map[kind]
```

## mlrun/runtimes/base.py

```diff
@@ -327,15 +327,16 @@
 
                         * A string of the key to use to log the returning value as result or as an artifact. To specify
                           The artifact type, it is possible to pass a string in the following structure:
                           "<key> : <type>". Available artifact types can be seen in `mlrun.ArtifactType`. If no
                           artifact type is specified, the object's default artifact type will be used.
                         * A dictionary of configurations to use when logging. Further info per object type and artifact
                           type can be given there. The artifact key must appear in the dictionary as "key": "the_key".
-
+        :param builder_env: Kaniko builder pod env vars dict (for config/credentials)
+                                        e.g. builder_env={"GIT_TOKEN": token}
         :return: Run context object (RunObject) with run metadata, results and status
         """
         launcher = mlrun.launcher.factory.LauncherFactory().create_launcher(
             self._is_remote, local=local, **launcher_kwargs
         )
         return launcher.launch(
             runtime=self,
```

## mlrun/runtimes/daskjob.py

```diff
@@ -24,28 +24,20 @@
 import mlrun.utils.regex
 from mlrun.errors import err_to_str
 
 from ..config import config
 from ..execution import MLClientCtx
 from ..model import RunObject
 from ..render import ipython_display
-from ..utils import logger, normalize_name, update_in
+from ..utils import logger
 from .base import FunctionStatus
 from .kubejob import KubejobRuntime
 from .local import exec_from_params, load_module
-from .pod import KubeResourceSpec, kube_resource_spec_to_pod_spec
-from .utils import RunError, get_func_selector, get_resource_labels, log_std
-
-
-def get_dask_resource():
-    return {
-        "scope": "function",
-        "start": deploy_function,
-        "status": get_obj_status,
-    }
+from .pod import KubeResourceSpec
+from .utils import RunError, get_func_selector, log_std
 
 
 class DaskSpec(KubeResourceSpec):
     _dict_fields = KubeResourceSpec._dict_fields + [
         "extra_pip",
         "remote",
         "service_type",
@@ -238,58 +230,58 @@
                 if self.kfp:
                     logger.info(f"dask status: {db_func['status']}")
                 return "scheduler_address" in db_func["status"]
 
         return False
 
     def _start(self, watch=True):
-        if self._is_remote_api():
-            self.try_auto_mount_based_on_config()
-            self._fill_credentials()
-            db = self._get_db()
-            if not self.is_deployed():
-                raise RunError(
-                    "function image is not built/ready, use .deploy()"
-                    " method first, or set base dask image (daskdev/dask:latest)"
-                )
+        db = self._get_db()
+        if not self._is_remote_api():
+            self._cluster = db.start_function(function=self)
+            return
+
+        self.try_auto_mount_based_on_config()
+        self._fill_credentials()
+        if not self.is_deployed():
+            raise RunError(
+                "Function image is not built/ready, use .deploy()"
+                " method first, or set base dask image (daskdev/dask:latest)"
+            )
 
-            self.save(versioned=False)
-            background_task = db.remote_start(self._function_uri())
-            if watch:
-                now = datetime.datetime.utcnow()
-                timeout = now + datetime.timedelta(minutes=10)
-                while now < timeout:
-                    background_task = db.get_project_background_task(
-                        background_task.metadata.project, background_task.metadata.name
-                    )
+        self.save(versioned=False)
+        background_task = db.start_function(func_url=self._function_uri())
+        if watch:
+            now = datetime.datetime.utcnow()
+            timeout = now + datetime.timedelta(minutes=10)
+            while now < timeout:
+                background_task = db.get_project_background_task(
+                    background_task.metadata.project, background_task.metadata.name
+                )
+                if (
+                    background_task.status.state
+                    in mlrun.common.schemas.BackgroundTaskState.terminal_states()
+                ):
                     if (
                         background_task.status.state
-                        in mlrun.common.schemas.BackgroundTaskState.terminal_states()
+                        == mlrun.common.schemas.BackgroundTaskState.failed
                     ):
-                        if (
-                            background_task.status.state
-                            == mlrun.common.schemas.BackgroundTaskState.failed
-                        ):
-                            raise mlrun.errors.MLRunRuntimeError(
-                                "Failed bringing up dask cluster"
-                            )
-                        else:
-                            function = db.get_function(
-                                self.metadata.name,
-                                self.metadata.project,
-                                self.metadata.tag,
-                            )
-                            if function and function.get("status"):
-                                self.status = function.get("status")
-                            return
-                    time.sleep(5)
-                    now = datetime.datetime.utcnow()
-        else:
-            self._cluster = deploy_function(self)
-            self.save(versioned=False)
+                        raise mlrun.errors.MLRunRuntimeError(
+                            "Failed bringing up dask cluster"
+                        )
+                    else:
+                        function = db.get_function(
+                            self.metadata.name,
+                            self.metadata.project,
+                            self.metadata.tag,
+                        )
+                        if function and function.get("status"):
+                            self.status = function.get("status")
+                        return
+                time.sleep(5)
+                now = datetime.datetime.utcnow()
 
     def close(self, running=True):
         from dask.distributed import default_client
 
         try:
             client = default_client()
             # shutdown the cluster first, then close the client
@@ -297,21 +289,16 @@
             client.close()
         except ValueError:
             pass
 
     def get_status(self):
         meta = self.metadata
         selector = get_func_selector(meta.project, meta.name, meta.tag)
-        if self._is_remote_api():
-            db = self._get_db()
-            return db.remote_status(meta.project, meta.name, self.kind, selector)
-
-        status = get_obj_status(selector)
-        print(status)
-        return status
+        db = self._get_db()
+        return db.function_status(meta.project, meta.name, self.kind, selector)
 
     def cluster(self):
         return self._cluster
 
     def _remote_addresses(self):
         addr = self.status.scheduler_address
         dash = ""
@@ -487,184 +474,7 @@
                 )
             handler = load_module(self.spec.command, handler, context=context)
         client = self.client
         setattr(context, "dask_client", client)
         sout, serr = exec_from_params(handler, runobj, context)
         log_std(self._db_conn, runobj, sout, serr, skip=self.is_child, show=False)
         return context.to_dict()
-
-
-def deploy_function(
-    function: DaskCluster,
-    secrets=None,
-    client_version: str = None,
-    client_python_version: str = None,
-):
-    _validate_dask_related_libraries_installed()
-
-    scheduler_pod, worker_pod, function, namespace = enrich_dask_cluster(
-        function, secrets, client_version, client_python_version
-    )
-    return initialize_dask_cluster(scheduler_pod, worker_pod, function, namespace)
-
-
-def initialize_dask_cluster(scheduler_pod, worker_pod, function, namespace):
-    import dask
-    import dask_kubernetes
-
-    spec, meta = function.spec, function.metadata
-
-    svc_temp = dask.config.get("kubernetes.scheduler-service-template")
-    if spec.service_type or spec.node_port:
-        if spec.node_port:
-            spec.service_type = "NodePort"
-            svc_temp["spec"]["ports"][1]["nodePort"] = spec.node_port
-        update_in(svc_temp, "spec.type", spec.service_type)
-
-    norm_name = normalize_name(meta.name)
-    dask.config.set(
-        {
-            "kubernetes.scheduler-service-template": svc_temp,
-            "kubernetes.name": "mlrun-" + norm_name + "-{uuid}",
-        }
-    )
-
-    cluster = dask_kubernetes.KubeCluster(
-        worker_pod,
-        scheduler_pod_template=scheduler_pod,
-        deploy_mode="remote",
-        namespace=namespace,
-        idle_timeout=spec.scheduler_timeout,
-    )
-
-    logger.info(f"cluster {cluster.name} started at {cluster.scheduler_address}")
-
-    function.status.scheduler_address = cluster.scheduler_address
-    function.status.cluster_name = cluster.name
-    if spec.service_type == "NodePort":
-        ports = cluster.scheduler.service.spec.ports
-        function.status.node_ports = {
-            "scheduler": ports[0].node_port,
-            "dashboard": ports[1].node_port,
-        }
-
-    if spec.replicas:
-        cluster.scale(spec.replicas)
-    else:
-        cluster.adapt(minimum=spec.min_replicas, maximum=spec.max_replicas)
-
-    return cluster
-
-
-def enrich_dask_cluster(
-    function, secrets, client_version: str = None, client_python_version: str = None
-):
-    from dask.distributed import Client, default_client  # noqa: F401
-    from dask_kubernetes import KubeCluster, make_pod_spec  # noqa: F401
-    from kubernetes import client
-
-    # Is it possible that the function will not have a project at this point?
-    if function.metadata.project:
-        function._add_secrets_to_spec_before_running(project=function.metadata.project)
-
-    spec = function.spec
-    meta = function.metadata
-    spec.remote = True
-
-    image = (
-        function.full_image_path(
-            client_version=client_version, client_python_version=client_python_version
-        )
-        # TODO: we might never enter here, since running a function requires defining an image
-        or "daskdev/dask:latest"
-    )
-    env = spec.env
-    namespace = meta.namespace or config.namespace
-    if spec.extra_pip:
-        env.append(spec.extra_pip)
-
-    pod_labels = get_resource_labels(function, scrape_metrics=config.scrape_metrics)
-    # TODO: 'dask-worker' is deprecated, new dask CLI was introduced in 2022.10.0.
-    #  Upgrade when we drop python 3.7 support and use 'dask worker' instead
-    worker_args = ["dask-worker", "--nthreads", str(spec.nthreads)]
-    memory_limit = spec.worker_resources.get("limits", {}).get("memory")
-    if memory_limit:
-        worker_args.extend(["--memory-limit", str(memory_limit)])
-    if spec.args:
-        worker_args.extend(spec.args)
-    # TODO: 'dask-scheduler' is deprecated, new dask CLI was introduced in 2022.10.0.
-    #  Upgrade when we drop python 3.7 support and use 'dask scheduler' instead
-    scheduler_args = ["dask-scheduler"]
-
-    container_kwargs = {
-        "name": "base",
-        "image": image,
-        "env": env,
-        "image_pull_policy": spec.image_pull_policy,
-        "volume_mounts": spec.volume_mounts,
-    }
-    scheduler_container = client.V1Container(
-        resources=spec.scheduler_resources, args=scheduler_args, **container_kwargs
-    )
-    worker_container = client.V1Container(
-        resources=spec.worker_resources, args=worker_args, **container_kwargs
-    )
-
-    scheduler_pod_spec = kube_resource_spec_to_pod_spec(spec, scheduler_container)
-    worker_pod_spec = kube_resource_spec_to_pod_spec(spec, worker_container)
-    for pod_spec in [scheduler_pod_spec, worker_pod_spec]:
-        if spec.image_pull_secret:
-            pod_spec.image_pull_secrets = [
-                client.V1LocalObjectReference(name=spec.image_pull_secret)
-            ]
-
-    scheduler_pod = client.V1Pod(
-        metadata=client.V1ObjectMeta(namespace=namespace, labels=pod_labels),
-        # annotations=meta.annotation),
-        spec=scheduler_pod_spec,
-    )
-    worker_pod = client.V1Pod(
-        metadata=client.V1ObjectMeta(namespace=namespace, labels=pod_labels),
-        # annotations=meta.annotation),
-        spec=worker_pod_spec,
-    )
-    return scheduler_pod, worker_pod, function, namespace
-
-
-def _validate_dask_related_libraries_installed():
-    try:
-        import dask  # noqa: F401
-        from dask.distributed import Client, default_client  # noqa: F401
-        from dask_kubernetes import KubeCluster, make_pod_spec  # noqa: F401
-        from kubernetes import client  # noqa: F401
-    except ImportError as exc:
-        print(
-            "missing dask or dask_kubernetes, please run "
-            '"pip install dask distributed dask_kubernetes", %s',
-            exc,
-        )
-        raise exc
-
-
-def get_obj_status(selector=None, namespace=None):
-    if selector is None:
-        selector = []
-
-    import mlrun.api.utils.singletons.k8s
-
-    k8s = mlrun.api.utils.singletons.k8s.get_k8s_helper()
-    namespace = namespace or config.namespace
-    selector = ",".join(["dask.org/component=scheduler"] + selector)
-    pods = k8s.list_pods(namespace, selector=selector)
-    status = ""
-    for pod in pods:
-        status = pod.status.phase.lower()
-        if status == "running":
-            cluster = pod.metadata.labels.get("dask.org/cluster-name")
-            logger.info(
-                f"found running dask function {pod.metadata.name}, cluster={cluster}"
-            )
-            return status
-        logger.info(
-            f"found dask function {pod.metadata.name} in non ready state ({status})"
-        )
-    return status
```

## mlrun/runtimes/kubejob.py

```diff
@@ -108,14 +108,16 @@
         with_mlrun=None,
         auto_build=None,
         requirements=None,
         overwrite=False,
         verify_base_image=False,
         prepare_image_for_deploy=True,
         requirements_file=None,
+        builder_env=None,
+        extra_args=None,
     ):
         """specify builder configuration for the deploy operation
 
         :param image:      target image name/path
         :param base_image: base image name/path
         :param commands:   list of docker build (RUN) commands e.g. ['pip install pandas']
         :param secret:     k8s secret for accessing the docker registry
@@ -124,38 +126,42 @@
         :param extra:      extra Dockerfile lines
         :param load_source_on_run: load the archive code into the container at runtime vs at build time
         :param with_mlrun: add the current mlrun package to the container build
         :param auto_build: when set to True and the function require build it will be built on the first
                            function run, use only if you dont plan on changing the build config between runs
         :param requirements: a list of packages to install
         :param requirements_file: requirements file to install
-        :param overwrite:  overwrite existing build configuration
-
-           * False: the new params are merged with the existing (currently merge is applied to requirements and
-             commands)
+        :param overwrite:  overwrite existing build configuration (currently applies to requirements and commands)
+           * False: the new params are merged with the existing
            * True: the existing params are replaced by the new ones
         :param verify_base_image:           verify that the base image is configured
                                             (deprecated, use prepare_image_for_deploy)
         :param prepare_image_for_deploy:    prepare the image/base_image spec for deployment
+        :param extra_args:  A string containing additional builder arguments in the format of command-line options,
+            e.g. extra_args="--skip-tls-verify --build-arg A=val"
+        :param builder_env: Kaniko builder pod env vars dict (for config/credentials)
+            e.g. builder_env={"GIT_TOKEN": token}
         """
 
         image = mlrun.utils.helpers.remove_image_protocol_prefix(image)
         self.spec.build.build_config(
-            image,
-            base_image,
-            commands,
-            secret,
-            source,
-            extra,
-            load_source_on_run,
-            with_mlrun,
-            auto_build,
-            requirements,
-            requirements_file,
-            overwrite,
+            image=image,
+            base_image=base_image,
+            commands=commands,
+            secret=secret,
+            source=source,
+            extra=extra,
+            load_source_on_run=load_source_on_run,
+            with_mlrun=with_mlrun,
+            auto_build=auto_build,
+            requirements=requirements,
+            requirements_file=requirements_file,
+            overwrite=overwrite,
+            builder_env=builder_env,
+            extra_args=extra_args,
         )
 
         if verify_base_image or prepare_image_for_deploy:
             if verify_base_image:
                 # TODO: remove verify_base_image in 1.6.0
                 warnings.warn(
                     "verify_base_image is deprecated in 1.4.0 and will be removed in 1.6.0, "
```

## mlrun/runtimes/utils.py

```diff
@@ -25,19 +25,17 @@
 
 import mlrun
 import mlrun.common.constants
 import mlrun.common.schemas
 import mlrun.utils.regex
 from mlrun.errors import err_to_str
 from mlrun.frameworks.parallel_coordinates import gen_pcp_plot
-from mlrun.runtimes.constants import MPIJobCRDVersions
 
 from ..artifacts import TableArtifact
 from ..config import config, is_running_as_api
-from ..k8s_utils import is_running_inside_kubernetes_cluster
 from ..utils import get_in, helpers, logger, verify_field_regex
 from .generators import selector
 
 
 class RunError(Exception):
     pass
 
@@ -55,63 +53,14 @@
     def set(self, context):
         self._context = context
 
 
 global_context = _ContextStore()
 
 
-cached_mpijob_crd_version = None
-
-
-# resolve mpijob runtime according to the mpi-operator's supported crd-version
-# if specified on mlrun config set it likewise,
-# if not specified, try resolving it according to the mpi-operator, otherwise set to default
-# since this is a heavy operation (sending requests to k8s/API), and it's unlikely that the crd version
-# will change in any context - cache it
-def resolve_mpijob_crd_version():
-    global cached_mpijob_crd_version
-    if not cached_mpijob_crd_version:
-
-        # config override everything
-        # on client side, expecting it to get enriched from the API through the client-spec
-        mpijob_crd_version = config.mpijob_crd_version
-
-        if not mpijob_crd_version:
-            in_k8s_cluster = is_running_inside_kubernetes_cluster()
-
-            if in_k8s_cluster and is_running_as_api():
-                import mlrun.api.utils.singletons.k8s
-
-                k8s_helper = mlrun.api.utils.singletons.k8s.get_k8s_helper()
-                namespace = k8s_helper.resolve_namespace()
-
-                # try resolving according to mpi-operator that's running
-                res = k8s_helper.list_pods(
-                    namespace=namespace, selector="component=mpi-operator"
-                )
-                if len(res) > 0:
-                    mpi_operator_pod = res[0]
-                    mpijob_crd_version = mpi_operator_pod.metadata.labels.get(
-                        "crd-version"
-                    )
-
-            # backoff to use default if wasn't resolved in API
-            if not mpijob_crd_version:
-                mpijob_crd_version = MPIJobCRDVersions.default()
-
-        if mpijob_crd_version not in MPIJobCRDVersions.all():
-            raise ValueError(
-                f"unsupported mpijob crd version: {mpijob_crd_version}. "
-                f"supported versions: {MPIJobCRDVersions.all()}"
-            )
-        cached_mpijob_crd_version = mpijob_crd_version
-
-    return cached_mpijob_crd_version
-
-
 def resolve_spark_operator_version():
     try:
         regex = re.compile("spark-([23])")
         return int(regex.findall(config.spark_operator_version)[0])
     except Exception:
         raise ValueError("Failed to resolve spark operator's version")
```

## mlrun/runtimes/mpijob/__init__.py

```diff
@@ -10,9 +10,38 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 # flake8: noqa  - this is until we take care of the F401 violations with respect to __all__ & sphinx
 
+from dependency_injector import containers, providers
+
+from mlrun.config import config
+
+from .. import MPIJobCRDVersions
 from .v1 import MpiRuntimeV1
 from .v1alpha1 import MpiRuntimeV1Alpha1
+
+
+def _resolve_mpijob_crd_version():
+    # config is expected to get enriched from the API through the client-spec
+    return config.mpijob_crd_version or MPIJobCRDVersions.default()
+
+
+class MpiRuntimeContainer(containers.DeclarativeContainer):
+    resolver = providers.Callable(
+        _resolve_mpijob_crd_version,
+    )
+
+    selector = providers.Selector(
+        resolver,
+        v1=providers.Object(MpiRuntimeV1),
+        v1alpha1=providers.Object(MpiRuntimeV1Alpha1),
+    )
+
+    # An empty selector to be overriden by the API
+    handler_selector = providers.Selector(
+        resolver,
+        v1=providers.Object(None),
+        v1alpha1=providers.Object(None),
+    )
```

## mlrun/utils/helpers.py

```diff
@@ -9,14 +9,15 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import enum
+import functools
 import hashlib
 import inspect
 import json
 import os
 import pathlib
 import re
 import sys
@@ -25,24 +26,27 @@
 import warnings
 from datetime import datetime, timezone
 from importlib import import_module
 from os import path
 from types import ModuleType
 from typing import Any, List, Optional, Tuple
 
+import anyio
 import git
 import numpy as np
 import pandas
 import semver
 import yaml
 from dateutil import parser
+from deprecated import deprecated
 from pandas._libs.tslibs.timestamps import Timedelta, Timestamp
 from yaml.representer import RepresenterError
 
 import mlrun
+import mlrun.common.helpers
 import mlrun.common.schemas
 import mlrun.errors
 import mlrun.utils.regex
 import mlrun.utils.version.version
 from mlrun.errors import err_to_str
 
 from ..config import config
@@ -55,14 +59,27 @@
 DB_SCHEMA = "store"
 
 LEGAL_TIME_UNITS = ["year", "month", "day", "hour", "minute", "second"]
 DEFAULT_TIME_PARTITIONS = ["year", "month", "day", "hour"]
 DEFAULT_TIME_PARTITIONING_GRANULARITY = "hour"
 
 
+# TODO: remove in 1.7.0
+@deprecated(
+    version="1.5.0",
+    reason="'parse_versioned_object_uri' will be removed from this file in 1.7.0, use "
+    "'mlrun.common.helpers.parse_versioned_object_uri' instead",
+    category=FutureWarning,
+)
+def parse_versioned_object_uri(uri: str, default_project: str = ""):
+    return mlrun.common.helpers.parse_versioned_object_uri(
+        uri=uri, default_project=default_project
+    )
+
+
 class StorePrefix:
     """map mlrun store objects to prefixes"""
 
     FeatureSet = "feature-sets"
     FeatureVector = "feature-vectors"
     Artifact = "artifacts"
     Model = "models"
@@ -677,27 +694,58 @@
     if iter is not None:
         artifact_uri = f"{artifact_uri}#{iter}"
     if tag is not None:
         artifact_uri = f"{artifact_uri}:{tag}"
     return artifact_uri
 
 
-def extend_hub_uri_if_needed(uri):
-    if not uri.startswith(hub_prefix):
-        return uri, False
-    name = uri[len(hub_prefix) :]
-    tag = "master"
-    if ":" in name:
-        loc = name.find(":")
-        tag = name[loc + 1 :]
-        name = name[:loc]
+def extend_hub_uri_if_needed(uri) -> Tuple[str, bool]:
+    """
+    Retrieve the full uri of the item's yaml in the hub.
 
+    :param uri: structure: "hub://[<source>/]<item-name>[:<tag>]"
+
+    :return: A tuple of:
+               [0] = Extended URI of item
+               [1] =  Is hub item (bool)
+    """
+    is_hub_uri = uri.startswith(hub_prefix)
+    if not is_hub_uri:
+        return uri, is_hub_uri
+
+    db = mlrun.get_run_db()
+    name = uri.removeprefix(hub_prefix)
+    tag = "latest"
+    source_name = ""
+    if ":" in name:
+        name, tag = name.split(":")
+    if "/" in name:
+        try:
+            source_name, name = name.split("/")
+        except ValueError as exc:
+            raise mlrun.errors.MLRunInvalidArgumentError(
+                "Invalid character '/' in function name or source name"
+            ) from exc
+    name = normalize_name(name=name, verbose=False)
+    if not source_name:
+        # Searching item in all sources
+        sources = db.list_hub_sources(item_name=name, tag=tag)
+        if not sources:
+            raise mlrun.errors.MLRunNotFoundError(
+                f"Item={name}, tag={tag} not found in any hub source"
+            )
+        # precedence to user source
+        indexed_source = sources[0]
+    else:
+        # Specific source is given
+        indexed_source = db.get_hub_source(source_name)
     # hub function directory name are with underscores instead of hyphens
     name = name.replace("-", "_")
-    return config.get_hub_url().format(name=name, tag=tag), True
+    function_suffix = f"{name}/{tag}/src/function.yaml"
+    return indexed_source.source.get_full_uri(function_suffix), is_hub_uri
 
 
 def gen_md_table(header, rows=None):
     rows = [] if rows is None else rows
 
     def gen_list(items=None):
         items = [] if items is None else items
@@ -1443,11 +1491,17 @@
 
     def __getattr__(self, attr):
         self._warn()
         return getattr(self._new_target, attr)
 
 
 def normalize_workflow_name(name, project_name):
-    workflow_name = (
-        name.lstrip(project_name).lstrip("-") if project_name in name else name
-    )
-    return workflow_name
+    return name.removeprefix(project_name + "-")
+
+
+# run_in threadpool is taken from fastapi to allow us to run sync functions in a threadpool
+# without importing fastapi in the client
+async def run_in_threadpool(func, *args, **kwargs):
+    if kwargs:
+        # run_sync doesn't accept 'kwargs', so bind them in here
+        func = functools.partial(func, **kwargs)
+    return await anyio.to_thread.run_sync(func, *args)
```

## mlrun/utils/notifications/notification_pusher.py

```diff
@@ -14,19 +14,18 @@
 
 import asyncio
 import datetime
 import os
 import typing
 from concurrent.futures import ThreadPoolExecutor
 
-from fastapi.concurrency import run_in_threadpool
-
 import mlrun.common.schemas
 import mlrun.config
 import mlrun.db.base
+import mlrun.errors
 import mlrun.lists
 import mlrun.model
 import mlrun.utils.helpers
 from mlrun.utils import logger
 from mlrun.utils.condition_evaluator import evaluate_condition_in_separate_process
 
 from .notification import NotificationBase, NotificationTypes
@@ -201,22 +200,33 @@
         logger.debug(
             "Pushing sync notification",
             notification=_sanitize_notification(notification_object),
             run_uid=run.metadata.uid,
         )
         try:
             notification.push(message, severity, runs)
+            logger.debug(
+                "Notification sent successfully",
+                notification=_sanitize_notification(notification_object),
+                run_uid=run.metadata.uid,
+            )
             self._update_notification_status(
                 run.metadata.uid,
                 run.metadata.project,
                 notification_object,
                 status=mlrun.common.schemas.NotificationStatus.SENT,
                 sent_time=datetime.datetime.now(tz=datetime.timezone.utc),
             )
         except Exception as exc:
+            logger.warning(
+                "Failed to send notification",
+                notification=_sanitize_notification(notification_object),
+                run_uid=run.metadata.uid,
+                exc=mlrun.errors.err_to_str(exc),
+            )
             self._update_notification_status(
                 run.metadata.uid,
                 run.metadata.project,
                 notification_object,
                 status=mlrun.common.schemas.NotificationStatus.ERROR,
             )
             raise exc
@@ -233,25 +243,35 @@
         logger.debug(
             "Pushing async notification",
             notification=_sanitize_notification(notification_object),
             run_uid=run.metadata.uid,
         )
         try:
             await notification.push(message, severity, runs)
-
-            await run_in_threadpool(
+            logger.debug(
+                "Notification sent successfully",
+                notification=_sanitize_notification(notification_object),
+                run_uid=run.metadata.uid,
+            )
+            await mlrun.utils.helpers.run_in_threadpool(
                 self._update_notification_status,
                 run.metadata.uid,
                 run.metadata.project,
                 notification_object,
                 status=mlrun.common.schemas.NotificationStatus.SENT,
                 sent_time=datetime.datetime.now(tz=datetime.timezone.utc),
             )
         except Exception as exc:
-            await run_in_threadpool(
+            logger.warning(
+                "Failed to send notification",
+                notification=_sanitize_notification(notification_object),
+                run_uid=run.metadata.uid,
+                exc=mlrun.errors.err_to_str(exc),
+            )
+            await mlrun.utils.helpers.run_in_threadpool(
                 self._update_notification_status,
                 run.metadata.uid,
                 run.metadata.project,
                 notification_object,
                 status=mlrun.common.schemas.NotificationStatus.ERROR,
             )
             raise exc
```

## mlrun/utils/version/version.json

### Pretty-printed

 * *Similarity: 0.5%*

 * *Differences: {"'git_commit'": "'c88418421deeb9ee3b44521697cc8cddd8770a7d'", "'version'": "'1.5.0-rc3'"}*

```diff
@@ -1,4 +1,4 @@
 {
-    "git_commit": "dcf0e7215136557c4f4d1159a1b494defce16d40",
-    "version": "1.5.0-rc2"
+    "git_commit": "c88418421deeb9ee3b44521697cc8cddd8770a7d",
+    "version": "1.5.0-rc3"
 }
```

## Comparing `mlrun-1.5.0rc2.dist-info/LICENSE` & `mlrun-1.5.0rc3.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `mlrun-1.5.0rc2.dist-info/METADATA` & `mlrun-1.5.0rc3.dist-info/METADATA`

 * *Files 7% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: mlrun
-Version: 1.5.0rc2
+Version: 1.5.0rc3
 Summary: Tracking and config of machine learning runs
 Home-page: https://github.com/mlrun/mlrun
 Author: Yaron Haviv
 Author-email: yaronh@iguazio.com
 License: MIT
 Platform: UNKNOWN
 Classifier: Development Status :: 4 - Beta
@@ -17,157 +17,166 @@
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python
 Classifier: Topic :: Software Development :: Libraries :: Python Modules
 Classifier: Topic :: Software Development :: Libraries
 Description-Content-Type: text/markdown
 License-File: LICENSE
-Requires-Dist: urllib3 (<1.27,>=1.26.9)
-Requires-Dist: chardet (<4.0,>=3.0.2)
-Requires-Dist: GitPython (>=3.1.30,~=3.1)
-Requires-Dist: aiohttp (~=3.8)
-Requires-Dist: aiohttp-retry (~=2.8)
-Requires-Dist: click (~=8.0.0)
-Requires-Dist: kfp (<1.8.14,~=1.8.0)
-Requires-Dist: nest-asyncio (~=1.0)
-Requires-Dist: ipython (<9.0,>=7.0)
-Requires-Dist: nuclio-jupyter (~=0.9.11)
-Requires-Dist: numpy (<1.23.0,>=1.16.5)
-Requires-Dist: pandas (<1.5.0,~=1.2)
-Requires-Dist: pyarrow (<12,>=10.0)
-Requires-Dist: pyyaml (~=5.1)
-Requires-Dist: requests (~=2.22)
-Requires-Dist: sqlalchemy (~=1.4)
-Requires-Dist: tabulate (~=0.8.6)
-Requires-Dist: v3io (~=0.5.21)
-Requires-Dist: pydantic (>=1.10.8,~=1.10)
-Requires-Dist: orjson (<3.8.12,~=3.3)
-Requires-Dist: alembic (~=1.9)
-Requires-Dist: mergedeep (~=1.3)
-Requires-Dist: v3io-frames (~=0.10.4)
-Requires-Dist: semver (~=2.13)
-Requires-Dist: dask (~=2021.11.2)
-Requires-Dist: distributed (~=2021.11.2)
-Requires-Dist: kubernetes (~=12.0)
-Requires-Dist: dependency-injector (~=4.41)
-Requires-Dist: humanfriendly (~=9.2)
-Requires-Dist: fastapi (~=0.95.2)
-Requires-Dist: fsspec (~=2023.6.0)
-Requires-Dist: v3iofs (~=0.1.15)
-Requires-Dist: storey (~=1.5.2)
-Requires-Dist: deepdiff (~=5.0)
-Requires-Dist: pymysql (~=1.0)
-Requires-Dist: inflection (~=0.5.0)
-Requires-Dist: python-dotenv (~=0.17.0)
-Requires-Dist: setuptools (~=65.5)
-Requires-Dist: deprecated (~=1.2)
-Requires-Dist: jinja2 (~=3.1)
+Requires-Dist: urllib3 <1.27,>=1.26.9
+Requires-Dist: chardet <4.0,>=3.0.2
+Requires-Dist: GitPython >=3.1.30,~=3.1
+Requires-Dist: aiohttp ~=3.8
+Requires-Dist: aiohttp-retry ~=2.8
+Requires-Dist: click ~=8.0.0
+Requires-Dist: kfp <1.8.14,~=1.8.0
+Requires-Dist: nest-asyncio ~=1.0
+Requires-Dist: ipython <9.0,>=7.0
+Requires-Dist: nuclio-jupyter ~=0.9.11
+Requires-Dist: numpy <1.23.0,>=1.16.5
+Requires-Dist: pandas <1.5.0,~=1.2
+Requires-Dist: pyarrow <12,>=10.0
+Requires-Dist: pyyaml ~=5.1
+Requires-Dist: requests ~=2.22
+Requires-Dist: tabulate ~=0.8.6
+Requires-Dist: v3io ~=0.5.21
+Requires-Dist: pydantic >=1.10.8,~=1.10
+Requires-Dist: orjson <3.8.12,~=3.3
+Requires-Dist: alembic ~=1.9
+Requires-Dist: mergedeep ~=1.3
+Requires-Dist: v3io-frames ~=0.10.4
+Requires-Dist: semver ~=2.13
+Requires-Dist: dask ~=2021.11.2
+Requires-Dist: distributed ~=2021.11.2
+Requires-Dist: kubernetes ~=12.0
+Requires-Dist: dependency-injector ~=4.41
+Requires-Dist: fsspec <2023.7,>=2023.1
+Requires-Dist: v3iofs ~=0.1.15
+Requires-Dist: storey ~=1.5.2
+Requires-Dist: deepdiff ~=5.0
+Requires-Dist: pymysql ~=1.0
+Requires-Dist: inflection ~=0.5.0
+Requires-Dist: python-dotenv ~=0.17.0
+Requires-Dist: setuptools ~=65.5
+Requires-Dist: deprecated ~=1.2
+Requires-Dist: jinja2 ~=3.1
+Requires-Dist: anyio ~=3.5
 Provides-Extra: all
-Requires-Dist: adlfs (~=2023.4.0) ; extra == 'all'
-Requires-Dist: aiobotocore (~=2.5.2) ; extra == 'all'
-Requires-Dist: avro (~=1.11) ; extra == 'all'
-Requires-Dist: azure-core (~=1.24) ; extra == 'all'
-Requires-Dist: azure-identity (~=1.5) ; extra == 'all'
-Requires-Dist: azure-keyvault-secrets (~=4.2) ; extra == 'all'
-Requires-Dist: azure-storage-blob (~=12.13) ; extra == 'all'
-Requires-Dist: bokeh (>=2.4.2,~=2.4) ; extra == 'all'
-Requires-Dist: boto3 (~=1.26.161) ; extra == 'all'
-Requires-Dist: gcsfs (~=2023.6.0) ; extra == 'all'
-Requires-Dist: google-cloud-bigquery[bqstorage,pandas] (~=3.2) ; extra == 'all'
-Requires-Dist: google-cloud-storage (~=1.20) ; extra == 'all'
-Requires-Dist: google-cloud (~=0.34) ; extra == 'all'
-Requires-Dist: graphviz (~=0.20.0) ; extra == 'all'
-Requires-Dist: kafka-python (~=2.0) ; extra == 'all'
-Requires-Dist: msrest (~=0.6.21) ; extra == 'all'
-Requires-Dist: plotly (<5.12.0,~=5.4) ; extra == 'all'
-Requires-Dist: pyopenssl (>=23) ; extra == 'all'
-Requires-Dist: redis (~=4.3) ; extra == 'all'
-Requires-Dist: s3fs (~=2023.6.0) ; extra == 'all'
+Requires-Dist: adlfs <2023.5,>=2022.2 ; extra == 'all'
+Requires-Dist: aiobotocore <2.6,>=2.4.2 ; extra == 'all'
+Requires-Dist: avro ~=1.11 ; extra == 'all'
+Requires-Dist: azure-core ~=1.24 ; extra == 'all'
+Requires-Dist: azure-identity ~=1.5 ; extra == 'all'
+Requires-Dist: azure-keyvault-secrets ~=4.2 ; extra == 'all'
+Requires-Dist: azure-storage-blob ~=12.13 ; extra == 'all'
+Requires-Dist: bokeh >=2.4.2,~=2.4 ; extra == 'all'
+Requires-Dist: boto3 <1.27,>=1.24.59 ; extra == 'all'
+Requires-Dist: databricks-sdk ~=0.3.0 ; extra == 'all'
+Requires-Dist: gcsfs <2023.7,>=2023.1 ; extra == 'all'
+Requires-Dist: google-cloud-bigquery[bqstorage,pandas] ~=3.2 ; extra == 'all'
+Requires-Dist: google-cloud-storage ~=1.20 ; extra == 'all'
+Requires-Dist: google-cloud ~=0.34 ; extra == 'all'
+Requires-Dist: graphviz ~=0.20.0 ; extra == 'all'
+Requires-Dist: kafka-python ~=2.0 ; extra == 'all'
+Requires-Dist: msrest ~=0.6.21 ; extra == 'all'
+Requires-Dist: plotly <5.12.0,~=5.4 ; extra == 'all'
+Requires-Dist: pyopenssl >=23 ; extra == 'all'
+Requires-Dist: redis ~=4.3 ; extra == 'all'
+Requires-Dist: s3fs <2023.7,>=2023.1 ; extra == 'all'
 Provides-Extra: api
-Requires-Dist: uvicorn (~=0.20.0) ; extra == 'api'
-Requires-Dist: dask-kubernetes (~=0.11.0) ; extra == 'api'
-Requires-Dist: apscheduler (~=3.6) ; extra == 'api'
-Requires-Dist: sqlite3-to-mysql (~=1.4) ; extra == 'api'
-Requires-Dist: objgraph (~=3.5) ; extra == 'api'
-Requires-Dist: igz-mgmt (~=0.0.10) ; extra == 'api'
+Requires-Dist: uvicorn ~=0.20.0 ; extra == 'api'
+Requires-Dist: dask-kubernetes ~=0.11.0 ; extra == 'api'
+Requires-Dist: apscheduler ~=3.6 ; extra == 'api'
+Requires-Dist: sqlite3-to-mysql ~=1.4 ; extra == 'api'
+Requires-Dist: objgraph ~=3.5 ; extra == 'api'
+Requires-Dist: igz-mgmt ~=0.0.10 ; extra == 'api'
+Requires-Dist: humanfriendly ~=9.2 ; extra == 'api'
+Requires-Dist: fastapi ~=0.95.2 ; extra == 'api'
+Requires-Dist: sqlalchemy ~=1.4 ; extra == 'api'
 Provides-Extra: azure-blob-storage
-Requires-Dist: msrest (~=0.6.21) ; extra == 'azure-blob-storage'
-Requires-Dist: azure-core (~=1.24) ; extra == 'azure-blob-storage'
-Requires-Dist: azure-storage-blob (~=12.13) ; extra == 'azure-blob-storage'
-Requires-Dist: adlfs (~=2023.4.0) ; extra == 'azure-blob-storage'
-Requires-Dist: pyopenssl (>=23) ; extra == 'azure-blob-storage'
+Requires-Dist: msrest ~=0.6.21 ; extra == 'azure-blob-storage'
+Requires-Dist: azure-core ~=1.24 ; extra == 'azure-blob-storage'
+Requires-Dist: azure-storage-blob ~=12.13 ; extra == 'azure-blob-storage'
+Requires-Dist: adlfs <2023.5,>=2022.2 ; extra == 'azure-blob-storage'
+Requires-Dist: pyopenssl >=23 ; extra == 'azure-blob-storage'
 Provides-Extra: azure-key-vault
-Requires-Dist: azure-identity (~=1.5) ; extra == 'azure-key-vault'
-Requires-Dist: azure-keyvault-secrets (~=4.2) ; extra == 'azure-key-vault'
-Requires-Dist: pyopenssl (>=23) ; extra == 'azure-key-vault'
+Requires-Dist: azure-identity ~=1.5 ; extra == 'azure-key-vault'
+Requires-Dist: azure-keyvault-secrets ~=4.2 ; extra == 'azure-key-vault'
+Requires-Dist: pyopenssl >=23 ; extra == 'azure-key-vault'
 Provides-Extra: bokeh
-Requires-Dist: bokeh (>=2.4.2,~=2.4) ; extra == 'bokeh'
+Requires-Dist: bokeh >=2.4.2,~=2.4 ; extra == 'bokeh'
 Provides-Extra: complete
-Requires-Dist: adlfs (~=2023.4.0) ; extra == 'complete'
-Requires-Dist: aiobotocore (~=2.5.2) ; extra == 'complete'
-Requires-Dist: avro (~=1.11) ; extra == 'complete'
-Requires-Dist: azure-core (~=1.24) ; extra == 'complete'
-Requires-Dist: azure-identity (~=1.5) ; extra == 'complete'
-Requires-Dist: azure-keyvault-secrets (~=4.2) ; extra == 'complete'
-Requires-Dist: azure-storage-blob (~=12.13) ; extra == 'complete'
-Requires-Dist: boto3 (~=1.26.161) ; extra == 'complete'
-Requires-Dist: gcsfs (~=2023.6.0) ; extra == 'complete'
-Requires-Dist: google-cloud-bigquery[bqstorage,pandas] (~=3.2) ; extra == 'complete'
-Requires-Dist: graphviz (~=0.20.0) ; extra == 'complete'
-Requires-Dist: kafka-python (~=2.0) ; extra == 'complete'
-Requires-Dist: msrest (~=0.6.21) ; extra == 'complete'
-Requires-Dist: plotly (<5.12.0,~=5.4) ; extra == 'complete'
-Requires-Dist: pyopenssl (>=23) ; extra == 'complete'
-Requires-Dist: redis (~=4.3) ; extra == 'complete'
-Requires-Dist: s3fs (~=2023.6.0) ; extra == 'complete'
+Requires-Dist: adlfs <2023.5,>=2022.2 ; extra == 'complete'
+Requires-Dist: aiobotocore <2.6,>=2.4.2 ; extra == 'complete'
+Requires-Dist: avro ~=1.11 ; extra == 'complete'
+Requires-Dist: azure-core ~=1.24 ; extra == 'complete'
+Requires-Dist: azure-identity ~=1.5 ; extra == 'complete'
+Requires-Dist: azure-keyvault-secrets ~=4.2 ; extra == 'complete'
+Requires-Dist: azure-storage-blob ~=12.13 ; extra == 'complete'
+Requires-Dist: boto3 <1.27,>=1.24.59 ; extra == 'complete'
+Requires-Dist: databricks-sdk ~=0.3.0 ; extra == 'complete'
+Requires-Dist: gcsfs <2023.7,>=2023.1 ; extra == 'complete'
+Requires-Dist: google-cloud-bigquery[bqstorage,pandas] ~=3.2 ; extra == 'complete'
+Requires-Dist: graphviz ~=0.20.0 ; extra == 'complete'
+Requires-Dist: kafka-python ~=2.0 ; extra == 'complete'
+Requires-Dist: msrest ~=0.6.21 ; extra == 'complete'
+Requires-Dist: plotly <5.12.0,~=5.4 ; extra == 'complete'
+Requires-Dist: pyopenssl >=23 ; extra == 'complete'
+Requires-Dist: redis ~=4.3 ; extra == 'complete'
+Requires-Dist: s3fs <2023.7,>=2023.1 ; extra == 'complete'
 Provides-Extra: complete-api
-Requires-Dist: adlfs (~=2023.4.0) ; extra == 'complete-api'
-Requires-Dist: aiobotocore (~=2.5.2) ; extra == 'complete-api'
-Requires-Dist: apscheduler (~=3.6) ; extra == 'complete-api'
-Requires-Dist: avro (~=1.11) ; extra == 'complete-api'
-Requires-Dist: azure-core (~=1.24) ; extra == 'complete-api'
-Requires-Dist: azure-identity (~=1.5) ; extra == 'complete-api'
-Requires-Dist: azure-keyvault-secrets (~=4.2) ; extra == 'complete-api'
-Requires-Dist: azure-storage-blob (~=12.13) ; extra == 'complete-api'
-Requires-Dist: boto3 (~=1.26.161) ; extra == 'complete-api'
-Requires-Dist: dask-kubernetes (~=0.11.0) ; extra == 'complete-api'
-Requires-Dist: gcsfs (~=2023.6.0) ; extra == 'complete-api'
-Requires-Dist: google-cloud-bigquery[bqstorage,pandas] (~=3.2) ; extra == 'complete-api'
-Requires-Dist: graphviz (~=0.20.0) ; extra == 'complete-api'
-Requires-Dist: igz-mgmt (~=0.0.10) ; extra == 'complete-api'
-Requires-Dist: kafka-python (~=2.0) ; extra == 'complete-api'
-Requires-Dist: msrest (~=0.6.21) ; extra == 'complete-api'
-Requires-Dist: objgraph (~=3.5) ; extra == 'complete-api'
-Requires-Dist: plotly (<5.12.0,~=5.4) ; extra == 'complete-api'
-Requires-Dist: pyopenssl (>=23) ; extra == 'complete-api'
-Requires-Dist: redis (~=4.3) ; extra == 'complete-api'
-Requires-Dist: s3fs (~=2023.6.0) ; extra == 'complete-api'
-Requires-Dist: sqlite3-to-mysql (~=1.4) ; extra == 'complete-api'
-Requires-Dist: uvicorn (~=0.20.0) ; extra == 'complete-api'
+Requires-Dist: adlfs <2023.5,>=2022.2 ; extra == 'complete-api'
+Requires-Dist: aiobotocore <2.6,>=2.4.2 ; extra == 'complete-api'
+Requires-Dist: apscheduler ~=3.6 ; extra == 'complete-api'
+Requires-Dist: avro ~=1.11 ; extra == 'complete-api'
+Requires-Dist: azure-core ~=1.24 ; extra == 'complete-api'
+Requires-Dist: azure-identity ~=1.5 ; extra == 'complete-api'
+Requires-Dist: azure-keyvault-secrets ~=4.2 ; extra == 'complete-api'
+Requires-Dist: azure-storage-blob ~=12.13 ; extra == 'complete-api'
+Requires-Dist: boto3 <1.27,>=1.24.59 ; extra == 'complete-api'
+Requires-Dist: dask-kubernetes ~=0.11.0 ; extra == 'complete-api'
+Requires-Dist: databricks-sdk ~=0.3.0 ; extra == 'complete-api'
+Requires-Dist: fastapi ~=0.95.2 ; extra == 'complete-api'
+Requires-Dist: gcsfs <2023.7,>=2023.1 ; extra == 'complete-api'
+Requires-Dist: google-cloud-bigquery[bqstorage,pandas] ~=3.2 ; extra == 'complete-api'
+Requires-Dist: graphviz ~=0.20.0 ; extra == 'complete-api'
+Requires-Dist: humanfriendly ~=9.2 ; extra == 'complete-api'
+Requires-Dist: igz-mgmt ~=0.0.10 ; extra == 'complete-api'
+Requires-Dist: kafka-python ~=2.0 ; extra == 'complete-api'
+Requires-Dist: msrest ~=0.6.21 ; extra == 'complete-api'
+Requires-Dist: objgraph ~=3.5 ; extra == 'complete-api'
+Requires-Dist: plotly <5.12.0,~=5.4 ; extra == 'complete-api'
+Requires-Dist: pyopenssl >=23 ; extra == 'complete-api'
+Requires-Dist: redis ~=4.3 ; extra == 'complete-api'
+Requires-Dist: s3fs <2023.7,>=2023.1 ; extra == 'complete-api'
+Requires-Dist: sqlalchemy ~=1.4 ; extra == 'complete-api'
+Requires-Dist: sqlite3-to-mysql ~=1.4 ; extra == 'complete-api'
+Requires-Dist: uvicorn ~=0.20.0 ; extra == 'complete-api'
+Provides-Extra: databricks-sdk
+Requires-Dist: databricks-sdk ~=0.3.0 ; extra == 'databricks-sdk'
 Provides-Extra: google-cloud
-Requires-Dist: google-cloud-storage (~=1.20) ; extra == 'google-cloud'
-Requires-Dist: google-cloud-bigquery[bqstorage,pandas] (~=3.2) ; extra == 'google-cloud'
-Requires-Dist: google-cloud (~=0.34) ; extra == 'google-cloud'
+Requires-Dist: google-cloud-storage ~=1.20 ; extra == 'google-cloud'
+Requires-Dist: google-cloud-bigquery[bqstorage,pandas] ~=3.2 ; extra == 'google-cloud'
+Requires-Dist: google-cloud ~=0.34 ; extra == 'google-cloud'
 Provides-Extra: google-cloud-bigquery
-Requires-Dist: google-cloud-bigquery[bqstorage,pandas] (~=3.2) ; extra == 'google-cloud-bigquery'
+Requires-Dist: google-cloud-bigquery[bqstorage,pandas] ~=3.2 ; extra == 'google-cloud-bigquery'
 Provides-Extra: google-cloud-storage
-Requires-Dist: gcsfs (~=2023.6.0) ; extra == 'google-cloud-storage'
+Requires-Dist: gcsfs <2023.7,>=2023.1 ; extra == 'google-cloud-storage'
 Provides-Extra: graphviz
-Requires-Dist: graphviz (~=0.20.0) ; extra == 'graphviz'
+Requires-Dist: graphviz ~=0.20.0 ; extra == 'graphviz'
 Provides-Extra: kafka
-Requires-Dist: kafka-python (~=2.0) ; extra == 'kafka'
-Requires-Dist: avro (~=1.11) ; extra == 'kafka'
+Requires-Dist: kafka-python ~=2.0 ; extra == 'kafka'
+Requires-Dist: avro ~=1.11 ; extra == 'kafka'
 Provides-Extra: plotly
-Requires-Dist: plotly (<5.12.0,~=5.4) ; extra == 'plotly'
+Requires-Dist: plotly <5.12.0,~=5.4 ; extra == 'plotly'
 Provides-Extra: redis
-Requires-Dist: redis (~=4.3) ; extra == 'redis'
+Requires-Dist: redis ~=4.3 ; extra == 'redis'
 Provides-Extra: s3
-Requires-Dist: boto3 (~=1.26.161) ; extra == 's3'
-Requires-Dist: aiobotocore (~=2.5.2) ; extra == 's3'
-Requires-Dist: s3fs (~=2023.6.0) ; extra == 's3'
+Requires-Dist: boto3 <1.27,>=1.24.59 ; extra == 's3'
+Requires-Dist: aiobotocore <2.6,>=2.4.2 ; extra == 's3'
+Requires-Dist: s3fs <2023.7,>=2023.1 ; extra == 's3'
 
 <a id="top"></a>
 [![Build Status](https://github.com/mlrun/mlrun/workflows/CI/badge.svg)](https://github.com/mlrun/mlrun/actions)
 [![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
 [![PyPI version fury.io](https://badge.fury.io/py/mlrun.svg)](https://pypi.python.org/pypi/mlrun/)
 [![Documentation](https://readthedocs.org/projects/mlrun/badge/?version=latest)](https://mlrun.readthedocs.io/en/latest/?badge=latest)
 [![Code style: black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)
```

## Comparing `mlrun-1.5.0rc2.dist-info/RECORD` & `mlrun-1.5.0rc3.dist-info/RECORD`

 * *Files 2% similar despite different names*

```diff
@@ -1,44 +1,46 @@
 mlrun/__init__.py,sha256=adWxPTY8n0qaMkwt3KVGPN2hZeHT4vcG7lWZxBewEg4,7279
-mlrun/__main__.py,sha256=WeCDL8gBtdACJtSoAIusxM8-lCPoUPbgt_b_GUEV6l8,48410
-mlrun/config.py,sha256=lkxnwIvJf48E-vWBUH25AKmr3ej4DIgaGcQOSAd4NEw,56571
+mlrun/__main__.py,sha256=cdt32TZDjEp6MKrD8gT8D50QltE-7riDVCYH2hGGVWM,48480
+mlrun/config.py,sha256=Q7z1MA7KXgaYUpkO8U4Hepknwvb7y6qttCHV_JvevEs,56989
 mlrun/errors.py,sha256=pYZZtJsMqkFktG6T8iTyfyESrrhOLfKvB3U_jUDHMo8,6780
 mlrun/execution.py,sha256=DPy9QzI18sRrI8vu4qXChl7QAPbc5swi_AU7E5YWBj0,39723
 mlrun/features.py,sha256=UQQ2uh5Xh9XsMGiYBqh3bKgDhOHANjv1gQgWyId9qQE,15624
 mlrun/k8s_utils.py,sha256=DhaLjX9Y4n6MZ-Gie2puEQ7LNQ9N6yUmnu6W_Y5ifMU,4876
 mlrun/kfpops.py,sha256=ezBWKexTjI7krBegx5aKY_6qn0fo1a3oFSBUctcsDbQ,29489
 mlrun/lists.py,sha256=lMbcVvtS5MLI40JPtT5ithTojX8xUZx4RkZX0-L9zUE,8390
-mlrun/model.py,sha256=fiUSUifDw1WbQFTi6rA0HF9Re9nmQqSnEmaVF4NjXIo,60317
+mlrun/model.py,sha256=mrHDDovpNJKbOLVqwj35OdlG0OOhI7QcGZuaR7MfR6g,60657
 mlrun/render.py,sha256=a_s-kzQ35bJg7e7cBxk3MCnoIK4qvDS2dGO8RzHgI1c,13016
-mlrun/run.py,sha256=UK2HdQ9kXmQGzE1H0_ogs-cS0mjmnF3dIe3C20EYATU,47007
+mlrun/run.py,sha256=Snp2pQYsxblkRefN6_-qyMgfRxFLwsx1q72kqiHjqUo,47374
 mlrun/secrets.py,sha256=hr2Ia9kLkoMM3KoxijXqO6AIJOUrrLxvz4Q7Xk39d4Y,7783
 mlrun/api/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/api/alembic.ini,sha256=oeSJRHwBbF3c3-N_RJilcZD-diq3F-oPv21gDIkrZGs,2105
 mlrun/api/constants.py,sha256=8xjdBYxt3-5_osRk_rII1nabyL3zMVOxnCJ6YrEhdFQ,685
-mlrun/api/initial_data.py,sha256=Ow2nWkgGc3AoJqZMaVnMpgLspJlREpBYfOquW9aV4eA,25653
-mlrun/api/launcher.py,sha256=kv7vf-HBxH-55KbY3tnYvxBGEJCzzvcJMCoNUsdnY4g,8681
+mlrun/api/initial_data.py,sha256=THxb9BrUVJMdmyGDoNc5uVN7-DrgKcRtBLhXSUebKO0,26133
+mlrun/api/launcher.py,sha256=J6iopTnW4t4AcE1kUcEG1Dpsp47ZRecG7BvwiFYCfjs,9167
 mlrun/api/main.py,sha256=4HLGz7lGW7b0WNuIoX3PzMzlCSuGqu47IVJ3rOrYB0k,27263
 mlrun/api/middlewares.py,sha256=JXI4HOR-2w9Cf30my4vMK-pC1zgAFHK65NzFYgRcOuI,5289
 mlrun/api/api/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
-mlrun/api/api/api.py,sha256=I2ctjy96mjVcncmMU94BoQU0KzFhrmVRYcI8zImQWkg,4402
+mlrun/api/api/api.py,sha256=QUUjbjBq2H_4cTExYgXAQ2zIWNOPGEUUd2g8wfxxILk,4644
 mlrun/api/api/deps.py,sha256=4jSegE1XNWvy93LKnI-NGvR-yhJdNqueVGHFJLKldpg,3197
-mlrun/api/api/utils.py,sha256=50UM15EfFLXW_XtxZ_58AE540T8fvyJeZT55RNdn2GM,40170
+mlrun/api/api/utils.py,sha256=4l9PHJifr3L7ksJyCM_4jIUaMmA4LsRwtQx9UTJuzZE,39018
 mlrun/api/api/endpoints/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/api/api/endpoints/artifacts.py,sha256=-MPAuhzyepyd6Fxa5ZFidcDksNGP_Vmd2DRnFND7ug0,10452
 mlrun/api/api/endpoints/auth.py,sha256=hoqYSELX_6Zi3Cvep2nGLJgBo4YbMJoCt3WwbEZrnDU,1199
 mlrun/api/api/endpoints/background_tasks.py,sha256=5SV4iDF-dZR878kp77VpANRb86BJYgffrHnGsM4gQ3o,3618
 mlrun/api/api/endpoints/client_spec.py,sha256=lN2By-KGzHuzNTGiJk0RK3SM6ZUr3VLgsudsymrtZE8,1214
 mlrun/api/api/endpoints/clusterization_spec.py,sha256=0eSG7TSt647V7-A-uI5CLRItkVOBqIBM9ep_fiMFqPI,1175
+mlrun/api/api/endpoints/datastore_profile.py,sha256=aYfuVQrtdnp7B5SHKprc0eZHo9yuVENTLsiJzgffUD4,4860
 mlrun/api/api/endpoints/feature_store.py,sha256=mq6XVv9zaW7zU-XRHh8X2gTwk-z6a1QE3bcuOdR6jQU,28853
 mlrun/api/api/endpoints/files.py,sha256=2pYv6JG_SKxjNB4QqXu7ssmluEElSoOZ1NJeHASPz98,6709
 mlrun/api/api/endpoints/frontend_spec.py,sha256=ppmYdRS6_JqEDBcArTnT0EOXidVtiDoA1zYJwa_4A70,5946
-mlrun/api/api/endpoints/functions.py,sha256=Exi-B-SZg_3Jbu8Q820cS4D8K5nhGpULcDw0l2wlFds,38214
+mlrun/api/api/endpoints/functions.py,sha256=K6-Etdg7pOmIMU5OjvsQVfI4PtP3Kgxg5CF1rrIXJQE,37458
 mlrun/api/api/endpoints/grafana_proxy.py,sha256=5PvWjqTeb88kNtuTtZub9eFgr6I0ORlmPXGHk6G1QfM,6086
 mlrun/api/api/endpoints/healthz.py,sha256=DVNb94DLQhmQWxxo5d3AZbd82AL_PGuzU6NJ3IT5pkA,1344
-mlrun/api/api/endpoints/hub.py,sha256=3v9SQKUdZt2LNpGpegbQXaRsjGty4fujA9DBCVwGKUk,10312
+mlrun/api/api/endpoints/hub.py,sha256=6uOYYft-ZZ8xTxW743UIoWxZ4BoOcJOIH8KKqGWtx2A,10624
+mlrun/api/api/endpoints/jobs.py,sha256=TTfV0xGrThuf8XqeGlrH34_aoo89QDt_wJgy7WcxD44,2931
 mlrun/api/api/endpoints/logs.py,sha256=jMoRvAxgIIcwNahTbH_FPScND_m_Yez91SS92KUGahw,2975
 mlrun/api/api/endpoints/model_endpoints.py,sha256=nSqZZcSKl_mGb13Sa-CXCfIBBZwZvxkvFoGnb3VdX0M,15734
 mlrun/api/api/endpoints/operations.py,sha256=tLqaRsyVP8CxCv8H_IDg3GtJW040xY5F_D5exLF7bGg,3756
 mlrun/api/api/endpoints/pipelines.py,sha256=1tyw8E9fS4K2MeVHSyd3ED1uPVLO0KUmddamsODdtLg,9098
 mlrun/api/api/endpoints/projects.py,sha256=nCHgjYNxC4_E33WB_kWoFj-3yULxE11f39xJcH0M8F8,14736
 mlrun/api/api/endpoints/runs.py,sha256=KgB65u6X7WS7JKo_9Z4psSHvrCWconB2ahnfwV6WXpE,11881
 mlrun/api/api/endpoints/runtime_resources.py,sha256=_Nv7CJTRI4gimlDbwufEWRJQhZFK9UNqIcJjDYwOkg0,9035
@@ -46,98 +48,101 @@
 mlrun/api/api/endpoints/secrets.py,sha256=jPOQiTXMRUYcR9K0NT74ScNQaZpI1o-DMUnjtt6RsvE,6061
 mlrun/api/api/endpoints/submit.py,sha256=xKUX-9q6Zh0s9XOZueorn-Dc6knK4eSz3SS73Q0fXKc,5327
 mlrun/api/api/endpoints/tags.py,sha256=KIZziSd6XF2TR94b_4_UDsptXHecDXgOIwQYFRApGmA,4849
 mlrun/api/api/endpoints/workflows.py,sha256=vZEgZ6gEDdTRJgBxJPd8-XIsyNsNGUZxTrFSntMhG3c,13795
 mlrun/api/api/endpoints/internal/__init__.py,sha256=IVXgIyUv8lVStgCjFm3fZDDMIqEzmMAvkbbbOKwNJgo,1203
 mlrun/api/api/endpoints/internal/config.py,sha256=IVqf6YWokNXY3LC5o1BWqlEDVQ-AJdRrbWRwTFFAwfY,1043
 mlrun/api/api/endpoints/internal/memory_reports.py,sha256=PRVaj8i_WAbIqjP37xBlYfPunkZHTCXMprka0Qoxhxw,1718
-mlrun/api/crud/__init__.py,sha256=nQO8wnRDTpto2gs0CeivRodpr_Voa0eCqL-NthBpy-k,1248
+mlrun/api/crud/__init__.py,sha256=EvtS3LBcPy2ZDJMgiHe-9CSzsnTVsRAuIcGW_szATO8,1298
 mlrun/api/crud/artifacts.py,sha256=Z0CzdgywxS352DD0MumACDfGg92VqZlOcBSw8FCRao8,5610
-mlrun/api/crud/client_spec.py,sha256=mMeK2UQ6b68TvanFqLEeTn0sRJmKHg5smriIhnij50k,7536
+mlrun/api/crud/client_spec.py,sha256=UeahrRu2Z9e43VkTo9Bqr14nBnL3mBNE2FVFOlkXgOs,7553
 mlrun/api/crud/clusterization_spec.py,sha256=6riIRpWf1dGTRUSi1lLeydO-3KCcnpQ-Y_AuUCm5i7k,1055
+mlrun/api/crud/datastore_profiles.py,sha256=y8qIgqsSHf_fmgSRzU1ogRU30VmFWteDzZjtN5VehQg,3883
 mlrun/api/crud/feature_store.py,sha256=Wizxaq6MXmj77Q4lR0-VawoSR3lmEDFQuaylmLtUTBM,18971
-mlrun/api/crud/functions.py,sha256=zub_q2QJ617kmokLMwdIHF5Mf7-o15amNXfFgOhg7n4,3556
-mlrun/api/crud/hub.py,sha256=qg1rkRPdLF5qDpaUKNSACmaEEHGhY1vThfOoiPiAfXw,12025
+mlrun/api/crud/functions.py,sha256=TQNtSP_AcLMhT1SNO0ViAFgzHeD4NnTEOjLYOOh9RzY,4536
+mlrun/api/crud/hub.py,sha256=eUXRtqqlCtbAzJyP7c1xvq76r7bzORP8r0wkED2raAg,14107
 mlrun/api/crud/logs.py,sha256=vFi9hynLqRT81erkGU2lhGmo394huYV3hoIkiInhspQ,9409
 mlrun/api/crud/notifications.py,sha256=Y4n-JYbFatBdHpIAuWOwLa2ilcTpfsM89Kyo1gmLuI8,5739
 mlrun/api/crud/pipelines.py,sha256=Z5_0RebYRglvSz7pN0GTCCYRC723U4d8D0U_DsfI7WQ,14781
 mlrun/api/crud/projects.py,sha256=yUeQDqNYeVJLoPKZNRNMBMwBaYU_g9dBpkUHy4ow-tA,15240
-mlrun/api/crud/runs.py,sha256=W_ahD8aFZCqJBfiLmxVkcjvLpJYaeHHF729vmEHLH4o,5963
+mlrun/api/crud/runs.py,sha256=RYTOOhn8lj4k5b63tu8sGVbnuDtbfuW8M-9GfjBHz1M,6226
 mlrun/api/crud/runtime_resources.py,sha256=hAulDtCyWrMDTe35gIetg3ApiHumBmCA7Ap3Fo2fSqw,5645
-mlrun/api/crud/secrets.py,sha256=8E5-DUwZDb0XB6frYIx_pUdFLumfk-yAR7qXasJ1GZ8,22158
+mlrun/api/crud/secrets.py,sha256=MnsA96ArLOlgqvXpKuIp1tWjKSWelD82tDtGhsm1d-k,22204
 mlrun/api/crud/tags.py,sha256=pcXXrmlfgCBCtw5uBX6hAHdqO96XIg0ov5vn-u6r5Q4,3277
-mlrun/api/crud/workflows.py,sha256=C92wZmMBWAtawzNkR9-WWy3B5qxskcb40x-6blAbWXQ,13193
+mlrun/api/crud/workflows.py,sha256=ehiHbA6GLL_qofum_7zBKb4bXssRe1XwTWVbjvQctEA,13485
 mlrun/api/crud/model_monitoring/__init__.py,sha256=_rZmfvis_Qkhephv_SEgzqUVuC4bY-D84mCyyztWRs0,759
-mlrun/api/crud/model_monitoring/deployment.py,sha256=EJgxqFA-PjaKtXCPCK7k741UbAt2O1NGJqul6pASUic,21692
+mlrun/api/crud/model_monitoring/deployment.py,sha256=p9rPFT3SUPB1jUfZO-KqA1qnlUVQ9qZwqDDZU-OXWyM,24698
 mlrun/api/crud/model_monitoring/grafana.py,sha256=7D-sUY3PjFh7_HjYe-KWryvepxO9zLArVC3U7IChuqA,17494
 mlrun/api/crud/model_monitoring/helpers.py,sha256=ry6OvaeUJHbzNxwK8Fs8cWs1UdX2uMrximGP9oaMc2c,5581
-mlrun/api/crud/model_monitoring/model_endpoints.py,sha256=2ZqFrjP5YN1O2CcjhgPdCag3w5eL6zxaQQz2_BBdj8Y,31573
+mlrun/api/crud/model_monitoring/model_endpoints.py,sha256=Sz9hibbb150-v0blisbLp781fMNco2yy67AMTOkLhmA,31643
 mlrun/api/crud/runtimes/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/api/crud/runtimes/nuclio/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/api/crud/runtimes/nuclio/function.py,sha256=Tgca7uACPlyeoGiLkIHsX0d9SePy_a6pEW03ryGMdPc,18762
 mlrun/api/crud/runtimes/nuclio/helpers.py,sha256=lx1apUFTUvKC9Itq1jEF0xPL4IhcaKf0G_qTNyOO6jM,11510
 mlrun/api/db/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
-mlrun/api/db/base.py,sha256=wjlLwEf2plcHMBEXIeAXzEJeI6BihHf6nSRCC51dtIU,15769
+mlrun/api/db/base.py,sha256=J4KvwQc5_QQnqlkU0-fLA9JdfJH4jY28MEHldCApD78,16379
 mlrun/api/db/init_db.py,sha256=WTHphTsHl-ZKszZsQk3V-lFTzIEbWYJADolleugQ8eg,739
 mlrun/api/db/session.py,sha256=VXNLPqYpLOVUqaWdkzgve2nzYxVCF991Wv98GALJGas,994
 mlrun/api/db/sqldb/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
-mlrun/api/db/sqldb/db.py,sha256=ZZmvotgc0JS2nZtDwFSQk-zXvfzIE7Vcau47B_Z-d9Y,151630
+mlrun/api/db/sqldb/db.py,sha256=sW9wb0x0zEXCUoA_KxGiqPLulSjK7v58oHlzp90xDsM,156090
 mlrun/api/db/sqldb/helpers.py,sha256=Asc_cDFE2e7gbQ3SVriYyyK4yu94wfOemYPYCMpNLws,2340
 mlrun/api/db/sqldb/models/__init__.py,sha256=oD0qix1voOtUiP-fG04QK5VHOPageoclcSjw0PIoBQY,1105
-mlrun/api/db/sqldb/models/models_mysql.py,sha256=uMqx79fm5msRVJVfa1qvhWKW3tJAvziaHWptkmQi_XY,21345
-mlrun/api/db/sqldb/models/models_sqlite.py,sha256=y73PcQQgN8WtLAHYHGrquBE-5cho4ANiIYlnXV65zxY,19014
+mlrun/api/db/sqldb/models/models_mysql.py,sha256=8aMELh8z8Q9JRC6_0j6f6MQN3v3HN1SS1mSF0MvFQ7w,21920
+mlrun/api/db/sqldb/models/models_sqlite.py,sha256=tq4cqTEJ_pOo8C3vW4mlm59DTHLEzLVerXAMLLi4S9U,19609
 mlrun/api/migrations_mysql/env.py,sha256=DYsmYYPMvbXxrkuEPzWUJcq9tzJrHIZkpJ0rrKdjmdw,2906
 mlrun/api/migrations_mysql/versions/28383af526f3_market_place_to_hub.py,sha256=JhNw92kyWYT80zhvUN4x2zyvme_O1-i-vRFuYH3DM18,1203
 mlrun/api/migrations_mysql/versions/32bae1b0e29c_increase_timestamp_fields_precision.py,sha256=mFG4HN_xHf13bf_Ow6L0AHwyl3lQK0wIvEYuwQgKBoY,4614
 mlrun/api/migrations_mysql/versions/4903aef6a91d_tag_foreign_key_and_cascades.py,sha256=lbeGcZOH_9tMl343Ztlfg5PvnoHUK0PlagBSzgYvOn8,1936
 mlrun/api/migrations_mysql/versions/5f1351c88a19_adding_background_tasks_table.py,sha256=7iB4cZkt3zCN8yiY0MW__T0JGKFitNlUizDAE1L3TB8,1909
 mlrun/api/migrations_mysql/versions/88e656800d6a_add_requested_logs_column_and_index_to_.py,sha256=aw8c4NCzrtqCjYq-orRnG0Ho9KNJzOsiFDLz-Ge21oY,1415
 mlrun/api/migrations_mysql/versions/9d16de5f03a7_adding_data_versions_table.py,sha256=--o7J4b5fdmTDjNy-pGof5tpwOmxah8ChCljOjclpd0,1504
+mlrun/api/migrations_mysql/versions/b1d1e7ab5dec_adding_table_datastore_profiles.py,sha256=oS8emFyzlOyUNIiE1rlhwR-AV1hiBJ-v7ElDJPOaPYo,1768
 mlrun/api/migrations_mysql/versions/b86f5b53f3d7_adding_name_and_updated_to_runs_table.py,sha256=TWVhHM-8OjnZBJjYhMHW4OBDnERezAggaWNjt2X-6iU,1649
 mlrun/api/migrations_mysql/versions/c4af40b0bf61_init.py,sha256=3Tl8QNQfcsAbbNmELAvtmgwxO8GSk_3HFgHCQ-xaJHs,24057
 mlrun/api/migrations_mysql/versions/c905d15bd91d_notifications.py,sha256=-h1VQRi3oVF0kBScmrBRyW2hOP4HxCh-IkgEHl82Pew,2662
 mlrun/api/migrations_mysql/versions/ee041e8fdaa0_adding_next_run_time_column_to_schedule_.py,sha256=mEf-7xV0rRXuodYiZWJ6Bum9X9QvVX2wLx24J71sAes,1351
 mlrun/api/migrations_sqlite/env.py,sha256=DYsmYYPMvbXxrkuEPzWUJcq9tzJrHIZkpJ0rrKdjmdw,2906
 mlrun/api/migrations_sqlite/versions/11f8dd2dc9fe_init.py,sha256=o92us6ZftBrNIriEOcz8G4JpdvjyAglyF4L2-MhJxFs,11473
 mlrun/api/migrations_sqlite/versions/1c954f8cb32d_schedule_last_run_uri.py,sha256=Js8qSLlrviH6UlFxSjr_KprR2Nc6pAeSQod01bchNbo,1348
 mlrun/api/migrations_sqlite/versions/2b6d23c715aa_adding_feature_sets.py,sha256=pj0yGhP4amDK5WOHvkzMMSqAIehkaHIcawNtbzSpHOQ,5180
 mlrun/api/migrations_sqlite/versions/4acd9430b093_market_place_to_hub.py,sha256=ZTV_X1IiOYmBSeOmTCWOvx8yIg0wbQ-Fmf1If4UNOAU,2595
 mlrun/api/migrations_sqlite/versions/6401142f2d7c_adding_next_run_time_column_to_schedule_.py,sha256=YEj9tENBqWVbvKaVKSrTKxXrjACtwFKeVUm7qi_ripI,1388
 mlrun/api/migrations_sqlite/versions/64d90a1a69bc_adding_background_tasks_table.py,sha256=CSAzzTotUp8v7ShI0w0pyMGEX-pSmd6LJ10F7Wclup8,1767
+mlrun/api/migrations_sqlite/versions/6e0c9531edc7_adding_table_datastore_profiles.py,sha256=FskirpugT0j7srXLPU1zazgtJxVDUHpiSyUIMnXckWI,1678
 mlrun/api/migrations_sqlite/versions/803438ecd005_add_requested_logs_column_to_runs.py,sha256=05ENsKt4ofb4xrdBiEweiArHo_XnTHbKkMLIqL0CzsM,1360
 mlrun/api/migrations_sqlite/versions/863114f0c659_refactoring_feature_set.py,sha256=sU1qwPgqWnv50mGtpTlucQdEGq46HrUQGXIG1XO60B4,1259
 mlrun/api/migrations_sqlite/versions/959ae00528ad_notifications.py,sha256=vznKCMmNSggrBVoE6vf7hiuWBU1Xk9T-N82lUCBvzlc,2352
 mlrun/api/migrations_sqlite/versions/accf9fc83d38_adding_data_versions_table.py,sha256=Tsq7qinfLaO80o-9Vi3CvcTbpHeogiHgpnFv5aVZgH8,1482
 mlrun/api/migrations_sqlite/versions/b68e8e897a28_schedule_labels.py,sha256=NcOjSnpsJf5ybTB8bo41ZoatM-hbT-P6OLy-ItEdUs4,1892
 mlrun/api/migrations_sqlite/versions/bcd0c1f9720c_adding_project_labels.py,sha256=orr_27CXy7Nwkxhy2wXkEu-_YeZu232YNyuJzbux3FI,1882
 mlrun/api/migrations_sqlite/versions/cf21882f938e_schedule_id.py,sha256=6uIiHz_MlT1hs8JjxiKRA_JEizH1wzU7VprO-vzEJIY,1420
 mlrun/api/migrations_sqlite/versions/d781f58f607f_tag_object_name_string.py,sha256=0s4JdFH6fICbdJDJMTgjWjtqX0gjbHf-3IMVtogxabU,2034
 mlrun/api/migrations_sqlite/versions/deac06871ace_adding_marketplace_sources_table.py,sha256=HfjkoI0J8cFOuzHYlVhtjT49K7KCjrkYOdu7pNLXj5Y,1828
 mlrun/api/migrations_sqlite/versions/e1dd5983c06b_schedule_concurrency_limit.py,sha256=XxndhUXxVFypeFdOrudpWpV2kFcjEXb4ESoe95PLHb4,1380
 mlrun/api/migrations_sqlite/versions/e5594ed3ab53_adding_name_and_updated_to_runs_table.py,sha256=tIMEPe8YONGqDerbhjTyBk71krmqEKXAqaTNcK_OuBM,1831
 mlrun/api/migrations_sqlite/versions/f4249b4ba6fa_adding_feature_vectors.py,sha256=bjjjtMy5IgM-kWefKmql4B-xiS49bvSF5aYSR8mXzUE,3936
 mlrun/api/migrations_sqlite/versions/f7b5a1a03629_adding_feature_labels.py,sha256=9YQL4ikdN4URenEiAGWNdFwNkTpuF-Uccr5Eo8RENrk,2588
 mlrun/api/rundb/__init__.py,sha256=pZgS6ZN126aJme4z5spCX-RmdchShxMnQeCPya8AsQI,577
-mlrun/api/rundb/sqldb.py,sha256=siEq_GtZUCGaowImazXvMcApz5gCuPDp399X1xETH4Q,25246
-mlrun/api/runtime_handlers/__init__.py,sha256=zJ8yU2_X1ePSwCmmoPE80IKmKcYmif7gCCkdOt0c61A,2523
+mlrun/api/rundb/sqldb.py,sha256=kMlARZeJuHtWMj435T6kbNoCQEd6FJE38nHHaisTJ4k,27385
+mlrun/api/runtime_handlers/__init__.py,sha256=vuE2vilCcVR450mf0htFQYnkoaPWKLSdY92yY9vbQFU,2399
 mlrun/api/runtime_handlers/base.py,sha256=TCGatXtOeXLbkAYD0xvZlpu5G_eg5gj81PkGC9RJZy0,50942
-mlrun/api/runtime_handlers/daskjob.py,sha256=34dUUrjT-sn8G2B5kMb6NSbpaTY9e8RWxec8Z2_3gJc,7886
-mlrun/api/runtime_handlers/kubejob.py,sha256=sCAuyKa2AZWt44vcOSuQdx1z7ss0MW5dl3lEn8v3bu4,1309
-mlrun/api/runtime_handlers/mpijob.py,sha256=KmduYwOr3tU8VHTZMVyu20XxW_FoTMv2RCFo3xP55FQ,5433
+mlrun/api/runtime_handlers/daskjob.py,sha256=i8V1lX65z1GTM_102v3dpBzR3XNiSLbo54fklRSrStU,14568
+mlrun/api/runtime_handlers/kubejob.py,sha256=wfERpFbXNDE5S-h0cdTjiTwyU5-lTV0BnMCJ8qCbb5g,1442
+mlrun/api/runtime_handlers/mpijob.py,sha256=bAd4f7eC9nVpabY7y2yK2_nGIGj4Zpxg3UF4yPrEVSY,7853
 mlrun/api/runtime_handlers/remotesparkjob.py,sha256=fxLdwwpb45dfx5VkuDDjiRD0IYj0kxDlCllec_Fam_Y,1036
 mlrun/api/runtime_handlers/sparkjob.py,sha256=4f8PA6OSmhJ2EtDsuRdJV0Us7-hjILFp9iZYYTFwXRM,5440
 mlrun/api/schemas/__init__.py,sha256=ckAFziB1YgJTsIoY-Dd1iUh8nZMKLsLT_W40dCAixg8,13571
 mlrun/api/utils/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/api/utils/asyncio.py,sha256=Uaekrr2Gw55ivhqmxdXIDBgFmcH48p94XfEdhqq7ot8,1092
 mlrun/api/utils/background_tasks.py,sha256=ZlNkk-4I37s_efqg521AudbN52NRIOdbvbRpoWL_S54,7371
-mlrun/api/utils/builder.py,sha256=JElO62tDSpAUpA4Fdxf5Z3MzKy4BQ6snnu2ZP6w71hY,26821
+mlrun/api/utils/builder.py,sha256=6wWWkuz0-Wl2jdIAGANArFkm0SOprOjdpmPvoRQii7I,35401
 mlrun/api/utils/helpers.py,sha256=WltrGj7UOURvHzdz99wo-Aixqh06Lqyrt31c1EQw7AE,2512
 mlrun/api/utils/memory_reports.py,sha256=l-texuripca1J5tfBmwzSc3l0t6dAMNO8JFjt9kptd8,3728
 mlrun/api/utils/periodic.py,sha256=0dyKI1bEYRJGwH1Ciqt52Brqys8MAesq84hli6ENZbg,2760
-mlrun/api/utils/scheduler.py,sha256=dXwIIKTEwJShnejfYnHn44gR-CfzCS8SELZtDjquLn4,45705
+mlrun/api/utils/scheduler.py,sha256=f_qMVigxHQ8OwxmpE_cDJVyRFbvIMxYfcpVNfGAQHvI,45265
 mlrun/api/utils/auth/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/api/utils/auth/verifier.py,sha256=21iHy2O77H_CNVSXdXr6O6uG6prJ3C9hvXQ1U9wXB4s,12383
 mlrun/api/utils/auth/providers/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/api/utils/auth/providers/base.py,sha256=WMVk7tgT_bZoQhyFcMt_FMQRr7NRrk4NnqDXerKgeH8,1381
 mlrun/api/utils/auth/providers/nop.py,sha256=FdThFkA2_Bgyg36bpPFcNOdRjdtO2WV3ZJjDUDad8PY,1460
 mlrun/api/utils/auth/providers/opa.py,sha256=JJXqh0nSlp7jCfpDvGCemyy893cUO9gZH6_myYN-oo8,10883
 mlrun/api/utils/clients/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
@@ -155,51 +160,52 @@
 mlrun/api/utils/db/sqlite_migration.py,sha256=CnrG2Gl68tTGuQ8rSONVLXLwQD4pR1dcvV_Wp6psKV0,3861
 mlrun/api/utils/events/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/api/utils/events/base.py,sha256=w0qyqp6Gzl7fk2HSZuMPovk5i3lbi_sDhnaKw15nYQ4,1721
 mlrun/api/utils/events/events_factory.py,sha256=jtEn8y0ssxB9sML8zIqZTHQa29KkCG4AzsH3lOGIrsE,1630
 mlrun/api/utils/events/iguazio.py,sha256=krzyxNv405V7aqkrs4ZlaByxzZkKEJWvZksvQUaZgDg,8798
 mlrun/api/utils/events/nop.py,sha256=qjbrS2Mszl87GxrQZpX0TKiRl7RL9cDJd_G5RAut2FQ,1739
 mlrun/api/utils/projects/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
-mlrun/api/utils/projects/follower.py,sha256=S7YWVyOB6OaKp1VD3KCV_i2IL3c68Frgw92QZMpsTk4,17760
+mlrun/api/utils/projects/follower.py,sha256=iXjxTtQ_j8wF0qrFO-okGzb19yLRBmnsIBxjcMf6chk,18658
 mlrun/api/utils/projects/leader.py,sha256=LfOx99_SnUKghzZJ37JM0MywazNqFWW7ujreETS19KU,19412
 mlrun/api/utils/projects/member.py,sha256=LPhV_hFnsaoeZxUAhZ1LNWPcL14fPuBna7Zww0hBMA8,7133
 mlrun/api/utils/projects/remotes/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/api/utils/projects/remotes/follower.py,sha256=hMEdSY58RIO40J68p3WhjKzqYw5ZgQU-5SBos-z9ZWw,2659
 mlrun/api/utils/projects/remotes/leader.py,sha256=yxOaVygWexYES2zkGf2BkqBbuXdlLzDs7guKhMpHMcM,2094
 mlrun/api/utils/projects/remotes/nop_follower.py,sha256=LBYFqVIO4nuzTAckPFAHU07Y8HdeFswcn9kkZrvZ0dY,4995
 mlrun/api/utils/projects/remotes/nop_leader.py,sha256=IJbuMrfxQhCY9EuSKo_RAHc4JhvdfXpFDLHgQBk3Iu4,3854
 mlrun/api/utils/runtimes/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/api/utils/runtimes/nuclio.py,sha256=xQtcQTItMo_cMrYBUpppVhaDKHG9tSV1nkeuYnuQrZo,1675
 mlrun/api/utils/singletons/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/api/utils/singletons/db.py,sha256=idTdQknaKVZVPzFeVfBe1JKDUtbH0rCNt8-zMOgxTdA,1313
-mlrun/api/utils/singletons/k8s.py,sha256=k5ERoQPUrj0hGc0TzhA-66DzNE4sPSX8jqtzd0STeOk,24570
+mlrun/api/utils/singletons/k8s.py,sha256=rp8x1T-wR-xGELGmY-kqoUrix76YqBJZca3EXUgN8ls,24434
 mlrun/api/utils/singletons/logs_dir.py,sha256=DUHIa-A87yUFqAGjPHFpMlvMiFMXGPZXjthzZCwiNKo,840
 mlrun/api/utils/singletons/project_member.py,sha256=11b_FmTC9kWvAVXuWwLOYpJT5TXT2I13sbzFjjtFMuI,1312
 mlrun/api/utils/singletons/scheduler.py,sha256=tlT826tOXQqaTgbQ8fcC4sx02JOliM_obUcSdtXtUa4,1064
 mlrun/artifacts/__init__.py,sha256=gLuGdv-6oSl_ePf3LT7hiaNNGTFSbI6X4_FJiOE8Y1Q,1123
 mlrun/artifacts/base.py,sha256=OKEJxlKZ58JLEOGmeP1W8IBPtb9O8-qaHaohRJc1vWA,31144
 mlrun/artifacts/dataset.py,sha256=7HnzOYtEQoHo4i5mJZggdQcNRbjzeBDhB6zTUc0g3ZI,20485
-mlrun/artifacts/manager.py,sha256=FnIcQDf6kOM7iX8I_OZXQJiFht1_z-4FhPMjzEzggog,12573
+mlrun/artifacts/manager.py,sha256=allBgkwIpWrQGpBYj4KdPv7ouWT_a4VNds_qH8LVSII,12628
 mlrun/artifacts/model.py,sha256=5yu2lACWaMaU5RD-8l94c5Jnmr4-XNkTjjjGAypP8Eo,24241
-mlrun/artifacts/plots.py,sha256=DeII7_XDJecyaVpxZRmWFnO4MD3cULn7MJ6h6MPjHEQ,15383
+mlrun/artifacts/plots.py,sha256=bbqRjPau72UVonIzf3jFmm9K56Nd-XWhAufjHKOdpK8,15717
 mlrun/common/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/common/constants.py,sha256=NpBgZV-ReSvPeMKPFp3DKzNWgiVebjGZrZ19pG_ZfRE,660
 mlrun/common/helpers.py,sha256=FqlMfRiZeGS6HZCOHaAJae2wDL1aRoijFBS5aZoPiIM,1108
 mlrun/common/types.py,sha256=V_jCEFCJZcycFVsPzEToCRQja5bqW0zRAAVaGN_QYxQ,790
 mlrun/common/db/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/common/db/sql_session.py,sha256=iWR8DWyziN2DSDiBgc5Wj3O7iVWDwfd0nJklAKwjoRM,2542
 mlrun/common/model_monitoring/__init__.py,sha256=x0EMEvxVjHsm858J1t6IEA9dtKTdFpJ9sKhss10ld8A,721
 mlrun/common/model_monitoring/helpers.py,sha256=5iszLVcUtWiDRnidYpPAR6kZWD76TVlWsFL4x7QOKaE,2312
-mlrun/common/schemas/__init__.py,sha256=qMo6x2PdZK3uSzht5Pp87l_83rzKFhppw0DmBqpGEBA,4496
+mlrun/common/schemas/__init__.py,sha256=y6pIe1ZWFfBzWzQkkhg_wiFuDkWUBh5xC17ldqwb-Sk,4561
 mlrun/common/schemas/artifact.py,sha256=vbXaY8eHxKt7YHKksD_PYEC-47eguxVb6wRAtMAW7Bk,1923
-mlrun/common/schemas/auth.py,sha256=rVPz0Yyy64bNxIMTRrR93ezMazk21S6EvV4aFUIpjXA,5730
+mlrun/common/schemas/auth.py,sha256=CZgqGDVNk4rnpVzEsTrNtOoBbYVj-G2o88s3eTonAlc,5879
 mlrun/common/schemas/background_task.py,sha256=1_nTVLDvTyYzsrzXQSfCwz_OlrcvrBlIwxy1ghDLyt8,1553
-mlrun/common/schemas/client_spec.py,sha256=LxhNMyHtZF_5ch1o9wJE01XEKgJjy5m2vgWHuXQRIK0,2813
+mlrun/common/schemas/client_spec.py,sha256=2nwr1p-HfSAIEpJ8SZHdKeKm1LL6ghooLkyOKNXzxCM,2816
 mlrun/common/schemas/clusterization_spec.py,sha256=aeaFJZms7r7h2HDv6ML_GDAT6gboW-PxBbc3GKPalGk,888
 mlrun/common/schemas/constants.py,sha256=WpREVl6QW7sDJJO6LquRnCFi1cKEI-zI3AxkONEihts,6243
+mlrun/common/schemas/datastore_profile.py,sha256=GM64epfg76xRxZOtK-vN9sdc9tJfKaHax-mk3mhsTx0,699
 mlrun/common/schemas/events.py,sha256=ROHJLo_fqYjc96pek7yhAUPpPRIuAR76lwxvNz8LIr8,1026
 mlrun/common/schemas/feature_store.py,sha256=LrJJ55TxpCF4RkmorB-i1IUTbixlP-jwLhdn19LLF-Q,3723
 mlrun/common/schemas/frontend_spec.py,sha256=bFjFic5hAWquaibR8fUaoDV8SRKrzdp9kTCjbeqT2Qc,2546
 mlrun/common/schemas/function.py,sha256=6eslF1HMlKqfIpryPCJLqYJkpkWUelQ72lE9_oAc5HU,4432
 mlrun/common/schemas/http.py,sha256=1PtYFhF6sqLSBRcuPMtYcUGmroBhaleqLmYidSdL9LM,705
 mlrun/common/schemas/hub.py,sha256=CZ38rx0CWX7wyGRkdzAcZp505k8w0M7z8hoiiEQ13Lw,4245
 mlrun/common/schemas/k8s.py,sha256=nmMnhgjVMLem5jyumoG2eQKioGK9eUVhQnOSb3hG7yw,1395
@@ -211,55 +217,56 @@
 mlrun/common/schemas/regex.py,sha256=8_vbDeAE0SODJDj7yUFg1FbaB9CNydYQTJ29JxE74Kc,776
 mlrun/common/schemas/runs.py,sha256=H9QhaN83cFUN42eE9TLgi1gs6Xdq11oQSZ96ESM94mI,745
 mlrun/common/schemas/runtime_resource.py,sha256=GyeqRwbBoLMq-0zWCkocvKl2nz9a62dAfguaPdqUzYw,1636
 mlrun/common/schemas/schedule.py,sha256=dFaPWY3CtuW1KKGcs-br1Gsm5vPjiTgcBZGfcbAAeug,4293
 mlrun/common/schemas/secret.py,sha256=51tCN1F8DFTq4y_XdHIMDy3I1TnMEBX8kO8BHKavYF4,1484
 mlrun/common/schemas/tag.py,sha256=2sm2Z5qM0jyakHuT_lxb-EQ2M5Unpodz4lj6MNkDEzo,905
 mlrun/common/schemas/workflow.py,sha256=zlEod6UCWDVHK_DEuLEx30XhTUg2xwvpiJNIWLAML2s,1729
-mlrun/common/schemas/model_monitoring/__init__.py,sha256=H3E9QbwuDBaqz8LFC3irRYXgkAmYdcaPVWdDl3LFfvM,1322
-mlrun/common/schemas/model_monitoring/constants.py,sha256=HWv8cgBMaRA5fOpWTjH5a0PT_hz8lgwuRG3PmgIsedY,5376
+mlrun/common/schemas/model_monitoring/__init__.py,sha256=KwmcSWhbgvrb9VZ91EJ-F3anp0CVSb28Q5eBIHxo91Y,1339
+mlrun/common/schemas/model_monitoring/constants.py,sha256=7ZRT-kINRK0tqvEPnDmA6WIC4rqkPNHuMEwRFEGGIVY,5582
 mlrun/common/schemas/model_monitoring/grafana.py,sha256=W6TcNc7mqPj040lfQrEadEQ37csdxLDgdU3QRLlELMQ,1444
 mlrun/common/schemas/model_monitoring/model_endpoints.py,sha256=4asvVsqhusAsBKXSvZ4_88oSBN9Kom7Ac8VQAbqqUI8,11152
 mlrun/data_types/__init__.py,sha256=EkxfkFoHb91zz3Aymq-KZfCHlPMzEc3bBqgzPUwmHWY,1087
 mlrun/data_types/data_types.py,sha256=qgRIdlSl9X-rAnwOW-F0hwPbDKOZI05JlSzV1O8ReaU,4647
 mlrun/data_types/infer.py,sha256=iEEQKZ6l-6PhHJWPwVyBJTEANNoP9xkrkYtryOH3O60,5813
 mlrun/data_types/spark.py,sha256=iNcpPsChTmDndqRp92eWN0ZoAszqWXvRR86rupx2ThQ,9426
 mlrun/datastore/__init__.py,sha256=ZHspikZYGqiCKqH5H3EA5txuckayC0BwXh9jONCSHzw,4089
 mlrun/datastore/azure_blob.py,sha256=8j3cZuQ8pqnPx48JAJvjtqSqufyNlqXROGrMGD8h3wM,6946
 mlrun/datastore/base.py,sha256=9riD7d__cegdvegsgDebo2G7fxOejXKk8c7xq3yH8qo,22471
-mlrun/datastore/datastore.py,sha256=_F_lz5QXBo8FNdek5yPW9WIqjprkrg0v-nULEqDrYvM,8377
-mlrun/datastore/dbfs_store.py,sha256=Zlr1SjU5pCZT3Uqa2xn0sCXtGc8i5bSCCGXtLoNojC8,6302
+mlrun/datastore/datastore.py,sha256=TsHyQWLtQfogwgIc52Vxs8np6z8hQi-29Q67fGUrbeY,8467
+mlrun/datastore/datastore_profile.py,sha256=NRUfXWtBOvE6362MJm9rnVqkJE8anehMfjDwgCzAMmk,5150
+mlrun/datastore/dbfs_store.py,sha256=uZrVIaJcxEDhGG27aRiMUXkNOZf11qeI3G1YWI5A9Oc,6435
 mlrun/datastore/filestore.py,sha256=o4ex777XyxyV1CQBP7M2JyyssCVVAc4H3JrvNC9eryM,3791
 mlrun/datastore/google_cloud_storage.py,sha256=Y_X4ODhvvBeknE_Aqaky_Fdi0-EY5waZAglmAttgFgY,5114
 mlrun/datastore/helpers.py,sha256=-bKveE9rteLd0hJd6OSMuMbfz09W_OXyu1G5O2ihZjs,622
 mlrun/datastore/inmem.py,sha256=6PAltUk7uyYlDgnsaJPOkg_P98iku1ys2e2wpAmPRkc,2779
-mlrun/datastore/redis.py,sha256=bcUpBK_HzHxEyjtSHjxmcD2C6wYe_AI7kaLKeiwHH5w,4873
+mlrun/datastore/redis.py,sha256=MTicmskCPv6V-hkW6b66MNijTXgBGR9LkirtOWaYQ-M,5202
 mlrun/datastore/s3.py,sha256=Zd3Bmd9IMA3WEG4fWQnhJqyAjwW2PouHPpk4uDnMttg,7035
 mlrun/datastore/sources.py,sha256=SMHEnNkYEQRsltngPDliqCN1LY58dw4v080Bw2lGmLM,37649
 mlrun/datastore/spark_udf.py,sha256=NnnB3DZxZb-rqpRy7b-NC7QWXuuqFn3XkBDc86tU4mQ,1498
 mlrun/datastore/store_resources.py,sha256=SUY9oJieq3r8PEq8G661XxmXem_e-CxDoy2AJ7dpXBk,6906
-mlrun/datastore/targets.py,sha256=YAlwvuKbYTDeN3n5sujqWktV56K_Y4_c9lF8gvFdcKQ,63310
+mlrun/datastore/targets.py,sha256=w449tv-RmmypJZKRZ1BMeWJKJeYKFWSrabgz3Oql3nY,63601
 mlrun/datastore/utils.py,sha256=tEuLkrb66l5rISjlhzZ6_aDZiZdhT1ZRQv4-sj_-YXc,5438
 mlrun/datastore/v3io.py,sha256=ywd-rrB5Uicdk7KGMk-nJ4mKPjvg2z5w6TVx5Bo5jIo,8099
 mlrun/datastore/wasbfs/__init__.py,sha256=s5Ul-0kAhYqFjKDR2X0O2vDGDbLQQduElb32Ev56Te4,1343
 mlrun/datastore/wasbfs/fs.py,sha256=FfKli7rBwres1pg8AxDlyyg1D5WukBEKb8Mi1SF5HqY,6152
 mlrun/db/__init__.py,sha256=Wy3NbZwgAneRHXCIKygQE-68tnAhvF7lVxrFSh9G6Y4,1145
-mlrun/db/base.py,sha256=2pHx82sHnXZL4CYpAPFw9kFT1b8g8ewOuR3gX1j1kXA,16494
+mlrun/db/base.py,sha256=_kKaOobTXVmoWJHjUjPnVDrGJR4n1dHwDlUMEdb0HHM,17358
 mlrun/db/factory.py,sha256=et3z63FTCt7kdbxwtEE8yNb33aSDM13gDKvrz5SeqBM,2117
-mlrun/db/httpdb.py,sha256=W46sgdFDalGqWW7ggyl0J4CJHrtQfP_Er6CgPPGEx9w,139637
-mlrun/db/nopdb.py,sha256=Y-6sPcjcpHD_NC2mPS8dJEQtEgCgUmVn3bBbs1UbcAk,13378
+mlrun/db/httpdb.py,sha256=afo6KOxZTTxlEOrsVZcTlUBXW-STJFjhqgbDBZY_YC4,143266
+mlrun/db/nopdb.py,sha256=V3OiOMmRadl1zgaBE0Lh89Z9w7GouPcSdnFW8H1oYQA,13984
 mlrun/feature_store/__init__.py,sha256=HdRKopsv4pTM-FTw1320b41VncJsek3_iWBH4r4IGK0,1516
 mlrun/feature_store/api.py,sha256=Qoepu316lSDQi_Fsfb-6Pw6K97Ys9-pZxZQBrRTB-bs,44899
 mlrun/feature_store/common.py,sha256=sl2pmkuv5w4KtTMjt0ky34Qps0iuoXNWbyYGuBkCxjc,12809
 mlrun/feature_store/feature_set.py,sha256=F9XtGm6j2sjSo-mXnyePSSgDVo0SiZW2ubYxEv2vFgI,47773
 mlrun/feature_store/feature_vector.py,sha256=1dfQYuzulR24Pt6gK1-hQCI0uj931LWGPbiFxmeRPLo,34934
 mlrun/feature_store/ingestion.py,sha256=JLkMYNFwaRu6qMTB0Kkgew9teJ2broAw3PHrdPb92YE,11185
 mlrun/feature_store/steps.py,sha256=EcZBJvSO-7UMUnzf-nv728cHRxGxHschzfXrmji7e5U,29357
 mlrun/feature_store/retrieval/__init__.py,sha256=6qtZFx8-vtsHv8ZGJuTv3UDe9m7XIlOq4ryEYC58Eww,1260
-mlrun/feature_store/retrieval/base.py,sha256=s_XsBGXEy2s2bM8kUAq9BqyYwB4Ri0cWQ6x1h9VvuNk,30622
+mlrun/feature_store/retrieval/base.py,sha256=bBMvspAxN739KXdNIv2qog7ypjnPsytZl7ioeUd_Bus,30787
 mlrun/feature_store/retrieval/dask_merger.py,sha256=Lxoj16c8hp9i5RHf-8BmG9NmReeEev6AHu96oEN2Gp8,4895
 mlrun/feature_store/retrieval/job.py,sha256=ZveUaLml6jU8EZCGoxM4vLKNWnjC7EDndGMH3aOuAu0,7714
 mlrun/feature_store/retrieval/local_merger.py,sha256=M0R2FWc-kuLVvyAYbawrxAJvqjshtaRK2gQqF6DjgxM,4218
 mlrun/feature_store/retrieval/spark_merger.py,sha256=6A1YJF2W3zbMqnQ1WrBVzRpNExW9vX54ybREO2B9aXU,9819
 mlrun/feature_store/retrieval/storey_merger.py,sha256=6bRnVm7YQBm3igviKeO0uXH3TSf74ZxspFnD4w23J5w,6539
 mlrun/frameworks/__init__.py,sha256=qRHe_nUfxpoLaSASAkIxcW6IyunMtxq5LXhjzZMO_1E,743
 mlrun/frameworks/parallel_coordinates.py,sha256=8buVHWA-mD1R5R9jm71XN5fvDyz9Bkp7D1xD4vFYHTE,11466
@@ -347,70 +354,74 @@
 mlrun/frameworks/xgboost/utils.py,sha256=5zLzHoeI3n2FuA_rdGzi404QCTLfQx1TYEyUWhZogs8,1069
 mlrun/launcher/__init__.py,sha256=pZgS6ZN126aJme4z5spCX-RmdchShxMnQeCPya8AsQI,577
 mlrun/launcher/base.py,sha256=-J_TDSiUjQqL1xAt0HqCVxhpXoY-euJMWMpq10WO2vw,15798
 mlrun/launcher/client.py,sha256=tz8ao6TFjWBSqW7-AoK-K8DBgYN3Eg6WVsLwDHeTj4k,6174
 mlrun/launcher/factory.py,sha256=tk6foFWox7f_xaeTgkWTx9ht_5fv0XzLDR8ucdb8oTE,2344
 mlrun/launcher/local.py,sha256=cWsXKfW-VOgAQOO795rh1YWalR-epRb0z0AbkYwL1x8,10815
 mlrun/launcher/remote.py,sha256=9vmM36ofsBqZrOQ5V7DntstdBwEElR2jM3u_ZSWtGkQ,6770
-mlrun/model_monitoring/__init__.py,sha256=bC0NzTgk0lbMqZRvRsIPRRuGYX2ure5ENnTWNXzrmCw,872
-mlrun/model_monitoring/features_drift_table.py,sha256=tVWTOjU7q5oopKbu-dRfgGrrjJlLilQAavn9dVp01RI,23970
+mlrun/model_monitoring/__init__.py,sha256=MpUGFaBQNKail9LBfhKn3YdY6ezaXsoMJJ4N_vVcpGU,916
+mlrun/model_monitoring/api.py,sha256=SoykPANyMNebFQsVC6RNbvxPAfdX14eTMBgzNSemkAU,23344
+mlrun/model_monitoring/features_drift_table.py,sha256=2r51W4xQ8gNq3PXt73IfsYu4l4mjwD-dLfRVAvKplTE,24209
 mlrun/model_monitoring/helpers.py,sha256=Vsrsbyn_i_VYPYeJTFDYqKl5QrK9bz3kPLqftuMrqV8,1902
 mlrun/model_monitoring/model_endpoint.py,sha256=yuKvIa5vJxsPk4dXPK6cKgfmZqsD_W2cdeNCWKEO6Tc,5214
-mlrun/model_monitoring/model_monitoring_batch.py,sha256=A_-IY50kA5lkFlNzHZZICl1T4_3ZWWSzmac-OjL9HNc,39798
+mlrun/model_monitoring/model_monitoring_batch.py,sha256=Xv941ka72kvuELX7OZYomEqKV42yxIeJx_ZTKDD4Uf0,39932
 mlrun/model_monitoring/prometheus.py,sha256=Z0UWmhQ-dpGGH31gCiGdfmhfj-RFRf1Tu1bYVe-k4jk,7605
 mlrun/model_monitoring/stream_processing.py,sha256=LqRMosAWF1ncKjP829zDTdpkx5pPcydv5QJp3RGQY_U,48755
 mlrun/model_monitoring/tracking_policy.py,sha256=HFlANGEFobdG8kHXFsSwK9Vuxs8D3WKFrYIDH-5hExA,4475
 mlrun/model_monitoring/stores/__init__.py,sha256=adU_G07jkD3JUT8__d0jAxs9nNomL7igKmd6uVM9L50,4525
 mlrun/model_monitoring/stores/kv_model_endpoint_store.py,sha256=cdsdlI6U7VInET2L6j9zQDYx0QG6bUdp7ePd-i6DXA4,20351
 mlrun/model_monitoring/stores/model_endpoint_store.py,sha256=zqGVidq9Clym1l15ZltIZMCTdFuZ1QUwXxEAma9-4Hs,5695
 mlrun/model_monitoring/stores/sql_model_endpoint_store.py,sha256=RDlcD8U24al8B6jApdIdYD4m1CGgbZYxSRQTiwwLmro,16123
 mlrun/model_monitoring/stores/models/__init__.py,sha256=rod--mpxH03wuyfbsp1Y-4vSx-vpvufohfBdrXR-4o0,884
 mlrun/model_monitoring/stores/models/base.py,sha256=IXPIE8iLAXmg8gfxA9iNMfToMpZ9BrIZf0VoZ1bd_Jc,655
 mlrun/model_monitoring/stores/models/mysql.py,sha256=0s6TC783RLrEXnbPahYpJrYuWIWHVhNvj2lrwQdi7fw,4153
 mlrun/model_monitoring/stores/models/sqlite.py,sha256=lZZgkhce_209T6QKXzoO98gtJQxk9M1nOQR38y-JWk0,4070
 mlrun/package/__init__.py,sha256=4A1houoObsq46gc4eSeaEanoJKTpund00KZomyciN2I,7101
-mlrun/package/context_handler.py,sha256=Tb8I9iX03SdKp1ZKrhbEmE_sgEYrvlPV9Q2cfyKUrbg,13974
+mlrun/package/context_handler.py,sha256=YIWKrrHAwjnyrNIy6KWXNCXTjCWLTe9ZyEHz6Tr8SWg,15237
 mlrun/package/errors.py,sha256=LKF8SSaRIdbkB7JQz6b9U4mZV42Ebnf6ZHu4wKuWqK4,1204
 mlrun/package/packager.py,sha256=bm2no_rgGNZgv4ZQCc8EfkWBx1XlNfSSqJflZnkqFTQ,12578
 mlrun/package/packagers_manager.py,sha256=ilmV_0_cW-CIAiLVLoS0FINDdBzXFbCPccZBBlLxOCI,37275
 mlrun/package/packagers/__init__.py,sha256=rpxpuATMoxCMgHDaVamm0uwocy71e0CSXm85Q5X9tkU,769
 mlrun/package/packagers/default_packager.py,sha256=AI5rflcj1IErlsnVbMm6ffmfO6TQrZ98nndfpZ814oM,24227
 mlrun/package/packagers/numpy_packagers.py,sha256=ACG0cctrjvRCrYPiffEPV3K0XZiXG78zU_zn14uu8OI,20618
 mlrun/package/packagers/pandas_packagers.py,sha256=shWlNIeWGcrkDS-2oBxukNrBQ9XrSoeY5Mtvc8zAMIg,35951
-mlrun/package/packagers/python_standard_library_packagers.py,sha256=8yjqBN634Yaht3LsO-YclqmVZDD9pJxCKEC2vm5adb0,21528
+mlrun/package/packagers/python_standard_library_packagers.py,sha256=M7nxzZ7A-pc2JeP2WhP8OKeymqg7RmrxCR4zmj8drSA,22518
 mlrun/package/utils/__init__.py,sha256=RXkhPH-zFLFFvOjMRJUVgVT33rusK5J4eTVLJ7bjN6k,1722
 mlrun/package/utils/_archiver.py,sha256=EF9r6BBwrFq7o8ig5nFlOnXJ-JsBnvSFTQphYuoGGAM,7567
 mlrun/package/utils/_formatter.py,sha256=EgdSMrJMgt-35myGuwfIOOKAe4jBi6QU7ssw1G0cacY,6393
 mlrun/package/utils/_pickler.py,sha256=S8UcTZ3XD68yqfY6ebD-loNC-C5goKfBR4cS5GOGbBI,10926
 mlrun/package/utils/_supported_format.py,sha256=fvwD1icALyV0wJUcRori6voH10j6KR3NN8n5o8HVw2E,2379
 mlrun/package/utils/log_hint_utils.py,sha256=ie7opnHlhVdh1mBkvYDFyWyFIjHn8Lm2FcxkiCmL9Z8,3709
 mlrun/package/utils/type_hint_utils.py,sha256=f-1AeFv2vwljH0ymXA4JmcIkH1lEf7HfsJ2A62H-X4A,14825
 mlrun/platforms/__init__.py,sha256=ArWn_iZiEE6qz7hvY_1RqMkFnHGuKjP3k5xYKnfKA58,2352
-mlrun/platforms/iguazio.py,sha256=BN3V2cv9a28S86EOat8nLvmChXoXbvfI900EspZPDwg,21581
+mlrun/platforms/iguazio.py,sha256=dDd6EBRB272EkKe2GXsb-hefrXWnsfyP_b0Svsi1uLE,21636
 mlrun/platforms/other.py,sha256=z4pWqxXkVVuMLk-MbNb0Y_ZR5pmIsUm0R8vHnqpEnew,11852
 mlrun/projects/__init__.py,sha256=Lv5rfxyXJrw6WGOWJKhBz66M6t3_zsNMCfUD6waPwx4,1153
-mlrun/projects/operations.py,sha256=A3JzRNZnYE1_VXN5JSGrZHIFO7ngLt8Vzau7XoPhAjs,17602
+mlrun/projects/operations.py,sha256=AJsin0LrJHTisAPi-9t2ciFNZ83QdMRESIG31Mh_0x4,17948
 mlrun/projects/pipelines.py,sha256=AKnSGwX5TZc7GEQw-fnL6iozl3ty1FTT5siwiuXiiyE,34337
-mlrun/projects/project.py,sha256=hhs_xia96c47lkRkiWxeG3a0aFdZl2EZD2BEJ2U0NUI,126661
-mlrun/runtimes/__init__.py,sha256=jz7fUkICG9oywq2S1hxl7KWgUT8IvJG58cdbvueoCOM,7174
-mlrun/runtimes/base.py,sha256=B390d8NgCC54nQD_4tgwjiqIgUQuYbzU2tjhqnSUdAE,36681
+mlrun/projects/project.py,sha256=cFXX06suXDDEER4j8-Hme65KBtjYpXdHBVolR1PBFnE,128900
+mlrun/runtimes/__init__.py,sha256=nqvb_DT4Cz71q1NARUDkwMjK83iuo6w-hUkBZTCFEcw,7042
+mlrun/runtimes/base.py,sha256=TDehiOOoF-PsZYY9Vc46ZLN-WhBtzBCs6ghpGqFIbR0,36844
 mlrun/runtimes/constants.py,sha256=TnkD0nQ7pcFq1aJvbweoM4BgbkhaA6fHhg9rnAkxDBE,6689
-mlrun/runtimes/daskjob.py,sha256=eP6-A_0t2Kc1y9HCGLTpgY22dj_qu71pJ_OhMBilHfk,22830
+mlrun/runtimes/daskjob.py,sha256=r2-qC9Kt0jQbTNRcPH43HKZ4sy-AbyXO9TpfNij_MxQ,16021
 mlrun/runtimes/funcdoc.py,sha256=HRD-mQkSyRBPExNWEhTCX3Cj01MXyeuQqc6jKwg5aZ4,9994
 mlrun/runtimes/function.py,sha256=IkycL8e9VgX0cVoVFXQkp3R3Lh7R_R9YHMHbZ2KJVLs,45208
 mlrun/runtimes/function_reference.py,sha256=SJ0J-4ww0FQdijmdnUwGUKhMb-h5wtzqCPItTWKIL40,4911
 mlrun/runtimes/generators.py,sha256=_vuJVL4lDdyts0xK_R1Bw9zoblV-NsvSWr-bj-uXKB0,6530
-mlrun/runtimes/kubejob.py,sha256=_WidtV52KIyay1Nk8br1Krrjh4MO_uuzSMef37nV_38,14634
+mlrun/runtimes/kubejob.py,sha256=Uyq_3_S4cxQ-nGfmwO81L7JuNnQzkm2rZi_CCw_JOVQ,15180
 mlrun/runtimes/local.py,sha256=zRekoW7H6ve8awBCnhkkCXK1CVLUhpRWCkUiuW7lYO0,19579
 mlrun/runtimes/nuclio.py,sha256=cb1Q8dowZaDqOLlxcblcTebOD6K3jrss0FOuIklq5UI,2877
 mlrun/runtimes/pod.py,sha256=SoerOZMadz3h4w15plOI1DCeqeSeHzUWhFnxS4CQuqc,61396
 mlrun/runtimes/remotesparkjob.py,sha256=R5y8zDFqkzJRfylZfxBBp5H4FiQNJin0cXEu7GbNm68,7289
 mlrun/runtimes/serving.py,sha256=K-SJxDUaUppiCoYOxK3RRv1GCSV4KF-OwZdkj2YfLg0,30483
-mlrun/runtimes/utils.py,sha256=wxX1K8vwcygizduqEhSnEh6DswPL2K-xWg568NTr2O8,20801
-mlrun/runtimes/mpijob/__init__.py,sha256=0I0EpRg76TClDXIL8FBu21_5lUTOoTyhC4MfnQn1iUY,742
+mlrun/runtimes/utils.py,sha256=MnIFHxfcedzssE3JJA76HhnxDiwWPXughhbej6G8K2E,18703
+mlrun/runtimes/databricks/__init__.py,sha256=kXGBqhLN0rlAx0kTXhozGzFsIdSqW0uTSKMmsLgq_is,569
+mlrun/runtimes/databricks/databricks.py,sha256=8FcUnkV_uU98VY9QE0h3YjFfucRjJbMpJP1httYZV4A,2568
+mlrun/runtimes/databricks/databricks_wrapper.py,sha256=rY0mOsf42z2j0LNaBAGBC1vGwKcR7JYBrKUFbbBZJ9M,3249
+mlrun/runtimes/mpijob/__init__.py,sha256=Y6wQkTTCByvJ4pUIfQyEdT_lTo0AEKJGqETX7KQL3Es,1539
 mlrun/runtimes/mpijob/abstract.py,sha256=4PqXLVWO8QQ1eGer-e_VpJb7tmkz9HW9h1B2ngtXH9U,15147
 mlrun/runtimes/mpijob/v1.py,sha256=oHf2gKRZloJkqhyjGU-CZtCcC4rC1Ptu3404a0bVAzs,10916
 mlrun/runtimes/mpijob/v1alpha1.py,sha256=JrmmaG0lvKoDgKXOHYA_XYhjPQJWCTl5pBnLLrg0Cdg,5650
 mlrun/runtimes/sparkjob/__init__.py,sha256=_KPvk0qefeLtHO6lxQE_AMOGiMTG_OT48eRCE4Z2ldw,709
 mlrun/runtimes/sparkjob/abstract.py,sha256=h3ZTGETbSoMo71CPhEKPT0wmEIPDR_eKgScfQj5PhZk,30404
 mlrun/runtimes/sparkjob/spark3job.py,sha256=6oDQISBnfiCJ9M0NHJCANu2p2AwS6i6htEOUy4TgUNs,28746
 mlrun/serving/__init__.py,sha256=_6HRAOuS2Ehjo3vwx5h1aI_-JppxEAsl4VfEERAbGFE,1078
@@ -425,32 +436,32 @@
 mlrun/serving/v2_serving.py,sha256=fAMA52lBvpLFpUa8LKHjRAwBZp_sR0wUmmtrN1ChJC4,21823
 mlrun/utils/__init__.py,sha256=g2pbT3loDw0GWELOC_rBq1NojSMCFnWrD-TYcDgAZiI,826
 mlrun/utils/async_http.py,sha256=Rjnulj27T7PxgyD_bZlBCdjOV8APC9_YP68jBONlt7s,10636
 mlrun/utils/azure_vault.py,sha256=VNs2fz0XlFrV5Ggz3T0mR7mOWHefEcC14wM7QpsbY44,3456
 mlrun/utils/clones.py,sha256=Q1b1BA4-slooth0gEXoX-x8mhr1m6BgFBA72DXfCqJ8,6245
 mlrun/utils/condition_evaluator.py,sha256=oR-GjryAg76D4G79G-DzVkx631D6Gd4jJgbr_d3Btnw,1920
 mlrun/utils/db.py,sha256=2pdIYKIA0GiwwuWLW0PJ_bPu9M1rd7ESBqnMr5wWuW4,1662
-mlrun/utils/helpers.py,sha256=P5-7EJSbf08OalcXHp2JullqXqrv6C6hKfJAd1wBbV8,47314
+mlrun/utils/helpers.py,sha256=AemeTnYW5_8xowxpkx80tfy7sim0yIx3-Ipm1FOXD8s,49274
 mlrun/utils/http.py,sha256=i32dQYH35pt4gQjPdQugIaCtEOuKxPikRQyKBiHp1ew,8241
 mlrun/utils/logger.py,sha256=d5qUNJ-J_tNASi7A7-cRBOOXA0jJrEDEWFft8AAukLc,7035
 mlrun/utils/regex.py,sha256=V0kaw1-zuehkN20g_Pq6SgkJTBLRdBqNkXOGN_2TJEw,4430
 mlrun/utils/singleton.py,sha256=UUTQiBTXyzmjeYzsvTUsSxqyLJHOtesqif9GNfZO9rc,883
 mlrun/utils/v3io_clients.py,sha256=HL7Hma-pxaQBXMKcEnWqGLCpFgykwnszlabzeOHC9-E,1319
 mlrun/utils/vault.py,sha256=xUiKL17dCXjwQJ33YRzQj0oadUXATlFWPzKKYAESoQk,10447
 mlrun/utils/notifications/__init__.py,sha256=eUzQDBxSQmMZASRY-YAnYS6tL5801P0wEjycp3Dvoe0,990
-mlrun/utils/notifications/notification_pusher.py,sha256=5pw2MK2rLm6dzswp5v3wqFl90brdSW2D2Ipx3d79iWk,19251
+mlrun/utils/notifications/notification_pusher.py,sha256=BEY5b82aOHtuZLTxXXT6AJXyEaS0UJJXlLTTE0O-8HI,20181
 mlrun/utils/notifications/notification/__init__.py,sha256=v2ULfsoGLlgBKS90ezou9wooBX7fo0NJgDsNdr51YEk,2113
 mlrun/utils/notifications/notification/base.py,sha256=t1sxExL2i2tJr3UuiQ9NTDONrpXcGBsrnxtAdemog2s,2293
 mlrun/utils/notifications/notification/console.py,sha256=3xNMf-PFANx6h6I6qpf-xRnI5S0001fHI4caYguNBgg,1971
 mlrun/utils/notifications/notification/git.py,sha256=5pJs3LFzuz2h3JO9vAGo3BL00-WZFdUcCaO2XaZh-1I,5221
 mlrun/utils/notifications/notification/ipython.py,sha256=qrBmtECiRG6sZpCIVMg7RZcWi5WqbgWl9Ktgg-oi2EY,1962
 mlrun/utils/notifications/notification/slack.py,sha256=5JysqIpUYUZKXPSeeZtbl7qb2L9dj7p2NvnEBcEsZkA,3898
 mlrun/utils/notifications/notification/webhook.py,sha256=iD4DhpJjfjaYj4o8NLQEY842-hNSnqj7SqKzSvnlmGE,1865
 mlrun/utils/version/__init__.py,sha256=7kkrB7hEZ3cLXoWj1kPoDwo4MaswsI2JVOBpbKgPAgc,614
-mlrun/utils/version/version.json,sha256=Es3D4BIdpm72upkoVoWBapiYqv5XUe_6tPQpmUbBY9Q,88
+mlrun/utils/version/version.json,sha256=eSCngxCxxOw97V9w9sK6VPmOTqIVslA6KKaXm82Yv_Y,88
 mlrun/utils/version/version.py,sha256=HMwseV8xjTQ__6T6yUWojx_z6yUj7Io7O4NcCCH_sz8,1970
-mlrun-1.5.0rc2.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
-mlrun-1.5.0rc2.dist-info/METADATA,sha256=5vsPSfVG3VTZpfHgYe9CMz11N0Pwj1M5NoktPI5WlLc,17062
-mlrun-1.5.0rc2.dist-info/WHEEL,sha256=AtBG6SXL3KF_v0NxLf0ehyVOh0cold-JbJYXNGorC6Q,92
-mlrun-1.5.0rc2.dist-info/entry_points.txt,sha256=ZbXmb36B9JmK7EaleP8MIAbZSOQXQV0iwKR6si0HUWk,47
-mlrun-1.5.0rc2.dist-info/top_level.txt,sha256=NObLzw3maSF9wVrgSeYBv-fgnHkAJ1kEkh12DLdd5KM,6
-mlrun-1.5.0rc2.dist-info/RECORD,,
+mlrun-1.5.0rc3.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
+mlrun-1.5.0rc3.dist-info/METADATA,sha256=mwJZLk9Nvn85uISGcH-9flYKXehk5tOqftOy6oG47AQ,17455
+mlrun-1.5.0rc3.dist-info/WHEEL,sha256=5sUXSg9e4bi7lTLOHcm6QEYwO5TIF1TNbTSVFVjcJcc,92
+mlrun-1.5.0rc3.dist-info/entry_points.txt,sha256=ZbXmb36B9JmK7EaleP8MIAbZSOQXQV0iwKR6si0HUWk,47
+mlrun-1.5.0rc3.dist-info/top_level.txt,sha256=NObLzw3maSF9wVrgSeYBv-fgnHkAJ1kEkh12DLdd5KM,6
+mlrun-1.5.0rc3.dist-info/RECORD,,
```

