# Comparing `tmp/DyGraph-0.0.3.tar.gz` & `tmp/DyGraph-0.0.4.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "DyGraph-0.0.3.tar", last modified: Sun Aug  6 01:28:42 2023, max compression
+gzip compressed data, was "DyGraph-0.0.4.tar", last modified: Mon Aug  7 11:07:12 2023, max compression
```

## Comparing `DyGraph-0.0.3.tar` & `DyGraph-0.0.4.tar`

### file list

```diff
@@ -1,27 +1,27 @@
-drwxrwxrwx   0        0        0        0 2023-08-06 01:28:42.022199 DyGraph-0.0.3/
--rw-rw-rw-   0        0        0     1102 2023-06-07 13:00:07.000000 DyGraph-0.0.3/LICENSE
--rw-rw-rw-   0        0        0     3286 2023-08-06 01:28:42.023198 DyGraph-0.0.3/PKG-INFO
--rw-rw-rw-   0        0        0     2374 2023-06-07 13:00:07.000000 DyGraph-0.0.3/README.md
--rw-rw-rw-   0        0        0      228 2023-06-07 13:00:07.000000 DyGraph-0.0.3/pyproject.toml
--rw-rw-rw-   0        0        0     1143 2023-08-06 01:28:42.031995 DyGraph-0.0.3/setup.cfg
--rw-rw-rw-   0        0        0       71 2023-06-07 13:00:07.000000 DyGraph-0.0.3/setup.py
-drwxrwxrwx   0        0        0        0 2023-08-06 01:28:41.954260 DyGraph-0.0.3/src/
-drwxrwxrwx   0        0        0        0 2023-08-06 01:28:41.960735 DyGraph-0.0.3/src/CovReg/
--rw-rw-rw-   0        0        0      334 2023-08-04 07:50:57.000000 DyGraph-0.0.3/src/CovReg/__init__.py
--rw-rw-rw-   0        0        0     8635 2023-08-06 01:23:23.000000 DyGraph-0.0.3/src/CovReg/covreg.py
--rw-rw-rw-   0        0        0    13036 2023-08-06 01:23:58.000000 DyGraph-0.0.3/src/CovReg/graphcovreg.py
-drwxrwxrwx   0        0        0        0 2023-08-06 01:28:41.991670 DyGraph-0.0.3/src/DyGraph/
--rw-rw-rw-   0        0        0     5064 2023-06-07 13:00:07.000000 DyGraph-0.0.3/src/DyGraph/RootDygl.py
--rw-rw-rw-   0        0        0      250 2023-08-04 03:06:35.000000 DyGraph-0.0.3/src/DyGraph/__init__.py
--rw-rw-rw-   0        0        0    11758 2023-07-23 00:51:58.000000 DyGraph-0.0.3/src/DyGraph/dyg_outer_em.py
--rw-rw-rw-   0        0        0    11690 2023-07-23 00:51:58.000000 DyGraph-0.0.3/src/DyGraph/dygl_inner_em.py
--rw-rw-rw-   0        0        0    24554 2023-06-07 13:00:07.000000 DyGraph-0.0.3/src/DyGraph/dygl_utils.py
--rw-rw-rw-   0        0        0     4581 2023-06-07 13:00:07.000000 DyGraph-0.0.3/src/DyGraph/sgl_inner_em.py
--rw-rw-rw-   0        0        0     4924 2023-06-07 13:00:07.000000 DyGraph-0.0.3/src/DyGraph/sgl_outer_em.py
-drwxrwxrwx   0        0        0        0 2023-08-06 01:28:42.020206 DyGraph-0.0.3/src/DyGraph.egg-info/
--rw-rw-rw-   0        0        0     3286 2023-08-06 01:28:41.000000 DyGraph-0.0.3/src/DyGraph.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      516 2023-08-06 01:28:41.000000 DyGraph-0.0.3/src/DyGraph.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-08-06 01:28:41.000000 DyGraph-0.0.3/src/DyGraph.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0        2 2023-08-05 22:46:00.000000 DyGraph-0.0.3/src/DyGraph.egg-info/not-zip-safe
--rw-rw-rw-   0        0        0       91 2023-08-06 01:28:41.000000 DyGraph-0.0.3/src/DyGraph.egg-info/requires.txt
--rw-rw-rw-   0        0        0       15 2023-08-06 01:28:41.000000 DyGraph-0.0.3/src/DyGraph.egg-info/top_level.txt
+drwxrwxrwx   0        0        0        0 2023-08-07 11:07:12.929339 DyGraph-0.0.4/
+-rw-rw-rw-   0        0        0     1102 2023-06-07 13:00:07.000000 DyGraph-0.0.4/LICENSE
+-rw-rw-rw-   0        0        0     3286 2023-08-07 11:07:12.929339 DyGraph-0.0.4/PKG-INFO
+-rw-rw-rw-   0        0        0     2374 2023-06-07 13:00:07.000000 DyGraph-0.0.4/README.md
+-rw-rw-rw-   0        0        0      228 2023-06-07 13:00:07.000000 DyGraph-0.0.4/pyproject.toml
+-rw-rw-rw-   0        0        0     1143 2023-08-07 11:07:12.929339 DyGraph-0.0.4/setup.cfg
+-rw-rw-rw-   0        0        0       71 2023-06-07 13:00:07.000000 DyGraph-0.0.4/setup.py
+drwxrwxrwx   0        0        0        0 2023-08-07 11:07:12.870558 DyGraph-0.0.4/src/
+drwxrwxrwx   0        0        0        0 2023-08-07 11:07:12.882067 DyGraph-0.0.4/src/CovReg/
+-rw-rw-rw-   0        0        0      334 2023-08-04 07:50:57.000000 DyGraph-0.0.4/src/CovReg/__init__.py
+-rw-rw-rw-   0        0        0     8635 2023-08-06 01:23:23.000000 DyGraph-0.0.4/src/CovReg/covreg.py
+-rw-rw-rw-   0        0        0    13424 2023-08-07 11:04:32.000000 DyGraph-0.0.4/src/CovReg/graphcovreg.py
+drwxrwxrwx   0        0        0        0 2023-08-07 11:07:12.904700 DyGraph-0.0.4/src/DyGraph/
+-rw-rw-rw-   0        0        0     5064 2023-06-07 13:00:07.000000 DyGraph-0.0.4/src/DyGraph/RootDygl.py
+-rw-rw-rw-   0        0        0      250 2023-08-04 03:06:35.000000 DyGraph-0.0.4/src/DyGraph/__init__.py
+-rw-rw-rw-   0        0        0    11758 2023-07-23 00:51:58.000000 DyGraph-0.0.4/src/DyGraph/dyg_outer_em.py
+-rw-rw-rw-   0        0        0    11690 2023-07-23 00:51:58.000000 DyGraph-0.0.4/src/DyGraph/dygl_inner_em.py
+-rw-rw-rw-   0        0        0    24554 2023-06-07 13:00:07.000000 DyGraph-0.0.4/src/DyGraph/dygl_utils.py
+-rw-rw-rw-   0        0        0     4581 2023-06-07 13:00:07.000000 DyGraph-0.0.4/src/DyGraph/sgl_inner_em.py
+-rw-rw-rw-   0        0        0     4924 2023-06-07 13:00:07.000000 DyGraph-0.0.4/src/DyGraph/sgl_outer_em.py
+drwxrwxrwx   0        0        0        0 2023-08-07 11:07:12.929339 DyGraph-0.0.4/src/DyGraph.egg-info/
+-rw-rw-rw-   0        0        0     3286 2023-08-07 11:07:12.000000 DyGraph-0.0.4/src/DyGraph.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      516 2023-08-07 11:07:12.000000 DyGraph-0.0.4/src/DyGraph.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-08-07 11:07:12.000000 DyGraph-0.0.4/src/DyGraph.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0        2 2023-08-05 22:46:00.000000 DyGraph-0.0.4/src/DyGraph.egg-info/not-zip-safe
+-rw-rw-rw-   0        0        0       91 2023-08-07 11:07:12.000000 DyGraph-0.0.4/src/DyGraph.egg-info/requires.txt
+-rw-rw-rw-   0        0        0       15 2023-08-07 11:07:12.000000 DyGraph-0.0.4/src/DyGraph.egg-info/top_level.txt
```

### Comparing `DyGraph-0.0.3/LICENSE` & `DyGraph-0.0.4/LICENSE`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.3/PKG-INFO` & `DyGraph-0.0.4/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: DyGraph
-Version: 0.0.3
+Version: 0.0.4
 Summary: A package for estimating dynamic graphical lasso with heavy tailed distributions
 Home-page: https://github.com/ragnarlevi/DyGraph
 Author: ragnarlevi
 License: MIT
 Project-URL: Bug Tracker, https://github.com/ragnarlevi/DyGraph/issues
 Platform: unix
 Platform: linux
```

### Comparing `DyGraph-0.0.3/README.md` & `DyGraph-0.0.4/README.md`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.3/setup.cfg` & `DyGraph-0.0.4/setup.cfg`

 * *Files 0% similar despite different names*

```diff
@@ -9,15 +9,15 @@
 00000080: 5f64 6573 6372 6970 7469 6f6e 203d 2066  _description = f
 00000090: 696c 653a 2052 4541 444d 452e 6d64 0d0a  ile: README.md..
 000000a0: 6c6f 6e67 5f64 6573 6372 6970 7469 6f6e  long_description
 000000b0: 5f63 6f6e 7465 6e74 5f74 7970 6520 3d20  _content_type = 
 000000c0: 7465 7874 2f6d 6172 6b64 6f77 6e0d 0a61  text/markdown..a
 000000d0: 7574 686f 7220 3d20 7261 676e 6172 6c65  uthor = ragnarle
 000000e0: 7669 0d0a 7665 7273 696f 6e20 3d20 302e  vi..version = 0.
-000000f0: 302e 330d 0a6c 6963 656e 7365 203d 204d  0.3..license = M
+000000f0: 302e 340d 0a6c 6963 656e 7365 203d 204d  0.4..license = M
 00000100: 4954 0d0a 6c69 6365 6e73 655f 6669 6c65  IT..license_file
 00000110: 203d 204c 4943 454e 5345 0d0a 7572 6c20   = LICENSE..url 
 00000120: 3d20 6874 7470 733a 2f2f 6769 7468 7562  = https://github
 00000130: 2e63 6f6d 2f72 6167 6e61 726c 6576 692f  .com/ragnarlevi/
 00000140: 4479 4772 6170 680d 0a70 6c61 7466 6f72  DyGraph..platfor
 00000150: 6d73 203d 2075 6e69 782c 206c 696e 7578  ms = unix, linux
 00000160: 2c20 6f73 782c 2063 7967 7769 6e2c 2077  , osx, cygwin, w
```

### Comparing `DyGraph-0.0.3/src/CovReg/covreg.py` & `DyGraph-0.0.4/src/CovReg/covreg.py`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.3/src/CovReg/graphcovreg.py` & `DyGraph-0.0.4/src/CovReg/graphcovreg.py`

 * *Files 2% similar despite different names*

```diff
@@ -455,361 +455,385 @@
 00001c60: 203d 206e 702e 6f6e 6573 2873 656c 662e   = np.ones(self.
 00001c70: 6e29 0d0a 2020 2020 2020 2020 6d20 3d20  n)..        m = 
 00001c80: 6e70 2e6f 6e65 7328 7365 6c66 2e6e 290d  np.ones(self.n).
 00001c90: 0a0d 0a20 2020 2020 2020 2070 7369 5f69  ...        psi_i
 00001ca0: 6e76 203d 206e 702e 6c69 6e61 6c67 2e69  nv = np.linalg.i
 00001cb0: 6e76 2873 656c 662e 5073 6929 0d0a 0d0a  nv(self.Psi)....
 00001cc0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00001cd0: 4120 6973 204e 6f6e 653a 0d0a 2020 2020  A is None:..    
-00001ce0: 2020 2020 2020 2020 4320 3d20 7365 6c66          C = self
-00001cf0: 2e42 0d0a 2020 2020 2020 2020 656c 7365  .B..        else
-00001d00: 3a0d 0a20 2020 2020 2020 2020 2020 2043  :..            C
-00001d10: 203d 206e 702e 6873 7461 636b 2828 7365   = np.hstack((se
-00001d20: 6c66 2e41 2c20 7365 6c66 2e42 2929 0d0a  lf.A, self.B))..
-00001d30: 2020 2020 2020 2020 0d0a 0d0a 2020 2020          ....    
-00001d40: 2020 2020 2320 452d 7374 6570 0d0a 2020      # E-step..  
-00001d50: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00001d60: 616e 6765 2873 656c 662e 6e29 3a0d 0a20  ange(self.n):.. 
-00001d70: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00001d80: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00001d90: 2e41 2069 7320 6e6f 7420 4e6f 6e65 3a0d  .A is not None:.
-00001da0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001db0: 2078 5f69 203d 206e 702e 6873 7461 636b   x_i = np.hstack
-00001dc0: 2828 7365 6c66 2e46 5b69 5d2c 2073 656c  ((self.F[i], sel
-00001dd0: 662e 465b 695d 2929 0d0a 2020 2020 2020  f.F[i]))..      
-00001de0: 2020 2020 2020 2020 2020 765b 695d 203d            v[i] =
-00001df0: 2028 312b 6e70 2e64 6f74 2878 5f69 2e54   (1+np.dot(x_i.T
-00001e00: 2c20 432e 5429 2e64 6f74 2870 7369 5f69  , C.T).dot(psi_i
-00001e10: 6e76 292e 646f 7428 4329 2e64 6f74 2878  nv).dot(C).dot(x
-00001e20: 5f69 2929 202a 2a20 282d 3129 0d0a 2020  _i)) ** (-1)..  
-00001e30: 2020 2020 2020 2020 2020 2020 2020 6d5b                m[
-00001e40: 695d 203d 2076 5b69 5d2a 6e70 2e64 6f74  i] = v[i]*np.dot
-00001e50: 2828 7365 6c66 2e59 5b69 5d2d 6e70 2e64  ((self.Y[i]-np.d
-00001e60: 6f74 2873 656c 662e 412c 2073 656c 662e  ot(self.A, self.
-00001e70: 465b 695d 2929 2e54 2c70 7369 5f69 6e76  F[i])).T,psi_inv
-00001e80: 292e 646f 7428 4329 2e64 6f74 2878 5f69  ).dot(C).dot(x_i
-00001e90: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00001ea0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00001eb0: 2020 2020 2020 785f 6920 3d20 7365 6c66        x_i = self
-00001ec0: 2e46 5b69 5d0d 0a20 2020 2020 2020 2020  .F[i]..         
-00001ed0: 2020 2020 2020 2076 5b69 5d20 3d20 2831         v[i] = (1
-00001ee0: 2b6e 702e 646f 7428 785f 692e 542c 2043  +np.dot(x_i.T, C
-00001ef0: 2e54 292e 646f 7428 7073 695f 696e 7629  .T).dot(psi_inv)
-00001f00: 2e64 6f74 2843 292e 646f 7428 785f 6929  .dot(C).dot(x_i)
-00001f10: 2920 2a2a 2028 2d31 290d 0a20 2020 2020  ) ** (-1)..     
-00001f20: 2020 2020 2020 2020 2020 206d 5b69 5d20             m[i] 
-00001f30: 3d20 765b 695d 2a6e 702e 646f 7428 2873  = v[i]*np.dot((s
-00001f40: 656c 662e 595b 695d 292e 542c 7073 695f  elf.Y[i]).T,psi_
-00001f50: 696e 7629 2e64 6f74 2843 292e 646f 7428  inv).dot(C).dot(
-00001f60: 785f 6929 0d0a 0d0a 2020 2020 2020 2020  x_i)....        
-00001f70: 0d0a 2020 2020 2020 2020 2320 4d2d 7374  ..        # M-st
-00001f80: 6570 0d0a 0d0a 2020 2020 2020 2020 595f  ep....        Y_
-00001f90: 7469 6c64 6520 3d20 6e70 2e76 7374 6163  tilde = np.vstac
-00001fa0: 6b28 2873 656c 662e 592c 206e 702e 7a65  k((self.Y, np.ze
-00001fb0: 726f 7328 2873 656c 662e 6e2c 7365 6c66  ros((self.n,self
-00001fc0: 2e64 2929 2929 0d0a 2020 2020 2020 2020  .d))))..        
-00001fd0: 6966 2073 656c 662e 4120 6973 206e 6f74  if self.A is not
-00001fe0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-00001ff0: 2020 2020 585f 7469 6c64 6520 3d20 206e      X_tilde =  n
-00002000: 702e 7673 7461 636b 2828 6e70 2e68 7374  p.vstack((np.hst
-00002010: 6163 6b28 2873 656c 662e 462c 206d 5b3a  ack((self.F, m[:
-00002020: 2c6e 702e 6e65 7761 7869 735d 2a73 656c  ,np.newaxis]*sel
-00002030: 662e 4629 292c 6e70 2e68 7374 6163 6b28  f.F)),np.hstack(
-00002040: 286e 702e 7a65 726f 7328 2873 656c 662e  (np.zeros((self.
-00002050: 6e2c 2073 656c 662e 7231 2929 2c76 5b3a  n, self.r1)),v[:
-00002060: 2c6e 702e 6e65 7761 7869 735d 2a73 656c  ,np.newaxis]*sel
-00002070: 662e 4629 2929 290d 0a20 2020 2020 2020  f.F))))..       
-00002080: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00002090: 2020 2020 585f 7469 6c64 6520 3d20 206e      X_tilde =  n
-000020a0: 702e 7673 7461 636b 2828 6d5b 3a2c 6e70  p.vstack((m[:,np
-000020b0: 2e6e 6577 6178 6973 5d2a 7365 6c66 2e46  .newaxis]*self.F
-000020c0: 2c76 5b3a 2c6e 702e 6e65 7761 7869 735d  ,v[:,np.newaxis]
-000020d0: 2a73 656c 662e 4629 290d 0a0d 0a0d 0a20  *self.F))...... 
-000020e0: 2020 2020 2020 206f 626a 203d 2030 2e35         obj = 0.5
-000020f0: 2a6e 702e 7472 6163 6528 6e70 2e64 6f74  *np.trace(np.dot
-00002100: 2828 595f 7469 6c64 652d 6e70 2e64 6f74  ((Y_tilde-np.dot
-00002110: 2858 5f74 696c 6465 2c20 432e 5429 292e  (X_tilde, C.T)).
-00002120: 542c 2028 595f 7469 6c64 652d 6e70 2e64  T, (Y_tilde-np.d
-00002130: 6f74 2858 5f74 696c 6465 2c20 432e 5429  ot(X_tilde, C.T)
-00002140: 2929 2e64 6f74 2870 7369 5f69 6e76 2929  )).dot(psi_inv))
-00002150: 202b 2030 2e35 2a73 656c 662e 6f6d 6567   + 0.5*self.omeg
-00002160: 612a 6e70 2e74 7261 6365 286e 702e 646f  a*np.trace(np.do
-00002170: 7428 7365 6c66 2e4b 5f69 6e76 2c20 7365  t(self.K_inv, se
-00002180: 6c66 2e46 292e 646f 7428 7365 6c66 2e48  lf.F).dot(self.H
-00002190: 5f73 715f 696e 7629 2e64 6f74 2873 656c  _sq_inv).dot(sel
-000021a0: 662e 462e 5429 290d 0a20 2020 2020 2020  f.F.T))..       
-000021b0: 200d 0a20 2020 2020 2020 2072 6574 7572   ..        retur
-000021c0: 6e20 6f62 6a0d 0a0d 0a0d 0a0d 0a0d 0a0d  n obj...........
-000021d0: 0a0d 0a0d 0a20 2020 2064 6566 2066 6974  .....    def fit
-000021e0: 5f67 6770 5f62 5f6f 6e6c 7928 7365 6c66  _ggp_b_only(self
-000021f0: 2c20 7073 6920 3d20 4e6f 6e65 2c20 465f  , psi = None, F_
-00002200: 7374 6172 7420 3d20 4e6f 6e65 2c20 2072  start = None,  r
-00002210: 6567 203d 204e 6f6e 652c 2074 7970 655f  eg = None, type_
-00002220: 7265 6720 3d20 4e6f 6e65 2c20 465f 6d65  reg = None, F_me
-00002230: 7468 6f64 203d 2027 6469 7265 6374 272c  thod = 'direct',
-00002240: 2063 203d 204e 6f6e 6529 2d3e 204e 6f6e   c = None)-> Non
-00002250: 653a 0d0a 2020 2020 2020 2020 2222 220d  e:..        """.
-00002260: 0a20 2020 2020 2020 2047 7261 7068 2047  .        Graph G
-00002270: 5020 6f6e 6c79 2066 6974 2063 6f76 6172  P only fit covar
-00002280: 6961 6e63 6520 7465 726d 0d0a 2020 2020  iance term..    
-00002290: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
-000022a0: 2020 2073 656c 662e 465f 6d65 7468 6f64     self.F_method
-000022b0: 203d 2046 5f6d 6574 686f 640d 0a20 2020   = F_method..   
-000022c0: 2020 2020 2073 656c 662e 7265 6720 3d20       self.reg = 
-000022d0: 7265 670d 0a20 2020 2020 2020 2073 656c  reg..        sel
-000022e0: 662e 7479 7065 5f72 6567 203d 2074 7970  f.type_reg = typ
-000022f0: 655f 7265 670d 0a0d 0a20 2020 2020 2020  e_reg....       
-00002300: 2073 656c 662e 7231 203d 2030 0d0a 2020   self.r1 = 0..  
-00002310: 2020 2020 2020 7365 6c66 2e72 3220 3d20        self.r2 = 
-00002320: 7365 6c66 2e72 0d0a 0d0a 2020 2020 2020  self.r....      
-00002330: 2020 0d0a 0d0a 2020 2020 2020 2020 6966    ....        if
-00002340: 2046 5f73 7461 7274 2069 7320 4e6f 6e65   F_start is None
-00002350: 3a0d 0a20 2020 2020 2020 2020 2020 2046  :..            F
-00002360: 5f70 7265 203d 206e 702e 6f6e 6573 2828  _pre = np.ones((
-00002370: 7365 6c66 2e6e 2c20 7365 6c66 2e72 2929  self.n, self.r))
-00002380: 0d0a 0d0a 2020 2020 2020 2020 595f 7469  ....        Y_ti
-00002390: 6c64 6520 3d20 6e70 2e76 7374 6163 6b28  lde = np.vstack(
-000023a0: 2873 656c 662e 592c 206e 702e 7a65 726f  (self.Y, np.zero
-000023b0: 7328 2873 656c 662e 6e2c 7365 6c66 2e64  s((self.n,self.d
-000023c0: 2929 2929 0d0a 0d0a 0d0a 2020 2020 2020  ))))......      
-000023d0: 2020 6966 2070 7369 2069 7320 4e6f 6e65    if psi is None
-000023e0: 3a0d 0a20 2020 2020 2020 2020 2020 2050  :..            P
-000023f0: 7369 5f70 7265 203d 206e 702e 6964 656e  si_pre = np.iden
-00002400: 7469 7479 2873 656c 662e 6429 0d0a 2020  tity(self.d)..  
-00002410: 2020 2020 2020 2020 2020 5073 695f 7072            Psi_pr
-00002420: 655f 696e 7620 3d20 6e70 2e6c 696e 616c  e_inv = np.linal
-00002430: 672e 696e 7628 5073 695f 7072 6529 0d0a  g.inv(Psi_pre)..
-00002440: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00002450: 2020 2020 2020 2020 2020 2050 7369 5f70             Psi_p
-00002460: 7265 203d 2070 7369 0d0a 2020 2020 2020  re = psi..      
-00002470: 2020 2020 2020 5073 695f 7072 655f 696e        Psi_pre_in
-00002480: 7620 3d20 6e70 2e6c 696e 616c 672e 696e  v = np.linalg.in
-00002490: 7628 5073 695f 7072 6529 0d0a 0d0a 2020  v(Psi_pre)....  
-000024a0: 2020 2020 2020 7620 3d20 6e70 2e6f 6e65        v = np.one
-000024b0: 7328 7365 6c66 2e6e 290d 0a20 2020 2020  s(self.n)..     
-000024c0: 2020 206d 203d 206e 702e 6f6e 6573 2873     m = np.ones(s
-000024d0: 656c 662e 6e29 0d0a 2020 2020 2020 2020  elf.n)..        
-000024e0: 2320 5468 6520 736f 6c75 7469 6f6e 2069  # The solution i
-000024f0: 7320 6576 7279 2073 656e 7369 7469 7665  s evry sensitive
-00002500: 2074 6f20 7468 6520 696e 6974 616c 206d   to the inital m
-00002510: 6174 7269 782c 2074 6865 206c 3220 7265  atrix, the l2 re
-00002520: 6775 6c61 7269 7a61 7469 6f6e 2066 6f72  gularization for
-00002530: 2042 5f70 7265 2065 6666 6563 7473 2061   B_pre effects a
-00002540: 6c70 6861 0d0a 2020 2020 2020 2020 0d0a  lpha..        ..
-00002550: 2020 2020 2020 2020 6966 2063 2069 7320          if c is 
-00002560: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-00002570: 2020 2043 5f70 7265 203d 206e 702e 6f6e     C_pre = np.on
-00002580: 6573 2828 7365 6c66 2e64 2c20 7365 6c66  es((self.d, self
-00002590: 2e72 2929 2320 6e70 2e64 6f74 2859 5f74  .r))# np.dot(Y_t
-000025a0: 696c 6465 2e54 2c20 585f 7469 6c64 6529  ilde.T, X_tilde)
-000025b0: 2e64 6f74 286e 702e 6c69 6e61 6c67 2e69  .dot(np.linalg.i
-000025c0: 6e76 286e 702e 646f 7428 585f 7469 6c64  nv(np.dot(X_tild
-000025d0: 652e 542c 2058 5f74 696c 6465 2920 2b20  e.T, X_tilde) + 
-000025e0: 616c 7068 612a 6e70 2e69 6465 6e74 6974  alpha*np.identit
-000025f0: 7928 7229 2929 0d0a 2020 2020 2020 2020  y(r)))..        
-00002600: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00002610: 2020 2043 5f70 7265 203d 2063 0d0a 2020     C_pre = c..  
-00002620: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00002630: 7365 6c66 2e69 7465 7261 7469 6f6e 203d  self.iteration =
-00002640: 2030 0d0a 2020 2020 2020 2020 7365 6c66   0..        self
-00002650: 2e74 6f6c 5f76 6563 203d 206e 702e 7a65  .tol_vec = np.ze
-00002660: 726f 7328 7365 6c66 2e6d 6178 5f69 7465  ros(self.max_ite
-00002670: 7229 0d0a 2020 2020 2020 2020 7768 696c  r)..        whil
-00002680: 6520 7365 6c66 2e69 7465 7261 7469 6f6e  e self.iteration
-00002690: 203c 7365 6c66 2e6d 6178 5f69 7465 723a   <self.max_iter:
-000026a0: 0d0a 2020 2020 2020 2020 2020 2020 432c  ..            C,
-000026b0: 2050 7369 5f65 7374 2c20 462c 2074 6f6c   Psi_est, F, tol
-000026c0: 5f69 203d 2073 656c 662e 6f6e 655f 6974  _i = self.one_it
-000026d0: 6572 6174 696f 6e28 6e70 2e6c 696e 616c  eration(np.linal
-000026e0: 672e 696e 7628 5073 695f 7072 6529 2c20  g.inv(Psi_pre), 
-000026f0: 7073 692c 2043 5f70 7265 2c20 632c 2059  psi, C_pre, c, Y
-00002700: 5f74 696c 6465 2c20 465f 7072 6520 3d20  _tilde, F_pre = 
-00002710: 465f 7072 652c 2077 6974 685f 6d65 616e  F_pre, with_mean
-00002720: 203d 2046 616c 7365 290d 0a20 2020 2020   = False)..     
-00002730: 2020 2020 2020 2073 656c 662e 746f 6c5f         self.tol_
-00002740: 7665 635b 7365 6c66 2e69 7465 7261 7469  vec[self.iterati
-00002750: 6f6e 5d20 3d20 746f 6c5f 690d 0a20 2020  on] = tol_i..   
-00002760: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00002770: 2020 2020 2020 2069 6620 2874 6f6c 5f69         if (tol_i
-00002780: 3c73 656c 662e 746f 6c29 2026 2028 6e6f  <self.tol) & (no
-00002790: 7420 7365 6c66 2e64 6f5f 616c 6c5f 6974  t self.do_all_it
-000027a0: 6572 293a 0d0a 2020 2020 2020 2020 2020  er):..          
-000027b0: 2020 2020 2020 6272 6561 6b0d 0a20 2020        break..   
-000027c0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-000027d0: 2020 2020 2020 2073 656c 662e 6974 6572         self.iter
-000027e0: 6174 696f 6e2b 3d31 0d0a 0d0a 2020 2020  ation+=1....    
-000027f0: 2020 2020 2020 2020 6966 2070 7369 2069          if psi i
-00002800: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
-00002810: 2020 2020 2020 2020 2050 7369 5f70 7265           Psi_pre
-00002820: 203d 2050 7369 5f65 7374 2e63 6f70 7928   = Psi_est.copy(
-00002830: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00002840: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00002850: 2020 2020 2020 5073 695f 7072 6520 3d20        Psi_pre = 
-00002860: 7073 690d 0a0d 0a20 2020 2020 2020 2020  psi....         
-00002870: 2020 2043 5f70 7265 203d 2043 2e63 6f70     C_pre = C.cop
-00002880: 7928 290d 0a20 2020 2020 2020 2020 2020  y()..           
-00002890: 2046 5f70 7265 203d 2046 2e63 6f70 7928   F_pre = F.copy(
-000028a0: 290d 0a0d 0a0d 0a0d 0a20 2020 2020 2020  )........       
-000028b0: 2073 656c 662e 4120 3d20 4e6f 6e65 0d0a   self.A = None..
-000028c0: 2020 2020 2020 2020 7365 6c66 2e42 203d          self.B =
-000028d0: 2043 5b3a 2c73 656c 662e 723a 5d0d 0a20   C[:,self.r:].. 
-000028e0: 2020 2020 2020 2073 656c 662e 4620 3d20         self.F = 
-000028f0: 460d 0a20 2020 2020 2020 2073 656c 662e  F..        self.
-00002900: 5073 6920 3d20 5073 695f 6573 740d 0a0d  Psi = Psi_est...
-00002910: 0a0d 0a0d 0a20 2020 2064 6566 2066 6974  .....    def fit
-00002920: 5f67 6770 5f61 5f6f 6e6c 7928 7365 6c66  _ggp_a_only(self
-00002930: 2c20 7073 6920 3d20 4e6f 6e65 2c20 465f  , psi = None, F_
-00002940: 7374 6172 7420 3d20 4e6f 6e65 2c20 7265  start = None, re
-00002950: 6720 3d20 4e6f 6e65 2c20 7479 7065 5f72  g = None, type_r
-00002960: 6567 203d 204e 6f6e 652c 2046 5f6d 6574  eg = None, F_met
-00002970: 686f 6420 3d20 2764 6972 6563 7427 2c20  hod = 'direct', 
-00002980: 6320 3d20 4e6f 6e65 2920 2d3e 204e 6f6e  c = None) -> Non
-00002990: 653a 0d0a 0d0a 0d0a 2020 2020 2020 2020  e:......        
-000029a0: 7365 6c66 2e72 6567 203d 2072 6567 0d0a  self.reg = reg..
-000029b0: 2020 2020 2020 2020 7365 6c66 2e74 7970          self.typ
-000029c0: 655f 7265 6720 3d20 7479 7065 5f72 6567  e_reg = type_reg
-000029d0: 0d0a 2020 2020 2020 2020 7365 6c66 2e46  ..        self.F
-000029e0: 5f6d 6574 686f 6420 3d20 465f 6d65 7468  _method = F_meth
-000029f0: 6f64 0d0a 0d0a 2020 2020 2020 2020 7365  od....        se
-00002a00: 6c66 2e72 3120 3d20 7365 6c66 2e72 0d0a  lf.r1 = self.r..
-00002a10: 2020 2020 2020 2020 7365 6c66 2e72 3220          self.r2 
-00002a20: 3d20 300d 0a0d 0a0d 0a20 2020 2020 2020  = 0......       
-00002a30: 2069 6620 7073 6920 6973 204e 6f6e 653a   if psi is None:
-00002a40: 0d0a 2020 2020 2020 2020 2020 2020 5073  ..            Ps
-00002a50: 695f 7072 6520 3d20 6e70 2e69 6465 6e74  i_pre = np.ident
-00002a60: 6974 7928 7365 6c66 2e64 290d 0a20 2020  ity(self.d)..   
-00002a70: 2020 2020 2020 2020 2050 7369 5f70 7265           Psi_pre
-00002a80: 5f69 6e76 203d 206e 702e 6c69 6e61 6c67  _inv = np.linalg
-00002a90: 2e69 6e76 2850 7369 5f70 7265 290d 0a20  .inv(Psi_pre).. 
-00002aa0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00002ab0: 2020 2020 2020 2020 2020 5073 695f 7072            Psi_pr
-00002ac0: 6520 3d20 7073 690d 0a20 2020 2020 2020  e = psi..       
-00002ad0: 2020 2020 2050 7369 5f70 7265 5f69 6e76       Psi_pre_inv
-00002ae0: 203d 206e 702e 6c69 6e61 6c67 2e69 6e76   = np.linalg.inv
-00002af0: 2850 7369 5f70 7265 290d 0a0d 0a0d 0a0d  (Psi_pre).......
-00002b00: 0a20 2020 2020 2020 2069 6620 6320 6973  .        if c is
-00002b10: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-00002b20: 2020 2020 435f 7072 6520 3d20 6e70 2e6f      C_pre = np.o
-00002b30: 6e65 7328 2873 656c 662e 642c 2073 656c  nes((self.d, sel
-00002b40: 662e 7229 2923 206e 702e 646f 7428 595f  f.r))# np.dot(Y_
-00002b50: 7469 6c64 652e 542c 2058 5f74 696c 6465  tilde.T, X_tilde
-00002b60: 292e 646f 7428 6e70 2e6c 696e 616c 672e  ).dot(np.linalg.
-00002b70: 696e 7628 6e70 2e64 6f74 2858 5f74 696c  inv(np.dot(X_til
-00002b80: 6465 2e54 2c20 585f 7469 6c64 6529 202b  de.T, X_tilde) +
-00002b90: 2061 6c70 6861 2a6e 702e 6964 656e 7469   alpha*np.identi
-00002ba0: 7479 2872 2929 290d 0a20 2020 2020 2020  ty(r)))..       
-00002bb0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00002bc0: 2020 2020 435f 7072 6520 3d20 630d 0a0d      C_pre = c...
-00002bd0: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
-00002be0: 6974 6572 6174 696f 6e20 3d20 300d 0a20  iteration = 0.. 
-00002bf0: 2020 2020 2020 2073 656c 662e 746f 6c5f         self.tol_
-00002c00: 7665 6320 3d20 6e70 2e7a 6572 6f73 2873  vec = np.zeros(s
-00002c10: 656c 662e 6d61 785f 6974 6572 290d 0a20  elf.max_iter).. 
-00002c20: 2020 2020 2020 2077 6869 6c65 2073 656c         while sel
-00002c30: 662e 6974 6572 6174 696f 6e20 3c73 656c  f.iteration <sel
-00002c40: 662e 6d61 785f 6974 6572 3a0d 0a20 2020  f.max_iter:..   
-00002c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c60: 2023 204d 2d73 7465 700d 0a20 2020 2020   # M-step..     
-00002c70: 2020 2020 2020 2050 7369 5f70 7265 5f69         Psi_pre_i
-00002c80: 6e76 203d 206e 702e 6c69 6e61 6c67 2e69  nv = np.linalg.i
-00002c90: 6e76 2850 7369 5f70 7265 290d 0a20 2020  nv(Psi_pre)..   
-00002ca0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00002cb0: 2e46 5f6d 6574 686f 6420 3d3d 2027 6469  .F_method == 'di
-00002cc0: 7265 6374 273a 0d0a 2020 2020 2020 2020  rect':..        
-00002cd0: 2020 2020 2020 2020 4620 3d20 7365 6c66          F = self
-00002ce0: 2e46 5f6c 735f 7265 6728 2043 5f70 7265  .F_ls_reg( C_pre
-00002cf0: 2c20 5073 695f 7072 655f 696e 7629 0d0a  , Psi_pre_inv)..
-00002d00: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00002d10: 2073 656c 662e 465f 6d65 7468 6f64 203d   self.F_method =
-00002d20: 3d20 2773 6563 616e 7427 3a0d 0a20 2020  = 'secant':..   
-00002d30: 2020 2020 2020 2020 2020 2020 2046 203d               F =
-00002d40: 2073 656c 662e 465f 7365 6361 6e74 5f6f   self.F_secant_o
-00002d50: 7074 696d 286e 702e 7a65 726f 7328 2873  ptim(np.zeros((s
-00002d60: 656c 662e 642c 2073 656c 662e 7229 292c  elf.d, self.r)),
-00002d70: 2043 5f70 7265 2c20 6e70 2e6f 6e65 7328   C_pre, np.ones(
-00002d80: 7365 6c66 2e6e 292c 6e70 2e6f 6e65 7328  self.n),np.ones(
-00002d90: 7365 6c66 2e6e 292c 2050 7369 5f70 7265  self.n), Psi_pre
-00002da0: 5f69 6e76 290d 0a0d 0a20 2020 2020 2020  _inv)....       
-00002db0: 2020 2020 2069 6620 6320 6973 204e 6f6e       if c is Non
-00002dc0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00002dd0: 2020 2020 435f 746d 7020 3d20 435f 7072      C_tmp = C_pr
-00002de0: 652e 666c 6174 7465 6e28 290d 0a20 2020  e.flatten()..   
-00002df0: 2020 2020 2020 2020 2020 2020 2043 5f76               C_v
-00002e00: 6563 203d 206e 702e 7a65 726f 7328 322a  ec = np.zeros(2*
-00002e10: 2873 656c 662e 7231 2b73 656c 662e 7232  (self.r1+self.r2
-00002e20: 292a 7365 6c66 2e64 290d 0a20 2020 2020  )*self.d)..     
-00002e30: 2020 2020 2020 2020 2020 2043 5f76 6563             C_vec
-00002e40: 5b3a 2873 656c 662e 7231 2b73 656c 662e  [:(self.r1+self.
-00002e50: 7232 292a 7365 6c66 2e64 5d20 3d20 6e70  r2)*self.d] = np
-00002e60: 2e61 6273 2843 5f74 6d70 2920 2a20 2843  .abs(C_tmp) * (C
-00002e70: 5f74 6d70 3e30 290d 0a20 2020 2020 2020  _tmp>0)..       
-00002e80: 2020 2020 2020 2020 2043 5f76 6563 5b28           C_vec[(
-00002e90: 7365 6c66 2e72 312b 7365 6c66 2e72 3229  self.r1+self.r2)
-00002ea0: 2a73 656c 662e 643a 5d20 3d20 6e70 2e61  *self.d:] = np.a
-00002eb0: 6273 2843 5f74 6d70 2920 2a20 2843 5f74  bs(C_tmp) * (C_t
-00002ec0: 6d70 3c30 290d 0a0d 0a20 2020 2020 2020  mp<0)....       
-00002ed0: 2020 2020 2020 2020 206f 7574 203d 206d           out = m
-00002ee0: 696e 696d 697a 6528 7365 6c66 2e6c 6173  inimize(self.las
-00002ef0: 736f 5f6f 626a 6563 7469 7665 2c20 435f  so_objective, C_
-00002f00: 7665 632c 2061 7267 7320 3d20 2846 2c20  vec, args = (F, 
-00002f10: 7365 6c66 2e59 2c20 5073 695f 7072 655f  self.Y, Psi_pre_
-00002f20: 696e 762c 7365 6c66 2e64 2c73 656c 662e  inv,self.d,self.
-00002f30: 7231 2b73 656c 662e 7232 2c20 7365 6c66  r1+self.r2, self
-00002f40: 2e61 6c70 6861 292c 206d 6574 686f 643d  .alpha), method=
-00002f50: 274c 2d42 4647 532d 4227 2c20 6a61 633d  'L-BFGS-B', jac=
-00002f60: 5472 7565 2c20 626f 756e 6473 203d 205b  True, bounds = [
-00002f70: 2830 2e30 2c4e 6f6e 6529 5d2a 2832 2a28  (0.0,None)]*(2*(
-00002f80: 7365 6c66 2e72 312b 7365 6c66 2e72 3229  self.r1+self.r2)
-00002f90: 2a73 656c 662e 6429 290d 0a20 2020 2020  *self.d))..     
-00002fa0: 2020 2020 2020 2020 2020 2043 5f76 6563             C_vec
-00002fb0: 203d 206f 7574 2e78 0d0a 2020 2020 2020   = out.x..      
-00002fc0: 2020 2020 2020 2020 2020 4320 3d20 6e70            C = np
-00002fd0: 2e72 6573 6861 7065 286f 7574 2e78 5b3a  .reshape(out.x[:
-00002fe0: 2873 656c 662e 7231 2b73 656c 662e 7232  (self.r1+self.r2
-00002ff0: 292a 7365 6c66 2e64 5d20 2d20 6f75 742e  )*self.d] - out.
-00003000: 785b 2873 656c 662e 7231 2b73 656c 662e  x[(self.r1+self.
-00003010: 7232 292a 7365 6c66 2e64 3a5d 2c20 2873  r2)*self.d:], (s
-00003020: 656c 662e 642c 7365 6c66 2e72 312b 7365  elf.d,self.r1+se
-00003030: 6c66 2e72 3229 290d 0a0d 0a20 2020 2020  lf.r2))....     
-00003040: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00003050: 2020 2020 2020 2020 2020 2020 2020 4320                C 
-00003060: 3d20 630d 0a0d 0a0d 0a20 2020 2020 2020  = c......       
-00003070: 2020 2020 2074 6f6c 5f69 203d 2028 6e70       tol_i = (np
-00003080: 2e6c 696e 616c 672e 6e6f 726d 2843 2d43  .linalg.norm(C-C
-00003090: 5f70 7265 2929 2f28 6e70 2e6c 696e 616c  _pre))/(np.linal
-000030a0: 672e 6e6f 726d 2843 5f70 7265 2929 0d0a  g.norm(C_pre))..
-000030b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000030c0: 2e74 6f6c 5f76 6563 5b73 656c 662e 6974  .tol_vec[self.it
-000030d0: 6572 6174 696f 6e5d 203d 2074 6f6c 5f69  eration] = tol_i
-000030e0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-000030f0: 2020 2020 2020 2020 6966 2028 746f 6c5f          if (tol_
-00003100: 693c 7365 6c66 2e74 6f6c 2920 2620 286e  i<self.tol) & (n
-00003110: 6f74 2073 656c 662e 646f 5f61 6c6c 5f69  ot self.do_all_i
-00003120: 7465 7229 3a0d 0a20 2020 2020 2020 2020  ter):..         
-00003130: 2020 2020 2020 2062 7265 616b 0d0a 2020         break..  
-00003140: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00003150: 2020 2020 2020 2020 7365 6c66 2e69 7465          self.ite
-00003160: 7261 7469 6f6e 2b3d 310d 0a20 2020 2020  ration+=1..     
-00003170: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00003180: 2020 2020 2069 6620 7073 6920 6973 204e       if psi is N
-00003190: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-000031a0: 2020 2020 2020 5073 695f 6573 7420 3d20        Psi_est = 
-000031b0: 6e70 2e63 6f76 2828 7365 6c66 2e59 2d6e  np.cov((self.Y-n
-000031c0: 702e 646f 7428 462c 432e 5429 292e 5429  p.dot(F,C.T)).T)
-000031d0: 2a28 7365 6c66 2e6e 2d31 292f 7365 6c66  *(self.n-1)/self
-000031e0: 2e6e 0d0a 2020 2020 2020 2020 2020 2020  .n..            
-000031f0: 2020 2020 5073 695f 7072 6520 3d20 5073      Psi_pre = Ps
-00003200: 695f 6573 742e 636f 7079 2829 0d0a 2020  i_est.copy()..  
-00003210: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00003220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003230: 2050 7369 5f65 7374 203d 2070 7369 0d0a   Psi_est = psi..
-00003240: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00003250: 435f 7072 6520 3d20 432e 636f 7079 2829  C_pre = C.copy()
-00003260: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00003270: 6c66 2e69 7465 7261 7469 6f6e 2b3d 310d  lf.iteration+=1.
-00003280: 0a0d 0a0d 0a20 2020 2020 2020 2073 656c  .....        sel
-00003290: 662e 4120 3d20 430d 0a20 2020 2020 2020  f.A = C..       
-000032a0: 2073 656c 662e 4220 3d20 4e6f 6e65 0d0a   self.B = None..
-000032b0: 2020 2020 2020 2020 7365 6c66 2e46 203d          self.F =
-000032c0: 2046 0d0a 2020 2020 2020 2020 7365 6c66   F..        self
-000032d0: 2e50 7369 203d 2050 7369 5f65 7374 0d0a  .Psi = Psi_est..
-000032e0: 0d0a 0d0a 0d0a 0d0a 0d0a 0d0a            ............
+00001cd0: 4220 6973 204e 6f6e 653a 0d0a 0d0a 2020  B is None:....  
+00001ce0: 2020 2020 2020 2020 2020 6f62 6a20 3d20            obj = 
+00001cf0: 302e 352a 6e70 2e74 7261 6365 286e 702e  0.5*np.trace(np.
+00001d00: 646f 7428 2873 656c 662e 592d 6e70 2e64  dot((self.Y-np.d
+00001d10: 6f74 2873 656c 662e 462c 2073 656c 662e  ot(self.F, self.
+00001d20: 412e 5429 292e 542c 2028 7365 6c66 2e59  A.T)).T, (self.Y
+00001d30: 2d6e 702e 646f 7428 7365 6c66 2e46 2c20  -np.dot(self.F, 
+00001d40: 7365 6c66 2e41 2e54 2929 292e 646f 7428  self.A.T))).dot(
+00001d50: 7073 695f 696e 7629 2920 2b20 302e 352a  psi_inv)) + 0.5*
+00001d60: 7365 6c66 2e6f 6d65 6761 2a6e 702e 7472  self.omega*np.tr
+00001d70: 6163 6528 6e70 2e64 6f74 2873 656c 662e  ace(np.dot(self.
+00001d80: 4b5f 696e 762c 2073 656c 662e 4629 2e64  K_inv, self.F).d
+00001d90: 6f74 2873 656c 662e 485f 7371 5f69 6e76  ot(self.H_sq_inv
+00001da0: 292e 646f 7428 7365 6c66 2e46 2e54 2929  ).dot(self.F.T))
+00001db0: 0d0a 2020 2020 2020 2020 0d0a 0d0a 2020  ..        ....  
+00001dc0: 2020 2020 2020 656c 7365 3a0d 0a0d 0a20        else:.... 
+00001dd0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00001de0: 6c66 2e41 2069 7320 4e6f 6e65 3a0d 0a20  lf.A is None:.. 
+00001df0: 2020 2020 2020 2020 2020 2020 2020 2043                 C
+00001e00: 203d 2073 656c 662e 420d 0a20 2020 2020   = self.B..     
+00001e10: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00001e20: 2020 2020 2020 2020 2020 2020 2020 4320                C 
+00001e30: 3d20 6e70 2e68 7374 6163 6b28 2873 656c  = np.hstack((sel
+00001e40: 662e 412c 2073 656c 662e 4229 290d 0a20  f.A, self.B)).. 
+00001e50: 2020 2020 2020 200d 0a0d 0a20 2020 2020         ....     
+00001e60: 2020 2020 2020 2023 2045 2d73 7465 700d         # E-step.
+00001e70: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00001e80: 2069 2069 6e20 7261 6e67 6528 7365 6c66   i in range(self
+00001e90: 2e6e 293a 0d0a 2020 2020 2020 2020 2020  .n):..          
+00001ea0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00001eb0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00001ec0: 4120 6973 206e 6f74 204e 6f6e 653a 0d0a  A is not None:..
+00001ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001ee0: 2020 2020 785f 6920 3d20 6e70 2e68 7374      x_i = np.hst
+00001ef0: 6163 6b28 2873 656c 662e 465b 695d 2c20  ack((self.F[i], 
+00001f00: 7365 6c66 2e46 5b69 5d29 290d 0a20 2020  self.F[i]))..   
+00001f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001f20: 2076 5b69 5d20 3d20 2831 2b6e 702e 646f   v[i] = (1+np.do
+00001f30: 7428 785f 692e 542c 2043 2e54 292e 646f  t(x_i.T, C.T).do
+00001f40: 7428 7073 695f 696e 7629 2e64 6f74 2843  t(psi_inv).dot(C
+00001f50: 292e 646f 7428 785f 6929 2920 2a2a 2028  ).dot(x_i)) ** (
+00001f60: 2d31 290d 0a20 2020 2020 2020 2020 2020  -1)..           
+00001f70: 2020 2020 2020 2020 206d 5b69 5d20 3d20           m[i] = 
+00001f80: 765b 695d 2a6e 702e 646f 7428 2873 656c  v[i]*np.dot((sel
+00001f90: 662e 595b 695d 2d6e 702e 646f 7428 7365  f.Y[i]-np.dot(se
+00001fa0: 6c66 2e41 2c20 7365 6c66 2e46 5b69 5d29  lf.A, self.F[i])
+00001fb0: 292e 542c 7073 695f 696e 7629 2e64 6f74  ).T,psi_inv).dot
+00001fc0: 2843 292e 646f 7428 785f 6929 0d0a 2020  (C).dot(x_i)..  
+00001fd0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00001fe0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00001ff0: 2020 2020 2020 2020 2078 5f69 203d 2073           x_i = s
+00002000: 656c 662e 465b 695d 0d0a 2020 2020 2020  elf.F[i]..      
+00002010: 2020 2020 2020 2020 2020 2020 2020 765b                v[
+00002020: 695d 203d 2028 312b 6e70 2e64 6f74 2878  i] = (1+np.dot(x
+00002030: 5f69 2e54 2c20 432e 5429 2e64 6f74 2870  _i.T, C.T).dot(p
+00002040: 7369 5f69 6e76 292e 646f 7428 4329 2e64  si_inv).dot(C).d
+00002050: 6f74 2878 5f69 2929 202a 2a20 282d 3129  ot(x_i)) ** (-1)
+00002060: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00002070: 2020 2020 2020 6d5b 695d 203d 2076 5b69        m[i] = v[i
+00002080: 5d2a 6e70 2e64 6f74 2828 7365 6c66 2e59  ]*np.dot((self.Y
+00002090: 5b69 5d29 2e54 2c70 7369 5f69 6e76 292e  [i]).T,psi_inv).
+000020a0: 646f 7428 4329 2e64 6f74 2878 5f69 290d  dot(C).dot(x_i).
+000020b0: 0a0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
+000020c0: 2020 2020 2023 204d 2d73 7465 700d 0a0d       # M-step...
+000020d0: 0a20 2020 2020 2020 2020 2020 2059 5f74  .            Y_t
+000020e0: 696c 6465 203d 206e 702e 7673 7461 636b  ilde = np.vstack
+000020f0: 2828 7365 6c66 2e59 2c20 6e70 2e7a 6572  ((self.Y, np.zer
+00002100: 6f73 2828 7365 6c66 2e6e 2c73 656c 662e  os((self.n,self.
+00002110: 6429 2929 290d 0a20 2020 2020 2020 2020  d))))..         
+00002120: 2020 2069 6620 7365 6c66 2e41 2069 7320     if self.A is 
+00002130: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
+00002140: 2020 2020 2020 2020 2020 2058 5f74 696c             X_til
+00002150: 6465 203d 2020 6e70 2e76 7374 6163 6b28  de =  np.vstack(
+00002160: 286e 702e 6873 7461 636b 2828 7365 6c66  (np.hstack((self
+00002170: 2e46 2c20 6d5b 3a2c 6e70 2e6e 6577 6178  .F, m[:,np.newax
+00002180: 6973 5d2a 7365 6c66 2e46 2929 2c6e 702e  is]*self.F)),np.
+00002190: 6873 7461 636b 2828 6e70 2e7a 6572 6f73  hstack((np.zeros
+000021a0: 2828 7365 6c66 2e6e 2c20 7365 6c66 2e72  ((self.n, self.r
+000021b0: 3129 292c 765b 3a2c 6e70 2e6e 6577 6178  1)),v[:,np.newax
+000021c0: 6973 5d2a 7365 6c66 2e46 2929 2929 0d0a  is]*self.F))))..
+000021d0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000021e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000021f0: 2020 2058 5f74 696c 6465 203d 2020 6e70     X_tilde =  np
+00002200: 2e76 7374 6163 6b28 286d 5b3a 2c6e 702e  .vstack((m[:,np.
+00002210: 6e65 7761 7869 735d 2a73 656c 662e 462c  newaxis]*self.F,
+00002220: 765b 3a2c 6e70 2e6e 6577 6178 6973 5d2a  v[:,np.newaxis]*
+00002230: 7365 6c66 2e46 2929 0d0a 0d0a 0d0a 2020  self.F))......  
+00002240: 2020 2020 2020 2020 2020 6f62 6a20 3d20            obj = 
+00002250: 302e 352a 6e70 2e74 7261 6365 286e 702e  0.5*np.trace(np.
+00002260: 646f 7428 2859 5f74 696c 6465 2d6e 702e  dot((Y_tilde-np.
+00002270: 646f 7428 585f 7469 6c64 652c 2043 2e54  dot(X_tilde, C.T
+00002280: 2929 2e54 2c20 2859 5f74 696c 6465 2d6e  )).T, (Y_tilde-n
+00002290: 702e 646f 7428 585f 7469 6c64 652c 2043  p.dot(X_tilde, C
+000022a0: 2e54 2929 292e 646f 7428 7073 695f 696e  .T))).dot(psi_in
+000022b0: 7629 2920 2b20 302e 352a 7365 6c66 2e6f  v)) + 0.5*self.o
+000022c0: 6d65 6761 2a6e 702e 7472 6163 6528 6e70  mega*np.trace(np
+000022d0: 2e64 6f74 2873 656c 662e 4b5f 696e 762c  .dot(self.K_inv,
+000022e0: 2073 656c 662e 4629 2e64 6f74 2873 656c   self.F).dot(sel
+000022f0: 662e 485f 7371 5f69 6e76 292e 646f 7428  f.H_sq_inv).dot(
+00002300: 7365 6c66 2e46 2e54 2929 0d0a 2020 2020  self.F.T))..    
+00002310: 2020 2020 0d0a 2020 2020 2020 2020 7265      ..        re
+00002320: 7475 726e 206f 626a 0d0a 0d0a 0d0a 0d0a  turn obj........
+00002330: 0d0a 0d0a 0d0a 0d0a 2020 2020 6465 6620  ........    def 
+00002340: 6669 745f 6767 705f 625f 6f6e 6c79 2873  fit_ggp_b_only(s
+00002350: 656c 662c 2070 7369 203d 204e 6f6e 652c  elf, psi = None,
+00002360: 2046 5f73 7461 7274 203d 204e 6f6e 652c   F_start = None,
+00002370: 2020 7265 6720 3d20 4e6f 6e65 2c20 7479    reg = None, ty
+00002380: 7065 5f72 6567 203d 204e 6f6e 652c 2046  pe_reg = None, F
+00002390: 5f6d 6574 686f 6420 3d20 2764 6972 6563  _method = 'direc
+000023a0: 7427 2c20 6320 3d20 4e6f 6e65 292d 3e20  t', c = None)-> 
+000023b0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2022  None:..        "
+000023c0: 2222 0d0a 2020 2020 2020 2020 4772 6170  ""..        Grap
+000023d0: 6820 4750 206f 6e6c 7920 6669 7420 636f  h GP only fit co
+000023e0: 7661 7269 616e 6365 2074 6572 6d0d 0a20  variance term.. 
+000023f0: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
+00002400: 2020 2020 2020 7365 6c66 2e41 203d 204e        self.A = N
+00002410: 6f6e 650d 0a20 2020 2020 2020 2073 656c  one..        sel
+00002420: 662e 465f 6d65 7468 6f64 203d 2046 5f6d  f.F_method = F_m
+00002430: 6574 686f 640d 0a20 2020 2020 2020 2073  ethod..        s
+00002440: 656c 662e 7265 6720 3d20 7265 670d 0a20  elf.reg = reg.. 
+00002450: 2020 2020 2020 2073 656c 662e 7479 7065         self.type
+00002460: 5f72 6567 203d 2074 7970 655f 7265 670d  _reg = type_reg.
+00002470: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
+00002480: 7231 203d 2030 0d0a 2020 2020 2020 2020  r1 = 0..        
+00002490: 7365 6c66 2e72 3220 3d20 7365 6c66 2e72  self.r2 = self.r
+000024a0: 0d0a 0d0a 2020 2020 2020 2020 0d0a 0d0a  ....        ....
+000024b0: 2020 2020 2020 2020 6966 2046 5f73 7461          if F_sta
+000024c0: 7274 2069 7320 4e6f 6e65 3a0d 0a20 2020  rt is None:..   
+000024d0: 2020 2020 2020 2020 2046 5f70 7265 203d           F_pre =
+000024e0: 206e 702e 6f6e 6573 2828 7365 6c66 2e6e   np.ones((self.n
+000024f0: 2c20 7365 6c66 2e72 2929 0d0a 0d0a 2020  , self.r))....  
+00002500: 2020 2020 2020 595f 7469 6c64 6520 3d20        Y_tilde = 
+00002510: 6e70 2e76 7374 6163 6b28 2873 656c 662e  np.vstack((self.
+00002520: 592c 206e 702e 7a65 726f 7328 2873 656c  Y, np.zeros((sel
+00002530: 662e 6e2c 7365 6c66 2e64 2929 2929 0d0a  f.n,self.d))))..
+00002540: 0d0a 0d0a 2020 2020 2020 2020 6966 2070  ....        if p
+00002550: 7369 2069 7320 4e6f 6e65 3a0d 0a20 2020  si is None:..   
+00002560: 2020 2020 2020 2020 2050 7369 5f70 7265           Psi_pre
+00002570: 203d 206e 702e 6964 656e 7469 7479 2873   = np.identity(s
+00002580: 656c 662e 6429 0d0a 2020 2020 2020 2020  elf.d)..        
+00002590: 2020 2020 5073 695f 7072 655f 696e 7620      Psi_pre_inv 
+000025a0: 3d20 6e70 2e6c 696e 616c 672e 696e 7628  = np.linalg.inv(
+000025b0: 5073 695f 7072 6529 0d0a 2020 2020 2020  Psi_pre)..      
+000025c0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+000025d0: 2020 2020 2050 7369 5f70 7265 203d 2070       Psi_pre = p
+000025e0: 7369 0d0a 2020 2020 2020 2020 2020 2020  si..            
+000025f0: 5073 695f 7072 655f 696e 7620 3d20 6e70  Psi_pre_inv = np
+00002600: 2e6c 696e 616c 672e 696e 7628 5073 695f  .linalg.inv(Psi_
+00002610: 7072 6529 0d0a 0d0a 2020 2020 2020 2020  pre)....        
+00002620: 7620 3d20 6e70 2e6f 6e65 7328 7365 6c66  v = np.ones(self
+00002630: 2e6e 290d 0a20 2020 2020 2020 206d 203d  .n)..        m =
+00002640: 206e 702e 6f6e 6573 2873 656c 662e 6e29   np.ones(self.n)
+00002650: 0d0a 2020 2020 2020 2020 2320 5468 6520  ..        # The 
+00002660: 736f 6c75 7469 6f6e 2069 7320 6576 7279  solution is evry
+00002670: 2073 656e 7369 7469 7665 2074 6f20 7468   sensitive to th
+00002680: 6520 696e 6974 616c 206d 6174 7269 782c  e inital matrix,
+00002690: 2074 6865 206c 3220 7265 6775 6c61 7269   the l2 regulari
+000026a0: 7a61 7469 6f6e 2066 6f72 2042 5f70 7265  zation for B_pre
+000026b0: 2065 6666 6563 7473 2061 6c70 6861 0d0a   effects alpha..
+000026c0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+000026d0: 2020 6966 2063 2069 7320 4e6f 6e65 3a0d    if c is None:.
+000026e0: 0a20 2020 2020 2020 2020 2020 2043 5f70  .            C_p
+000026f0: 7265 203d 206e 702e 6f6e 6573 2828 7365  re = np.ones((se
+00002700: 6c66 2e64 2c20 7365 6c66 2e72 2929 2320  lf.d, self.r))# 
+00002710: 6e70 2e64 6f74 2859 5f74 696c 6465 2e54  np.dot(Y_tilde.T
+00002720: 2c20 585f 7469 6c64 6529 2e64 6f74 286e  , X_tilde).dot(n
+00002730: 702e 6c69 6e61 6c67 2e69 6e76 286e 702e  p.linalg.inv(np.
+00002740: 646f 7428 585f 7469 6c64 652e 542c 2058  dot(X_tilde.T, X
+00002750: 5f74 696c 6465 2920 2b20 616c 7068 612a  _tilde) + alpha*
+00002760: 6e70 2e69 6465 6e74 6974 7928 7229 2929  np.identity(r)))
+00002770: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00002780: 0a20 2020 2020 2020 2020 2020 2043 5f70  .            C_p
+00002790: 7265 203d 2063 0d0a 2020 2020 2020 2020  re = c..        
+000027a0: 0d0a 2020 2020 2020 2020 7365 6c66 2e69  ..        self.i
+000027b0: 7465 7261 7469 6f6e 203d 2030 0d0a 2020  teration = 0..  
+000027c0: 2020 2020 2020 7365 6c66 2e74 6f6c 5f76        self.tol_v
+000027d0: 6563 203d 206e 702e 7a65 726f 7328 7365  ec = np.zeros(se
+000027e0: 6c66 2e6d 6178 5f69 7465 7229 0d0a 2020  lf.max_iter)..  
+000027f0: 2020 2020 2020 7768 696c 6520 7365 6c66        while self
+00002800: 2e69 7465 7261 7469 6f6e 203c 7365 6c66  .iteration <self
+00002810: 2e6d 6178 5f69 7465 723a 0d0a 2020 2020  .max_iter:..    
+00002820: 2020 2020 2020 2020 432c 2050 7369 5f65          C, Psi_e
+00002830: 7374 2c20 462c 2074 6f6c 5f69 203d 2073  st, F, tol_i = s
+00002840: 656c 662e 6f6e 655f 6974 6572 6174 696f  elf.one_iteratio
+00002850: 6e28 6e70 2e6c 696e 616c 672e 696e 7628  n(np.linalg.inv(
+00002860: 5073 695f 7072 6529 2c20 7073 692c 2043  Psi_pre), psi, C
+00002870: 5f70 7265 2c20 632c 2059 5f74 696c 6465  _pre, c, Y_tilde
+00002880: 2c20 465f 7072 6520 3d20 465f 7072 652c  , F_pre = F_pre,
+00002890: 2077 6974 685f 6d65 616e 203d 2046 616c   with_mean = Fal
+000028a0: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
+000028b0: 2073 656c 662e 746f 6c5f 7665 635b 7365   self.tol_vec[se
+000028c0: 6c66 2e69 7465 7261 7469 6f6e 5d20 3d20  lf.iteration] = 
+000028d0: 746f 6c5f 690d 0a20 2020 2020 2020 2020  tol_i..         
+000028e0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+000028f0: 2069 6620 2874 6f6c 5f69 3c73 656c 662e   if (tol_i<self.
+00002900: 746f 6c29 2026 2028 6e6f 7420 7365 6c66  tol) & (not self
+00002910: 2e64 6f5f 616c 6c5f 6974 6572 293a 0d0a  .do_all_iter):..
+00002920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002930: 6272 6561 6b0d 0a20 2020 2020 2020 2020  break..         
+00002940: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00002950: 2073 656c 662e 6974 6572 6174 696f 6e2b   self.iteration+
+00002960: 3d31 0d0a 0d0a 2020 2020 2020 2020 2020  =1....          
+00002970: 2020 6966 2070 7369 2069 7320 4e6f 6e65    if psi is None
+00002980: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00002990: 2020 2050 7369 5f70 7265 203d 2050 7369     Psi_pre = Psi
+000029a0: 5f65 7374 2e63 6f70 7928 290d 0a20 2020  _est.copy()..   
+000029b0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+000029c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000029d0: 5073 695f 7072 6520 3d20 7073 690d 0a0d  Psi_pre = psi...
+000029e0: 0a20 2020 2020 2020 2020 2020 2043 5f70  .            C_p
+000029f0: 7265 203d 2043 2e63 6f70 7928 290d 0a20  re = C.copy().. 
+00002a00: 2020 2020 2020 2020 2020 2046 5f70 7265             F_pre
+00002a10: 203d 2046 2e63 6f70 7928 290d 0a0d 0a0d   = F.copy().....
+00002a20: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
+00002a30: 4120 3d20 4e6f 6e65 0d0a 2020 2020 2020  A = None..      
+00002a40: 2020 7365 6c66 2e42 203d 2043 0d0a 2020    self.B = C..  
+00002a50: 2020 2020 2020 7365 6c66 2e46 203d 2046        self.F = F
+00002a60: 0d0a 2020 2020 2020 2020 7365 6c66 2e50  ..        self.P
+00002a70: 7369 203d 2050 7369 5f65 7374 0d0a 0d0a  si = Psi_est....
+00002a80: 0d0a 0d0a 2020 2020 6465 6620 6669 745f  ....    def fit_
+00002a90: 6767 705f 615f 6f6e 6c79 2873 656c 662c  ggp_a_only(self,
+00002aa0: 2070 7369 203d 204e 6f6e 652c 2046 5f73   psi = None, F_s
+00002ab0: 7461 7274 203d 204e 6f6e 652c 2072 6567  tart = None, reg
+00002ac0: 203d 204e 6f6e 652c 2074 7970 655f 7265   = None, type_re
+00002ad0: 6720 3d20 4e6f 6e65 2c20 465f 6d65 7468  g = None, F_meth
+00002ae0: 6f64 203d 2027 6469 7265 6374 272c 2063  od = 'direct', c
+00002af0: 203d 204e 6f6e 6529 202d 3e20 4e6f 6e65   = None) -> None
+00002b00: 3a0d 0a0d 0a20 2020 2020 2020 2073 656c  :....        sel
+00002b10: 662e 4220 3d20 4e6f 6e65 0d0a 2020 2020  f.B = None..    
+00002b20: 2020 2020 7365 6c66 2e72 6567 203d 2072      self.reg = r
+00002b30: 6567 0d0a 2020 2020 2020 2020 7365 6c66  eg..        self
+00002b40: 2e74 7970 655f 7265 6720 3d20 7479 7065  .type_reg = type
+00002b50: 5f72 6567 0d0a 2020 2020 2020 2020 7365  _reg..        se
+00002b60: 6c66 2e46 5f6d 6574 686f 6420 3d20 465f  lf.F_method = F_
+00002b70: 6d65 7468 6f64 0d0a 0d0a 2020 2020 2020  method....      
+00002b80: 2020 7365 6c66 2e72 3120 3d20 7365 6c66    self.r1 = self
+00002b90: 2e72 0d0a 2020 2020 2020 2020 7365 6c66  .r..        self
+00002ba0: 2e72 3220 3d20 300d 0a0d 0a0d 0a20 2020  .r2 = 0......   
+00002bb0: 2020 2020 2069 6620 7073 6920 6973 204e       if psi is N
+00002bc0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+00002bd0: 2020 5073 695f 7072 6520 3d20 6e70 2e69    Psi_pre = np.i
+00002be0: 6465 6e74 6974 7928 7365 6c66 2e64 290d  dentity(self.d).
+00002bf0: 0a20 2020 2020 2020 2020 2020 2050 7369  .            Psi
+00002c00: 5f70 7265 5f69 6e76 203d 206e 702e 6c69  _pre_inv = np.li
+00002c10: 6e61 6c67 2e69 6e76 2850 7369 5f70 7265  nalg.inv(Psi_pre
+00002c20: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+00002c30: 0d0a 2020 2020 2020 2020 2020 2020 5073  ..            Ps
+00002c40: 695f 7072 6520 3d20 7073 690d 0a20 2020  i_pre = psi..   
+00002c50: 2020 2020 2020 2020 2050 7369 5f70 7265           Psi_pre
+00002c60: 5f69 6e76 203d 206e 702e 6c69 6e61 6c67  _inv = np.linalg
+00002c70: 2e69 6e76 2850 7369 5f70 7265 290d 0a0d  .inv(Psi_pre)...
+00002c80: 0a0d 0a0d 0a20 2020 2020 2020 2069 6620  .....        if 
+00002c90: 6320 6973 204e 6f6e 653a 0d0a 2020 2020  c is None:..    
+00002ca0: 2020 2020 2020 2020 435f 7072 6520 3d20          C_pre = 
+00002cb0: 6e70 2e6f 6e65 7328 2873 656c 662e 642c  np.ones((self.d,
+00002cc0: 2073 656c 662e 7229 2923 206e 702e 646f   self.r))# np.do
+00002cd0: 7428 595f 7469 6c64 652e 542c 2058 5f74  t(Y_tilde.T, X_t
+00002ce0: 696c 6465 292e 646f 7428 6e70 2e6c 696e  ilde).dot(np.lin
+00002cf0: 616c 672e 696e 7628 6e70 2e64 6f74 2858  alg.inv(np.dot(X
+00002d00: 5f74 696c 6465 2e54 2c20 585f 7469 6c64  _tilde.T, X_tild
+00002d10: 6529 202b 2061 6c70 6861 2a6e 702e 6964  e) + alpha*np.id
+00002d20: 656e 7469 7479 2872 2929 290d 0a20 2020  entity(r)))..   
+00002d30: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00002d40: 2020 2020 2020 2020 435f 7072 6520 3d20          C_pre = 
+00002d50: 630d 0a0d 0a0d 0a20 2020 2020 2020 2073  c......        s
+00002d60: 656c 662e 6974 6572 6174 696f 6e20 3d20  elf.iteration = 
+00002d70: 300d 0a20 2020 2020 2020 2073 656c 662e  0..        self.
+00002d80: 746f 6c5f 7665 6320 3d20 6e70 2e7a 6572  tol_vec = np.zer
+00002d90: 6f73 2873 656c 662e 6d61 785f 6974 6572  os(self.max_iter
+00002da0: 290d 0a20 2020 2020 2020 2077 6869 6c65  )..        while
+00002db0: 2073 656c 662e 6974 6572 6174 696f 6e20   self.iteration 
+00002dc0: 3c73 656c 662e 6d61 785f 6974 6572 3a0d  <self.max_iter:.
+00002dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002de0: 2020 2020 2023 204d 2d73 7465 700d 0a20       # M-step.. 
+00002df0: 2020 2020 2020 2020 2020 2050 7369 5f70             Psi_p
+00002e00: 7265 5f69 6e76 203d 206e 702e 6c69 6e61  re_inv = np.lina
+00002e10: 6c67 2e69 6e76 2850 7369 5f70 7265 290d  lg.inv(Psi_pre).
+00002e20: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00002e30: 7365 6c66 2e46 5f6d 6574 686f 6420 3d3d  self.F_method ==
+00002e40: 2027 6469 7265 6374 273a 0d0a 2020 2020   'direct':..    
+00002e50: 2020 2020 2020 2020 2020 2020 4620 3d20              F = 
+00002e60: 7365 6c66 2e46 5f6c 735f 7265 6728 2043  self.F_ls_reg( C
+00002e70: 5f70 7265 2c20 5073 695f 7072 655f 696e  _pre, Psi_pre_in
+00002e80: 7629 0d0a 2020 2020 2020 2020 2020 2020  v)..            
+00002e90: 656c 6966 2073 656c 662e 465f 6d65 7468  elif self.F_meth
+00002ea0: 6f64 203d 3d20 2773 6563 616e 7427 3a0d  od == 'secant':.
+00002eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002ec0: 2046 203d 2073 656c 662e 465f 7365 6361   F = self.F_seca
+00002ed0: 6e74 5f6f 7074 696d 286e 702e 7a65 726f  nt_optim(np.zero
+00002ee0: 7328 2873 656c 662e 642c 2073 656c 662e  s((self.d, self.
+00002ef0: 7229 292c 2043 5f70 7265 2c20 6e70 2e6f  r)), C_pre, np.o
+00002f00: 6e65 7328 7365 6c66 2e6e 292c 6e70 2e6f  nes(self.n),np.o
+00002f10: 6e65 7328 7365 6c66 2e6e 292c 2050 7369  nes(self.n), Psi
+00002f20: 5f70 7265 5f69 6e76 290d 0a0d 0a20 2020  _pre_inv)....   
+00002f30: 2020 2020 2020 2020 2069 6620 6320 6973           if c is
+00002f40: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00002f50: 2020 2020 2020 2020 435f 746d 7020 3d20          C_tmp = 
+00002f60: 435f 7072 652e 666c 6174 7465 6e28 290d  C_pre.flatten().
+00002f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002f80: 2043 5f76 6563 203d 206e 702e 7a65 726f   C_vec = np.zero
+00002f90: 7328 322a 2873 656c 662e 7231 2b73 656c  s(2*(self.r1+sel
+00002fa0: 662e 7232 292a 7365 6c66 2e64 290d 0a20  f.r2)*self.d).. 
+00002fb0: 2020 2020 2020 2020 2020 2020 2020 2043                 C
+00002fc0: 5f76 6563 5b3a 2873 656c 662e 7231 2b73  _vec[:(self.r1+s
+00002fd0: 656c 662e 7232 292a 7365 6c66 2e64 5d20  elf.r2)*self.d] 
+00002fe0: 3d20 6e70 2e61 6273 2843 5f74 6d70 2920  = np.abs(C_tmp) 
+00002ff0: 2a20 2843 5f74 6d70 3e30 290d 0a20 2020  * (C_tmp>0)..   
+00003000: 2020 2020 2020 2020 2020 2020 2043 5f76               C_v
+00003010: 6563 5b28 7365 6c66 2e72 312b 7365 6c66  ec[(self.r1+self
+00003020: 2e72 3229 2a73 656c 662e 643a 5d20 3d20  .r2)*self.d:] = 
+00003030: 6e70 2e61 6273 2843 5f74 6d70 2920 2a20  np.abs(C_tmp) * 
+00003040: 2843 5f74 6d70 3c30 290d 0a0d 0a20 2020  (C_tmp<0)....   
+00003050: 2020 2020 2020 2020 2020 2020 206f 7574               out
+00003060: 203d 206d 696e 696d 697a 6528 7365 6c66   = minimize(self
+00003070: 2e6c 6173 736f 5f6f 626a 6563 7469 7665  .lasso_objective
+00003080: 2c20 435f 7665 632c 2061 7267 7320 3d20  , C_vec, args = 
+00003090: 2846 2c20 7365 6c66 2e59 2c20 5073 695f  (F, self.Y, Psi_
+000030a0: 7072 655f 696e 762c 7365 6c66 2e64 2c73  pre_inv,self.d,s
+000030b0: 656c 662e 7231 2b73 656c 662e 7232 2c20  elf.r1+self.r2, 
+000030c0: 7365 6c66 2e61 6c70 6861 292c 206d 6574  self.alpha), met
+000030d0: 686f 643d 274c 2d42 4647 532d 4227 2c20  hod='L-BFGS-B', 
+000030e0: 6a61 633d 5472 7565 2c20 626f 756e 6473  jac=True, bounds
+000030f0: 203d 205b 2830 2e30 2c4e 6f6e 6529 5d2a   = [(0.0,None)]*
+00003100: 2832 2a28 7365 6c66 2e72 312b 7365 6c66  (2*(self.r1+self
+00003110: 2e72 3229 2a73 656c 662e 6429 290d 0a20  .r2)*self.d)).. 
+00003120: 2020 2020 2020 2020 2020 2020 2020 2043                 C
+00003130: 5f76 6563 203d 206f 7574 2e78 0d0a 2020  _vec = out.x..  
+00003140: 2020 2020 2020 2020 2020 2020 2020 4320                C 
+00003150: 3d20 6e70 2e72 6573 6861 7065 286f 7574  = np.reshape(out
+00003160: 2e78 5b3a 2873 656c 662e 7231 2b73 656c  .x[:(self.r1+sel
+00003170: 662e 7232 292a 7365 6c66 2e64 5d20 2d20  f.r2)*self.d] - 
+00003180: 6f75 742e 785b 2873 656c 662e 7231 2b73  out.x[(self.r1+s
+00003190: 656c 662e 7232 292a 7365 6c66 2e64 3a5d  elf.r2)*self.d:]
+000031a0: 2c20 2873 656c 662e 642c 7365 6c66 2e72  , (self.d,self.r
+000031b0: 312b 7365 6c66 2e72 3229 290d 0a0d 0a20  1+self.r2)).... 
+000031c0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+000031d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000031e0: 2020 4320 3d20 630d 0a0d 0a0d 0a20 2020    C = c......   
+000031f0: 2020 2020 2020 2020 2074 6f6c 5f69 203d           tol_i =
+00003200: 2028 6e70 2e6c 696e 616c 672e 6e6f 726d   (np.linalg.norm
+00003210: 2843 2d43 5f70 7265 2929 2f28 6e70 2e6c  (C-C_pre))/(np.l
+00003220: 696e 616c 672e 6e6f 726d 2843 5f70 7265  inalg.norm(C_pre
+00003230: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00003240: 7365 6c66 2e74 6f6c 5f76 6563 5b73 656c  self.tol_vec[sel
+00003250: 662e 6974 6572 6174 696f 6e5d 203d 2074  f.iteration] = t
+00003260: 6f6c 5f69 0d0a 2020 2020 2020 2020 0d0a  ol_i..        ..
+00003270: 2020 2020 2020 2020 2020 2020 6966 2028              if (
+00003280: 746f 6c5f 693c 7365 6c66 2e74 6f6c 2920  tol_i<self.tol) 
+00003290: 2620 286e 6f74 2073 656c 662e 646f 5f61  & (not self.do_a
+000032a0: 6c6c 5f69 7465 7229 3a0d 0a20 2020 2020  ll_iter):..     
+000032b0: 2020 2020 2020 2020 2020 2062 7265 616b             break
+000032c0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+000032d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000032e0: 2e69 7465 7261 7469 6f6e 2b3d 310d 0a20  .iteration+=1.. 
+000032f0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00003300: 2020 2020 2020 2020 2069 6620 7073 6920           if psi 
+00003310: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
+00003320: 2020 2020 2020 2020 2020 5073 695f 6573            Psi_es
+00003330: 7420 3d20 6e70 2e63 6f76 2828 7365 6c66  t = np.cov((self
+00003340: 2e59 2d6e 702e 646f 7428 462c 432e 5429  .Y-np.dot(F,C.T)
+00003350: 292e 5429 2a28 7365 6c66 2e6e 2d31 292f  ).T)*(self.n-1)/
+00003360: 7365 6c66 2e6e 0d0a 2020 2020 2020 2020  self.n..        
+00003370: 2020 2020 2020 2020 5073 695f 7072 6520          Psi_pre 
+00003380: 3d20 5073 695f 6573 742e 636f 7079 2829  = Psi_est.copy()
+00003390: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+000033a0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+000033b0: 2020 2020 2050 7369 5f65 7374 203d 2070       Psi_est = p
+000033c0: 7369 0d0a 0d0a 0d0a 2020 2020 2020 2020  si......        
+000033d0: 2020 2020 435f 7072 6520 3d20 432e 636f      C_pre = C.co
+000033e0: 7079 2829 0d0a 2020 2020 2020 2020 2020  py()..          
+000033f0: 2020 7365 6c66 2e69 7465 7261 7469 6f6e    self.iteration
+00003400: 2b3d 310d 0a0d 0a0d 0a20 2020 2020 2020  +=1......       
+00003410: 2073 656c 662e 4120 3d20 430d 0a20 2020   self.A = C..   
+00003420: 2020 2020 2073 656c 662e 4220 3d20 4e6f       self.B = No
+00003430: 6e65 0d0a 2020 2020 2020 2020 7365 6c66  ne..        self
+00003440: 2e46 203d 2046 0d0a 2020 2020 2020 2020  .F = F..        
+00003450: 7365 6c66 2e50 7369 203d 2050 7369 5f65  self.Psi = Psi_e
+00003460: 7374 0d0a 0d0a 0d0a 0d0a 0d0a 0d0a 0d0a  st..............
```

### Comparing `DyGraph-0.0.3/src/DyGraph/RootDygl.py` & `DyGraph-0.0.4/src/DyGraph/RootDygl.py`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.3/src/DyGraph/dyg_outer_em.py` & `DyGraph-0.0.4/src/DyGraph/dyg_outer_em.py`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.3/src/DyGraph/dygl_inner_em.py` & `DyGraph-0.0.4/src/DyGraph/dygl_inner_em.py`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.3/src/DyGraph/dygl_utils.py` & `DyGraph-0.0.4/src/DyGraph/dygl_utils.py`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.3/src/DyGraph/sgl_inner_em.py` & `DyGraph-0.0.4/src/DyGraph/sgl_inner_em.py`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.3/src/DyGraph/sgl_outer_em.py` & `DyGraph-0.0.4/src/DyGraph/sgl_outer_em.py`

 * *Files identical despite different names*

### Comparing `DyGraph-0.0.3/src/DyGraph.egg-info/PKG-INFO` & `DyGraph-0.0.4/src/DyGraph.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: DyGraph
-Version: 0.0.3
+Version: 0.0.4
 Summary: A package for estimating dynamic graphical lasso with heavy tailed distributions
 Home-page: https://github.com/ragnarlevi/DyGraph
 Author: ragnarlevi
 License: MIT
 Project-URL: Bug Tracker, https://github.com/ragnarlevi/DyGraph/issues
 Platform: unix
 Platform: linux
```

### Comparing `DyGraph-0.0.3/src/DyGraph.egg-info/SOURCES.txt` & `DyGraph-0.0.4/src/DyGraph.egg-info/SOURCES.txt`

 * *Files identical despite different names*

